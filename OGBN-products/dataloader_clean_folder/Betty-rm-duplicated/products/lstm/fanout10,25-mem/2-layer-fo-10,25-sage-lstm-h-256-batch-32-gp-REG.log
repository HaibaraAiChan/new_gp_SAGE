main start at this time 1661485104.2345822
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.20376920700073242
global_2_local spend time (sec) 0.3590695858001709

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.898 seconds
Metis partitioning: 12.965 seconds
Split the graph: 0.673 seconds
Construct subgraphs: 0.265 seconds
6093
6085
6323
6327
5966
5970
6301
6307
6012
6293
6276
6271
5968
5983
6286
5963
6317
6011
5991
6327
6022
5971
5963
6084
5967
6326
6190
6082
5963
6320
6297
6316
REG metis partition end ----................................
the time spent:  25.648690700531006
REG construction  time spent:  8.826935052871704
pure dgl.metis_partition the time spent:  16.8217556476593
total k batches seeds list generation spend  26.174833059310913
after graph partition
graph partition algorithm spend time 26.596858978271484

partition_len_list
[47900, 52859, 60205, 62031, 54341, 56898, 55242, 46549, 53171, 55017, 58798, 73435, 56373, 59620, 65709, 70881, 44267, 63516, 56658, 59458, 44120, 48568, 54922, 49114, 58496, 66190, 58804, 83189, 66617, 76431, 68117, 66109]
REG selection method  spend 27.14302134513855
check_connections_block*********************************
time for parepare 1: 0.21979165077209473
local_output_nid generation: 0.002124309539794922
local_in_edges_tensor generation: 0.002700328826904297

&&&&&&&&&&&&&&& before remove duplicate length: 146503
remove duplicated spend time : 0.02178025245666504

&&&&&&&&&&&&&&& after remove duplicate length: 47410

mini_batch_src_global generation: 0.0027430057525634766
r_  generation: 0.021422863006591797

local_output_nid generation: 0.0024306774139404297
local_in_edges_tensor generation: 0.0025320053100585938

&&&&&&&&&&&&&&& before remove duplicate length: 147185
remove duplicated spend time : 0.021946191787719727

&&&&&&&&&&&&&&& after remove duplicate length: 52372

mini_batch_src_global generation: 0.0033788681030273438
r_  generation: 0.022821903228759766

local_output_nid generation: 0.002596616744995117
local_in_edges_tensor generation: 0.0025932788848876953

&&&&&&&&&&&&&&& before remove duplicate length: 152941
remove duplicated spend time : 0.024236202239990234

&&&&&&&&&&&&&&& after remove duplicate length: 59654

mini_batch_src_global generation: 0.003893613815307617
r_  generation: 0.02612447738647461

local_output_nid generation: 0.002607583999633789
local_in_edges_tensor generation: 0.0026483535766601562

&&&&&&&&&&&&&&& before remove duplicate length: 151661
remove duplicated spend time : 0.02320098876953125

&&&&&&&&&&&&&&& after remove duplicate length: 61314

mini_batch_src_global generation: 0.004086732864379883
r_  generation: 0.026951313018798828

local_output_nid generation: 0.0024950504302978516
local_in_edges_tensor generation: 0.0025386810302734375

&&&&&&&&&&&&&&& before remove duplicate length: 144508
remove duplicated spend time : 0.02276754379272461

&&&&&&&&&&&&&&& after remove duplicate length: 53865

mini_batch_src_global generation: 0.003806591033935547
r_  generation: 0.024593353271484375

local_output_nid generation: 0.002506732940673828
local_in_edges_tensor generation: 0.0025031566619873047

&&&&&&&&&&&&&&& before remove duplicate length: 145363
remove duplicated spend time : 0.0216519832611084

&&&&&&&&&&&&&&& after remove duplicate length: 56254

mini_batch_src_global generation: 0.0038573741912841797
r_  generation: 0.02527904510498047

local_output_nid generation: 0.002617359161376953
local_in_edges_tensor generation: 0.0025682449340820312

&&&&&&&&&&&&&&& before remove duplicate length: 148160
remove duplicated spend time : 0.022606849670410156

&&&&&&&&&&&&&&& after remove duplicate length: 54383

mini_batch_src_global generation: 0.003766775131225586
r_  generation: 0.025163650512695312

local_output_nid generation: 0.002605438232421875
local_in_edges_tensor generation: 0.002664327621459961

&&&&&&&&&&&&&&& before remove duplicate length: 149849
remove duplicated spend time : 0.021689653396606445

&&&&&&&&&&&&&&& after remove duplicate length: 46146

mini_batch_src_global generation: 0.0032176971435546875
r_  generation: 0.02231311798095703

local_output_nid generation: 0.0025153160095214844
local_in_edges_tensor generation: 0.0024013519287109375

&&&&&&&&&&&&&&& before remove duplicate length: 128654
remove duplicated spend time : 0.018908023834228516

&&&&&&&&&&&&&&& after remove duplicate length: 50739

mini_batch_src_global generation: 0.0034837722778320312
r_  generation: 0.022637128829956055

local_output_nid generation: 0.0026547908782958984
local_in_edges_tensor generation: 0.002650022506713867

&&&&&&&&&&&&&&& before remove duplicate length: 155931
remove duplicated spend time : 0.023960590362548828

&&&&&&&&&&&&&&& after remove duplicate length: 54447

mini_batch_src_global generation: 0.0037741661071777344
r_  generation: 0.02442169189453125

local_output_nid generation: 0.002590656280517578
local_in_edges_tensor generation: 0.0026166439056396484

&&&&&&&&&&&&&&& before remove duplicate length: 156264
remove duplicated spend time : 0.02416682243347168

&&&&&&&&&&&&&&& after remove duplicate length: 58281

mini_batch_src_global generation: 0.004065990447998047
r_  generation: 0.026517629623413086

local_output_nid generation: 0.0026085376739501953
local_in_edges_tensor generation: 0.002591371536254883

&&&&&&&&&&&&&&& before remove duplicate length: 156295
remove duplicated spend time : 0.025542020797729492

&&&&&&&&&&&&&&& after remove duplicate length: 72751

mini_batch_src_global generation: 0.0048372745513916016
r_  generation: 0.0318751335144043

local_output_nid generation: 0.00251007080078125
local_in_edges_tensor generation: 0.0025238990783691406

&&&&&&&&&&&&&&& before remove duplicate length: 148426
remove duplicated spend time : 0.022568464279174805

&&&&&&&&&&&&&&& after remove duplicate length: 55656

mini_batch_src_global generation: 0.0040857791900634766
r_  generation: 0.0254974365234375

local_output_nid generation: 0.0025086402893066406
local_in_edges_tensor generation: 0.0024940967559814453

&&&&&&&&&&&&&&& before remove duplicate length: 144917
remove duplicated spend time : 0.02153468132019043

&&&&&&&&&&&&&&& after remove duplicate length: 57664

mini_batch_src_global generation: 0.0038564205169677734
r_  generation: 0.024972915649414062

local_output_nid generation: 0.002603769302368164
local_in_edges_tensor generation: 0.002567768096923828

&&&&&&&&&&&&&&& before remove duplicate length: 153072
remove duplicated spend time : 0.024168729782104492

&&&&&&&&&&&&&&& after remove duplicate length: 64355

mini_batch_src_global generation: 0.004354000091552734
r_  generation: 0.02836775779724121

local_output_nid generation: 0.002488851547241211
local_in_edges_tensor generation: 0.002474069595336914

&&&&&&&&&&&&&&& before remove duplicate length: 134485
remove duplicated spend time : 0.02236199378967285

&&&&&&&&&&&&&&& after remove duplicate length: 68735

mini_batch_src_global generation: 0.0045278072357177734
r_  generation: 0.02930593490600586

local_output_nid generation: 0.0026063919067382812
local_in_edges_tensor generation: 0.002645254135131836

&&&&&&&&&&&&&&& before remove duplicate length: 155376
remove duplicated spend time : 0.022653579711914062

&&&&&&&&&&&&&&& after remove duplicate length: 44002

mini_batch_src_global generation: 0.003299236297607422
r_  generation: 0.02244853973388672

local_output_nid generation: 0.0025594234466552734
local_in_edges_tensor generation: 0.002500295639038086

&&&&&&&&&&&&&&& before remove duplicate length: 147571
remove duplicated spend time : 0.022579669952392578

&&&&&&&&&&&&&&& after remove duplicate length: 62842

mini_batch_src_global generation: 0.004185676574707031
r_  generation: 0.027101755142211914

local_output_nid generation: 0.002471923828125
local_in_edges_tensor generation: 0.0025005340576171875

&&&&&&&&&&&&&&& before remove duplicate length: 145170
remove duplicated spend time : 0.022989511489868164

&&&&&&&&&&&&&&& after remove duplicate length: 55882

mini_batch_src_global generation: 0.0038595199584960938
r_  generation: 0.025665283203125

local_output_nid generation: 0.0037238597869873047
local_in_edges_tensor generation: 0.013057947158813477

&&&&&&&&&&&&&&& before remove duplicate length: 153520
remove duplicated spend time : 0.02478814125061035

&&&&&&&&&&&&&&& after remove duplicate length: 58842

mini_batch_src_global generation: 0.004027128219604492
r_  generation: 0.026962995529174805

local_output_nid generation: 0.0025386810302734375
local_in_edges_tensor generation: 0.01670980453491211

&&&&&&&&&&&&&&& before remove duplicate length: 142210
remove duplicated spend time : 0.02042698860168457

&&&&&&&&&&&&&&& after remove duplicate length: 43436

mini_batch_src_global generation: 0.0031785964965820312
r_  generation: 0.019155502319335938

local_output_nid generation: 0.002507448196411133
local_in_edges_tensor generation: 0.05176901817321777

&&&&&&&&&&&&&&& before remove duplicate length: 141837
remove duplicated spend time : 0.021118640899658203

&&&&&&&&&&&&&&& after remove duplicate length: 47772

mini_batch_src_global generation: 0.0033185482025146484
r_  generation: 0.022341489791870117

local_output_nid generation: 0.0035562515258789062
local_in_edges_tensor generation: 0.006426572799682617

&&&&&&&&&&&&&&& before remove duplicate length: 137851
remove duplicated spend time : 0.02124762535095215

&&&&&&&&&&&&&&& after remove duplicate length: 53702

mini_batch_src_global generation: 0.0036497116088867188
r_  generation: 0.023680686950683594

local_output_nid generation: 0.002572298049926758
local_in_edges_tensor generation: 0.004620790481567383

&&&&&&&&&&&&&&& before remove duplicate length: 150035
remove duplicated spend time : 0.023301362991333008

&&&&&&&&&&&&&&& after remove duplicate length: 48831

mini_batch_src_global generation: 0.003399372100830078
r_  generation: 0.02298140525817871

local_output_nid generation: 0.0024864673614501953
local_in_edges_tensor generation: 0.003426074981689453

&&&&&&&&&&&&&&& before remove duplicate length: 146558
remove duplicated spend time : 0.024127483367919922

&&&&&&&&&&&&&&& after remove duplicate length: 57832

mini_batch_src_global generation: 0.003906965255737305
r_  generation: 0.025438785552978516

local_output_nid generation: 0.0026154518127441406
local_in_edges_tensor generation: 0.0031435489654541016

&&&&&&&&&&&&&&& before remove duplicate length: 157096
remove duplicated spend time : 0.026227712631225586

&&&&&&&&&&&&&&& after remove duplicate length: 65553

mini_batch_src_global generation: 0.004438161849975586
r_  generation: 0.02931380271911621

local_output_nid generation: 0.0025663375854492188
local_in_edges_tensor generation: 0.002864837646484375

&&&&&&&&&&&&&&& before remove duplicate length: 153806
remove duplicated spend time : 0.02607870101928711

&&&&&&&&&&&&&&& after remove duplicate length: 58409

mini_batch_src_global generation: 0.0040836334228515625
r_  generation: 0.02710413932800293

local_output_nid generation: 0.0025136470794677734
local_in_edges_tensor generation: 0.0026235580444335938

&&&&&&&&&&&&&&& before remove duplicate length: 149486
remove duplicated spend time : 0.02634143829345703

&&&&&&&&&&&&&&& after remove duplicate length: 81651

mini_batch_src_global generation: 0.005346775054931641
r_  generation: 0.03618335723876953

local_output_nid generation: 0.002569437026977539
local_in_edges_tensor generation: 0.00261688232421875

&&&&&&&&&&&&&&& before remove duplicate length: 148241
remove duplicated spend time : 0.025197267532348633

&&&&&&&&&&&&&&& after remove duplicate length: 65706

mini_batch_src_global generation: 0.005011558532714844
r_  generation: 0.03212547302246094

local_output_nid generation: 0.002669095993041992
local_in_edges_tensor generation: 0.0026590824127197266

&&&&&&&&&&&&&&& before remove duplicate length: 157216
remove duplicated spend time : 0.02800273895263672

&&&&&&&&&&&&&&& after remove duplicate length: 75393

mini_batch_src_global generation: 0.005608558654785156
r_  generation: 0.03551602363586426

local_output_nid generation: 0.0026445388793945312
local_in_edges_tensor generation: 0.002689361572265625

&&&&&&&&&&&&&&& before remove duplicate length: 156668
remove duplicated spend time : 0.027354717254638672

&&&&&&&&&&&&&&& after remove duplicate length: 67549

mini_batch_src_global generation: 0.00518345832824707
r_  generation: 0.033333539962768555

local_output_nid generation: 0.002687215805053711
local_in_edges_tensor generation: 0.0026693344116210938

&&&&&&&&&&&&&&& before remove duplicate length: 157024
remove duplicated spend time : 0.027265548706054688

&&&&&&&&&&&&&&& after remove duplicate length: 65643

mini_batch_src_global generation: 0.00505375862121582
r_  generation: 0.032520294189453125


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6665353775024414
gen group dst list time:  0.04996442794799805
check_connections_block*********************************
time for parepare 1: 0.3705310821533203
local_output_nid generation: 0.01285696029663086
local_in_edges_tensor generation: 0.06163191795349121

&&&&&&&&&&&&&&& before remove duplicate length: 462765
remove duplicated spend time : 0.07958006858825684

&&&&&&&&&&&&&&& after remove duplicate length: 139617

mini_batch_src_global generation: 0.008436918258666992
r_  generation: 0.07962679862976074

local_output_nid generation: 0.017293691635131836
local_in_edges_tensor generation: 0.019341230392456055

&&&&&&&&&&&&&&& before remove duplicate length: 509101
remove duplicated spend time : 0.09822511672973633

&&&&&&&&&&&&&&& after remove duplicate length: 165709

mini_batch_src_global generation: 0.01382756233215332
r_  generation: 0.10321998596191406

local_output_nid generation: 0.019633769989013672
local_in_edges_tensor generation: 0.01886272430419922

&&&&&&&&&&&&&&& before remove duplicate length: 579749
remove duplicated spend time : 0.11675190925598145

&&&&&&&&&&&&&&& after remove duplicate length: 173745

mini_batch_src_global generation: 0.017030715942382812
r_  generation: 0.11896705627441406

local_output_nid generation: 0.019517898559570312
local_in_edges_tensor generation: 0.020397663116455078

&&&&&&&&&&&&&&& before remove duplicate length: 594826
remove duplicated spend time : 0.1370866298675537

&&&&&&&&&&&&&&& after remove duplicate length: 193119

mini_batch_src_global generation: 0.021059036254882812
r_  generation: 0.14355850219726562

local_output_nid generation: 0.018135547637939453
local_in_edges_tensor generation: 0.016389131546020508

&&&&&&&&&&&&&&& before remove duplicate length: 524669
remove duplicated spend time : 0.12294316291809082

&&&&&&&&&&&&&&& after remove duplicate length: 182509

mini_batch_src_global generation: 0.02142810821533203
r_  generation: 0.13826370239257812

local_output_nid generation: 0.017162084579467773
local_in_edges_tensor generation: 0.015171051025390625

&&&&&&&&&&&&&&& before remove duplicate length: 556160
remove duplicated spend time : 0.13036799430847168

&&&&&&&&&&&&&&& after remove duplicate length: 182705

mini_batch_src_global generation: 0.020958662033081055
r_  generation: 0.1375586986541748

local_output_nid generation: 0.0167388916015625
local_in_edges_tensor generation: 0.014896631240844727

&&&&&&&&&&&&&&& before remove duplicate length: 536262
remove duplicated spend time : 0.12164878845214844

&&&&&&&&&&&&&&& after remove duplicate length: 178227

mini_batch_src_global generation: 0.022565841674804688
r_  generation: 0.13781332969665527

local_output_nid generation: 0.013765811920166016
local_in_edges_tensor generation: 0.014554500579833984

&&&&&&&&&&&&&&& before remove duplicate length: 444276
remove duplicated spend time : 0.08989548683166504

&&&&&&&&&&&&&&& after remove duplicate length: 116907

mini_batch_src_global generation: 0.012311220169067383
r_  generation: 0.08631134033203125

local_output_nid generation: 0.017284154891967773
local_in_edges_tensor generation: 0.01933598518371582

&&&&&&&&&&&&&&& before remove duplicate length: 521559
remove duplicated spend time : 0.12470769882202148

&&&&&&&&&&&&&&& after remove duplicate length: 214162

mini_batch_src_global generation: 0.02246570587158203
r_  generation: 0.2659471035003662

local_output_nid generation: 0.017565011978149414
local_in_edges_tensor generation: 0.018210649490356445

&&&&&&&&&&&&&&& before remove duplicate length: 544225
remove duplicated spend time : 0.1136775016784668

&&&&&&&&&&&&&&& after remove duplicate length: 158826

mini_batch_src_global generation: 0.01874065399169922
r_  generation: 0.11578154563903809

local_output_nid generation: 0.017661094665527344
local_in_edges_tensor generation: 0.015536308288574219

&&&&&&&&&&&&&&& before remove duplicate length: 582018
remove duplicated spend time : 0.11586189270019531

&&&&&&&&&&&&&&& after remove duplicate length: 148454

mini_batch_src_global generation: 0.015442609786987305
r_  generation: 0.10695457458496094

local_output_nid generation: 0.022718429565429688
local_in_edges_tensor generation: 0.025027036666870117

&&&&&&&&&&&&&&& before remove duplicate length: 730231
remove duplicated spend time : 0.1696765422821045

&&&&&&&&&&&&&&& after remove duplicate length: 233564

mini_batch_src_global generation: 0.026935577392578125
r_  generation: 0.16971087455749512

local_output_nid generation: 0.018077850341796875
local_in_edges_tensor generation: 0.017740488052368164

&&&&&&&&&&&&&&& before remove duplicate length: 558606
remove duplicated spend time : 0.13279461860656738

&&&&&&&&&&&&&&& after remove duplicate length: 196445

mini_batch_src_global generation: 0.024471282958984375
r_  generation: 0.14896488189697266

local_output_nid generation: 0.01938605308532715
local_in_edges_tensor generation: 0.018285036087036133

&&&&&&&&&&&&&&& before remove duplicate length: 590106
remove duplicated spend time : 0.14333033561706543

&&&&&&&&&&&&&&& after remove duplicate length: 246662

mini_batch_src_global generation: 0.028865814208984375
r_  generation: 0.1713707447052002

local_output_nid generation: 0.019731998443603516
local_in_edges_tensor generation: 0.01696491241455078

&&&&&&&&&&&&&&& before remove duplicate length: 648970
remove duplicated spend time : 0.15705513954162598

&&&&&&&&&&&&&&& after remove duplicate length: 218678

mini_batch_src_global generation: 0.026908159255981445
r_  generation: 0.16963672637939453

local_output_nid generation: 0.02469015121459961
local_in_edges_tensor generation: 0.08341407775878906

&&&&&&&&&&&&&&& before remove duplicate length: 693415
remove duplicated spend time : 0.17122936248779297

&&&&&&&&&&&&&&& after remove duplicate length: 302990

mini_batch_src_global generation: 0.03586888313293457
r_  generation: 0.20946383476257324

local_output_nid generation: 0.014169931411743164
local_in_edges_tensor generation: 0.012189865112304688

&&&&&&&&&&&&&&& before remove duplicate length: 431544
remove duplicated spend time : 0.09830689430236816

&&&&&&&&&&&&&&& after remove duplicate length: 126904

mini_batch_src_global generation: 0.01526641845703125
r_  generation: 0.09513974189758301

local_output_nid generation: 0.019261598587036133
local_in_edges_tensor generation: 0.017660140991210938

&&&&&&&&&&&&&&& before remove duplicate length: 624812
remove duplicated spend time : 0.14763474464416504

&&&&&&&&&&&&&&& after remove duplicate length: 212692

mini_batch_src_global generation: 0.02257823944091797
r_  generation: 0.1498725414276123

local_output_nid generation: 0.01891183853149414
local_in_edges_tensor generation: 0.017877578735351562

&&&&&&&&&&&&&&& before remove duplicate length: 551893
remove duplicated spend time : 0.1411130428314209

&&&&&&&&&&&&&&& after remove duplicate length: 211295

mini_batch_src_global generation: 0.025827646255493164
r_  generation: 0.15614104270935059

local_output_nid generation: 0.018406152725219727
local_in_edges_tensor generation: 0.016406774520874023

&&&&&&&&&&&&&&& before remove duplicate length: 579127
remove duplicated spend time : 0.14279961585998535

&&&&&&&&&&&&&&& after remove duplicate length: 180905

mini_batch_src_global generation: 0.021587133407592773
r_  generation: 0.14129090309143066

local_output_nid generation: 0.013939142227172852
local_in_edges_tensor generation: 0.012200355529785156

&&&&&&&&&&&&&&& before remove duplicate length: 427803
remove duplicated spend time : 0.08946967124938965

&&&&&&&&&&&&&&& after remove duplicate length: 110384

mini_batch_src_global generation: 0.012333869934082031
r_  generation: 0.08250308036804199

local_output_nid generation: 0.014907121658325195
local_in_edges_tensor generation: 0.013091802597045898

&&&&&&&&&&&&&&& before remove duplicate length: 472537
remove duplicated spend time : 0.09406518936157227

&&&&&&&&&&&&&&& after remove duplicate length: 129859

mini_batch_src_global generation: 0.012534379959106445
r_  generation: 0.08783936500549316

local_output_nid generation: 0.017035245895385742
local_in_edges_tensor generation: 0.015285968780517578

&&&&&&&&&&&&&&& before remove duplicate length: 532483
remove duplicated spend time : 0.12838983535766602

&&&&&&&&&&&&&&& after remove duplicate length: 177014

mini_batch_src_global generation: 0.019775867462158203
r_  generation: 0.12978458404541016

local_output_nid generation: 0.014168262481689453
local_in_edges_tensor generation: 0.011750221252441406

&&&&&&&&&&&&&&& before remove duplicate length: 482110
remove duplicated spend time : 0.10118627548217773

&&&&&&&&&&&&&&& after remove duplicate length: 117532

mini_batch_src_global generation: 0.013502836227416992
r_  generation: 0.088775634765625

local_output_nid generation: 0.01886296272277832
local_in_edges_tensor generation: 0.018200397491455078

&&&&&&&&&&&&&&& before remove duplicate length: 572701
remove duplicated spend time : 0.13885831832885742

&&&&&&&&&&&&&&& after remove duplicate length: 199092

mini_batch_src_global generation: 0.022250652313232422
r_  generation: 0.14224481582641602

local_output_nid generation: 0.02066349983215332
local_in_edges_tensor generation: 0.02230095863342285

&&&&&&&&&&&&&&& before remove duplicate length: 656202
remove duplicated spend time : 0.16216754913330078

&&&&&&&&&&&&&&& after remove duplicate length: 213482

mini_batch_src_global generation: 0.026981353759765625
r_  generation: 0.1638641357421875

local_output_nid generation: 0.018517494201660156
local_in_edges_tensor generation: 0.016701936721801758

&&&&&&&&&&&&&&& before remove duplicate length: 582545
remove duplicated spend time : 0.13386940956115723

&&&&&&&&&&&&&&& after remove duplicate length: 169471

mini_batch_src_global generation: 0.021193265914916992
r_  generation: 0.12662696838378906

local_output_nid generation: 0.026510238647460938
local_in_edges_tensor generation: 0.025440692901611328

&&&&&&&&&&&&&&& before remove duplicate length: 824356
remove duplicated spend time : 0.20934152603149414

&&&&&&&&&&&&&&& after remove duplicate length: 318297

mini_batch_src_global generation: 0.03802204132080078
r_  generation: 0.2227339744567871

local_output_nid generation: 0.02129817008972168
local_in_edges_tensor generation: 0.023046016693115234

&&&&&&&&&&&&&&& before remove duplicate length: 660379
remove duplicated spend time : 0.16759085655212402

&&&&&&&&&&&&&&& after remove duplicate length: 222625

mini_batch_src_global generation: 0.030470848083496094
r_  generation: 0.17731118202209473

local_output_nid generation: 0.024700403213500977
local_in_edges_tensor generation: 0.02295231819152832

&&&&&&&&&&&&&&& before remove duplicate length: 757633
remove duplicated spend time : 0.18404579162597656

&&&&&&&&&&&&&&& after remove duplicate length: 263792

mini_batch_src_global generation: 0.032282114028930664
r_  generation: 0.19964981079101562

local_output_nid generation: 0.020354509353637695
local_in_edges_tensor generation: 0.01928544044494629

&&&&&&&&&&&&&&& before remove duplicate length: 674575
remove duplicated spend time : 0.16634202003479004

&&&&&&&&&&&&&&& after remove duplicate length: 205938

mini_batch_src_global generation: 0.02661871910095215
r_  generation: 0.16474533081054688

local_output_nid generation: 0.02050185203552246
local_in_edges_tensor generation: 0.018837690353393555

&&&&&&&&&&&&&&& before remove duplicate length: 654700
remove duplicated spend time : 0.1665961742401123

&&&&&&&&&&&&&&& after remove duplicate length: 208488

mini_batch_src_global generation: 0.026244401931762695
r_  generation: 0.16055679321289062


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 0.05723094940185547  GigaBytes
Max Memory Allocated: 0.05723094940185547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 0.05727672576904297  GigaBytes
Max Memory Allocated: 0.05727672576904297  GigaBytes

first layer input nodes number: 145721
first layer output nodes number: 47900
edges number: 462765
----------------------------------------before model layer 0
 Nvidia-smi: 7.2205810546875 GB
    Memory Allocated: 0.06326007843017578  GigaBytes
Max Memory Allocated: 0.06498432159423828  GigaBytes

torch.Size([145721, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2205810546875 GB
    Memory Allocated: 0.06326007843017578  GigaBytes
Max Memory Allocated: 0.06498432159423828  GigaBytes

m.shape torch.Size([159, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.5018310546875 GB
    Memory Allocated: 0.24059629440307617  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5018310546875 GB
    Memory Allocated: 0.24059629440307617  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

 h.shape torch.Size([1, 159, 100]), torch.Size([1, 159, 100])
----------------------------------------3
 Nvidia-smi: 7.5018310546875 GB
    Memory Allocated: 0.24071550369262695  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5037841796875 GB
    Memory Allocated: 0.24166488647460938  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

rst.shape  torch.Size([1, 159, 100])
m.shape torch.Size([244, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.5037841796875 GB
    Memory Allocated: 0.24178743362426758  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5037841796875 GB
    Memory Allocated: 0.24178743362426758  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

 h.shape torch.Size([1, 244, 100]), torch.Size([1, 244, 100])
----------------------------------------3
 Nvidia-smi: 7.5037841796875 GB
    Memory Allocated: 0.24196958541870117  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5076904296875 GB
    Memory Allocated: 0.24469900131225586  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

rst.shape  torch.Size([1, 244, 100])
m.shape torch.Size([307, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.5076904296875 GB
    Memory Allocated: 0.2449512481689453  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5076904296875 GB
    Memory Allocated: 0.2449512481689453  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

 h.shape torch.Size([1, 307, 100]), torch.Size([1, 307, 100])
----------------------------------------3
 Nvidia-smi: 7.5076904296875 GB
    Memory Allocated: 0.2451801300048828  GigaBytes
Max Memory Allocated: 0.24790143966674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5135498046875 GB
    Memory Allocated: 0.2502155303955078  GigaBytes
Max Memory Allocated: 0.25055885314941406  GigaBytes

rst.shape  torch.Size([1, 307, 100])
m.shape torch.Size([420, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.5135498046875 GB
    Memory Allocated: 0.25072717666625977  GigaBytes
Max Memory Allocated: 0.2507467269897461  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5135498046875 GB
    Memory Allocated: 0.25072717666625977  GigaBytes
Max Memory Allocated: 0.2507467269897461  GigaBytes

 h.shape torch.Size([1, 420, 100]), torch.Size([1, 420, 100])
----------------------------------------3
 Nvidia-smi: 7.5135498046875 GB
    Memory Allocated: 0.2510409355163574  GigaBytes
Max Memory Allocated: 0.2510409355163574  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5233154296875 GB
    Memory Allocated: 0.26012277603149414  GigaBytes
Max Memory Allocated: 0.26074886322021484  GigaBytes

rst.shape  torch.Size([1, 420, 100])
m.shape torch.Size([511, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.5252685546875 GB
    Memory Allocated: 0.26091814041137695  GigaBytes
Max Memory Allocated: 0.26094675064086914  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5252685546875 GB
    Memory Allocated: 0.26091814041137695  GigaBytes
Max Memory Allocated: 0.26094675064086914  GigaBytes

 h.shape torch.Size([1, 511, 100]), torch.Size([1, 511, 100])
----------------------------------------3
 Nvidia-smi: 7.5252685546875 GB
    Memory Allocated: 0.26129961013793945  GigaBytes
Max Memory Allocated: 0.26129961013793945  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5389404296875 GB
    Memory Allocated: 0.2750110626220703  GigaBytes
Max Memory Allocated: 0.27596330642700195  GigaBytes

rst.shape  torch.Size([1, 511, 100])
m.shape torch.Size([565, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.5389404296875 GB
    Memory Allocated: 0.27625465393066406  GigaBytes
Max Memory Allocated: 0.2762928009033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5389404296875 GB
    Memory Allocated: 0.27625465393066406  GigaBytes
Max Memory Allocated: 0.2762928009033203  GigaBytes

 h.shape torch.Size([1, 565, 100]), torch.Size([1, 565, 100])
----------------------------------------3
 Nvidia-smi: 7.5389404296875 GB
    Memory Allocated: 0.2766761779785156  GigaBytes
Max Memory Allocated: 0.2766761779785156  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.2947845458984375  GigaBytes
Max Memory Allocated: 0.2960476875305176  GigaBytes

rst.shape  torch.Size([1, 565, 100])
m.shape torch.Size([534, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.29596662521362305  GigaBytes
Max Memory Allocated: 0.2960476875305176  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.29596662521362305  GigaBytes
Max Memory Allocated: 0.2960476875305176  GigaBytes

 h.shape torch.Size([1, 534, 100]), torch.Size([1, 534, 100])
----------------------------------------3
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.29636526107788086  GigaBytes
Max Memory Allocated: 0.29636526107788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5780029296875 GB
    Memory Allocated: 0.3162670135498047  GigaBytes
Max Memory Allocated: 0.317659854888916  GigaBytes

rst.shape  torch.Size([1, 534, 100])
m.shape torch.Size([612, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.5780029296875 GB
    Memory Allocated: 0.31789159774780273  GigaBytes
Max Memory Allocated: 0.3179469108581543  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5780029296875 GB
    Memory Allocated: 0.31789159774780273  GigaBytes
Max Memory Allocated: 0.3179469108581543  GigaBytes

 h.shape torch.Size([1, 612, 100]), torch.Size([1, 612, 100])
----------------------------------------3
 Nvidia-smi: 7.5799560546875 GB
    Memory Allocated: 0.31834840774536133  GigaBytes
Max Memory Allocated: 0.31834840774536133  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6072998046875 GB
    Memory Allocated: 0.34435224533081055  GigaBytes
Max Memory Allocated: 0.3461761474609375  GigaBytes

rst.shape  torch.Size([1, 612, 100])
m.shape torch.Size([542, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.6072998046875 GB
    Memory Allocated: 0.34594106674194336  GigaBytes
Max Memory Allocated: 0.3461761474609375  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6072998046875 GB
    Memory Allocated: 0.34594106674194336  GigaBytes
Max Memory Allocated: 0.3461761474609375  GigaBytes

 h.shape torch.Size([1, 542, 100]), torch.Size([1, 542, 100])
----------------------------------------3
 Nvidia-smi: 7.6072998046875 GB
    Memory Allocated: 0.3463454246520996  GigaBytes
Max Memory Allocated: 0.3463454246520996  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 0.37219858169555664  GigaBytes
Max Memory Allocated: 0.37401580810546875  GigaBytes

rst.shape  torch.Size([1, 542, 100])
m.shape torch.Size([44006, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.5360589027404785  GigaBytes
Max Memory Allocated: 0.5413694381713867  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.5360589027404785  GigaBytes
Max Memory Allocated: 0.5413694381713867  GigaBytes

 h.shape torch.Size([1, 44006, 100]), torch.Size([1, 44006, 100])
----------------------------------------3
 Nvidia-smi: 7.8358154296875 GB
    Memory Allocated: 0.5688462257385254  GigaBytes
Max Memory Allocated: 0.5688462257385254  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 2.921694278717041  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 44006, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 2.749849796295166  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 2.7955307960510254  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

h_self size  torch.Size([47900, 100])
----------------------------------------before rst
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 2.7955307960510254  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

torch.Size([47900, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 2.8412117958068848  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 2.7955307960510254  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

torch.Size([47900, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 2.8412117958068848  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 2.8526320457458496  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------input nodes number: 47900
----------------output nodes number: 6093
----------------edges number: 146503
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3787841796875 GB
    Memory Allocated: 2.8530349731445312  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.994968891143799  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.994968891143799  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.994986057281494  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.9951233863830566  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.995138168334961  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.995138168334961  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.9951610565185547  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.995504379272461  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.9955334663391113  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.9955334663391113  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.9955601692199707  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.996147632598877  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.996211528778076  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.996211528778076  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.9962496757507324  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.9973559379577637  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([27, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.997467041015625  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.997467041015625  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.997518539428711  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.9993724822998047  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.999485492706299  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.999485492706299  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 2.9995312690734863  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 3.001499652862549  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 3.001584529876709  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 3.001584529876709  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 3.001615047454834  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 3.003140926361084  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 3.0032873153686523  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 3.0032873153686523  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 10.5213623046875 GB
    Memory Allocated: 3.0033273696899414  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5233154296875 GB
    Memory Allocated: 3.005610466003418  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5233154296875 GB
    Memory Allocated: 3.005685806274414  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5233154296875 GB
    Memory Allocated: 3.005685806274414  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 10.5233154296875 GB
    Memory Allocated: 3.005706787109375  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5233154296875 GB
    Memory Allocated: 3.007049560546875  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([23, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5252685546875 GB
    Memory Allocated: 3.007260322570801  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5252685546875 GB
    Memory Allocated: 3.007260322570801  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 10.5252685546875 GB
    Memory Allocated: 3.0073041915893555  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5272216796875 GB
    Memory Allocated: 3.0104188919067383  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5272216796875 GB
    Memory Allocated: 3.0106825828552246  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5272216796875 GB
    Memory Allocated: 3.0106825828552246  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 10.5272216796875 GB
    Memory Allocated: 3.0107340812683105  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5311279296875 GB
    Memory Allocated: 3.0147509574890137  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5311279296875 GB
    Memory Allocated: 3.0150251388549805  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5311279296875 GB
    Memory Allocated: 3.0150251388549805  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 10.5330810546875 GB
    Memory Allocated: 3.0150747299194336  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.019289970397949  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.0196027755737305  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.0196027755737305  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 10.5369873046875 GB
    Memory Allocated: 3.0196542739868164  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5428466796875 GB
    Memory Allocated: 3.0243921279907227  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5428466796875 GB
    Memory Allocated: 3.024608612060547  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5428466796875 GB
    Memory Allocated: 3.024608612060547  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 10.5428466796875 GB
    Memory Allocated: 3.0246429443359375  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.0280418395996094  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.0282845497131348  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.0282845497131348  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.0283188819885254  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5487060546875 GB
    Memory Allocated: 3.0319581031799316  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5487060546875 GB
    Memory Allocated: 3.0323100090026855  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5487060546875 GB
    Memory Allocated: 3.0323100090026855  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 10.5487060546875 GB
    Memory Allocated: 3.032355785369873  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 3.0375285148620605  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 3.0377674102783203  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 3.0377674102783203  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 3.0377979278564453  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5584716796875 GB
    Memory Allocated: 3.0414600372314453  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5584716796875 GB
    Memory Allocated: 3.0418081283569336  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5584716796875 GB
    Memory Allocated: 3.0418081283569336  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 10.5584716796875 GB
    Memory Allocated: 3.0418481826782227  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5643310546875 GB
    Memory Allocated: 3.0469350814819336  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5643310546875 GB
    Memory Allocated: 3.0473718643188477  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5643310546875 GB
    Memory Allocated: 3.0473718643188477  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 10.5643310546875 GB
    Memory Allocated: 3.047419548034668  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5721435546875 GB
    Memory Allocated: 3.05380916595459  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5721435546875 GB
    Memory Allocated: 3.0542659759521484  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5721435546875 GB
    Memory Allocated: 3.0542659759521484  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 10.5721435546875 GB
    Memory Allocated: 3.0543136596679688  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5780029296875 GB
    Memory Allocated: 3.061037063598633  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5780029296875 GB
    Memory Allocated: 3.0615181922912598  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5780029296875 GB
    Memory Allocated: 3.0615181922912598  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 10.5780029296875 GB
    Memory Allocated: 3.06156587600708  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5858154296875 GB
    Memory Allocated: 3.0686230659484863  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 3.0692758560180664  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 3.0692758560180664  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 3.0693368911743164  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5975341796875 GB
    Memory Allocated: 3.0787973403930664  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5975341796875 GB
    Memory Allocated: 3.0792531967163086  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5975341796875 GB
    Memory Allocated: 3.0792531967163086  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 10.5975341796875 GB
    Memory Allocated: 3.0792951583862305  GigaBytes
Max Memory Allocated: 3.085756778717041  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6033935546875 GB
    Memory Allocated: 3.086092948913574  GigaBytes
Max Memory Allocated: 3.086575508117676  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.6033935546875 GB
    Memory Allocated: 3.0864410400390625  GigaBytes
Max Memory Allocated: 3.086575508117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6033935546875 GB
    Memory Allocated: 3.0864410400390625  GigaBytes
Max Memory Allocated: 3.086575508117676  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 10.6033935546875 GB
    Memory Allocated: 3.0864715576171875  GigaBytes
Max Memory Allocated: 3.086575508117676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6092529296875 GB
    Memory Allocated: 3.0916290283203125  GigaBytes
Max Memory Allocated: 3.0919952392578125  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([5594, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.7459716796875 GB
    Memory Allocated: 3.2261695861816406  GigaBytes
Max Memory Allocated: 3.2266907691955566  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7459716796875 GB
    Memory Allocated: 3.2261695861816406  GigaBytes
Max Memory Allocated: 3.2266907691955566  GigaBytes

 h.shape torch.Size([1, 5594, 256]), torch.Size([1, 5594, 256])
----------------------------------------3
 Nvidia-smi: 10.7459716796875 GB
    Memory Allocated: 3.2376623153686523  GigaBytes
Max Memory Allocated: 3.2376623153686523  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6151123046875 GB
    Memory Allocated: 5.125388145446777  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 5594, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.6151123046875 GB
    Memory Allocated: 4.985099792480469  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.6151123046875 GB
    Memory Allocated: 4.986284255981445  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

h_self size  torch.Size([6093, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6151123046875 GB
    Memory Allocated: 4.986284255981445  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

torch.Size([6093, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6151123046875 GB
    Memory Allocated: 4.987468719482422  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6151123046875 GB
    Memory Allocated: 4.986284255981445  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

torch.Size([6093, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.9002685546875 GB
    Memory Allocated: 0.061005592346191406  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.9002685546875 GB
    Memory Allocated: 0.1255660057067871  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.9002685546875 GB
    Memory Allocated: 0.1256117820739746  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

first layer input nodes number: 173302
first layer output nodes number: 52859
edges number: 509101
----------------------------------------before model layer 0
 Nvidia-smi: 12.9002685546875 GB
    Memory Allocated: 0.07800865173339844  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

torch.Size([173302, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.9002685546875 GB
    Memory Allocated: 0.07800865173339844  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

m.shape torch.Size([186, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.27310943603515625  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.27310943603515625  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 186, 100]), torch.Size([1, 186, 100])
----------------------------------------3
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.27324867248535156  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.27435970306396484  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 186, 100])
m.shape torch.Size([316, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.27452564239501953  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.27452564239501953  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 316, 100]), torch.Size([1, 316, 100])
----------------------------------------3
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.2747611999511719  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.27829456329345703  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 316, 100])
m.shape torch.Size([386, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.2786083221435547  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.2786083221435547  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 386, 100]), torch.Size([1, 386, 100])
----------------------------------------3
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.2788963317871094  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.28522825241088867  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 386, 100])
m.shape torch.Size([494, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.28582048416137695  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.28582048416137695  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 494, 100]), torch.Size([1, 494, 100])
----------------------------------------3
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.28618860244750977  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.29686403274536133  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 494, 100])
m.shape torch.Size([572, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.2978992462158203  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.2978992462158203  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 572, 100]), torch.Size([1, 572, 100])
----------------------------------------3
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.2983255386352539  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.3136720657348633  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 572, 100])
m.shape torch.Size([648, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.31520986557006836  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.31520986557006836  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 648, 100]), torch.Size([1, 648, 100])
----------------------------------------3
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.31569337844848633  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.336458683013916  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 648, 100])
m.shape torch.Size([686, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.33800601959228516  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.33800601959228516  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 686, 100]), torch.Size([1, 686, 100])
----------------------------------------3
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.3385171890258789  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.3647618293762207  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 686, 100])
m.shape torch.Size([712, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.36662817001342773  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.36662817001342773  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 712, 100]), torch.Size([1, 712, 100])
----------------------------------------3
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.367159366607666  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.3981657028198242  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 712, 100])
m.shape torch.Size([687, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.4002037048339844  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.4002037048339844  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 687, 100]), torch.Size([1, 687, 100])
----------------------------------------3
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.40071582794189453  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0936279296875 GB
    Memory Allocated: 0.43425989151000977  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 687, 100])
m.shape torch.Size([48172, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.2733154296875 GB
    Memory Allocated: 0.6136913299560547  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.2733154296875 GB
    Memory Allocated: 0.6136913299560547  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 48172, 100]), torch.Size([1, 48172, 100])
----------------------------------------3
 Nvidia-smi: 13.2733154296875 GB
    Memory Allocated: 0.6495828628540039  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2070398330688477  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 48172, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.0181379318237305  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.0685482025146484  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

h_self size  torch.Size([52859, 100])
----------------------------------------before rst
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.0685482025146484  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

torch.Size([52859, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.1189584732055664  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.0685482025146484  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

torch.Size([52859, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.1189584732055664  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.131561279296875  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------input nodes number: 52859
----------------output nodes number: 6085
----------------edges number: 147185
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.1320009231567383  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2736825942993164  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2736825942993164  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2736997604370117  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.273837089538574  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2738537788391113  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2738537788391113  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.273878574371338  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2742505073547363  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.274250030517578  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.274250030517578  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2742576599121094  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.274425506591797  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2744717597961426  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2744717597961426  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.274496555328369  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2752156257629395  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.275290012359619  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.275290012359619  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2753243446350098  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2765603065490723  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.276641368865967  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.276641368865967  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2766737937927246  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2780680656433105  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([26, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.278226852416992  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.278226852416992  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2782764434814453  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2807559967041016  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([15, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.28084659576416  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.28084659576416  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2808752059936523  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.282505989074707  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.282630443572998  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.282630443572998  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.282660961151123  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.284614086151123  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.284733772277832  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.284733772277832  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2847604751586914  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.286656379699707  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.286865234375  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.286865234375  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.286905288696289  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.290029525756836  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.290228843688965  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.290228843688965  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2902650833129883  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2933454513549805  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2935776710510254  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2935776710510254  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2936158180236816  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2971253395080566  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2974562644958496  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2974562644958496  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.2975058555603027  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.302415370941162  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3026647567749023  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3026647567749023  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.302700996398926  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.30654239654541  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.306924343109131  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.306924343109131  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.306973934173584  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.312577724456787  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.312863826751709  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.312863826751709  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3129000663757324  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.317248821258545  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3175249099731445  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3175249099731445  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3175573348999023  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3216753005981445  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.321951389312744  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.321951389312744  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.321981906890869  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.326071262359619  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3265562057495117  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3265562057495117  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.326605796813965  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3335981369018555  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3338966369628906  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3338966369628906  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3339271545410156  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3384437561035156  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3388729095458984  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3388729095458984  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3389129638671875  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.345121383666992  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3456764221191406  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3456764221191406  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3457260131835938  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.353759765625  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.354311943054199  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.354311943054199  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3543596267700195  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.3624181747436523  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([5643, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.4985194206237793  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.4985194206237793  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

 h.shape torch.Size([1, 5643, 256]), torch.Size([1, 5643, 256])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 3.5092825889587402  GigaBytes
Max Memory Allocated: 5.258759498596191  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9608154296875 GB
    Memory Allocated: 5.4044718742370605  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 5643, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.9608154296875 GB
    Memory Allocated: 5.264976501464844  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.9608154296875 GB
    Memory Allocated: 5.2662763595581055  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

h_self size  torch.Size([6085, 256])
----------------------------------------before rst
 Nvidia-smi: 14.9608154296875 GB
    Memory Allocated: 5.2662763595581055  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

torch.Size([6085, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.9608154296875 GB
    Memory Allocated: 5.267709732055664  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.9608154296875 GB
    Memory Allocated: 5.266409873962402  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

torch.Size([6085, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.1014404296875 GB
    Memory Allocated: 0.07099390029907227  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.1014404296875 GB
    Memory Allocated: 0.13823938369750977  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.1014404296875 GB
    Memory Allocated: 0.13828659057617188  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

first layer input nodes number: 180510
first layer output nodes number: 60205
edges number: 579749
----------------------------------------before model layer 0
 Nvidia-smi: 15.1014404296875 GB
    Memory Allocated: 0.08203983306884766  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

torch.Size([180510, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1014404296875 GB
    Memory Allocated: 0.08203983306884766  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

m.shape torch.Size([201, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.30533313751220703  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.30533313751220703  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 201, 100]), torch.Size([1, 201, 100])
----------------------------------------3
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3054838180541992  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3066849708557129  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 201, 100])
m.shape torch.Size([336, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.30685997009277344  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.30685997009277344  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 336, 100]), torch.Size([1, 336, 100])
----------------------------------------3
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3071107864379883  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3108673095703125  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 336, 100])
m.shape torch.Size([479, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3112773895263672  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3112773895263672  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 479, 100]), torch.Size([1, 479, 100])
----------------------------------------3
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.31163501739501953  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3194899559020996  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 479, 100])
m.shape torch.Size([582, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3201785087585449  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3201785087585449  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 582, 100]), torch.Size([1, 582, 100])
----------------------------------------3
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.32061243057250977  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3331904411315918  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 582, 100])
m.shape torch.Size([691, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3342609405517578  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3342609405517578  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 691, 100]), torch.Size([1, 691, 100])
----------------------------------------3
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3347759246826172  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.35365772247314453  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 691, 100])
m.shape torch.Size([694, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3549518585205078  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3549518585205078  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 694, 100]), torch.Size([1, 694, 100])
----------------------------------------3
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.3554697036743164  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.37824106216430664  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 694, 100])
m.shape torch.Size([814, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.38010501861572266  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.38010501861572266  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 814, 100]), torch.Size([1, 814, 100])
----------------------------------------3
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.38071155548095703  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.4125704765319824  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 814, 100])
m.shape torch.Size([730, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.4144430160522461  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.4144430160522461  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 730, 100]), torch.Size([1, 730, 100])
----------------------------------------3
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.41498756408691406  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.446047306060791  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 730, 100])
m.shape torch.Size([826, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.4485445022583008  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.4485445022583008  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 826, 100]), torch.Size([1, 826, 100])
----------------------------------------3
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.4491605758666992  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3182373046875 GB
    Memory Allocated: 0.48928165435791016  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 826, 100])
m.shape torch.Size([54852, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 0.6940517425537109  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 0.6940517425537109  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 54852, 100]), torch.Size([1, 54852, 100])
----------------------------------------3
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 0.7349205017089844  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.640986919403076  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 54852, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.4250526428222656  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.482468605041504  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

h_self size  torch.Size([60205, 100])
----------------------------------------before rst
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.482468605041504  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

torch.Size([60205, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.539884567260742  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.482468605041504  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

torch.Size([60205, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.539884567260742  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.554238796234131  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------input nodes number: 60205
----------------output nodes number: 6323
----------------edges number: 152941
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.554734706878662  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7019529342651367  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7019529342651367  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7019662857055664  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.702073097229004  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.702078342437744  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.702078342437744  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.702089786529541  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.702261447906494  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.702281951904297  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.702281951904297  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.702299118041992  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.702676773071289  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7026915550231934  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7026915550231934  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7027029991149902  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7030348777770996  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([13, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.703092098236084  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.703092098236084  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7031168937683105  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.704009532928467  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7040610313415527  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7040610313415527  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7040820121765137  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.704984188079834  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7050814628601074  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7050814628601074  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7051119804382324  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7066378593444824  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.706730365753174  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.706730365753174  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.706757068634033  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7082791328430176  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([28, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.708508014678955  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.708508014678955  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.708561420440674  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.711979389190674  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7121739387512207  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7121739387512207  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7122178077697754  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.715332508087158  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([31, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7156386375427246  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7156386375427246  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.715697765350342  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7203097343444824  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.720545768737793  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.720545768737793  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7205896377563477  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.724318504333496  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.724734306335449  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.724734306335449  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7248010635375977  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.730942726135254  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7312192916870117  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7312192916870117  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7312631607055664  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7356061935424805  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7359447479248047  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7359447479248047  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.735992431640625  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.741046905517578  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.741407871246338  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.741407871246338  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.741455554962158  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7468438148498535  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7472124099731445  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7472124099731445  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.747258186340332  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.752751350402832  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7530574798583984  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7530574798583984  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.753093719482422  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7576961517333984  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7582626342773438  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7582626342773438  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7583236694335938  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7665023803710938  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.766818046569824  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.766818046569824  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.766852378845215  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.771693229675293  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.772019386291504  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.772019386291504  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7720518112182617  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.776850700378418  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7773208618164062  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7773208618164062  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.777364730834961  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7841644287109375  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7849607467651367  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.7849607467651367  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.785031318664551  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.796463966369629  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.796821117401123  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.796821117401123  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.796853542327881  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.802333354949951  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([5841, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.9430503845214844  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.9430503845214844  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

 h.shape torch.Size([1, 5841, 256]), torch.Size([1, 5841, 256])
----------------------------------------3
 Nvidia-smi: 16.6307373046875 GB
    Memory Allocated: 3.954191207885742  GigaBytes
Max Memory Allocated: 5.5392374992370605  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7713623046875 GB
    Memory Allocated: 5.926392555236816  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 5841, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.7713623046875 GB
    Memory Allocated: 5.781259059906006  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.7713623046875 GB
    Memory Allocated: 5.782732009887695  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

h_self size  torch.Size([6323, 256])
----------------------------------------before rst
 Nvidia-smi: 16.7713623046875 GB
    Memory Allocated: 5.782732009887695  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

torch.Size([6323, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.7713623046875 GB
    Memory Allocated: 5.783839225769043  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.7713623046875 GB
    Memory Allocated: 5.7823662757873535  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

torch.Size([6323, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 16.9178466796875 GB
    Memory Allocated: 0.07372808456420898  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.9178466796875 GB
    Memory Allocated: 0.14883852005004883  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.9178466796875 GB
    Memory Allocated: 0.14888572692871094  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

first layer input nodes number: 201623
first layer output nodes number: 62031
edges number: 594826
----------------------------------------before model layer 0
 Nvidia-smi: 16.9178466796875 GB
    Memory Allocated: 0.08995532989501953  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

torch.Size([201623, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.9178466796875 GB
    Memory Allocated: 0.08995532989501953  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

m.shape torch.Size([278, 1, 100])
----------------------------------------1
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.31793832778930664  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.31793832778930664  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 278, 100]), torch.Size([1, 278, 100])
----------------------------------------3
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3181462287902832  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3198051452636719  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 278, 100])
m.shape torch.Size([409, 2, 100])
----------------------------------------1
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3200063705444336  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3200063705444336  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 409, 100]), torch.Size([1, 409, 100])
----------------------------------------3
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3203115463256836  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3248863220214844  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 409, 100])
m.shape torch.Size([539, 3, 100])
----------------------------------------1
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3253364562988281  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3253364562988281  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 539, 100]), torch.Size([1, 539, 100])
----------------------------------------3
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.32573890686035156  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3345799446105957  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 539, 100])
m.shape torch.Size([627, 4, 100])
----------------------------------------1
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3353133201599121  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3353133201599121  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 627, 100]), torch.Size([1, 627, 100])
----------------------------------------3
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.33578062057495117  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.349332332611084  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 627, 100])
m.shape torch.Size([760, 5, 100])
----------------------------------------1
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.351163387298584  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.351163387298584  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 760, 100]), torch.Size([1, 760, 100])
----------------------------------------3
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3517298698425293  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3729557991027832  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 760, 100])
m.shape torch.Size([836, 6, 100])
----------------------------------------1
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3745412826538086  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3745412826538086  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 836, 100]), torch.Size([1, 836, 100])
----------------------------------------3
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.3751649856567383  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.4019584655761719  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 836, 100])
m.shape torch.Size([818, 7, 100])
----------------------------------------1
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.4037799835205078  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.4037799835205078  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 818, 100]), torch.Size([1, 818, 100])
----------------------------------------3
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.4043903350830078  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.43593263626098633  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 818, 100])
m.shape torch.Size([883, 8, 100])
----------------------------------------1
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.4382591247558594  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.4382591247558594  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 883, 100]), torch.Size([1, 883, 100])
----------------------------------------3
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.4389171600341797  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.4778480529785156  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 883, 100])
m.shape torch.Size([811, 9, 100])
----------------------------------------1
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.4802384376525879  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.4802384376525879  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 811, 100]), torch.Size([1, 811, 100])
----------------------------------------3
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.48084306716918945  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.5201845169067383  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 811, 100])
m.shape torch.Size([56070, 10, 100])
----------------------------------------1
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.7287592887878418  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.7287592887878418  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 56070, 100]), torch.Size([1, 56070, 100])
----------------------------------------3
 Nvidia-smi: 17.1405029296875 GB
    Memory Allocated: 0.7717280387878418  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.753946304321289  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 56070, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.5322189331054688  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.591376304626465  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

h_self size  torch.Size([62031, 100])
----------------------------------------before rst
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.591376304626465  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

torch.Size([62031, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.650533676147461  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.591376304626465  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

torch.Size([62031, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.650533676147461  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.6654014587402344  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------input nodes number: 62031
----------------output nodes number: 6327
----------------edges number: 151661
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.6659111976623535  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.811892032623291  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.811892032623291  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8118958473205566  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8119263648986816  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8119421005249023  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8119421005249023  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8119592666625977  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8122167587280273  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8122429847717285  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8122429847717285  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8122658729553223  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8127694129943848  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.812811851501465  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.812811851501465  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.812838554382324  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.813612937927246  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8136720657348633  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8136720657348633  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8137006759643555  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.814730644226074  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([28, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.814877986907959  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.814877986907959  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8149313926696777  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.817227840423584  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.817389965057373  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.817389965057373  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.817443370819092  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8201136589050293  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8202714920043945  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8202714920043945  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.820317268371582  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8229265213012695  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.823094367980957  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.823094367980957  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.823136329650879  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.825821876525879  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([28, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8260703086853027  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8260703086853027  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8261237144470215  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8299155235290527  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.830216884613037  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.830216884613037  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8302760124206543  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.834887981414795  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8351240158081055  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8351240158081055  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.83516788482666  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8388967514038086  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8393497467041016  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8393497467041016  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8394222259521484  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.846090316772461  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.846538543701172  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.846538543701172  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.846607208251953  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.853404998779297  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8537745475769043  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8537745475769043  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.853827953338623  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8594889640808105  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.860093116760254  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.860093116760254  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.860171318054199  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8690080642700195  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8695902824401855  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8695902824401855  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8696627616882324  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8783602714538574  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8786873817443848  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8786873817443848  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.878727436065674  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8838143348693848  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8841781616210938  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8841781616210938  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.884218215942383  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.889585494995117  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.889988422393799  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.889988422393799  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8900303840637207  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.895946979522705  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8965115547180176  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.8965115547180176  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.896566867828369  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.9047532081604004  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.90512752532959  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.90512752532959  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.9051637649536133  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.910780906677246  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.911470413208008  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.911470413208008  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.911531448364258  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.921419143676758  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.9220118522644043  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.9220118522644043  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.9220633506774902  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 3.9307665824890137  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([5739, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 4.068638324737549  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 4.068638324737549  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

 h.shape torch.Size([1, 5739, 256]), torch.Size([1, 5739, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 4.079768657684326  GigaBytes
Max Memory Allocated: 6.065652847290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.0760498046875 GB
    Memory Allocated: 6.019439697265625  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5739, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.0760498046875 GB
    Memory Allocated: 5.875821113586426  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.0760498046875 GB
    Memory Allocated: 5.876979827880859  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 18.0760498046875 GB
    Memory Allocated: 5.876979827880859  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.0760498046875 GB
    Memory Allocated: 5.878138542175293  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.0760498046875 GB
    Memory Allocated: 5.876979827880859  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6327, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.08140420913696289  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.15238714218139648  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.15243196487426758  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

first layer input nodes number: 190543
first layer output nodes number: 54341
edges number: 524669
----------------------------------------before model layer 0
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.08408546447753906  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([190543, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.08408546447753906  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([162, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2851376533508301  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2851376533508301  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 162, 100]), torch.Size([1, 162, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.28525876998901367  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2862262725830078  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 162, 100])
m.shape torch.Size([292, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.28638362884521484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.28638362884521484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 292, 100]), torch.Size([1, 292, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2866020202636719  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2898693084716797  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 292, 100])
m.shape torch.Size([394, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29020071029663086  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29020071029663086  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 394, 100]), torch.Size([1, 394, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.290494441986084  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29695653915405273  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 394, 100])
m.shape torch.Size([492, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2975430488586426  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2975430488586426  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 492, 100]), torch.Size([1, 492, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.297910213470459  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3085465431213379  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 492, 100])
m.shape torch.Size([533, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3096456527709961  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3096456527709961  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 533, 100]), torch.Size([1, 533, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3100433349609375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.32434558868408203  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 533, 100])
m.shape torch.Size([629, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.32555294036865234  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.32555294036865234  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 629, 100]), torch.Size([1, 629, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3260221481323242  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.34618091583251953  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 629, 100])
m.shape torch.Size([668, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3476886749267578  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3476886749267578  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 668, 100]), torch.Size([1, 668, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3481864929199219  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3747859001159668  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 668, 100])
m.shape torch.Size([691, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.37659645080566406  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.37659645080566406  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 691, 100]), torch.Size([1, 691, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.37711143493652344  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.40691232681274414  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 691, 100])
m.shape torch.Size([670, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.4089012145996094  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.4089012145996094  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 670, 100]), torch.Size([1, 670, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.40940093994140625  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.4416804313659668  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 670, 100])
m.shape torch.Size([49810, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.6269874572753906  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.6269874572753906  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 49810, 100]), torch.Size([1, 49810, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.6660499572753906  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3155927658081055  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 49810, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.119838237762451  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.171661853790283  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([54341, 100])
----------------------------------------before rst
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.171661853790283  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([54341, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.2234854698181152  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.171661853790283  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([54341, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.2234854698181152  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.2364416122436523  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------input nodes number: 54341
----------------output nodes number: 5966
----------------edges number: 144508
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.236891746520996  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3759899139404297  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3759899139404297  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3759937286376953  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3760242462158203  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3760361671447754  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3760361671447754  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.376049518585205  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3762497901916504  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([19, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.376297950744629  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.376297950744629  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3763341903686523  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.377131462097168  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3771791458129883  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3771791458129883  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.377211570739746  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3781518936157227  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3782272338867188  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3782272338867188  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.378263473510742  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.379568099975586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.379636764526367  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.379636764526367  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3796653747558594  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3808956146240234  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.380949020385742  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.380949020385742  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3809680938720703  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3819217681884766  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.382035255432129  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.382035255432129  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.382065773010254  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.383805274963379  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.383945941925049  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.383945941925049  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3839802742004395  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3861775398254395  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.386420249938965  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.386420249938965  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.386471748352051  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3901281356811523  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3902297019958496  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3902297019958496  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3902525901794434  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.392037868499756  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.392141819000244  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.392141819000244  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3921608924865723  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.393782138824463  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.393960475921631  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.393960475921631  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.393989086151123  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3966212272644043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3968358039855957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3968358039855957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3968682289123535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.400078296661377  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.400235176086426  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.400235176086426  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4002580642700195  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.402684211730957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4029345512390137  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4029345512390137  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4029669761657715  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4066309928894043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4070072174072266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4070072174072266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.407052993774414  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.412546157836914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4130077362060547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4130077362060547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4130611419677734  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4198436737060547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4202189445495605  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4202189445495605  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4202609062194824  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4258837699890137  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.426382064819336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.426382064819336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.426433563232422  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.433694839477539  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.434133529663086  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.434133529663086  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4341773986816406  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4406700134277344  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4413461685180664  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4413461685180664  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.441409111022949  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.451165199279785  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.451620101928711  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.451620101928711  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.451662063598633  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4584598541259766  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4589004516601562  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4589004516601562  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4589385986328125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4653854370117188  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([5534, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.59854793548584  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.59854793548584  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5534, 256]), torch.Size([1, 5534, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6096749305725098  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.489832401275635  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5534, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.353213787078857  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.354331016540527  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([5966, 256])
----------------------------------------before rst
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.354331016540527  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([5966, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.355664253234863  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.354547023773193  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([5966, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.07723283767700195  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.14949846267700195  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.14954328536987305  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

first layer input nodes number: 191705
first layer output nodes number: 56898
edges number: 556160
----------------------------------------before model layer 0
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.08559560775756836  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([191705, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.08559560775756836  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([100, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29866456985473633  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29866456985473633  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 100, 100]), torch.Size([1, 100, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2987399101257324  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29933834075927734  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 100, 100])
m.shape torch.Size([179, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29943418502807617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29943418502807617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 179, 100]), torch.Size([1, 179, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29956769943237305  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.30157041549682617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 179, 100])
m.shape torch.Size([228, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3017587661743164  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3017587661743164  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 228, 100]), torch.Size([1, 228, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3019294738769531  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.30567216873168945  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 228, 100])
m.shape torch.Size([324, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.30606985092163086  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.30606985092163086  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 324, 100]), torch.Size([1, 324, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.30631208419799805  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.31331968307495117  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 324, 100])
m.shape torch.Size([384, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.31391382217407227  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.31391382217407227  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 384, 100]), torch.Size([1, 384, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.31419992446899414  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.32449960708618164  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 384, 100])
m.shape torch.Size([431, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3253202438354492  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3253202438354492  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 431, 100]), torch.Size([1, 431, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3256416320800781  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.33945274353027344  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 431, 100])
m.shape torch.Size([499, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.34109067916870117  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.34109067916870117  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 499, 100]), torch.Size([1, 499, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3414626121520996  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3600592613220215  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 499, 100])
m.shape torch.Size([589, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.36162900924682617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.36162900924682617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 589, 100]), torch.Size([1, 589, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.36206865310668945  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.38709402084350586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 589, 100])
m.shape torch.Size([629, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.38898324966430664  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.38898324966430664  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 629, 100]), torch.Size([1, 629, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3894524574279785  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.41945600509643555  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 629, 100])
m.shape torch.Size([53535, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.6186552047729492  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.6186552047729492  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 53535, 100]), torch.Size([1, 53535, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.6585426330566406  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.490507125854492  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 53535, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.2840824127197266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3387699127197266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([56898, 100])
----------------------------------------before rst
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3387699127197266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([56898, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3937621116638184  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3390746116638184  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([56898, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3937621116638184  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.407632350921631  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------input nodes number: 56898
----------------output nodes number: 5970
----------------edges number: 145363
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4081015586853027  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5480265617370605  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5480265617370605  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5480380058288574  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5481295585632324  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5481433868408203  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5481433868408203  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5481624603271484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5484485626220703  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.548462390899658  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.548462390899658  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5484776496887207  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5488133430480957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.548832893371582  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.548832893371582  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5488462448120117  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5492334365844727  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5492701530456543  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5492701530456543  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5492873191833496  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.549905300140381  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.549954414367676  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.549954414367676  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.549973487854004  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5507936477661133  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5508718490600586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5508718490600586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.550896644592285  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5521364212036133  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5522165298461914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5522165298461914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.552239418029785  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.553544044494629  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.553593158721924  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.553593158721924  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5536065101623535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5544610023498535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([14, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.55458927154541  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.55458927154541  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5546159744262695  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.556511878967285  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.556678295135498  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.556678295135498  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.556710720062256  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5592398643493652  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.559420108795166  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.559420108795166  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.559452533721924  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.562208652496338  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5624799728393555  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5624799728393555  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.56252384185791  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5665597915649414  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.566847801208496  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.566847801208496  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.566891670227051  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.571234703063965  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.571457862854004  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.571457862854004  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5714902877807617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.57492733001709  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.575249671936035  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.575249671936035  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.575291633605957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.580033302307129  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5802903175354004  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5802903175354004  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.580322742462158  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5842137336730957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5845437049865723  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5845437049865723  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5845818519592285  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5894265174865723  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5897364616394043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5897364616394043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.589770793914795  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5943713188171387  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.594796657562256  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.594796657562256  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5948405265808105  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6010260581970215  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.601468563079834  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.601468563079834  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6015124320983887  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6080050468444824  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6082582473754883  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6082582473754883  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.608283042907715  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.612126350402832  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6126890182495117  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6126890182495117  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.612738609313965  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.620772361755371  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.621255397796631  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.621255397796631  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6212973594665527  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6283888816833496  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([5593, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.763256072998047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.763256072998047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5593, 256]), torch.Size([1, 5593, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.7742342948913574  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.658313274383545  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5593, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.519904613494873  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.521121501922607  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([5970, 256])
----------------------------------------before rst
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.521121501922607  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([5970, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.522662162780762  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 5.521445274353027  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([5970, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.07861518859863281  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.14874696731567383  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.14879417419433594  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

first layer input nodes number: 188258
first layer output nodes number: 55242
edges number: 536262
----------------------------------------before model layer 0
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.08353471755981445  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([188258, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.08353471755981445  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([48, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2899489402770996  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2899489402770996  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.28998517990112305  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29027223587036133  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([113, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29033851623535156  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29033851623535156  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2904233932495117  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2916908264160156  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([225, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2919001579284668  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2919001579284668  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 225, 100]), torch.Size([1, 225, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2920680046081543  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2957606315612793  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 225, 100])
m.shape torch.Size([420, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29630279541015625  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.29630279541015625  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 420, 100]), torch.Size([1, 420, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.2966165542602539  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3056983947753906  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 420, 100])
m.shape torch.Size([578, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.30661821365356445  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.30661821365356445  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 578, 100]), torch.Size([1, 578, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3070492744445801  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.32256031036376953  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 578, 100])
m.shape torch.Size([683, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3238716125488281  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3238716125488281  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 683, 100]), torch.Size([1, 683, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.32438087463378906  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.34780120849609375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 683, 100])
m.shape torch.Size([810, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3496589660644531  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3496589660644531  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 810, 100]), torch.Size([1, 810, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.3502626419067383  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.38138818740844727  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 810, 100])
m.shape torch.Size([874, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.38369131088256836  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.38369131088256836  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 874, 100]), torch.Size([1, 874, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.38434267044067383  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.4229469299316406  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 874, 100])
m.shape torch.Size([927, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.42572927474975586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.42572927474975586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 927, 100]), torch.Size([1, 927, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.4264206886291504  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.47144603729248047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 927, 100])
m.shape torch.Size([50564, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.6594662666320801  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.6594662666320801  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 50564, 100]), torch.Size([1, 50564, 100])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 0.6985287666320801  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.383056163787842  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 50564, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.1857967376708984  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.2384796142578125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([55242, 100])
----------------------------------------before rst
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.2384796142578125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([55242, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.2911624908447266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.2384796142578125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([55242, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.2911624908447266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.304333209991455  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------input nodes number: 55242
----------------output nodes number: 6301
----------------edges number: 148160
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.3047924041748047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4474072456359863  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4474072456359863  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.447420597076416  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4475274085998535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4475231170654297  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4475231170654297  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4475250244140625  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4475536346435547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4475646018981934  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4475646018981934  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4475722312927246  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.447740077972412  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4477787017822266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4477787017822266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4477996826171875  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4484081268310547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.448465347290039  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.448465347290039  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4484920501708984  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.449453353881836  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4495553970336914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4495553970336914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4495935440063477  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4512338638305664  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([41, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.451490879058838  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.451490879058838  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.451569080352783  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.455479145050049  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([23, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4556169509887695  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4556169509887695  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.455660820007324  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4581613540649414  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([41, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.458494186401367  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.458494186401367  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4585723876953125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4635772705078125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4641919136047363  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4641919136047363  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4643216133117676  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4735302925109863  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.474100112915039  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.474100112915039  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.474214553833008  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4831409454345703  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4836835861206055  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4836835861206055  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4837827682495117  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.492213249206543  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.492663860321045  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.492663860321045  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4927401542663574  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.4997591972351074  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5005016326904297  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5005016326904297  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.500612258911133  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.511564254760742  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.512259006500244  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.512259006500244  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5123581886291504  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.522871494293213  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.523714065551758  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.523714065551758  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.523824691772461  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.536325454711914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5368423461914062  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5368423461914062  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5369091033935547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.544919967651367  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5459423065185547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5459423065185547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5460586547851562  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5608348846435547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.561689853668213  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.561689853668213  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5617852210998535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5745644569396973  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5751514434814453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5751514434814453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.575214385986328  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5840892791748047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5856666564941406  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5856666564941406  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.5857696533203125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.60101318359375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6021671295166016  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6021671295166016  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.602275848388672  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6191272735595703  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([60, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.620534896850586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.620534896850586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 18.2225341796875 GB
    Memory Allocated: 3.6206493377685547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 3.639188766479492  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.2420654296875 GB
    Memory Allocated: 3.639939308166504  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2420654296875 GB
    Memory Allocated: 3.639939308166504  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 18.2420654296875 GB
    Memory Allocated: 3.6400060653686523  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2537841796875 GB
    Memory Allocated: 3.6512880325317383  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([5366, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.2537841796875 GB
    Memory Allocated: 3.780191421508789  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2537841796875 GB
    Memory Allocated: 3.780191421508789  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5366, 256]), torch.Size([1, 5366, 256])
----------------------------------------3
 Nvidia-smi: 18.2537841796875 GB
    Memory Allocated: 3.790426254272461  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2537841796875 GB
    Memory Allocated: 5.591756820678711  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5366, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.2537841796875 GB
    Memory Allocated: 5.451658725738525  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.2537841796875 GB
    Memory Allocated: 5.452992916107178  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([6301, 256])
----------------------------------------before rst
 Nvidia-smi: 18.2537841796875 GB
    Memory Allocated: 5.452992916107178  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6301, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2537841796875 GB
    Memory Allocated: 5.454560279846191  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.2537841796875 GB
    Memory Allocated: 5.453226089477539  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6301, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.07660102844238281  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.12305402755737305  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.12310123443603516  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

first layer input nodes number: 124696
first layer output nodes number: 46549
edges number: 444276
----------------------------------------before model layer 0
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.05862569808959961  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([124696, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.05862569808959961  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([67, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.22886323928833008  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.22886323928833008  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 67, 100]), torch.Size([1, 67, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.2289137840270996  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.22931528091430664  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 67, 100])
m.shape torch.Size([138, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.22939300537109375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.22939300537109375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 138, 100]), torch.Size([1, 138, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.22949600219726562  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.23104095458984375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 138, 100])
m.shape torch.Size([310, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.23133611679077148  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.23133611679077148  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 310, 100]), torch.Size([1, 310, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.2315678596496582  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.23665332794189453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 310, 100])
m.shape torch.Size([579, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.23740053176879883  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.23740053176879883  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 579, 100]), torch.Size([1, 579, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.23783254623413086  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.2503495216369629  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 579, 100])
m.shape torch.Size([815, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.25174760818481445  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.25174760818481445  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 815, 100]), torch.Size([1, 815, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.25235509872436523  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.2742176055908203  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 815, 100])
m.shape torch.Size([909, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.27594566345214844  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.27594566345214844  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 909, 100]), torch.Size([1, 909, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.2766237258911133  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.30632686614990234  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 909, 100])
m.shape torch.Size([983, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3085513114929199  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3085513114929199  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 983, 100]), torch.Size([1, 983, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3092837333679199  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3467116355895996  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 983, 100])
m.shape torch.Size([1059, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3495016098022461  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3495016098022461  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1059, 100]), torch.Size([1, 1059, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.35029125213623047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.39605188369750977  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1059, 100])
m.shape torch.Size([1085, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3992948532104492  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3992948532104492  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1085, 100]), torch.Size([1, 1085, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.4001035690307617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.45184850692749023  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1085, 100])
m.shape torch.Size([40604, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.6027059555053711  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.6027059555053711  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 40604, 100]), torch.Size([1, 40604, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.6329584121704102  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.7808828353881836  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 40604, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.6167144775390625  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.661107063293457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([46549, 100])
----------------------------------------before rst
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.661107063293457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([46549, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.7054996490478516  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.661107063293457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([46549, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.7054996490478516  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.7165980339050293  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------input nodes number: 46549
----------------output nodes number: 6307
----------------edges number: 149849
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.7169923782348633  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8612327575683594  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8612327575683594  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8612403869628906  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8613548278808594  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.861380100250244  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.861380100250244  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8613991737365723  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.861818790435791  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.861851692199707  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.861851692199707  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.861872673034668  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.862481117248535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8625431060791016  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8625431060791016  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8625717163085938  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8636016845703125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([25, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.863731861114502  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.863731861114502  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8637795448303223  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8658299446105957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8660149574279785  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8660149574279785  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8660740852355957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.869030475616455  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8692550659179688  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8692550659179688  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8693180084228516  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.872905731201172  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.873159885406494  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.873159885406494  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.873222827911377  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.877251148223877  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([48, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.877681255340576  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.877681255340576  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.877772808074951  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.884273052215576  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([43, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8846821784973145  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8846821784973145  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8847641944885254  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8911614418029785  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8914666175842285  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8914666175842285  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.891523838043213  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.8963875770568848  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.896846294403076  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.896846294403076  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.896920680999756  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.903764247894287  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.904305934906006  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.904305934906006  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.904387950897217  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9125075340270996  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9130868911743164  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9130868911743164  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9131689071655273  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9218626022338867  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9225292205810547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9225292205810547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.922616958618164  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9325313568115234  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.933206558227539  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.933206558227539  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.933290481567383  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.943361282348633  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.943976879119873  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.943976879119873  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.94404935836792  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.953254222869873  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9538025856018066  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9538025856018066  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9538636207580566  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9620423316955566  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9626846313476562  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9626846313476562  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9627513885498047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9721641540527344  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9728779792785645  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9728779792785645  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9729485511779785  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9833931922912598  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.984246253967285  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.984246253967285  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9843263626098633  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9967432022094727  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9975433349609375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9975433349609375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 2.9976158142089844  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.009357452392578  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.0099902153015137  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.0099902153015137  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.0100455284118652  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.0193934440612793  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([5558, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.153153896331787  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.153153896331787  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5558, 256]), torch.Size([1, 5558, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.164956569671631  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 5.066758632659912  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5558, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 4.924428462982178  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 4.925750255584717  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([6307, 256])
----------------------------------------before rst
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 4.925750255584717  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6307, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 4.927120685577393  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 4.9257988929748535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6307, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.05290985107421875  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.13690662384033203  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.13695144653320312  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

first layer input nodes number: 225477
first layer output nodes number: 53171
edges number: 521559
----------------------------------------before model layer 0
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.09737348556518555  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([225477, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.09737348556518555  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([114, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.29719114303588867  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.29719114303588867  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 114, 100]), torch.Size([1, 114, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.29727697372436523  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.2979593276977539  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 114, 100])
m.shape torch.Size([150, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.29802846908569336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.29802846908569336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 150, 100]), torch.Size([1, 150, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.2981410026550293  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.2998204231262207  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 150, 100])
m.shape torch.Size([229, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3000202178955078  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3000202178955078  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 229, 100]), torch.Size([1, 229, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.30019092559814453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.30394649505615234  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 229, 100])
m.shape torch.Size([246, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3042278289794922  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3042278289794922  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 246, 100]), torch.Size([1, 246, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3044118881225586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.30973243713378906  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 246, 100])
m.shape torch.Size([272, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3101472854614258  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3101472854614258  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 272, 100]), torch.Size([1, 272, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3103504180908203  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.31764888763427734  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 272, 100])
m.shape torch.Size([321, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3182649612426758  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3182649612426758  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 321, 100]), torch.Size([1, 321, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.31850433349609375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3287973403930664  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 321, 100])
m.shape torch.Size([376, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.32965850830078125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.32965850830078125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 376, 100]), torch.Size([1, 376, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3299388885498047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3439478874206543  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 376, 100])
m.shape torch.Size([331, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.34479427337646484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.34479427337646484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 331, 100]), torch.Size([1, 331, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.34504127502441406  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.35910892486572266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 331, 100])
m.shape torch.Size([412, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3603668212890625  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3603668212890625  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 412, 100]), torch.Size([1, 412, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3606739044189453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.3803272247314453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 412, 100])
m.shape torch.Size([50720, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.5691204071044922  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.5691204071044922  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 50720, 100]), torch.Size([1, 50720, 100])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 0.6081829071044922  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.300138473510742  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 50720, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.1057558059692383  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.156524658203125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([53171, 100])
----------------------------------------before rst
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.156524658203125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([53171, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.2072324752807617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.156463623046875  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([53171, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.2072324752807617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.220076560974121  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------input nodes number: 53171
----------------output nodes number: 6012
----------------edges number: 128654
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.220517635345459  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([18, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.344386100769043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.344386100769043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3444204330444336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3446950912475586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.344712734222412  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.344712734222412  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3447470664978027  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.345262050628662  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([57, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.345409393310547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.345409393310547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.345518112182617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.347909927368164  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([60, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.348086357116699  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.348086357116699  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.348200798034668  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3515195846557617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([56, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.351731777191162  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.351731777191162  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3518385887145996  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3556838035583496  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([87, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3561325073242188  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3561325073242188  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3562984466552734  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.363433837890625  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.364245891571045  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.364245891571045  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.364499568939209  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.377183437347412  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([67, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3775720596313477  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3775720596313477  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.377699851989746  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.384984016418457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([116, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3866047859191895  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3866047859191895  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.3868260383605957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.4009861946105957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([129, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.402562141418457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.402562141418457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.40280818939209  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.4202775955200195  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([97, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.421180248260498  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.421180248260498  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.421365261077881  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.4357962608337402  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([93, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.4371542930603027  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.4371542930603027  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.4373316764831543  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.452409267425537  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.45304536819458  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.45304536819458  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.453155994415283  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.4633336067199707  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.464597225189209  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.464597225189209  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.4647841453552246  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.4832892417907715  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([146, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.485802173614502  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.485802173614502  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.4860806465148926  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.515598773956299  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([70, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.516749382019043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.516749382019043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 18.2557373046875 GB
    Memory Allocated: 3.51688289642334  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2576904296875 GB
    Memory Allocated: 3.5319700241088867  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.2576904296875 GB
    Memory Allocated: 3.53250789642334  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2576904296875 GB
    Memory Allocated: 3.53250789642334  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 18.2576904296875 GB
    Memory Allocated: 3.532578468322754  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2674560546875 GB
    Memory Allocated: 3.5410470962524414  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.2674560546875 GB
    Memory Allocated: 3.54179048538208  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2674560546875 GB
    Memory Allocated: 3.54179048538208  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 18.2674560546875 GB
    Memory Allocated: 3.5418763160705566  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2791748046875 GB
    Memory Allocated: 3.55277681350708  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([64, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.2791748046875 GB
    Memory Allocated: 3.5539026260375977  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2791748046875 GB
    Memory Allocated: 3.5539026260375977  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 18.2791748046875 GB
    Memory Allocated: 3.5540246963500977  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.2947998046875 GB
    Memory Allocated: 3.5703821182250977  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.2947998046875 GB
    Memory Allocated: 3.5712437629699707  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.2947998046875 GB
    Memory Allocated: 3.5712437629699707  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 18.2947998046875 GB
    Memory Allocated: 3.5713353157043457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3084716796875 GB
    Memory Allocated: 3.5842442512512207  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([57, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.3084716796875 GB
    Memory Allocated: 3.5856375694274902  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3084716796875 GB
    Memory Allocated: 3.5856375694274902  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 18.3084716796875 GB
    Memory Allocated: 3.5857462882995605  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3240966796875 GB
    Memory Allocated: 3.601836681365967  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.3260498046875 GB
    Memory Allocated: 3.602480411529541  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3260498046875 GB
    Memory Allocated: 3.602480411529541  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 18.3260498046875 GB
    Memory Allocated: 3.602543354034424  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3358154296875 GB
    Memory Allocated: 3.6122994422912598  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([64, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.3358154296875 GB
    Memory Allocated: 3.613682746887207  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3358154296875 GB
    Memory Allocated: 3.613682746887207  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 18.3358154296875 GB
    Memory Allocated: 3.613804817199707  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3553466796875 GB
    Memory Allocated: 3.633580207824707  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.3553466796875 GB
    Memory Allocated: 3.6350879669189453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3553466796875 GB
    Memory Allocated: 3.6350879669189453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 18.3553466796875 GB
    Memory Allocated: 3.6352176666259766  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3768310546875 GB
    Memory Allocated: 3.657136917114258  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([4293, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.3787841796875 GB
    Memory Allocated: 3.7602248191833496  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3787841796875 GB
    Memory Allocated: 3.7602248191833496  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 4293, 256]), torch.Size([1, 4293, 256])
----------------------------------------3
 Nvidia-smi: 18.3787841796875 GB
    Memory Allocated: 3.7684130668640137  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3787841796875 GB
    Memory Allocated: 5.2101969718933105  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 4293, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.3787841796875 GB
    Memory Allocated: 5.089012145996094  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.3787841796875 GB
    Memory Allocated: 5.090198040008545  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([6012, 256])
----------------------------------------before rst
 Nvidia-smi: 18.3787841796875 GB
    Memory Allocated: 5.090198040008545  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6012, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.3787841796875 GB
    Memory Allocated: 5.091399669647217  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.3787841796875 GB
    Memory Allocated: 5.090213775634766  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6012, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.09031534194946289  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.15220022201538086  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.15224742889404297  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

first layer input nodes number: 166120
first layer output nodes number: 55017
edges number: 544225
----------------------------------------before model layer 0
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.07553768157958984  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([166120, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.07553768157958984  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([71, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.28412771224975586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.28412771224975586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 71, 100]), torch.Size([1, 71, 100])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2841811180114746  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2846055030822754  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 71, 100])
m.shape torch.Size([90, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.28464603424072266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.28464603424072266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 90, 100]), torch.Size([1, 90, 100])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2847137451171875  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2857236862182617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 90, 100])
m.shape torch.Size([113, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2858161926269531  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2858161926269531  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2859010696411133  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.28775978088378906  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([134, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2879171371459961  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2879171371459961  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 134, 100]), torch.Size([1, 134, 100])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.28801727294921875  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.29091548919677734  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 134, 100])
m.shape torch.Size([155, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2911543846130371  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2911543846130371  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 155, 100]), torch.Size([1, 155, 100])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.29127073287963867  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2954378128051758  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 155, 100])
m.shape torch.Size([194, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.29581356048583984  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.29581356048583984  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 194, 100]), torch.Size([1, 194, 100])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.2959585189819336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.3021831512451172  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 194, 100])
m.shape torch.Size([234, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.3027210235595703  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.3027210235595703  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 234, 100]), torch.Size([1, 234, 100])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.30289554595947266  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.31162166595458984  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 234, 100])
m.shape torch.Size([232, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.3122258186340332  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.3122258186340332  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 232, 100]), torch.Size([1, 232, 100])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.31239938735961914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.32225847244262695  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 232, 100])
m.shape torch.Size([274, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.3230905532836914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.3230905532836914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 274, 100]), torch.Size([1, 274, 100])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.32329559326171875  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.3363795280456543  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 274, 100])
m.shape torch.Size([53520, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.5356545448303223  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.5356545448303223  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 53520, 100]), torch.Size([1, 53520, 100])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 0.5758910179138184  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.407057285308838  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 53520, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.2038397789001465  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.256308078765869  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([55017, 100])
----------------------------------------before rst
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.256308078765869  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([55017, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.308776378631592  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.256308078765869  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([55017, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.308776378631592  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.3218936920166016  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------input nodes number: 55017
----------------output nodes number: 6293
----------------edges number: 155931
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.3223509788513184  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.472445011138916  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.472445011138916  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4724488258361816  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4724793434143066  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4724836349487305  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4724836349487305  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.472489356994629  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4725751876831055  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.472581386566162  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.472581386566162  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4725871086120605  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.472712993621826  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.472714424133301  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.472714424133301  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4727163314819336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.472771644592285  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4728140830993652  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4728140830993652  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4728312492370605  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.473449230194092  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.473446846008301  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.473446846008301  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4734487533569336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4735307693481445  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4735569953918457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4735569953918457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.473564624786377  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4739460945129395  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4739580154418945  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4739580154418945  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.47396183013916  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.474179267883301  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.474212169647217  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.474212169647217  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.474219799041748  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.474708080291748  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4747719764709473  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4747719764709473  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.474785327911377  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4757332801818848  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4757795333862305  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4757795333862305  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4757890701293945  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4765329360961914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.476609230041504  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.476609230041504  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4766225814819336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.477757453918457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.477850914001465  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.477850914001465  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4778661727905273  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4792699813842773  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4793028831481934  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4793028831481934  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.479308605194092  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.479875087738037  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.479959011077881  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.479959011077881  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4799704551696777  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4811835289001465  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.481255054473877  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.481255054473877  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.481264591217041  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.48234224319458  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4825825691223145  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4825825691223145  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4826111793518066  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.486044406890869  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.486116886138916  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.486116886138916  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.48612642288208  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.487337589263916  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.487497329711914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.487497329711914  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4875144958496094  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4898147583007812  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.489960193634033  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.489960193634033  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4899754524230957  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.492126941680908  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4922404289245605  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4922404289245605  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4922518730163574  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.493945598602295  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4940881729125977  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4940881729125977  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4941015243530273  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.496170997619629  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.496363639831543  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.496363639831543  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.4963808059692383  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.499161720275879  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.499361038208008  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.499361038208008  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.499378204345703  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.502279281616211  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6155, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.6505637168884277  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.6505637168884277  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 6155, 256]), torch.Size([1, 6155, 256])
----------------------------------------3
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 3.662728786468506  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 5.7291436195373535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 6155, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 5.580417156219482  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 5.581963539123535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([6293, 256])
----------------------------------------before rst
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 5.581963539123535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6293, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 5.583509922027588  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.3826904296875 GB
    Memory Allocated: 5.581963539123535  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6293, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.06856632232666016  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.1260356903076172  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.1260828971862793  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

first layer input nodes number: 154268
first layer output nodes number: 58798
edges number: 582018
----------------------------------------before model layer 0
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.07124042510986328  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([154268, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.07124042510986328  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([64, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29417943954467773  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29417943954467773  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29422712326049805  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29460859298706055  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([97, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29465723037719727  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29465723037719727  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 97, 100]), torch.Size([1, 97, 100])
----------------------------------------3
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29472970962524414  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29581689834594727  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 97, 100])
m.shape torch.Size([103, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.295896053314209  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.295896053314209  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 103, 100]), torch.Size([1, 103, 100])
----------------------------------------3
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.2959733009338379  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29766416549682617  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 103, 100])
m.shape torch.Size([118, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29780149459838867  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29780149459838867  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 118, 100]), torch.Size([1, 118, 100])
----------------------------------------3
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.29789018630981445  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.3004450798034668  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 118, 100])
m.shape torch.Size([195, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.3007640838623047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.3007640838623047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 195, 100]), torch.Size([1, 195, 100])
----------------------------------------3
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.30090999603271484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.3061485290527344  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 195, 100])
m.shape torch.Size([192, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.3065047264099121  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.3065047264099121  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 192, 100]), torch.Size([1, 192, 100])
----------------------------------------3
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.30664777755737305  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.31279897689819336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 192, 100])
m.shape torch.Size([225, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.31331443786621094  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.31331443786621094  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 225, 100]), torch.Size([1, 225, 100])
----------------------------------------3
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.31348228454589844  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.32187461853027344  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 225, 100])
m.shape torch.Size([248, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.32252979278564453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.32252979278564453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 248, 100]), torch.Size([1, 248, 100])
----------------------------------------3
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.32271480560302734  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.3332490921020508  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 248, 100])
m.shape torch.Size([267, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.33405208587646484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.33405208587646484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 267, 100]), torch.Size([1, 267, 100])
----------------------------------------3
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.33425140380859375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.34699487686157227  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 267, 100])
m.shape torch.Size([57289, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.5603137016296387  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.5603137016296387  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 57289, 100]), torch.Size([1, 57289, 100])
----------------------------------------3
 Nvidia-smi: 18.3846435546875 GB
    Memory Allocated: 0.6032824516296387  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.638678550720215  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 57289, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.4210338592529297  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.4771080017089844  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([58798, 100])
----------------------------------------before rst
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.4771080017089844  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([58798, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.533182144165039  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.4771080017089844  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([58798, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.533182144165039  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.5472006797790527  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------input nodes number: 58798
----------------output nodes number: 6276
----------------edges number: 156264
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.5476861000061035  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6980957984924316  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6980957984924316  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6980977058410645  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.698153018951416  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6981582641601562  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6981582641601562  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.698160171508789  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6982421875  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6982617378234863  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6982617378234863  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6982674598693848  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6985535621643066  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.698558807373047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.698558807373047  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6985607147216797  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.69866943359375  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6987032890319824  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6987032890319824  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6987109184265137  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6991991996765137  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6992053985595703  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6992053985595703  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.699207305908203  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.699342727661133  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6993632316589355  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6993632316589355  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.699367046356201  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.69966459274292  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.699697494506836  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.699697494506836  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.6997032165527344  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7001895904541016  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7002620697021484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7002620697021484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7002735137939453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.701326370239258  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7013745307922363  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7013745307922363  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7013821601867676  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7021374702453613  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.702162742614746  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.702162742614746  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7021665573120117  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.702570915222168  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.702615261077881  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.702615261077881  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7026209831237793  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7032675743103027  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7033138275146484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7033138275146484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.703319549560547  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7040061950683594  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.704176425933838  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.704176425933838  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.704195499420166  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.706617832183838  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.706699848175049  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.706699848175049  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.706709384918213  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7079873085021973  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7080979347229004  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7080979347229004  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7081093788146973  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7097229957580566  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.70977783203125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.70977783203125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7097835540771484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.710630416870117  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.710733413696289  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.710733413696289  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.710742950439453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.712221145629883  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7124156951904297  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7124156951904297  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.712432861328125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7152137756347656  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.715597629547119  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.715597629547119  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.715630054473877  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.7211098670959473  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([6187, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.869884490966797  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.869884490966797  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 6187, 256]), torch.Size([1, 6187, 256])
----------------------------------------3
 Nvidia-smi: 18.8572998046875 GB
    Memory Allocated: 3.881685256958008  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0057373046875 GB
    Memory Allocated: 5.959458827972412  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 6187, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.0057373046875 GB
    Memory Allocated: 5.810373783111572  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.0057373046875 GB
    Memory Allocated: 5.811957836151123  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([6276, 256])
----------------------------------------before rst
 Nvidia-smi: 19.0057373046875 GB
    Memory Allocated: 5.811957836151123  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6276, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 19.0057373046875 GB
    Memory Allocated: 5.813056945800781  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.0057373046875 GB
    Memory Allocated: 5.8114728927612305  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([6276, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 19.1561279296875 GB
    Memory Allocated: 0.06418848037719727  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.1561279296875 GB
    Memory Allocated: 0.155059814453125  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.1561279296875 GB
    Memory Allocated: 0.1551065444946289  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

first layer input nodes number: 243930
first layer output nodes number: 73435
edges number: 730231
----------------------------------------before model layer 0
 Nvidia-smi: 19.1561279296875 GB
    Memory Allocated: 0.10656118392944336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([243930, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.1561279296875 GB
    Memory Allocated: 0.10656118392944336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([39, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3862466812133789  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3862466812133789  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 39, 100]), torch.Size([1, 39, 100])
----------------------------------------3
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3862762451171875  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.38650989532470703  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 39, 100])
m.shape torch.Size([72, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3865489959716797  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3865489959716797  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 72, 100]), torch.Size([1, 72, 100])
----------------------------------------3
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.38660335540771484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.38741016387939453  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 72, 100])
m.shape torch.Size([94, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.38748836517333984  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.38748836517333984  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 94, 100]), torch.Size([1, 94, 100])
----------------------------------------3
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3875589370727539  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3891029357910156  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 94, 100])
m.shape torch.Size([72, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3891749382019043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3891749382019043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 72, 100]), torch.Size([1, 72, 100])
----------------------------------------3
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.38922929763793945  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.39078855514526367  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 72, 100])
m.shape torch.Size([105, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3909573554992676  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3909573554992676  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 105, 100]), torch.Size([1, 105, 100])
----------------------------------------3
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3910365104675293  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.39386463165283203  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 105, 100])
m.shape torch.Size([144, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3941469192504883  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3941469192504883  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 144, 100]), torch.Size([1, 144, 100])
----------------------------------------3
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3942546844482422  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.39887142181396484  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 144, 100])
m.shape torch.Size([158, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3992300033569336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.3992300033569336  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 158, 100]), torch.Size([1, 158, 100])
----------------------------------------3
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.39934825897216797  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.4052410125732422  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 158, 100])
m.shape torch.Size([162, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.40566492080688477  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.40566492080688477  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 162, 100]), torch.Size([1, 162, 100])
----------------------------------------3
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.40578603744506836  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.41267824172973633  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 162, 100])
m.shape torch.Size([203, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.4132986068725586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.4132986068725586  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 203, 100]), torch.Size([1, 203, 100])
----------------------------------------3
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.4134502410888672  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4315185546875 GB
    Memory Allocated: 0.4231419563293457  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 203, 100])
m.shape torch.Size([72386, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.7030029296875 GB
    Memory Allocated: 0.6927251815795898  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.7030029296875 GB
    Memory Allocated: 0.6927251815795898  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 72386, 100]), torch.Size([1, 72386, 100])
----------------------------------------3
 Nvidia-smi: 19.7030029296875 GB
    Memory Allocated: 0.7466573715209961  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.575828552246094  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 72386, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.3028082847595215  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.3728413581848145  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

h_self size  torch.Size([73435, 100])
----------------------------------------before rst
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.3728413581848145  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([73435, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.442874431610107  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.3728413581848145  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

torch.Size([73435, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.442874431610107  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.460452556610107  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------input nodes number: 73435
----------------output nodes number: 6271
----------------edges number: 156295
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.4610466957092285  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611475944519043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611475944519043  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611477851867676  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611506462097168  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611525058746338  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611525058746338  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611534595489502  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.61181116104126  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611815452575684  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611815452575684  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611817359924316  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.611939430236816  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([13, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.612088680267334  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.612088680267334  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.6121134757995605  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.614221096038818  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.61423397064209  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.61423397064209  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.6142377853393555  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.614588737487793  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.614600658416748  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.614600658416748  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.614602565765381  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.614791393280029  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.614833831787109  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.614833831787109  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.614839553833008  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.615446090698242  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.61545991897583  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.61545991897583  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.615461826324463  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.6156907081604  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.615724563598633  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.615724563598633  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.615728378295898  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.616212844848633  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.61622953414917  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.61622953414917  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.616231441497803  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.6164870262146  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.616659164428711  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.616659164428711  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.616676330566406  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.619096755981445  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.619189262390137  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.619189262390137  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.619198799133301  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.620610237121582  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.620626926422119  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.620626926422119  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.620628833770752  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.620924472808838  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.621062278747559  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.621062278747559  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.6210737228393555  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.623007774353027  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6220, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.7728095054626465  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.7728095054626465  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

 h.shape torch.Size([1, 6220, 256]), torch.Size([1, 6220, 256])
----------------------------------------3
 Nvidia-smi: 20.4119873046875 GB
    Memory Allocated: 4.78467321395874  GigaBytes
Max Memory Allocated: 6.156268119812012  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.5604248046875 GB
    Memory Allocated: 6.874716281890869  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6220, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.5604248046875 GB
    Memory Allocated: 6.725573539733887  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.5604248046875 GB
    Memory Allocated: 6.727084636688232  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([6271, 256])
----------------------------------------before rst
 Nvidia-smi: 20.5604248046875 GB
    Memory Allocated: 6.727084636688232  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6271, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.5604248046875 GB
    Memory Allocated: 6.728595733642578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.5604248046875 GB
    Memory Allocated: 6.727084636688232  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6271, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09751701354980469  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.17424917221069336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.17429399490356445  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 205976
first layer output nodes number: 56373
edges number: 558606
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09060001373291016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([205976, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09060001373291016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([54, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30545568466186523  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30545568466186523  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 54, 100]), torch.Size([1, 54, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3054966926574707  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3058204650878906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 54, 100])
m.shape torch.Size([87, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3058648109436035  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3058648109436035  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 87, 100]), torch.Size([1, 87, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30592966079711914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3069024085998535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 87, 100])
m.shape torch.Size([103, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30698537826538086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30698537826538086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 103, 100]), torch.Size([1, 103, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30706262588500977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30875349044799805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 103, 100])
m.shape torch.Size([113, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3088836669921875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3088836669921875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30896854400634766  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3114185333251953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([140, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31163692474365234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31163692474365234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 140, 100]), torch.Size([1, 140, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31174182891845703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3155040740966797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 140, 100])
m.shape torch.Size([163, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31581640243530273  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31581640243530273  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 163, 100]), torch.Size([1, 163, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31593847274780273  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3211703300476074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 163, 100])
m.shape torch.Size([180, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3215789794921875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3215789794921875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 180, 100]), torch.Size([1, 180, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3217134475708008  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3284268379211426  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 180, 100])
m.shape torch.Size([224, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3290271759033203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3290271759033203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 224, 100]), torch.Size([1, 224, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3291940689086914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33870697021484375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 224, 100])
m.shape torch.Size([203, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33930444717407227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33930444717407227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 203, 100]), torch.Size([1, 203, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33945608139038086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3491477966308594  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 203, 100])
m.shape torch.Size([55106, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5543580055236816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5543580055236816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 55106, 100]), torch.Size([1, 55106, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5973267555236816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.533423900604248  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 55106, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.3229079246520996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.3775954246520996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([56373, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.3775954246520996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([56373, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.431356906890869  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.376669406890869  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([56373, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.431356906890869  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.44387149810791  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 56373
----------------output nodes number: 5968
----------------edges number: 148426
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.444336414337158  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5871996879577637  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5871996879577637  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5872015953063965  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.587216854095459  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.58721923828125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.58721923828125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.587221145629883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5872631072998047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.587266445159912  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.587266445159912  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.587268352508545  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5873236656188965  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.587343215942383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.587343215942383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5873489379882812  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.587635040283203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5877017974853516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5877017974853516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.587718963623047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5886974334716797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.588740825653076  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.588740825653076  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.588752269744873  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.589484691619873  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.589510917663574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.589510917663574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5895166397094727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.589962959289551  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5899720191955566  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5899720191955566  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5899739265441895  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5901360511779785  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5901479721069336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5901479721069336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5901498794555664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.590325355529785  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5903921127319336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5903921127319336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5904016494750977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.59134578704834  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5913844108581543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5913844108581543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5913901329040527  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.591996669769287  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5920400619506836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5920400619506836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.592045783996582  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5926923751831055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.592771530151367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.592771530151367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5927810668945312  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5939254760742188  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.594024658203125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.594024658203125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.594036102294922  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.595489501953125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5955934524536133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5955934524536133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.59560489654541  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5971384048461914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.597248077392578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.597248077392578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.597259521484375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5988731384277344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.598907947540283  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.598907947540283  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.598911762237549  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5994763374328613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5997495651245117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5997495651245117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5997743606567383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6036176681518555  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6037821769714355  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6037821769714355  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.603797435760498  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.606269359588623  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6065850257873535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6065850257873535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.606611728668213  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6111245155334473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([5871, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.752223014831543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.752223014831543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5871, 256]), torch.Size([1, 5871, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.763421058654785  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.744706630706787  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5871, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.603614330291748  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.6054840087890625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([5968, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.6054840087890625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5968, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.607353687286377  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.6054840087890625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5968, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08373451232910156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.18046188354492188  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.18050670623779297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 259650
first layer output nodes number: 59620
edges number: 590106
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.1115870475769043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([259650, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.1115870475769043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([53, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33824682235717773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33824682235717773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 53, 100]), torch.Size([1, 53, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3382868766784668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3386044502258301  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 53, 100])
m.shape torch.Size([89, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.338651180267334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.338651180267334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 89, 100]), torch.Size([1, 89, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3387179374694824  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33971643447875977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 89, 100])
m.shape torch.Size([133, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3398318290710449  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3398318290710449  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 133, 100]), torch.Size([1, 133, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33993101119995117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34211301803588867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 133, 100])
m.shape torch.Size([145, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34227991104125977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34227991104125977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 145, 100]), torch.Size([1, 145, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3423886299133301  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34553003311157227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 145, 100])
m.shape torch.Size([166, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34578514099121094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34578514099121094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 166, 100]), torch.Size([1, 166, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34590911865234375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35036516189575195  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 166, 100])
m.shape torch.Size([194, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3507370948791504  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3507370948791504  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 194, 100]), torch.Size([1, 194, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35088205337524414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35710668563842773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 194, 100])
m.shape torch.Size([242, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3576655387878418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3576655387878418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 242, 100]), torch.Size([1, 242, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.357846736907959  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.36687660217285156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 242, 100])
m.shape torch.Size([252, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3675370216369629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3675370216369629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 252, 100]), torch.Size([1, 252, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3677248954772949  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3784337043762207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 252, 100])
m.shape torch.Size([268, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3792386054992676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3792386054992676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 268, 100]), torch.Size([1, 268, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3794388771057129  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3922305107116699  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 268, 100])
m.shape torch.Size([58078, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6089272499084473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6089272499084473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 58078, 100]), torch.Size([1, 58078, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6521992683410645  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7252259254455566  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 58078, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5048484802246094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.56170654296875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([59620, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.56170654296875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([59620, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6185646057128906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.56170654296875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([59620, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6185646057128906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.632779121398926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 59620
----------------output nodes number: 5983
----------------edges number: 144917
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.633268356323242  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7727599143981934  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7727599143981934  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.772765636444092  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7728114128112793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.772820472717285  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.772820472717285  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.772831916809082  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.773003578186035  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([27, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.773076057434082  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.773076057434082  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.773127555847168  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7742605209350586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.774254322052002  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.774254322052002  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.774263858795166  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.774540424346924  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.774555206298828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.774555206298828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7745628356933594  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7748374938964844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.774874210357666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.774874210357666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7748875617980957  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7754616737365723  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([18, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.775576114654541  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.775576114654541  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7756104469299316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.777327060699463  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([6, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7773561477661133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7773561477661133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.77736759185791  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.778019905090332  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([18, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.778170108795166  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.778170108795166  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7782044410705566  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7804017066955566  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7805099487304688  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7805099487304688  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7805347442626953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7822952270507812  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7823572158813477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7823572158813477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7823705673217773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.783411979675293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([23, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7836709022521973  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7836709022521973  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.783714771270752  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7874436378479004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7877345085144043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7877345085144043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7877821922302246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7921690940856934  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([14, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7923340797424316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7923340797424316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.792360782623291  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.795004367828369  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7955102920532227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7955102920532227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.795578956604004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8028573989868164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8031768798828125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8031768798828125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.803220748901367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.808177947998047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.808368682861328  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.808368682861328  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8083934783935547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.811368942260742  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.812100887298584  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.812100887298584  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.812182903289795  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.822598934173584  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.823087692260742  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.823087692260742  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8231430053710938  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.830554962158203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8314499855041504  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8314499855041504  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8315415382385254  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8444504737854004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8453335762023926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8453335762023926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.845421314239502  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8584065437316895  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.859124183654785  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.859124183654785  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8591928482055664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.86983585357666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8704209327697754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8704209327697754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.870474338531494  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8791260719299316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.880068302154541  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.880068302154541  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.880148410797119  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8936867713928223  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([5463, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.02509069442749  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.02509069442749  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5463, 256]), torch.Size([1, 5463, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.035510540008545  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.914802074432373  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5463, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.777992248535156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.77918815612793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([5983, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.77918815612793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5983, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.780579566955566  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.779383659362793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5983, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.10305595397949219  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.1889934539794922  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.1890406608581543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 229089
first layer output nodes number: 65709
edges number: 648970
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.10044193267822266  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([229089, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.10044193267822266  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([81, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34903430938720703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34903430938720703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 81, 100]), torch.Size([1, 81, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34909534454345703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3495807647705078  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 81, 100])
m.shape torch.Size([109, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34963178634643555  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34963178634643555  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 109, 100]), torch.Size([1, 109, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3497138023376465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3509354591369629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 109, 100])
m.shape torch.Size([132, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3510422706604004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3510422706604004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 132, 100]), torch.Size([1, 132, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35114145278930664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35331058502197266  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 132, 100])
m.shape torch.Size([215, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35358142852783203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35358142852783203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 215, 100]), torch.Size([1, 215, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3537416458129883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35838794708251953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 215, 100])
m.shape torch.Size([234, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35874414443969727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35874414443969727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 234, 100]), torch.Size([1, 234, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3589186668395996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.365201473236084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 234, 100])
m.shape torch.Size([277, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.36573362350463867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.36573362350463867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 277, 100]), torch.Size([1, 277, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.36594057083129883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.37482213973999023  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 277, 100])
m.shape torch.Size([316, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.37554311752319336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.37554311752319336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 316, 100]), torch.Size([1, 316, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3757786750793457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3875565528869629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 316, 100])
m.shape torch.Size([380, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.38857126235961914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.38857126235961914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 380, 100]), torch.Size([1, 380, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3888545036315918  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4049992561340332  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 380, 100])
m.shape torch.Size([319, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4059271812438965  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4059271812438965  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 319, 100]), torch.Size([1, 319, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.40616559982299805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4213857650756836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 319, 100])
m.shape torch.Size([63646, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6583666801452637  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6583666801452637  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 63646, 100]), torch.Size([1, 63646, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.705787181854248  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.0726141929626465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 63646, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.830389976501465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.893054962158203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([65709, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.893054962158203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([65709, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9557199478149414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.893054962158203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([65709, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9557199478149414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.971935272216797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 65709
----------------output nodes number: 6286
----------------edges number: 153072
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9724721908569336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119811534881592  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119811534881592  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119815349578857  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119845867156982  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119848251342773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119848251342773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119852066040039  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119909286499023  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119933605194092  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119933605194092  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.119950771331787  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.120328426361084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.120362281799316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.120362281799316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.120383262634277  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1209917068481445  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1210150718688965  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1210150718688965  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.121028423309326  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.121509075164795  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.121514320373535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.121514320373535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.121518135070801  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.121682167053223  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([23, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.121835231781006  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.121835231781006  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1218791007995605  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.124072551727295  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.124173641204834  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.124173641204834  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.124204158782959  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.125943660736084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.126006603240967  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.126006603240967  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.126023769378662  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.127122402191162  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([18, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.127286911010742  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.127286911010742  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.127321243286133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.129758834838867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1299214363098145  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1299214363098145  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.129953861236572  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.132483005523682  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.13260555267334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.13260555267334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.132628440856934  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.134573936462402  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1349873542785645  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1349873542785645  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.13505220413208  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.141018390655518  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([23, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.141295909881592  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.141295909881592  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1413397789001465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1456828117370605  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.145776271820068  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.145776271820068  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.145791530609131  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.147408962249756  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.147801399230957  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.147801399230957  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.14785099029541  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.153454780578613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.153871536254883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.153871536254883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.153923034667969  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.160102844238281  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.160907745361328  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.160907745361328  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.160999298095703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.172626495361328  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.172836780548096  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.172836780548096  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.172863483428955  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.176441669464111  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.176774501800537  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.176774501800537  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.176808834075928  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.181649684906006  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1820969581604  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1820969581604  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.182140827178955  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.188633441925049  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.188886642456055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.188886642456055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.188911437988281  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.192754745483398  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.192985534667969  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.192985534667969  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.19300651550293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.196405410766602  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.19706392288208  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.19706392288208  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.197119235992432  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.206467151641846  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([5884, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.348451137542725  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.348451137542725  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5884, 256]), torch.Size([1, 5884, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.360641956329346  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.343865871429443  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5884, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.19774055480957  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.199396133422852  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([6286, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.199396133422852  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6286, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.201281547546387  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.1996259689331055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6286, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.0927281379699707  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.21108341217041016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.21112823486328125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 317707
first layer output nodes number: 70881
edges number: 693415
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.13420867919921875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([317707, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.13420867919921875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([106, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3998532295227051  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3998532295227051  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 106, 100]), torch.Size([1, 106, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3999323844909668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.40056562423706055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 106, 100])
m.shape torch.Size([216, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.40068721771240234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.40068721771240234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 216, 100]), torch.Size([1, 216, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.400848388671875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4032630920410156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 216, 100])
m.shape torch.Size([329, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4035506248474121  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4035506248474121  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 329, 100]), torch.Size([1, 329, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4037966728210449  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4091968536376953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 329, 100])
m.shape torch.Size([412, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.40968799591064453  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.40968799591064453  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 412, 100]), torch.Size([1, 412, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.40999507904052734  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4189004898071289  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 412, 100])
m.shape torch.Size([482, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.419644832611084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.419644832611084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 482, 100]), torch.Size([1, 482, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.42000436782836914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4329404830932617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 482, 100])
m.shape torch.Size([533, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.43395233154296875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.43395233154296875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 533, 100]), torch.Size([1, 533, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.43435001373291016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4514331817626953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 533, 100])
m.shape torch.Size([553, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.45267677307128906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.45267677307128906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 553, 100]), torch.Size([1, 553, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.45308971405029297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4737067222595215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 553, 100])
m.shape torch.Size([597, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4752798080444336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4752798080444336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 597, 100]), torch.Size([1, 597, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4757251739501953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5010881423950195  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 597, 100])
m.shape torch.Size([543, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5026860237121582  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5026860237121582  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 543, 100]), torch.Size([1, 543, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5030913352966309  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5289926528930664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 543, 100])
m.shape torch.Size([67110, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.7787942886352539  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.7787942886352539  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 67110, 100]), torch.Size([1, 67110, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.8287954330444336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.379637718200684  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 67110, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.121394634246826  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.188992023468018  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([70881, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.188992023468018  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([70881, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.256589412689209  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.188992023468018  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([70881, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.256589412689209  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.274167537689209  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 70881
----------------output nodes number: 5963
----------------edges number: 134485
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.274740695953369  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.404201507568359  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.404201507568359  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.404212951660156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.404304504394531  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([22, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.404341220855713  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.404341220855713  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.404383182525635  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.405012607574463  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([62, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.405170440673828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.405170440673828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.4052886962890625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.407890319824219  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([60, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.408061981201172  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.408061981201172  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.408176422119141  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.411495208740234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([76, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.411803245544434  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.411803245544434  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.411948204040527  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.417166709899902  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([85, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.417584419250488  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.417584419250488  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.417746543884277  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.424717903137207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([89, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.425235748291016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.425235748291016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.425405502319336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.433893203735352  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([51, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.434200763702393  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.434200763702393  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.434298038482666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.439842700958252  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([24, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.440001964569092  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.440001964569092  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.440047740936279  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.442977428436279  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([45, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.443387508392334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.443387508392334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.4434733390808105  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.4495673179626465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.450159072875977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.450159072875977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.450273513793945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.459199905395508  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([38, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.45958137512207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.45958137512207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.459653854370117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.465814590454102  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.466278553009033  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.466278553009033  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.466354846954346  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.473373889923096  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.474520206451416  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.474520206451416  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.4746880531311035  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.491304874420166  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.491783618927002  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.491783618927002  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.491858005523682  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.4997429847717285  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.500505447387695  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.500505447387695  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.500604629516602  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.511812210083008  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.512301921844482  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.512301921844482  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.512364864349365  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.519917964935303  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.5202155113220215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.5202155113220215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.520251750946045  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.5248541831970215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.525183200836182  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.525183200836182  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.525219440460205  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.530075550079346  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.530730247497559  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.530730247497559  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.530797004699707  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.540209770202637  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.540539741516113  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.540539741516113  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.540574073791504  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.545655250549316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.5465264320373535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.5465264320373535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.546606540679932  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.559023380279541  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.559912204742432  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.559912204742432  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.55999231338501  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.572969913482666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.574012756347656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.574012756347656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.574098587036133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.588603973388672  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([4873, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.705650329589844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.705650329589844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4873, 256]), torch.Size([1, 4873, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.714986801147461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.3683929443359375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4873, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.241565227508545  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.243246078491211  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.243246078491211  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.244926929473877  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.243246078491211  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5963, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.1251688003540039  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.17462968826293945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.17467689514160156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 132770
first layer output nodes number: 44267
edges number: 431544
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.061969757080078125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([132770, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.061969757080078125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([81, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.22738885879516602  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.22738885879516602  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 81, 100]), torch.Size([1, 81, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.22744989395141602  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2279353141784668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 81, 100])
m.shape torch.Size([185, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2280430793762207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2280430793762207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 185, 100]), torch.Size([1, 185, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2281813621520996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.23025274276733398  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 185, 100])
m.shape torch.Size([203, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.23041057586669922  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.23041057586669922  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 203, 100]), torch.Size([1, 203, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2305622100830078  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.23389387130737305  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 203, 100])
m.shape torch.Size([314, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.23428630828857422  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.23428630828857422  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 314, 100]), torch.Size([1, 314, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.23452091217041016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24131298065185547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 314, 100])
m.shape torch.Size([329, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24180889129638672  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24180889129638672  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 329, 100]), torch.Size([1, 329, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24205493927001953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.25089120864868164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 329, 100])
m.shape torch.Size([379, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2516155242919922  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2516155242919922  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 379, 100]), torch.Size([1, 379, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.25189876556396484  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2640523910522461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 379, 100])
m.shape torch.Size([394, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2649383544921875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2649383544921875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 394, 100]), torch.Size([1, 394, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2652320861816406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2799186706542969  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 394, 100])
m.shape torch.Size([421, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.28102684020996094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.28102684020996094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 421, 100]), torch.Size([1, 421, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2813405990600586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.299224853515625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 421, 100])
m.shape torch.Size([427, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30049991607666016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30049991607666016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 427, 100]), torch.Size([1, 427, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30081844329833984  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.32119131088256836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 427, 100])
m.shape torch.Size([41534, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.47575855255126953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.47575855255126953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 41534, 100]), torch.Size([1, 41534, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5067043304443359  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7038259506225586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 41534, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.543247699737549  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.5854640007019043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([44267, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.5854640007019043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([44267, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.6276803016662598  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.5854640007019043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([44267, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.6276803016662598  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.6382346153259277  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 44267
----------------output nodes number: 6317
----------------edges number: 155376
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.6386117935180664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7884297370910645  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7884297370910645  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.78843355178833  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.788464069366455  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7884702682495117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7884702682495117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.788477897644043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7885923385620117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.788609027862549  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.788609027862549  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7886223793029785  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7889161109924316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.788959503173828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.788959503173828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7889842987060547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.789703369140625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.789710521697998  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.789710521697998  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7897181510925293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7899928092956543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7900466918945312  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7900466918945312  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7900657653808594  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7908859252929688  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7909302711486816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7909302711486816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.790945529937744  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.791708469390869  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([16, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7918238639831543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7918238639831543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7918543815612793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7935938835144043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7936482429504395  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7936482429504395  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.793663501739502  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.794640064239502  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.794671058654785  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.794671058654785  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7946786880493164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.795220375061035  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7953014373779297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7953014373779297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.795316696166992  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.796506881713867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.796614646911621  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.796614646911621  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.796633720397949  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.79825496673584  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7983956336975098  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7983956336975098  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7984185218811035  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8005242347717285  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8006744384765625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8006744384765625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8006973266601562  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8029632568359375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8031105995178223  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8031105995178223  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.803131580352783  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8053555488586426  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8054990768432617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8054990768432617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.80551815032959  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.807673454284668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8077950477600098  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8077950477600098  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8078103065490723  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8096413612365723  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8098416328430176  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8098416328430176  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8098645210266113  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8127713203430176  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8130340576171875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8130340576171875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8130626678466797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.816896438598633  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8171324729919434  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8171324729919434  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.81715726852417  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8206534385681152  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8207826614379883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8207826614379883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.820796012878418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8227720260620117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.822998046875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.822998046875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.823019027709961  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8262710571289062  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.826437473297119  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.826437473297119  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8264527320861816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8289246559143066  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8291478157043457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8291478157043457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.829166889190674  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.832390308380127  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6094, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.979778289794922  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.979778289794922  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6094, 256]), torch.Size([1, 6094, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.9914016723632812  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.041790008544922  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6094, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.893203258514404  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.894395351409912  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([6317, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.894395351409912  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6317, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.895501613616943  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.8943095207214355  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6317, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.05578804016113281  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.13837718963623047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.13842201232910156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 221698
first layer output nodes number: 63516
edges number: 624812
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09679508209228516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([221698, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09679508209228516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([98, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3361492156982422  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3361492156982422  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 98, 100]), torch.Size([1, 98, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33622264862060547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3368086814880371  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 98, 100])
m.shape torch.Size([165, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3368949890136719  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3368949890136719  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 165, 100]), torch.Size([1, 165, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3370180130004883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3388633728027344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 165, 100])
m.shape torch.Size([163, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33898448944091797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33898448944091797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 163, 100]), torch.Size([1, 163, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33910655975341797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3417835235595703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 163, 100])
m.shape torch.Size([323, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34220409393310547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34220409393310547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 323, 100]), torch.Size([1, 323, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34244537353515625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34943103790283203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 323, 100])
m.shape torch.Size([313, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34989356994628906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34989356994628906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 313, 100]), torch.Size([1, 313, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3501272201538086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35853147506713867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 313, 100])
m.shape torch.Size([354, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3592061996459961  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3592061996459961  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 354, 100]), torch.Size([1, 354, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3594703674316406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3708209991455078  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 354, 100])
m.shape torch.Size([312, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3715028762817383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3715028762817383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 312, 100]), torch.Size([1, 312, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3717355728149414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3833603858947754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 312, 100])
m.shape torch.Size([389, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.38463926315307617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.38463926315307617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 389, 100]), torch.Size([1, 389, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.38492918014526367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.40145444869995117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 389, 100])
m.shape torch.Size([372, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4025568962097168  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4025568962097168  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 372, 100]), torch.Size([1, 372, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.402834415435791  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.42058277130126953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 372, 100])
m.shape torch.Size([61027, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6477875709533691  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6477875709533691  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 61027, 100]), torch.Size([1, 61027, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6932568550109863  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9224839210510254  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 61027, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.689457893371582  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7500314712524414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([63516, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7500314712524414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([63516, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.810605049133301  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7500314712524414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([63516, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.810605049133301  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8265938758850098  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 63516
----------------output nodes number: 6011
----------------edges number: 147571
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8271121978759766  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.969161033630371  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.969161033630371  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9691686630249023  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9692296981811523  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.969233989715576  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.969233989715576  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9692416191101074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.969356060028076  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9693641662597656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9693641662597656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.969371795654297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9695396423339844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([19, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.969609260559082  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.969609260559082  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9696455001831055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.970696449279785  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.970731258392334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.970731258392334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.970752239227295  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9715075492858887  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9715609550476074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9715609550476074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9715819358825684  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9724841117858887  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9725208282470703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9725208282470703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9725341796875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9732017517089844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.973233699798584  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.973233699798584  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.973243236541748  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9737868309020996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9738516807556152  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9738516807556152  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9738669395446777  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9748435020446777  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([13, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.974961280822754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.974961280822754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9749860763549805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9767465591430664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.976840019226074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.976840019226074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9768590927124023  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.978346824645996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9784412384033203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9784412384033203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9784584045410156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.979917526245117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.979959011077881  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.979959011077881  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.979966640472412  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.980668544769287  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9808130264282227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9808130264282227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9808340072631836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9829111099243164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.98311710357666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.98311710357666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9831457138061523  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.986178398132324  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9862871170043945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9862871170043945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.986302375793457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9880266189575195  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.988198757171631  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.988198757171631  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.988219738006592  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9907374382019043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9908480644226074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9908480644226074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.990861415863037  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9925570487976074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9927330017089844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9927330017089844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9927520751953125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9953079223632812  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.995663642883301  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.995663642883301  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.995699882507324  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.000809669494629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.001054286956787  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.001054286956787  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.001079082489014  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.004748821258545  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.005053997039795  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.005053997039795  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.005082607269287  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.009517192840576  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.009657859802246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.009657859802246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.009671211242676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.011834144592285  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.012173652648926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.012173652648926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.012202262878418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.017037391662598  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5771, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.155689716339111  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.155689716339111  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5771, 256]), torch.Size([1, 5771, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.167355060577393  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.112614154815674  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5771, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.973412990570068  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.974480152130127  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([6011, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.974480152130127  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6011, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.9755473136901855  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.974480152130127  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6011, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08878898620605469  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.17115068435668945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.17119550704956055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 221087
first layer output nodes number: 56658
edges number: 551893
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.0958261489868164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([221087, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.0958261489868164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([152, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3077583312988281  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3077583312988281  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 152, 100]), torch.Size([1, 152, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30787181854248047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3087782859802246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 152, 100])
m.shape torch.Size([202, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3088722229003906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3088722229003906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 202, 100]), torch.Size([1, 202, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3090229034423828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3112831115722656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 202, 100])
m.shape torch.Size([285, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3115262985229492  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3115262985229492  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 285, 100]), torch.Size([1, 285, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3117389678955078  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31641340255737305  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 285, 100])
m.shape torch.Size([369, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31685733795166016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31685733795166016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 369, 100]), torch.Size([1, 369, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31713294982910156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.32511425018310547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 369, 100])
m.shape torch.Size([429, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3257756233215332  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3257756233215332  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 429, 100]), torch.Size([1, 429, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3260960578918457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33761024475097656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 429, 100])
m.shape torch.Size([508, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33878183364868164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33878183364868164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 508, 100]), torch.Size([1, 508, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3391604423522949  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.355440616607666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 508, 100])
m.shape torch.Size([563, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3568739891052246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3568739891052246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 563, 100]), torch.Size([1, 563, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35729360580444336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.37827444076538086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 563, 100])
m.shape torch.Size([524, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3796262741088867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3796262741088867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 524, 100]), torch.Size([1, 524, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3800172805786133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4022817611694336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 524, 100])
m.shape torch.Size([580, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.40403127670288086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.40403127670288086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 580, 100]), torch.Size([1, 580, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4044642448425293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.43213558197021484  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 580, 100])
m.shape torch.Size([53046, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6295309066772461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6295309066772461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 53046, 100]), torch.Size([1, 53046, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6690540313720703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4751529693603516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 53046, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.270592212677002  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.325279712677002  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([56658, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.325279712677002  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([56658, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.3793129920959473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.3246254920959473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([56658, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.3793129920959473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.392167091369629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 56658
----------------output nodes number: 5991
----------------edges number: 145170
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.392634391784668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([35, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5324020385742188  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5324020385742188  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.532468795776367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5330028533935547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5329813957214355  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5329813957214355  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5329928398132324  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5331645011901855  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5331850051879883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5331850051879883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5332021713256836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5335798263549805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.533613681793213  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.533613681793213  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.533634662628174  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.534243106842041  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5343146324157715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5343146324157715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5343470573425293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5355143547058105  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5355734825134277  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5355734825134277  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5355982780456543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5366644859313965  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.536773204803467  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.536773204803467  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5368075370788574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5385241508483887  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5386147499084473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5386147499084473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5386414527893066  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.540163516998291  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5402626991271973  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5402626991271973  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.540287494659424  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.541874408721924  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5419297218322754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5419297218322754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.541943073272705  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.542891025543213  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([22, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.543117046356201  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.543117046356201  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.543159008026123  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5464320182800293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.546584129333496  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.546584129333496  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5466127395629883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.549044609069824  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.549168109893799  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.549168109893799  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5491890907287598  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.551119327545166  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5513648986816406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5513648986816406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.551401138305664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5549888610839844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5552592277526855  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5552592277526855  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.555297374725342  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5593409538269043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5594911575317383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5594911575317383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.559512138366699  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.561882972717285  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5620198249816895  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5620198249816895  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5620369911193848  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5640969276428223  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.56443452835083  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.56443452835083  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5644726753234863  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.56931734085083  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.569700241088867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.569700241088867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.569742202758789  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5753650665283203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.575594425201416  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.575594425201416  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5756192207336426  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.579115390777588  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.579486846923828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.579486846923828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5795230865478516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5848865509033203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.585270404815674  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.585270404815674  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5853066444396973  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.59092378616333  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.591259479522705  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.591259479522705  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.59128999710083  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.59623384475708  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5966572761535645  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5966572761535645  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.596693515777588  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.602818012237549  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([5613, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.738311767578125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.738311767578125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5613, 256]), torch.Size([1, 5613, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7490177154541016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.637197971343994  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5613, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.498974323272705  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.500132083892822  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([5991, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.500132083892822  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5991, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.501651287078857  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.50049352645874  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5991, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08865213394165039  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.1588444709777832  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.1588916778564453  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 188420
first layer output nodes number: 59458
edges number: 579127
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08446168899536133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([188420, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08446168899536133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([126, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30666255950927734  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30666255950927734  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 126, 100]), torch.Size([1, 126, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30675697326660156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3075094223022461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 126, 100])
m.shape torch.Size([206, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3076157569885254  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3076157569885254  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 206, 100]), torch.Size([1, 206, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3077692985534668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3100724220275879  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 206, 100])
m.shape torch.Size([309, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31034135818481445  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31034135818481445  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 309, 100]), torch.Size([1, 309, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31057214736938477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.315640926361084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 309, 100])
m.shape torch.Size([396, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3161158561706543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3161158561706543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 396, 100]), torch.Size([1, 396, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31641149520874023  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.32497358322143555  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 396, 100])
m.shape torch.Size([492, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.325742244720459  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.325742244720459  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 492, 100]), torch.Size([1, 492, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3261094093322754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3393130302429199  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 492, 100])
m.shape torch.Size([552, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3403635025024414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3403635025024414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 552, 100]), torch.Size([1, 552, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3407754898071289  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35846519470214844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 552, 100])
m.shape torch.Size([593, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3598055839538574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3598055839538574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 593, 100]), torch.Size([1, 593, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3602480888366699  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3823533058166504  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 593, 100])
m.shape torch.Size([546, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3837594985961914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3837594985961914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 546, 100]), torch.Size([1, 546, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3841667175292969  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4073667526245117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 546, 100])
m.shape torch.Size([593, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.409151554107666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.409151554107666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 593, 100]), torch.Size([1, 593, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4095940589904785  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.43788862228393555  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 593, 100])
m.shape torch.Size([55645, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6449613571166992  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6449613571166992  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 55645, 100]), torch.Size([1, 55645, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6879301071166992  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6481170654296875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 55645, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4311695098876953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.487873077392578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([59458, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.487873077392578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([59458, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.544576644897461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.487873077392578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([59458, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.544576644897461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5587525367736816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 59458
----------------output nodes number: 6327
----------------edges number: 153520
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5592432022094727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7070231437683105  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7070231437683105  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7070345878601074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7072062492370605  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7072324752807617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7072324752807617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7072534561157227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7077150344848633  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707770347595215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707770347595215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7078027725219727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.708743095397949  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.708799362182617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.708799362182617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7088279724121094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.709857940673828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7099647521972656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7099647521972656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7100048065185547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7117271423339844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([29, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.711902618408203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.711902618408203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7119579315185547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.714723587036133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.714834690093994  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.714834690093994  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7148690223693848  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7168259620666504  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.71695613861084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.71695613861084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7169885635375977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7190637588500977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7192206382751465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7192206382751465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.719254970550537  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7216925621032715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7218236923217773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7218236923217773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7218503952026367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.723933219909668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.724092960357666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.724092960357666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.724121570587158  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.726553440093994  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.726801872253418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.726801872253418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.726841926574707  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.730526924133301  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7307090759277344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7307090759277344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7307376861572266  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.733570098876953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7338876724243164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7338876724243164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.733931541442871  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.738581657409668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7388367652893066  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7388367652893066  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7388710975646973  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.742750644683838  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.743011474609375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.743011474609375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.743043899536133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7469348907470703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7472476959228516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7472476959228516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.747283935546875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7518863677978516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7521605491638184  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7521605491638184  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7521910667419434  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7562804222106934  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.756592273712158  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.756592273712158  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.756624698638916  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7611966133117676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.761523723602295  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.761523723602295  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7615561485290527  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.766355037689209  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7668042182922363  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7668042182922363  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.766846179962158  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.773350238800049  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.773815631866455  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.773815631866455  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.773857593536377  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7806553840637207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.781118869781494  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.781118869781494  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.781158924102783  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7879281044006348  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([5918, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.930694580078125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.930694580078125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5918, 256]), torch.Size([1, 5918, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.9419822692871094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.9376678466796875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5918, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.790858745574951  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.79212760925293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.79212760925293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.793396472930908  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.79212760925293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6327, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.07659626007080078  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.11933279037475586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.11937808990478516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 114719
first layer output nodes number: 44120
edges number: 427803
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.05457115173339844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([114719, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.05457115173339844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([76, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.21848154067993164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.21848154067993164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.21853876113891602  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2189936637878418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([163, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2190866470336914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2190866470336914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 163, 100]), torch.Size([1, 163, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2192087173461914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.22103404998779297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 163, 100])
m.shape torch.Size([217, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.22121572494506836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.22121572494506836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 217, 100]), torch.Size([1, 217, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.22137784957885742  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.22494029998779297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 217, 100])
m.shape torch.Size([305, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.22531414031982422  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.22531414031982422  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 305, 100]), torch.Size([1, 305, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2255420684814453  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.23214054107666016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 305, 100])
m.shape torch.Size([456, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.23287630081176758  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.23287630081176758  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 456, 100]), torch.Size([1, 456, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2332167625427246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2454519271850586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 456, 100])
m.shape torch.Size([521, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24678659439086914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24678659439086914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 521, 100]), torch.Size([1, 521, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2471756935119629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.26388120651245117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 521, 100])
m.shape torch.Size([597, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2652435302734375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2652435302734375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 597, 100]), torch.Size([1, 597, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2656888961791992  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2879371643066406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 597, 100])
m.shape torch.Size([647, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2896428108215332  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2896428108215332  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 647, 100]), torch.Size([1, 647, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.29012537002563477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3176083564758301  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 647, 100])
m.shape torch.Size([611, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3194160461425781  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3194160461425781  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 611, 100]), torch.Size([1, 611, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3198719024658203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34902095794677734  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 611, 100])
m.shape torch.Size([40527, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4997682571411133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4997682571411133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 40527, 100]), torch.Size([1, 40527, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.529963493347168  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.6738109588623047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 40527, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.514946460723877  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.5570225715637207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([44120, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.5570225715637207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([44120, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.5990986824035645  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.5570225715637207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([44120, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.5990986824035645  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.6096177101135254  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 44120
----------------output nodes number: 6022
----------------edges number: 142210
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.609992027282715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.746886730194092  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.746886730194092  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.74690580368042  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.747058391571045  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.747072219848633  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.747072219848633  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7470951080322266  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.747438430786133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([22, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.747490882873535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.747490882873535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.747532844543457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7484560012817383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.748546600341797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.748546600341797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7486019134521484  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7502059936523438  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7503228187561035  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7503228187561035  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.750380039215088  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7524399757385254  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.752607822418213  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.752607822418213  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7526726722717285  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7554612159729004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.755624294281006  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.755624294281006  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7556796073913574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7584452629089355  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([37, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.758702278137207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.758702278137207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.758772850036621  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7627954483032227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7629852294921875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7629852294921875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7630348205566406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7662086486816406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7665395736694336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7665395736694336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7666101455688477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.771620750427246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7718920707702637  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7718920707702637  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7719473838806152  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.776261806488037  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.776522636413574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.776522636413574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7765703201293945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.780623435974121  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7810869216918945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7810869216918945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.781161308288574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7880048751831055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7884254455566406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7884254455566406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7884902954101562  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.794910430908203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7954258918762207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7954258918762207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7954983711242676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8031811714172363  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8035755157470703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8035755157470703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.803628921508789  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.809663772583008  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.810258388519287  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.810258388519287  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.810330867767334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.819028377532959  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8194942474365234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8194942474365234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.819549560546875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8265743255615234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.827186107635498  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.827186107635498  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8272528648376465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.836198329925537  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.836568832397461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.836568832397461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.83660888671875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.842256546020508  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8429837226867676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8429837226867676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8430542945861816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.853498935699463  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.854140281677246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.854140281677246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.854201316833496  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.863661766052246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8642725944519043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8642725944519043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.864327907562256  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.873288631439209  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8740453720092773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8740453720092773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.874110221862793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8850698471069336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([5308, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0127320289611816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0127320289611816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5308, 256]), torch.Size([1, 5308, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0247645378112793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.833341121673584  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.698981285095215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.700217247009277  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([6022, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.700217247009277  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6022, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.70145320892334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.700217247009277  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6022, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.04910564422607422  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09958124160766602  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09962606430053711  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 135494
first layer output nodes number: 48568
edges number: 472537
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.06279468536376953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([135494, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.06279468536376953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([123, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24398374557495117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24398374557495117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 123, 100]), torch.Size([1, 123, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24407625198364258  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24481201171875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 123, 100])
m.shape torch.Size([215, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24492597579956055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24492597579956055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 215, 100]), torch.Size([1, 215, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2450861930847168  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24748945236206055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 215, 100])
m.shape torch.Size([250, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24768877029418945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24768877029418945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 250, 100]), torch.Size([1, 250, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24787569046020508  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.25197935104370117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 250, 100])
m.shape torch.Size([336, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.25238656997680664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.25238656997680664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 336, 100]), torch.Size([1, 336, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2526373863220215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2598996162414551  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 336, 100])
m.shape torch.Size([385, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.26049137115478516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.26049137115478516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 385, 100]), torch.Size([1, 385, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.26077842712402344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.27111244201660156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 385, 100])
m.shape torch.Size([450, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.271975040435791  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.271975040435791  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 450, 100]), torch.Size([1, 450, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.272310733795166  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.28673696517944336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 450, 100])
m.shape torch.Size([440, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2877168655395508  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2877168655395508  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 440, 100]), torch.Size([1, 440, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.28804492950439453  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30443811416625977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 440, 100])
m.shape torch.Size([488, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3057284355163574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3057284355163574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 488, 100]), torch.Size([1, 488, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3060927391052246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.32682371139526367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 488, 100])
m.shape torch.Size([529, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3284153938293457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3284153938293457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 529, 100]), torch.Size([1, 529, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3288102149963379  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3540530204772949  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 529, 100])
m.shape torch.Size([45352, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5228052139282227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5228052139282227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 45352, 100]), torch.Size([1, 45352, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5579614639282227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.9713897705078125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 45352, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.7949562072753906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8412742614746094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([48568, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8412742614746094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([48568, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.887592315673828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8412742614746094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([48568, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.887592315673828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.899171829223633  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 48568
----------------output nodes number: 5971
----------------edges number: 141837
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.89957857131958  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([18, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.036123275756836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.036123275756836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0361576080322266  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0364322662353516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0364537239074707  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0364537239074707  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.036491870880127  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0370640754699707  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0371203422546387  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0371203422546387  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.037169933319092  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0382609367370605  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.038363456726074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.038363456726074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.038426399230957  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0402517318725586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0403456687927246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0403456687927246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0403952598571777  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0421805381774902  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0423059463500977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0423059463500977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.042355537414551  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.044487953186035  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.044658660888672  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.044658660888672  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0447139739990234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0474796295166016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0477137565612793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0477137565612793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.047778606414795  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0514750480651855  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0516762733459473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0516762733459473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.051727771759033  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.055023670196533  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.055171012878418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.055171012878418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0552053451538086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.057642936706543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([29, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0579323768615723  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0579323768615723  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.057987689971924  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0623021125793457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.062540054321289  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.062540054321289  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0625839233398438  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.066312789916992  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0665411949157715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0665411949157715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0665793418884277  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0700888633728027  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0703659057617188  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0703659057617188  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0704078674316406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0745620727539062  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0748586654663086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0748586654663086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0749006271362305  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.079348564147949  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0796661376953125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0796661376953125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0797080993652344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0844497680664062  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0848536491394043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0848536491394043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0849032402038574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0908541679382324  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.091244697570801  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.091244697570801  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0912904739379883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.097104072570801  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.097519874572754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.097519874572754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0975656509399414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1036996841430664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1041383743286133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1041383743286133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.104184150695801  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1106386184692383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.11106014251709  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.11106014251709  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1111021041870117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.117312431335449  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1177358627319336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1177358627319336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1177759170532227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1239843368530273  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.12445068359375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.12445068359375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.124492645263672  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1312904357910156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1318464279174805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1318464279174805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.131894111633301  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1399526596069336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([5388, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.269826889038086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.269826889038086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5388, 256]), torch.Size([1, 5388, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.2809829711914062  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.152061462402344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5388, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.017215251922607  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.018382549285889  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([5971, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.018382549285889  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5971, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.019428253173828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.018260955810547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5971, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.056725502014160156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.12565374374389648  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.12569856643676758  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 185027
first layer output nodes number: 54922
edges number: 532483
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08196210861206055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([185027, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08196210861206055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([141, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2859950065612793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2859950065612793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 141, 100]), torch.Size([1, 141, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2861008644104004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2869434356689453  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 141, 100])
m.shape torch.Size([254, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2870798110961914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2870798110961914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 254, 100]), torch.Size([1, 254, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.28726959228515625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.29011058807373047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 254, 100])
m.shape torch.Size([344, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.29040050506591797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.29040050506591797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 344, 100]), torch.Size([1, 344, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.29065704345703125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2962965965270996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 344, 100])
m.shape torch.Size([414, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2967853546142578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2967853546142578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 414, 100]), torch.Size([1, 414, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.29709434509277344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3060436248779297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 414, 100])
m.shape torch.Size([485, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3067927360534668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3067927360534668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 485, 100]), torch.Size([1, 485, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30715417861938477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.32016611099243164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 485, 100])
m.shape torch.Size([583, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3213386535644531  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3213386535644531  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 583, 100]), torch.Size([1, 583, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3217735290527344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3404560089111328  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 583, 100])
m.shape torch.Size([617, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34184789657592773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34184789657592773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 617, 100]), torch.Size([1, 617, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34230852127075195  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3653097152709961  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 617, 100])
m.shape torch.Size([645, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.367002010345459  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.367002010345459  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 645, 100]), torch.Size([1, 645, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.36748266220092773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3948798179626465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 645, 100])
m.shape torch.Size([646, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3968057632446289  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3968057632446289  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 646, 100]), torch.Size([1, 646, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.39728736877441406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.4280972480773926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 646, 100])
m.shape torch.Size([50793, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6170754432678223  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6170754432678223  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 50793, 100]), torch.Size([1, 50793, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6561379432678223  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.351590633392334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 50793, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.15372896194458  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.206106662750244  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([54922, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.206106662750244  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([54922, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.258484363555908  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.206106662750244  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([54922, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.258484363555908  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.271578788757324  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 54922
----------------output nodes number: 5963
----------------edges number: 137851
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.272033214569092  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([19, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.404740810394287  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.404740810394287  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4047770500183105  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.405066967010498  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([30, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.405106544494629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.405106544494629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4051637649536133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.406022071838379  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.406097412109375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.406097412109375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4061660766601562  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4076766967773438  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4078001976013184  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4078001976013184  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4078783988952637  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4101462364196777  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4102659225463867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4102659225463867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4103288650512695  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.412594795227051  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([61, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4129152297973633  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4129152297973633  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.413031578063965  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.418034553527832  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.418292999267578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.418292999267578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4183826446533203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4228649139404297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.423112392425537  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.423112392425537  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.423184871673584  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.427316188812256  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4276347160339355  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4276347160339355  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.427712917327881  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.432717800140381  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.433073043823242  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.433073043823242  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4331512451171875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4387035369873047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([40, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.439087390899658  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.439087390899658  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4391636848449707  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4451146125793457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4454917907714844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4454917907714844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4455604553222656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.451396942138672  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4518251419067383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4518251419067383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4518957138061523  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.458388328552246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4588513374328613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4588513374328613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4589219093322754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4659085273742676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4664359092712402  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4664359092712402  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.46651029586792  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.474395275115967  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4749274253845215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4749274253845215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4749979972839355  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4829726219177246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.483607292175293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.483607292175293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4836854934692383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.493069648742676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4936537742614746  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4936537742614746  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.493722438812256  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5024428367614746  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5030479431152344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5030479431152344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.503114700317383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5120601654052734  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.512584686279297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.512584686279297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5126399993896484  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5204391479492188  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.520956516265869  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.520956516265869  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.521008014678955  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.528629779815674  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.529238700866699  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.529238700866699  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5292959213256836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5381650924682617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.538954734802246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.538954734802246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.53902530670166  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5504579544067383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5512070655822754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5512070655822754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.551271915435791  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5622315406799316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([5081, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.684286117553711  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.684286117553711  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5081, 256]), torch.Size([1, 5081, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6939773559570312  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.402342796325684  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5081, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.272107124328613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.273241996765137  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.273241996765137  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.274739742279053  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.273604869842529  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5963, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.0751957893371582  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.12137413024902344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.12141990661621094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 123958
first layer output nodes number: 49114
edges number: 482110
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.058447837829589844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([123958, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.058447837829589844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([49, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24321603775024414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24321603775024414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 49, 100]), torch.Size([1, 49, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24325323104858398  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24354791641235352  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 49, 100])
m.shape torch.Size([119, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24361801147460938  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24361801147460938  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 119, 100]), torch.Size([1, 119, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24370670318603516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24503707885742188  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 119, 100])
m.shape torch.Size([128, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24513578414916992  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24513578414916992  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 128, 100]), torch.Size([1, 128, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24523115158081055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2473292350769043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 128, 100])
m.shape torch.Size([242, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24764251708984375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24764251708984375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 242, 100]), torch.Size([1, 242, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.24782371520996094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.25306129455566406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 242, 100])
m.shape torch.Size([307, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2535429000854492  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2535429000854492  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 307, 100]), torch.Size([1, 307, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2537717819213867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2620115280151367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 307, 100])
m.shape torch.Size([302, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2625722885131836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2625722885131836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 302, 100]), torch.Size([1, 302, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.26279735565185547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2724752426147461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 302, 100])
m.shape torch.Size([389, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.27368688583374023  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.27368688583374023  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 389, 100]), torch.Size([1, 389, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.27397680282592773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.28847265243530273  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 389, 100])
m.shape torch.Size([456, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2896866798400879  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2896866798400879  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 456, 100]), torch.Size([1, 456, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.2900271415710449  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3093991279602051  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 456, 100])
m.shape torch.Size([467, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3107948303222656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3107948303222656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 467, 100]), torch.Size([1, 467, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3111429214477539  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3334207534790039  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 467, 100])
m.shape torch.Size([46655, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5070748329162598  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5070748329162598  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 46655, 100]), torch.Size([1, 46655, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5422310829162598  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.014197826385498  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 46655, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.8345046043395996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.881343364715576  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([49114, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.881343364715576  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([49114, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.9281821250915527  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.881343364715576  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([49114, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.9281821250915527  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.9406919479370117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 49114
----------------output nodes number: 6084
----------------edges number: 150035
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 2.941103935241699  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([17, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.08555269241333  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.08555269241333  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.085585117340088  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.086071491241455  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0860671997070312  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0860671997070312  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0860748291015625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.08624267578125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0862622261047363  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0862622261047363  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.086273670196533  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0866055488586426  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0866193771362305  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0866193771362305  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0866270065307617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0869016647338867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0869383811950684  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0869383811950684  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.086951732635498  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0875258445739746  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0875463485717773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0875463485717773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0875539779663086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.087935447692871  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0879931449890137  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0879931449890137  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.088008403778076  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0888781547546387  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0889225006103516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0889225006103516  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0889339447021484  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0896663665771484  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.089747428894043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.089747428894043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0897645950317383  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0909833908081055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.091059684753418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.091059684753418  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0910749435424805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0922651290893555  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0923500061035156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0923500061035156  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.092365264892578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0936622619628906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.09379243850708  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.09379243850708  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.093813419342041  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0957436561584473  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0958542823791504  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0958542823791504  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0958714485168457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0975708961486816  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0976200103759766  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0976200103759766  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.097627639770508  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0984363555908203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0984787940979004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0984787940979004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.098484516143799  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.0991311073303223  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.099275588989258  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.099275588989258  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.099292755126953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1013526916503906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.101396083831787  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.101396083831787  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1014018058776855  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.102128505706787  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1023268699645996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1023268699645996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1023478507995605  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.105159282684326  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1053414344787598  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1053414344787598  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.105360507965088  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1080498695373535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1082019805908203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1082019805908203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.108217239379883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.110475540161133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1107006072998047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1107006072998047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1107215881347656  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.113973617553711  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1141180992126465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1141180992126465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.114131450653076  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1162943840026855  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.116426467895508  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.116426467895508  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1164379119873047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.1183719635009766  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5911, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.2605299949645996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.2605299949645996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5911, 256]), torch.Size([1, 5911, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.2718043327331543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.256087779998779  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5911, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.1130242347717285  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.114258766174316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([6084, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.114258766174316  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6084, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.115494251251221  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.114259719848633  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6084, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.05254650115966797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.1301589012145996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.1302037239074707  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 208338
first layer output nodes number: 58496
edges number: 572701
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09147882461547852  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([208338, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09147882461547852  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([125, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31089210510253906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31089210510253906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 125, 100]), torch.Size([1, 125, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3109855651855469  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31173181533813477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 125, 100])
m.shape torch.Size([165, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31180810928344727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31180810928344727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 165, 100]), torch.Size([1, 165, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31193113327026367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31377649307250977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 165, 100])
m.shape torch.Size([205, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31394433975219727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31394433975219727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 205, 100]), torch.Size([1, 205, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31409788131713867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3174629211425781  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 205, 100])
m.shape torch.Size([305, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3178410530090332  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3178410530090332  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 305, 100]), torch.Size([1, 305, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3180689811706543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.32466745376586914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 305, 100])
m.shape torch.Size([401, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3253006935119629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3253006935119629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 401, 100]), torch.Size([1, 401, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.32560014724731445  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3363661766052246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 401, 100])
m.shape torch.Size([435, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3371891975402832  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3371891975402832  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 435, 100]), torch.Size([1, 435, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33751344680786133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3514561653137207  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 435, 100])
m.shape torch.Size([462, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35278987884521484  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35278987884521484  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 462, 100]), torch.Size([1, 462, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3531341552734375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3703479766845703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 462, 100])
m.shape torch.Size([467, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3715677261352539  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3715677261352539  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 467, 100]), torch.Size([1, 467, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3719158172607422  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3917570114135742  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 467, 100])
m.shape torch.Size([484, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3932061195373535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3932061195373535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 484, 100]), torch.Size([1, 484, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3935675621032715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.41666126251220703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 484, 100])
m.shape torch.Size([55447, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6230368614196777  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6230368614196777  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 55447, 100]), torch.Size([1, 55447, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6660056114196777  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.617337703704834  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 55447, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.402369499206543  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.458418846130371  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([58496, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.458418846130371  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([58496, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.514204978942871  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.458155632019043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([58496, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.514204978942871  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.527888298034668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 58496
----------------output nodes number: 5967
----------------edges number: 146558
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5283689498901367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.669445514678955  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.669445514678955  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6694588661193848  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6695656776428223  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6695632934570312  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6695632934570312  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.669567108154297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6696243286132812  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.669628620147705  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.669628620147705  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6696324348449707  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6697163581848145  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.669741630554199  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.669741630554199  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.669754981994629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.67014217376709  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6701550483703613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6701550483703613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6701626777648926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6704373359680176  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.670474052429199  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.670474052429199  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.670487403869629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6710615158081055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6711153984069824  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6711153984069824  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6711325645446777  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6719908714294434  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.672043800354004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.672043800354004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6720590591430664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.672928810119629  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.673025131225586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.673025131225586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6730480194091797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6745128631591797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6746268272399902  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6746268272399902  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.674651622772217  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6764121055603027  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6765270233154297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6765270233154297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6765499114990234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.678335189819336  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.678439140319824  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.678439140319824  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6784582138061523  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.680079460144043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6801700592041016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6801700592041016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.680185317993164  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.681589126586914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([14, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6817703247070312  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6817703247070312  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6817970275878906  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6844406127929688  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6846723556518555  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6846723556518555  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6847047805786133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6881418228149414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6882948875427246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6882948875427246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6883158683776855  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6906867027282715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6910033226013184  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6910033226013184  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6910414695739746  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6956191062927246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.695946216583252  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.695946216583252  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.695984363555908  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.700829029083252  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.700956344604492  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.700956344604492  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7009716033935547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7030162811279297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.70314359664917  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.70314359664917  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7031569480895996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7050395011901855  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.705174446105957  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.705174446105957  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7051877975463867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7071638107299805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707432270050049  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707432270050049  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7074570655822754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7113003730773926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.711641788482666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.711641788482666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.711672306060791  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.716616153717041  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.716947078704834  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.716947078704834  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.716975688934326  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.721810817718506  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5718, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8594861030578613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8594861030578613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5718, 256]), torch.Size([1, 5718, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.870392322540283  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.805332660675049  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5718, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.6656599044799805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.666878700256348  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([5967, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.666878700256348  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5967, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.668097496032715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.666878700256348  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([5967, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08396387100219727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.16672849655151367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.16677570343017578  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 222169
first layer output nodes number: 66190
edges number: 656202
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09732818603515625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([222169, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.09732818603515625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([67, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3486776351928711  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3486776351928711  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 67, 100]), torch.Size([1, 67, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3487281799316406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34912967681884766  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 67, 100])
m.shape torch.Size([88, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3491702079772949  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3491702079772949  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 88, 100]), torch.Size([1, 88, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34923601150512695  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3502202033996582  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 88, 100])
m.shape torch.Size([117, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35031843185424805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35031843185424805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 117, 100]), torch.Size([1, 117, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3504061698913574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.352327823638916  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 117, 100])
m.shape torch.Size([127, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35247325897216797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.35247325897216797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 127, 100]), torch.Size([1, 127, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3525686264038086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3553171157836914  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 127, 100])
m.shape torch.Size([163, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3555731773376465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3555731773376465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 163, 100]), torch.Size([1, 163, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3556952476501465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3600754737854004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 163, 100])
m.shape torch.Size([168, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.36039018630981445  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.36039018630981445  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 168, 100]), torch.Size([1, 168, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3605160713195801  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.365903377532959  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 168, 100])
m.shape torch.Size([209, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.36638545989990234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.36638545989990234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 209, 100]), torch.Size([1, 209, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.36654186248779297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3743419647216797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 209, 100])
m.shape torch.Size([210, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3748898506164551  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3748898506164551  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 210, 100]), torch.Size([1, 210, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3750472068786621  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.38398218154907227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 210, 100])
m.shape torch.Size([276, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.384829044342041  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.384829044342041  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 276, 100]), torch.Size([1, 276, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.38503503799438477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3982057571411133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 276, 100])
m.shape torch.Size([64765, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.639371395111084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.639371395111084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 64765, 100]), torch.Size([1, 64765, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6876254081726074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.113646030426025  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 64765, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8684797286987305  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.93160343170166  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([66190, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.93160343170166  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([66190, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.99472713470459  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.93160343170166  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([66190, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.99472713470459  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.010508060455322  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 66190
----------------output nodes number: 6326
----------------edges number: 157096
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.011048793792725  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162259578704834  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162259578704834  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162261486053467  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162276744842529  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162278175354004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162278175354004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162280082702637  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162308692932129  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.16231107711792  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.16231107711792  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162312984466553  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162354946136475  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162358283996582  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162358283996582  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162360191345215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162415504455566  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162424564361572  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162424564361572  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162428379058838  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1625657081604  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162575721740723  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162575721740723  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162579536437988  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.16274356842041  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162765026092529  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162765026092529  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.162770748138428  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.163096904754639  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([24, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.163301944732666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.163301944732666  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1633477210998535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1662774085998535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166274070739746  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166274070739746  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166277885437012  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166548728942871  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166568279266357  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166568279266357  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166572093963623  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166869640350342  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166930675506592  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166930675506592  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.166940212249756  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.16781759262085  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1678667068481445  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1678667068481445  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.167874336242676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1686296463012695  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.168698310852051  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.168698310852051  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.168707847595215  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1697187423706055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.169806480407715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.169806480407715  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.169817924499512  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.171111106872559  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.171138286590576  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.171138286590576  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.171142101287842  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.171599864959717  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.171684741973877  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.171684741973877  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.171694278717041  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.172905445098877  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.173028945922852  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.173028945922852  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.173042297363281  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.174831390380859  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.174959659576416  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.174959659576416  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.174973011016846  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.176855564117432  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.177051067352295  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.177051067352295  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.177070140838623  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1798930168151855  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.179925918579102  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.179925918579102  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.179929733276367  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.180521011352539  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.180585861206055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.180585861206055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.180591583251953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.1815185546875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.181631088256836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.181631088256836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.181640625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.183252334594727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6226, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.332906723022461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.332906723022461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6226, 256]), torch.Size([1, 6226, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 4.345428943634033  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.436738967895508  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6226, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.286867141723633  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.288589954376221  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([6326, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.288589954376221  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6326, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.290387153625488  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 6.2886643409729  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6326, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08962249755859375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.15602874755859375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.15607500076293945  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 176469
first layer output nodes number: 58804
edges number: 582545
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08050394058227539  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([176469, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.08050394058227539  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([38, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3036351203918457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3036351203918457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 38, 100]), torch.Size([1, 38, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3036637306213379  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3038911819458008  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 38, 100])
m.shape torch.Size([77, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30393457412719727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30393457412719727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 77, 100]), torch.Size([1, 77, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30399274826049805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3048567771911621  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 77, 100])
m.shape torch.Size([101, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30494070053100586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30494070053100586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 101, 100]), torch.Size([1, 101, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30501604080200195  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.306673526763916  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 101, 100])
m.shape torch.Size([143, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30684900283813477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30684900283813477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 143, 100]), torch.Size([1, 143, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.30695581436157227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31004762649536133  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 143, 100])
m.shape torch.Size([189, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3103466033935547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3103466033935547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 189, 100]), torch.Size([1, 189, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3104877471923828  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31556177139282227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 189, 100])
m.shape torch.Size([187, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31590938568115234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31590938568115234  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 187, 100]), torch.Size([1, 187, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.31604957580566406  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.322052001953125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 187, 100])
m.shape torch.Size([201, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3225064277648926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3225064277648926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 201, 100]), torch.Size([1, 201, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.32265710830688477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.33016109466552734  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 201, 100])
m.shape torch.Size([232, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3307771682739258  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3307771682739258  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 232, 100]), torch.Size([1, 232, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3309507369995117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34080982208251953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 232, 100])
m.shape torch.Size([212, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3414340019226074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3414340019226074  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 212, 100]), torch.Size([1, 212, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.34159231185913086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.3517112731933594  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 212, 100])
m.shape torch.Size([57424, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5664758682250977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.5664758682250977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 57424, 100]), torch.Size([1, 57424, 100])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.6094446182250977  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.6502609252929688  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 57424, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4324703216552734  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4885501861572266  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([58804, 100])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4885501861572266  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([58804, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5446300506591797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.4885501861572266  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([58804, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5446300506591797  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.558650016784668  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 58804
----------------output nodes number: 6190
----------------edges number: 153806
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.5591344833374023  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7071800231933594  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7071800231933594  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707181930541992  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7072105407714844  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7072157859802246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7072157859802246  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7072196006774902  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707303524017334  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7073163986206055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7073163986206055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707322120666504  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7075281143188477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707554340362549  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707554340362549  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707563877105713  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7079739570617676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707996368408203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.707996368408203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7080039978027344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.708385467529297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7084202766418457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7084202766418457  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7084298133850098  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7089734077453613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.709012031555176  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.709012031555176  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.70902156829834  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.70963191986084  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7096848487854004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7096848487854004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7096962928771973  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7105088233947754  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7105560302734375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7105560302734375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7105655670166016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7113094329833984  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7113394737243652  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7113394737243652  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7113451957702637  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.711831569671631  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7119040489196777  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7119040489196777  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7119154930114746  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.712968349456787  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7129898071289062  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7129898071289062  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.712993621826172  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7133712768554688  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.713441848754883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.713441848754883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.713451385498047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7144622802734375  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7144885063171387  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7144885063171387  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7144923210144043  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.71492338180542  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.714954376220703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.714954376220703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7149581909179688  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7154159545898438  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.715466022491455  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.715466022491455  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7154717445373535  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.716198444366455  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.716269016265869  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.716269016265869  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7162766456604004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.717298984527588  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.717372417449951  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.717372417449951  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7173800468444824  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7184557914733887  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7185330390930176  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7185330390930176  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.718540668487549  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.719669818878174  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7197508811950684  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7197508811950684  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7197585105895996  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7209410667419434  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.721047878265381  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.721047878265381  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.721057415008545  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.722602367401123  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.722712993621826  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.722712993621826  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.7227225303649902  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.724334239959717  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6105, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8711838722229004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8711838722229004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6105, 256]), torch.Size([1, 6105, 256])
----------------------------------------3
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 3.8837952613830566  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.937530517578125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6105, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.790672779083252  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.7919745445251465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([6190, 256])
----------------------------------------before rst
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.7919745445251465  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6190, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.793874740600586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 5.792572975158691  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([6190, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.07284212112426758  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.19714689254760742  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.19719266891479492  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

first layer input nodes number: 333678
first layer output nodes number: 83189
edges number: 824356
----------------------------------------before model layer 0
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.14110279083251953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([333678, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.7108154296875 GB
    Memory Allocated: 0.14110279083251953  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([75, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.45685815811157227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.45685815811157227  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.45691442489624023  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4573631286621094  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([102, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4574112892150879  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4574112892150879  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4574875831604004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.45862913131713867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([158, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4587678909301758  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4587678909301758  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 158, 100]), torch.Size([1, 158, 100])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.45888614654541016  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.46147918701171875  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 158, 100])
m.shape torch.Size([199, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4617166519165039  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4617166519165039  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 199, 100]), torch.Size([1, 199, 100])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4618654251098633  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4661684036254883  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 199, 100])
m.shape torch.Size([209, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.46648359298706055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.46648359298706055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 209, 100]), torch.Size([1, 209, 100])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.46663999557495117  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4722561836242676  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 209, 100])
m.shape torch.Size([241, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4727168083190918  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4727168083190918  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 241, 100]), torch.Size([1, 241, 100])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4728970527648926  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.48063039779663086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 241, 100])
m.shape torch.Size([308, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.48134374618530273  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.48134374618530273  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 308, 100]), torch.Size([1, 308, 100])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.48157358169555664  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.4930553436279297  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 308, 100])
m.shape torch.Size([263, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.49372434616088867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.49372434616088867  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 263, 100]), torch.Size([1, 263, 100])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.49392080307006836  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.5050959587097168  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 263, 100])
m.shape torch.Size([284, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.5059499740600586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.5059499740600586  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 284, 100]), torch.Size([1, 284, 100])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.5061616897583008  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 0.5197114944458008  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 284, 100])
m.shape torch.Size([81350, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 0.8226580619812012  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 0.8226580619812012  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 81350, 100]), torch.Size([1, 81350, 100])
----------------------------------------3
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 0.8832688331604004  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.186619281768799  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 81350, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.878647804260254  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.957983016967773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

h_self size  torch.Size([83189, 100])
----------------------------------------before rst
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.957983016967773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([83189, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.037318229675293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.957983016967773  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

torch.Size([83189, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.037318229675293  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.057152271270752  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------input nodes number: 83189
----------------output nodes number: 6082
----------------edges number: 149486
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.0578179359436035  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.20170783996582  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.20170783996582  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.201711654663086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.201742172241211  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.201744556427002  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.201744556427002  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.201748371124268  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.201805591583252  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.201815605163574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.201815605163574  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.2018232345581055  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.201991081237793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([31, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.202106475830078  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.202106475830078  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.202165603637695  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.203880310058594  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.203884601593018  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.203884601593018  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.203897953033447  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.204378604888916  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.20440673828125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.20440673828125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.204418182373047  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.2049102783203125  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([14, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.204998970031738  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.204998970031738  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.205025672912598  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.206360816955566  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.206386089324951  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.206386089324951  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.206395626068115  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.206939220428467  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([13, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.207046985626221  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.207046985626221  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.207071781158447  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.208658695220947  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.208684921264648  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.208684921264648  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.20869255065918  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.209234237670898  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.209272861480713  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.209272861480713  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.209280490875244  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.209875583648682  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([13, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.21002197265625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.21002197265625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.210046768188477  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.212154388427734  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.212217330932617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.212217330932617  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.212228775024414  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.213281631469727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([19, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.213531970977783  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.213531970977783  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.213568210601807  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.217155933380127  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.217267990112305  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.217267990112305  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.21728515625  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.219104766845703  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.219188690185547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.219188690185547  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.219200134277344  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.220493316650391  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.220602035522461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.220602035522461  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.220615386962891  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.222217559814453  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.222314834594727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.222314834594727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.222326278686523  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.223779678344727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.223847389221191  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.223847389221191  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.223855018615723  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.22487735748291  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.22498893737793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.22498893737793  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.225000381469727  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.226613998413086  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.226769924163818  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.226769924163818  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.226785182952881  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.229043483734131  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.229141712188721  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.229141712188721  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.229151248931885  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.2306294441223145  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.230801582336426  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.230801582336426  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.230816841125488  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.233288764953613  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.233442783355713  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.233442783355713  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.233456134796143  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.23571252822876  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5886, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.377674102783203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.377674102783203  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

 h.shape torch.Size([1, 5886, 256]), torch.Size([1, 5886, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 5.389265060424805  GigaBytes
Max Memory Allocated: 7.023153781890869  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 7.374375820159912  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 5886, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 7.2324090003967285  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 7.233511924743652  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

h_self size  torch.Size([6082, 256])
----------------------------------------before rst
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 7.233511924743652  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([6082, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 7.234821319580078  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 7.233718395233154  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([6082, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.13054132461547852  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.2174077033996582  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.2174525260925293  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

first layer input nodes number: 233180
first layer output nodes number: 66617
edges number: 660379
----------------------------------------before model layer 0
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.10136222839355469  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([233180, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.10136222839355469  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

m.shape torch.Size([61, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35430908203125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35430908203125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 61, 100]), torch.Size([1, 61, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3543548583984375  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3547196388244629  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 61, 100])
m.shape torch.Size([99, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3547706604003906  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3547706604003906  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 99, 100]), torch.Size([1, 99, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3548450469970703  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3559551239013672  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 99, 100])
m.shape torch.Size([122, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35605430603027344  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35605430603027344  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 122, 100]), torch.Size([1, 122, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35614585876464844  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3581514358520508  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 122, 100])
m.shape torch.Size([155, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3583369255065918  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3583369255065918  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 155, 100]), torch.Size([1, 155, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35845327377319336  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36181020736694336  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 155, 100])
m.shape torch.Size([127, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36198902130126953  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36198902130126953  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 127, 100]), torch.Size([1, 127, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36208438873291016  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3654961585998535  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 127, 100])
m.shape torch.Size([166, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36581993103027344  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36581993103027344  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 166, 100]), torch.Size([1, 166, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36594390869140625  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.37126636505126953  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 166, 100])
m.shape torch.Size([208, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3717470169067383  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3717470169067383  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 208, 100]), torch.Size([1, 208, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3719024658203125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3796548843383789  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 208, 100])
m.shape torch.Size([225, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3802480697631836  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3802480697631836  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 225, 100]), torch.Size([1, 225, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3804159164428711  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3899831771850586  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 225, 100])
m.shape torch.Size([293, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3908820152282715  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3908820152282715  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 293, 100]), torch.Size([1, 293, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3911004066467285  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4050774574279785  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 293, 100])
m.shape torch.Size([65161, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.647712230682373  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.647712230682373  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 65161, 100]), torch.Size([1, 65161, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.6962618827819824  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.144917964935303  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 65161, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.8981995582580566  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.961730480194092  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

h_self size  torch.Size([66617, 100])
----------------------------------------before rst
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.961730480194092  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([66617, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.025261402130127  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.961730480194092  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([66617, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.025261402130127  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.041144371032715  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------input nodes number: 66617
----------------output nodes number: 5963
----------------edges number: 148241
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.041685581207275  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.184376239776611  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.184376239776611  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.184383869171143  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.18455171585083  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.184557914733887  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.184557914733887  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.184561729431152  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.184699058532715  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.184720516204834  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.184720516204834  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.184726238250732  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185052394866943  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185075759887695  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185075759887695  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185081481933594  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185447692871094  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185454845428467  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185454845428467  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1854567527771  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185592174530029  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([13, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185741424560547  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185741424560547  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.185766220092773  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.187873840332031  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.18804931640625  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.18804931640625  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.188077926635742  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.190710067749023  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.190736293792725  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.190736293792725  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.190742015838623  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.191308498382568  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.191336631774902  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.191336631774902  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.191340446472168  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.191771507263184  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.191802501678467  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.191802501678467  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.191806316375732  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.192264080047607  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.192331790924072  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.192331790924072  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1923394203186035  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.193308353424072  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.193615436553955  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.193615436553955  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.193647861480713  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.19799280166626  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.197996139526367  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.197996139526367  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.197998046875  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.198266983032227  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.198347091674805  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.198347091674805  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.198354721069336  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.199483871459961  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.199679374694824  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.199679374694824  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1996965408325195  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.20247745513916  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.202630519866943  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.202630519866943  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.202643871307373  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.20490026473999  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5873, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.346115589141846  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.346115589141846  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 5873, 256]), torch.Size([1, 5873, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.35785436630249  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.338790416717529  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 5873, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.197887897491455  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.198963165283203  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.198963165283203  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.200038433074951  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.198963165283203  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([5963, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.09307432174682617  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.19554853439331055  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.19559574127197266  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

first layer input nodes number: 275077
first layer output nodes number: 76431
edges number: 757633
----------------------------------------before model layer 0
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.1183018684387207  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([275077, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.1183018684387207  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

m.shape torch.Size([70, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.40850019454956055  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.40850019454956055  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 70, 100]), torch.Size([1, 70, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4085526466369629  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.40897083282470703  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 70, 100])
m.shape torch.Size([124, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.40903711318969727  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.40903711318969727  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 124, 100]), torch.Size([1, 124, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.40912961959838867  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.41051721572875977  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 124, 100])
m.shape torch.Size([125, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4106106758117676  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4106106758117676  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 125, 100]), torch.Size([1, 125, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4107041358947754  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.41275596618652344  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 125, 100])
m.shape torch.Size([167, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.41295814514160156  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.41295814514160156  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 167, 100]), torch.Size([1, 167, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4130830764770508  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.41669464111328125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 167, 100])
m.shape torch.Size([167, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4169435501098633  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4169435501098633  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 167, 100]), torch.Size([1, 167, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4170684814453125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4215517044067383  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 167, 100])
m.shape torch.Size([204, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.42194557189941406  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.42194557189941406  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 204, 100]), torch.Size([1, 204, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.42209815979003906  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.42864227294921875  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 204, 100])
m.shape torch.Size([226, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4291553497314453  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4291553497314453  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 226, 100]), torch.Size([1, 226, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4293241500854492  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.43775415420532227  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 226, 100])
m.shape torch.Size([280, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4385042190551758  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4385042190551758  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 280, 100]), torch.Size([1, 280, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.43871307373046875  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4506063461303711  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 280, 100])
m.shape torch.Size([289, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.45147132873535156  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.45147132873535156  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 289, 100]), torch.Size([1, 289, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4516868591308594  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.4654808044433594  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 289, 100])
m.shape torch.Size([74779, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.7439465522766113  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.7439465522766113  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 74779, 100]), torch.Size([1, 74779, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.7996621131896973  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.7554240226745605  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 74779, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.472365856170654  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.5452561378479  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

h_self size  torch.Size([76431, 100])
----------------------------------------before rst
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.5452561378479  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([76431, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.6181464195251465  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.5452561378479  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([76431, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.6181464195251465  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.636369228363037  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------input nodes number: 76431
----------------output nodes number: 6320
----------------edges number: 157216
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.636986255645752  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788313865661621  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788313865661621  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788317680358887  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788374900817871  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788379192352295  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788379192352295  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.7883830070495605  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788466930389404  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788469314575195  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788469314575195  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788471221923828  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.78852653503418  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.78854513168335  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.78854513168335  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788552761077881  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.788827419281006  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.7888875007629395  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.7888875007629395  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.7889084815979  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.789810657501221  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([4, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.789831161499023  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.789831161499023  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.789838790893555  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.790273666381836  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.790304660797119  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.790304660797119  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.79031229019165  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.79080057144165  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.790806770324707  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.790806770324707  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.79080867767334  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.7909440994262695  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.790954113006592  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.790954113006592  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.790956020355225  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.791104793548584  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.791150093078613  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.791150093078613  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.7911577224731445  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.791806221008301  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.791815280914307  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.791815280914307  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.7918171882629395  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.791992664337158  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.792018890380859  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.792018890380859  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.792022705078125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.792400360107422  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.79241418838501  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.79241418838501  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.792416095733643  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.79263162612915  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.79266357421875  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.79266357421875  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.792667388916016  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.793125152587891  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.793140888214111  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.793140888214111  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.793142795562744  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.793385028839111  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.793457508087158  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.793457508087158  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.7934651374816895  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.794487476348877  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.794541358947754  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.794541358947754  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.794547080993652  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.795353889465332  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.795512676239014  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.795512676239014  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.795527935028076  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.797786235809326  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.797884464263916  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.797884464263916  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.79789400100708  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.79937219619751  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.799500465393066  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.799500465393066  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.799511909484863  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.801365852355957  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.8015217781066895  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.8015217781066895  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.801535129547119  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.803791522979736  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6246, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.954009532928467  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.954009532928467  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6246, 256]), torch.Size([1, 6246, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.966649055480957  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 7.068429946899414  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6246, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.918420314788818  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.919660568237305  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

h_self size  torch.Size([6320, 256])
----------------------------------------before rst
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.919660568237305  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([6320, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.9209980964660645  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.919757843017578  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([6320, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.10884952545166016  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.18892717361450195  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.18897438049316406  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

first layer input nodes number: 214956
first layer output nodes number: 68117
edges number: 674575
----------------------------------------before model layer 0
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.0951085090637207  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([214956, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.0951085090637207  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

m.shape torch.Size([98, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35350894927978516  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35350894927978516  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 98, 100]), torch.Size([1, 98, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35358238220214844  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3541684150695801  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 98, 100])
m.shape torch.Size([108, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35421228408813477  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35421228408813477  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3542933464050293  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35550355911254883  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([129, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3556075096130371  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3556075096130371  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 129, 100]), torch.Size([1, 129, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35570383071899414  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35782289505004883  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 129, 100])
m.shape torch.Size([142, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3579864501953125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3579864501953125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 142, 100]), torch.Size([1, 142, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3580923080444336  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3611621856689453  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 142, 100])
m.shape torch.Size([189, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3614616394042969  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3614616394042969  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 189, 100]), torch.Size([1, 189, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.361602783203125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36667680740356445  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 189, 100])
m.shape torch.Size([185, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3670201301574707  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3670201301574707  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 185, 100]), torch.Size([1, 185, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3671584129333496  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3730959892272949  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 185, 100])
m.shape torch.Size([217, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3735928535461426  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3735928535461426  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 217, 100]), torch.Size([1, 217, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.37375497817993164  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3818511962890625  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 217, 100])
m.shape torch.Size([246, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3825035095214844  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3825035095214844  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 246, 100]), torch.Size([1, 246, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3826875686645508  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3931446075439453  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 246, 100])
m.shape torch.Size([266, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.39394474029541016  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.39394474029541016  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 266, 100]), torch.Size([1, 266, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.39414310455322266  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.40683841705322266  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 266, 100])
m.shape torch.Size([66537, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.654609203338623  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.654609203338623  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 66537, 100]), torch.Size([1, 66537, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.7041840553283691  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.224735736846924  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 66537, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.9719672203063965  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.036928653717041  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

h_self size  torch.Size([68117, 100])
----------------------------------------before rst
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.036928653717041  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([68117, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1018900871276855  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.036928653717041  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([68117, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1018900871276855  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.118579387664795  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------input nodes number: 68117
----------------output nodes number: 6297
----------------edges number: 156668
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.119134426116943  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.269941806793213  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.269941806793213  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.269949436187744  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.27017068862915  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.27017879486084  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.27017879486084  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.2701826095581055  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.270346641540527  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.270379543304443  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.270379543304443  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.270387172698975  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.270875453948975  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.270910263061523  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.270910263061523  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.270917892456055  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.271459579467773  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.271477222442627  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.271477222442627  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.271481037139893  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.271778583526611  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.271846294403076  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.271846294403076  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.271857738494873  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.272830486297607  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.272900104522705  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.272900104522705  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.272911548614502  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.2739644050598145  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.2740397453308105  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.2740397453308105  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.274051189422607  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.275184154510498  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.275221824645996  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.275221824645996  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.2752275466918945  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.275834083557129  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.275877475738525  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.275877475738525  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.275883197784424  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.276529788970947  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.276641368865967  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.276641368865967  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.2766547203063965  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.278256893157959  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.278371334075928  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.278371334075928  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.278384685516357  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.280080318450928  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.280165195465088  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.280165195465088  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.280174732208252  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.281452655792236  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.281505584716797  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.281505584716797  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.281511306762695  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.282318115234375  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.282416343688965  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.282416343688965  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.282425880432129  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.28383731842041  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.283959865570068  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.283959865570068  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.283971309661865  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.285745143890381  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.285938739776611  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.285938739776611  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.285955905914307  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.288736820220947  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.288820743560791  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.288820743560791  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.288828372955322  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.2901177406311035  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6211, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.439640522003174  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.439640522003174  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6211, 256]), torch.Size([1, 6211, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.4532036781311035  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.5398125648498535  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6211, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.390341281890869  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.3915276527404785  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

h_self size  torch.Size([6297, 256])
----------------------------------------before rst
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.3915276527404785  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([6297, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.392714023590088  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.3915276527404785  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([6297, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.08639907836914062  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.16723012924194336  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.16727733612060547  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

first layer input nodes number: 216978
first layer output nodes number: 66109
edges number: 654700
----------------------------------------before model layer 0
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.09531021118164062  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([216978, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.09531021118164062  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

m.shape torch.Size([74, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3460879325866699  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3460879325866699  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 74, 100]), torch.Size([1, 74, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3461432456970215  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.346585750579834  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 74, 100])
m.shape torch.Size([112, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.34664154052734375  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.34664154052734375  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 112, 100]), torch.Size([1, 112, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3467254638671875  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3479785919189453  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 112, 100])
m.shape torch.Size([119, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3480696678161621  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3480696678161621  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 119, 100]), torch.Size([1, 119, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3481583595275879  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3501095771789551  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 119, 100])
m.shape torch.Size([158, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35030078887939453  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35030078887939453  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 158, 100]), torch.Size([1, 158, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3504190444946289  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3538370132446289  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 158, 100])
m.shape torch.Size([177, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3541078567504883  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3541078567504883  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 177, 100]), torch.Size([1, 177, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35424041748046875  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35899829864501953  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 177, 100])
m.shape torch.Size([186, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3593478202819824  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3593478202819824  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 186, 100]), torch.Size([1, 186, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.35948705673217773  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36545705795288086  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 186, 100])
m.shape torch.Size([232, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36599254608154297  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.36599254608154297  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 232, 100]), torch.Size([1, 232, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3661661148071289  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.374814510345459  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 232, 100])
m.shape torch.Size([218, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3753776550292969  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3753776550292969  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 218, 100]), torch.Size([1, 218, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.37554073333740234  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3848133087158203  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 218, 100])
m.shape torch.Size([286, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.38569068908691406  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.38569068908691406  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 286, 100]), torch.Size([1, 286, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.38590431213378906  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.3995504379272461  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 286, 100])
m.shape torch.Size([64547, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.6399002075195312  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.6399002075195312  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 64547, 100]), torch.Size([1, 64547, 100])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.6879920959472656  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.102487564086914  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 64547, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.85793399810791  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.920980453491211  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

h_self size  torch.Size([66109, 100])
----------------------------------------before rst
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.920980453491211  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([66109, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.9840269088745117  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.920980453491211  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([66109, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.9840269088745117  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 3.999788761138916  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------input nodes number: 66109
----------------output nodes number: 6316
----------------edges number: 157024
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.000328540802002  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151469707489014  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151469707489014  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1514716148376465  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151486873626709  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1514892578125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1514892578125  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151491165161133  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151533126831055  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1515374183654785  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1515374183654785  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151539325714111  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151607990264893  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151613235473633  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151613235473633  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151615142822266  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151697158813477  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151716709136963  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151716709136963  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.151722431182861  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.152008533477783  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.152036666870117  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.152036666870117  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.152044296264648  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.15247917175293  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.152535915374756  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.152535915374756  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1525492668151855  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1534037590026855  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.153435707092285  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.153435707092285  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.153443336486816  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.153985023498535  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.15403413772583  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.15403413772583  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.154043674468994  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.154787540435791  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.154817581176758  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.154817581176758  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.154823303222656  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.155309677124023  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.155332088470459  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.155332088470459  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.155335903167725  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.155686855316162  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.155766010284424  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.155766010284424  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.155777454376221  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.156910419464111  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.15697717666626  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.15697717666626  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.156986713409424  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1579976081848145  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.158070087432861  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.158070087432861  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.158079624176025  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1591572761535645  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1592183113098145  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1592183113098145  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.159225940704346  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.160141468048096  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.160224437713623  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.160224437713623  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.160233974456787  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.161445140838623  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.161513805389404  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.161513805389404  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1615214347839355  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.162543773651123  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.162693977355957  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.162693977355957  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1627092361450195  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.164860725402832  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.164974212646484  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.164974212646484  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.164985656738281  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.166679382324219  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1668009757995605  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1668009757995605  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.166812419891357  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.168586254119873  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.168801784515381  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.168801784515381  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.168820858001709  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.171910762786865  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1721320152282715  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1721320152282715  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.1721510887146  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.175374507904053  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6215, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.324742317199707  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.324742317199707  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

 h.shape torch.Size([1, 6215, 256]), torch.Size([1, 6215, 256])
----------------------------------------3
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 4.33754301071167  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.426513195037842  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

rst.shape  torch.Size([1, 6215, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.2767109870910645  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.277851581573486  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

h_self size  torch.Size([6316, 256])
----------------------------------------before rst
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.277851581573486  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([6316, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.279189586639404  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 6.278048992156982  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes

torch.Size([6316, 47])
-----------------------------------------after training 
 Nvidia-smi: 21.6287841796875 GB
    Memory Allocated: 0.1086263656616211  GigaBytes
Max Memory Allocated: 7.514708995819092  GigaBytes


-----------------------------------------------------------------------------epoch done
