main start at this time 1661485197.4858606
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.21189308166503906
global_2_local spend time (sec) 0.36633849143981934

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.909 seconds
Metis partitioning: 14.285 seconds
Split the graph: 0.592 seconds
Construct subgraphs: 0.498 seconds
2981
3043
2981
3145
3146
3163
3161
3162
2981
2981
3155
3159
3053
2981
3061
2981
3116
3036
2998
3016
2981
3162
2981
2999
2981
3156
3029
3033
3142
3009
3075
3163
3118
3115
2981
3007
3050
2981
3160
3143
2998
3123
3163
2981
2985
3063
3016
2990
3152
3156
3105
3144
3048
3112
3129
2981
3118
3011
3162
2981
3133
3134
3163
3157
REG metis partition end ----................................
the time spent:  27.19177770614624
REG construction  time spent:  8.88660740852356
pure dgl.metis_partition the time spent:  18.30517029762268
total k batches seeds list generation spend  27.703506469726562
after graph partition
graph partition algorithm spend time 28.137526035308838

partition_len_list
[35345, 25075, 30551, 30025, 26928, 24668, 35730, 34789, 30351, 25951, 30433, 32575, 29784, 24401, 28047, 32192, 37239, 32648, 33750, 32247, 30824, 31396, 29750, 31957, 33654, 31806, 28738, 30973, 29614, 39885, 34583, 38438, 23963, 29127, 33640, 29525, 29696, 35358, 29702, 25853, 29988, 36557, 34440, 37347, 29359, 27329, 30842, 32722, 38621, 34155, 26794, 32502, 46354, 39949, 38966, 40248, 34814, 39107, 41355, 40025, 33173, 33735, 33752, 31989]
REG selection method  spend 28.678293466567993
check_connections_block*********************************
time for parepare 1: 0.20744538307189941
local_output_nid generation: 0.001161336898803711
local_in_edges_tensor generation: 0.0015575885772705078

&&&&&&&&&&&&&&& before remove duplicate length: 71844
remove duplicated spend time : 0.010257720947265625

&&&&&&&&&&&&&&& after remove duplicate length: 34717

mini_batch_src_global generation: 0.002069711685180664
r_  generation: 0.03007984161376953

local_output_nid generation: 0.0011279582977294922
local_in_edges_tensor generation: 0.0015325546264648438

&&&&&&&&&&&&&&& before remove duplicate length: 73105
remove duplicated spend time : 0.0095367431640625

&&&&&&&&&&&&&&& after remove duplicate length: 24836

mini_batch_src_global generation: 0.0021164417266845703
r_  generation: 0.01166224479675293

local_output_nid generation: 0.0012392997741699219
local_in_edges_tensor generation: 0.001462697982788086

&&&&&&&&&&&&&&& before remove duplicate length: 72373
remove duplicated spend time : 0.009755849838256836

&&&&&&&&&&&&&&& after remove duplicate length: 30156

mini_batch_src_global generation: 0.002501249313354492
r_  generation: 0.011659622192382812

local_output_nid generation: 0.0013589859008789062
local_in_edges_tensor generation: 0.0014643669128417969

&&&&&&&&&&&&&&& before remove duplicate length: 77055
remove duplicated spend time : 0.010054349899291992

&&&&&&&&&&&&&&& after remove duplicate length: 29790

mini_batch_src_global generation: 0.0025377273559570312
r_  generation: 0.01178598403930664

local_output_nid generation: 0.0013587474822998047
local_in_edges_tensor generation: 0.0014672279357910156

&&&&&&&&&&&&&&& before remove duplicate length: 76881
remove duplicated spend time : 0.010321617126464844

&&&&&&&&&&&&&&& after remove duplicate length: 26721

mini_batch_src_global generation: 0.002306699752807617
r_  generation: 0.011207818984985352

local_output_nid generation: 0.001373291015625
local_in_edges_tensor generation: 0.001468658447265625

&&&&&&&&&&&&&&& before remove duplicate length: 78153
remove duplicated spend time : 0.009806394577026367

&&&&&&&&&&&&&&& after remove duplicate length: 24470

mini_batch_src_global generation: 0.0021271705627441406
r_  generation: 0.010457277297973633

local_output_nid generation: 0.0013661384582519531
local_in_edges_tensor generation: 0.0014917850494384766

&&&&&&&&&&&&&&& before remove duplicate length: 78181
remove duplicated spend time : 0.010692358016967773

&&&&&&&&&&&&&&& after remove duplicate length: 35330

mini_batch_src_global generation: 0.0024476051330566406
r_  generation: 0.013430118560791016

local_output_nid generation: 0.0013659000396728516
local_in_edges_tensor generation: 0.0014119148254394531

&&&&&&&&&&&&&&& before remove duplicate length: 78386
remove duplicated spend time : 0.010498523712158203

&&&&&&&&&&&&&&& after remove duplicate length: 34373

mini_batch_src_global generation: 0.002390623092651367
r_  generation: 0.013524770736694336

local_output_nid generation: 0.001310586929321289
local_in_edges_tensor generation: 0.0014004707336425781

&&&&&&&&&&&&&&& before remove duplicate length: 69056
remove duplicated spend time : 0.00912165641784668

&&&&&&&&&&&&&&& after remove duplicate length: 29763

mini_batch_src_global generation: 0.0023696422576904297
r_  generation: 0.011820793151855469

local_output_nid generation: 0.0012860298156738281
local_in_edges_tensor generation: 0.0013921260833740234

&&&&&&&&&&&&&&& before remove duplicate length: 69804
remove duplicated spend time : 0.00904536247253418

&&&&&&&&&&&&&&& after remove duplicate length: 25522

mini_batch_src_global generation: 0.0020661354064941406
r_  generation: 0.010555028915405273

local_output_nid generation: 0.001360177993774414
local_in_edges_tensor generation: 0.0014405250549316406

&&&&&&&&&&&&&&& before remove duplicate length: 76740
remove duplicated spend time : 0.010340452194213867

&&&&&&&&&&&&&&& after remove duplicate length: 30153

mini_batch_src_global generation: 0.0025238990783691406
r_  generation: 0.012042760848999023

local_output_nid generation: 0.001354217529296875
local_in_edges_tensor generation: 0.0014586448669433594

&&&&&&&&&&&&&&& before remove duplicate length: 78140
remove duplicated spend time : 0.010571002960205078

&&&&&&&&&&&&&&& after remove duplicate length: 32297

mini_batch_src_global generation: 0.0025937557220458984
r_  generation: 0.012814998626708984

local_output_nid generation: 0.0013363361358642578
local_in_edges_tensor generation: 0.0014028549194335938

&&&&&&&&&&&&&&& before remove duplicate length: 71757
remove duplicated spend time : 0.010034322738647461

&&&&&&&&&&&&&&& after remove duplicate length: 29223

mini_batch_src_global generation: 0.0024597644805908203
r_  generation: 0.011819124221801758

local_output_nid generation: 0.0013086795806884766
local_in_edges_tensor generation: 0.001333475112915039

&&&&&&&&&&&&&&& before remove duplicate length: 70050
remove duplicated spend time : 0.009546279907226562

&&&&&&&&&&&&&&& after remove duplicate length: 24064

mini_batch_src_global generation: 0.0022296905517578125
r_  generation: 0.010370492935180664

local_output_nid generation: 0.001363992691040039
local_in_edges_tensor generation: 0.0014977455139160156

&&&&&&&&&&&&&&& before remove duplicate length: 71798
remove duplicated spend time : 0.009642362594604492

&&&&&&&&&&&&&&& after remove duplicate length: 27488

mini_batch_src_global generation: 0.0022821426391601562
r_  generation: 0.011049270629882812

local_output_nid generation: 0.0013172626495361328
local_in_edges_tensor generation: 0.0013675689697265625

&&&&&&&&&&&&&&& before remove duplicate length: 71875
remove duplicated spend time : 0.009702205657958984

&&&&&&&&&&&&&&& after remove duplicate length: 31562

mini_batch_src_global generation: 0.002563953399658203
r_  generation: 0.012324094772338867

local_output_nid generation: 0.0013580322265625
local_in_edges_tensor generation: 0.001478433609008789

&&&&&&&&&&&&&&& before remove duplicate length: 77530
remove duplicated spend time : 0.011124372482299805

&&&&&&&&&&&&&&& after remove duplicate length: 36818

mini_batch_src_global generation: 0.002419710159301758
r_  generation: 0.014201164245605469

local_output_nid generation: 0.0013115406036376953
local_in_edges_tensor generation: 0.0013973712921142578

&&&&&&&&&&&&&&& before remove duplicate length: 74304
remove duplicated spend time : 0.010533571243286133

&&&&&&&&&&&&&&& after remove duplicate length: 32274

mini_batch_src_global generation: 0.0027523040771484375
r_  generation: 0.01285862922668457

local_output_nid generation: 0.001317739486694336
local_in_edges_tensor generation: 0.0014157295227050781

&&&&&&&&&&&&&&& before remove duplicate length: 74820
remove duplicated spend time : 0.011245489120483398

&&&&&&&&&&&&&&& after remove duplicate length: 33492

mini_batch_src_global generation: 0.0022399425506591797
r_  generation: 0.013258934020996094

local_output_nid generation: 0.0013251304626464844
local_in_edges_tensor generation: 0.0016694068908691406

&&&&&&&&&&&&&&& before remove duplicate length: 73759
remove duplicated spend time : 0.009767770767211914

&&&&&&&&&&&&&&& after remove duplicate length: 31901

mini_batch_src_global generation: 0.0027086734771728516
r_  generation: 0.012771844863891602

local_output_nid generation: 0.001302957534790039
local_in_edges_tensor generation: 0.001377105712890625

&&&&&&&&&&&&&&& before remove duplicate length: 73004
remove duplicated spend time : 0.010090351104736328

&&&&&&&&&&&&&&& after remove duplicate length: 30447

mini_batch_src_global generation: 0.0025932788848876953
r_  generation: 0.012357711791992188

local_output_nid generation: 0.0014078617095947266
local_in_edges_tensor generation: 0.0014581680297851562

&&&&&&&&&&&&&&& before remove duplicate length: 77610
remove duplicated spend time : 0.011483907699584961

&&&&&&&&&&&&&&& after remove duplicate length: 31095

mini_batch_src_global generation: 0.0028884410858154297
r_  generation: 0.01282048225402832

local_output_nid generation: 0.0013675689697265625
local_in_edges_tensor generation: 0.0014865398406982422

&&&&&&&&&&&&&&& before remove duplicate length: 73027
remove duplicated spend time : 0.010114669799804688

&&&&&&&&&&&&&&& after remove duplicate length: 29391

mini_batch_src_global generation: 0.0025796890258789062
r_  generation: 0.011980533599853516

local_output_nid generation: 0.0013501644134521484
local_in_edges_tensor generation: 0.0013926029205322266

&&&&&&&&&&&&&&& before remove duplicate length: 72231
remove duplicated spend time : 0.010286331176757812

&&&&&&&&&&&&&&& after remove duplicate length: 31420

mini_batch_src_global generation: 0.002717733383178711
r_  generation: 0.012431859970092773

local_output_nid generation: 0.0013377666473388672
local_in_edges_tensor generation: 0.0013973712921142578

&&&&&&&&&&&&&&& before remove duplicate length: 71099
remove duplicated spend time : 0.010018348693847656

&&&&&&&&&&&&&&& after remove duplicate length: 33159

mini_batch_src_global generation: 0.002231597900390625
r_  generation: 0.013040542602539062

local_output_nid generation: 0.0013768672943115234
local_in_edges_tensor generation: 0.0013997554779052734

&&&&&&&&&&&&&&& before remove duplicate length: 76180
remove duplicated spend time : 0.01062464714050293

&&&&&&&&&&&&&&& after remove duplicate length: 31487

mini_batch_src_global generation: 0.002733469009399414
r_  generation: 0.012786626815795898

local_output_nid generation: 0.0013833045959472656
local_in_edges_tensor generation: 0.0014069080352783203

&&&&&&&&&&&&&&& before remove duplicate length: 72389
remove duplicated spend time : 0.009879112243652344

&&&&&&&&&&&&&&& after remove duplicate length: 28421

mini_batch_src_global generation: 0.002498626708984375
r_  generation: 0.011611700057983398

local_output_nid generation: 0.0013306140899658203
local_in_edges_tensor generation: 0.0013689994812011719

&&&&&&&&&&&&&&& before remove duplicate length: 74023
remove duplicated spend time : 0.010298490524291992

&&&&&&&&&&&&&&& after remove duplicate length: 30614

mini_batch_src_global generation: 0.0025436878204345703
r_  generation: 0.012094736099243164

local_output_nid generation: 0.0014004707336425781
local_in_edges_tensor generation: 0.0014400482177734375

&&&&&&&&&&&&&&& before remove duplicate length: 76992
remove duplicated spend time : 0.009987354278564453

&&&&&&&&&&&&&&& after remove duplicate length: 29320

mini_batch_src_global generation: 0.0024328231811523438
r_  generation: 0.012077569961547852

local_output_nid generation: 0.0013413429260253906
local_in_edges_tensor generation: 0.0013685226440429688

&&&&&&&&&&&&&&& before remove duplicate length: 71884
remove duplicated spend time : 0.010360002517700195

&&&&&&&&&&&&&&& after remove duplicate length: 39260

mini_batch_src_global generation: 0.002567768096923828
r_  generation: 0.014825105667114258

local_output_nid generation: 0.001394033432006836
local_in_edges_tensor generation: 0.0013761520385742188

&&&&&&&&&&&&&&& before remove duplicate length: 74836
remove duplicated spend time : 0.010289192199707031

&&&&&&&&&&&&&&& after remove duplicate length: 34228

mini_batch_src_global generation: 0.0024123191833496094
r_  generation: 0.01359248161315918

local_output_nid generation: 0.0013959407806396484
local_in_edges_tensor generation: 0.0014121532440185547

&&&&&&&&&&&&&&& before remove duplicate length: 75610
remove duplicated spend time : 0.010670661926269531

&&&&&&&&&&&&&&& after remove duplicate length: 37897

mini_batch_src_global generation: 0.0024755001068115234
r_  generation: 0.014598846435546875

local_output_nid generation: 0.0014166831970214844
local_in_edges_tensor generation: 0.0014264583587646484

&&&&&&&&&&&&&&& before remove duplicate length: 73492
remove duplicated spend time : 0.00910329818725586

&&&&&&&&&&&&&&& after remove duplicate length: 23668

mini_batch_src_global generation: 0.0020308494567871094
r_  generation: 0.01046609878540039

local_output_nid generation: 0.0013668537139892578
local_in_edges_tensor generation: 0.0013725757598876953

&&&&&&&&&&&&&&& before remove duplicate length: 73527
remove duplicated spend time : 0.009777545928955078

&&&&&&&&&&&&&&& after remove duplicate length: 28773

mini_batch_src_global generation: 0.0023071765899658203
r_  generation: 0.011542081832885742

local_output_nid generation: 0.0013246536254882812
local_in_edges_tensor generation: 0.0013549327850341797

&&&&&&&&&&&&&&& before remove duplicate length: 70543
remove duplicated spend time : 0.009435415267944336

&&&&&&&&&&&&&&& after remove duplicate length: 32938

mini_batch_src_global generation: 0.002252817153930664
r_  generation: 0.012723684310913086

local_output_nid generation: 0.001323699951171875
local_in_edges_tensor generation: 0.0013208389282226562

&&&&&&&&&&&&&&& before remove duplicate length: 70342
remove duplicated spend time : 0.009128808975219727

&&&&&&&&&&&&&&& after remove duplicate length: 28921

mini_batch_src_global generation: 0.0024139881134033203
r_  generation: 0.011694192886352539

local_output_nid generation: 0.0013456344604492188
local_in_edges_tensor generation: 0.0014264583587646484

&&&&&&&&&&&&&&& before remove duplicate length: 74874
remove duplicated spend time : 0.010066509246826172

&&&&&&&&&&&&&&& after remove duplicate length: 29115

mini_batch_src_global generation: 0.002431631088256836
r_  generation: 0.011639833450317383

local_output_nid generation: 0.0013186931610107422
local_in_edges_tensor generation: 0.0013720989227294922

&&&&&&&&&&&&&&& before remove duplicate length: 73264
remove duplicated spend time : 0.010230541229248047

&&&&&&&&&&&&&&& after remove duplicate length: 34836

mini_batch_src_global generation: 0.0023381710052490234
r_  generation: 0.01332235336303711

local_output_nid generation: 0.0013737678527832031
local_in_edges_tensor generation: 0.0014452934265136719

&&&&&&&&&&&&&&& before remove duplicate length: 77476
remove duplicated spend time : 0.009792089462280273

&&&&&&&&&&&&&&& after remove duplicate length: 29408

mini_batch_src_global generation: 0.0023751258850097656
r_  generation: 0.012181758880615234

local_output_nid generation: 0.0013585090637207031
local_in_edges_tensor generation: 0.0014371871948242188

&&&&&&&&&&&&&&& before remove duplicate length: 77996
remove duplicated spend time : 0.010230064392089844

&&&&&&&&&&&&&&& after remove duplicate length: 25674

mini_batch_src_global generation: 0.0021588802337646484
r_  generation: 0.010913848876953125

local_output_nid generation: 0.0013184547424316406
local_in_edges_tensor generation: 0.0013227462768554688

&&&&&&&&&&&&&&& before remove duplicate length: 62808
remove duplicated spend time : 0.008671045303344727

&&&&&&&&&&&&&&& after remove duplicate length: 28773

mini_batch_src_global generation: 0.0024013519287109375
r_  generation: 0.011109590530395508

local_output_nid generation: 0.0013580322265625
local_in_edges_tensor generation: 0.0014119148254394531

&&&&&&&&&&&&&&& before remove duplicate length: 76973
remove duplicated spend time : 0.010534524917602539

&&&&&&&&&&&&&&& after remove duplicate length: 36057

mini_batch_src_global generation: 0.0023581981658935547
r_  generation: 0.013887405395507812

local_output_nid generation: 0.0013623237609863281
local_in_edges_tensor generation: 0.0013835430145263672

&&&&&&&&&&&&&&& before remove duplicate length: 76851
remove duplicated spend time : 0.009923219680786133

&&&&&&&&&&&&&&& after remove duplicate length: 33481

mini_batch_src_global generation: 0.0022792816162109375
r_  generation: 0.013047218322753906

local_output_nid generation: 0.0013127326965332031
local_in_edges_tensor generation: 0.0013670921325683594

&&&&&&&&&&&&&&& before remove duplicate length: 72503
remove duplicated spend time : 0.00998687744140625

&&&&&&&&&&&&&&& after remove duplicate length: 36471

mini_batch_src_global generation: 0.002377748489379883
r_  generation: 0.013825178146362305

local_output_nid generation: 0.001322031021118164
local_in_edges_tensor generation: 0.0013689994812011719

&&&&&&&&&&&&&&& before remove duplicate length: 72641
remove duplicated spend time : 0.009053945541381836

&&&&&&&&&&&&&&& after remove duplicate length: 28211

mini_batch_src_global generation: 0.002361297607421875
r_  generation: 0.011439800262451172

local_output_nid generation: 0.0013539791107177734
local_in_edges_tensor generation: 0.0014216899871826172

&&&&&&&&&&&&&&& before remove duplicate length: 74034
remove duplicated spend time : 0.009627103805541992

&&&&&&&&&&&&&&& after remove duplicate length: 26624

mini_batch_src_global generation: 0.002237558364868164
r_  generation: 0.010839700698852539

local_output_nid generation: 0.0013420581817626953
local_in_edges_tensor generation: 0.0013949871063232422

&&&&&&&&&&&&&&& before remove duplicate length: 69785
remove duplicated spend time : 0.009013652801513672

&&&&&&&&&&&&&&& after remove duplicate length: 29691

mini_batch_src_global generation: 0.0024368762969970703
r_  generation: 0.011664628982543945

local_output_nid generation: 0.0013213157653808594
local_in_edges_tensor generation: 0.0012748241424560547

&&&&&&&&&&&&&&& before remove duplicate length: 59262
remove duplicated spend time : 0.008236408233642578

&&&&&&&&&&&&&&& after remove duplicate length: 31039

mini_batch_src_global generation: 0.002580404281616211
r_  generation: 0.011728286743164062

local_output_nid generation: 0.001401662826538086
local_in_edges_tensor generation: 0.0014493465423583984

&&&&&&&&&&&&&&& before remove duplicate length: 78737
remove duplicated spend time : 0.011380672454833984

&&&&&&&&&&&&&&& after remove duplicate length: 38297

mini_batch_src_global generation: 0.002516508102416992
r_  generation: 0.014777421951293945

local_output_nid generation: 0.0013780593872070312
local_in_edges_tensor generation: 0.0014452934265136719

&&&&&&&&&&&&&&& before remove duplicate length: 78472
remove duplicated spend time : 0.010704994201660156

&&&&&&&&&&&&&&& after remove duplicate length: 33836

mini_batch_src_global generation: 0.0023953914642333984
r_  generation: 0.013456344604492188

local_output_nid generation: 0.0013654232025146484
local_in_edges_tensor generation: 0.001451730728149414

&&&&&&&&&&&&&&& before remove duplicate length: 77290
remove duplicated spend time : 0.010082483291625977

&&&&&&&&&&&&&&& after remove duplicate length: 26636

mini_batch_src_global generation: 0.002226591110229492
r_  generation: 0.011473894119262695

local_output_nid generation: 0.001390695571899414
local_in_edges_tensor generation: 0.001508474349975586

&&&&&&&&&&&&&&& before remove duplicate length: 78342
remove duplicated spend time : 0.010790109634399414

&&&&&&&&&&&&&&& after remove duplicate length: 32233

mini_batch_src_global generation: 0.0026776790618896484
r_  generation: 0.012813568115234375

local_output_nid generation: 0.0013360977172851562
local_in_edges_tensor generation: 0.0030727386474609375

&&&&&&&&&&&&&&& before remove duplicate length: 75832
remove duplicated spend time : 0.013385534286499023

&&&&&&&&&&&&&&& after remove duplicate length: 45604

mini_batch_src_global generation: 0.003062009811401367
r_  generation: 0.01880812644958496

local_output_nid generation: 0.0013833045959472656
local_in_edges_tensor generation: 0.0014612674713134766

&&&&&&&&&&&&&&& before remove duplicate length: 77483
remove duplicated spend time : 0.011333942413330078

&&&&&&&&&&&&&&& after remove duplicate length: 39346

mini_batch_src_global generation: 0.0027077198028564453
r_  generation: 0.015409231185913086

local_output_nid generation: 0.001390695571899414
local_in_edges_tensor generation: 0.001470804214477539

&&&&&&&&&&&&&&& before remove duplicate length: 77943
remove duplicated spend time : 0.011095762252807617

&&&&&&&&&&&&&&& after remove duplicate length: 38312

mini_batch_src_global generation: 0.002457857131958008
r_  generation: 0.014981269836425781

local_output_nid generation: 0.00131988525390625
local_in_edges_tensor generation: 0.0013802051544189453

&&&&&&&&&&&&&&& before remove duplicate length: 74019
remove duplicated spend time : 0.011086702346801758

&&&&&&&&&&&&&&& after remove duplicate length: 39334

mini_batch_src_global generation: 0.002567768096923828
r_  generation: 0.015685558319091797

local_output_nid generation: 0.0014348030090332031
local_in_edges_tensor generation: 0.0014503002166748047

&&&&&&&&&&&&&&& before remove duplicate length: 77787
remove duplicated spend time : 0.01074361801147461

&&&&&&&&&&&&&&& after remove duplicate length: 34528

mini_batch_src_global generation: 0.0022814273834228516
r_  generation: 0.01413869857788086

local_output_nid generation: 0.001341104507446289
local_in_edges_tensor generation: 0.0013897418975830078

&&&&&&&&&&&&&&& before remove duplicate length: 75010
remove duplicated spend time : 0.010602235794067383

&&&&&&&&&&&&&&& after remove duplicate length: 38649

mini_batch_src_global generation: 0.0025358200073242188
r_  generation: 0.014955997467041016

local_output_nid generation: 0.0013833045959472656
local_in_edges_tensor generation: 0.0014643669128417969

&&&&&&&&&&&&&&& before remove duplicate length: 77650
remove duplicated spend time : 0.011041879653930664

&&&&&&&&&&&&&&& after remove duplicate length: 40545

mini_batch_src_global generation: 0.002657651901245117
r_  generation: 0.01568603515625

local_output_nid generation: 0.001363992691040039
local_in_edges_tensor generation: 0.001402139663696289

&&&&&&&&&&&&&&& before remove duplicate length: 71345
remove duplicated spend time : 0.009876251220703125

&&&&&&&&&&&&&&& after remove duplicate length: 38914

mini_batch_src_global generation: 0.002530813217163086
r_  generation: 0.014811992645263672

local_output_nid generation: 0.0013828277587890625
local_in_edges_tensor generation: 0.001445770263671875

&&&&&&&&&&&&&&& before remove duplicate length: 77506
remove duplicated spend time : 0.01040196418762207

&&&&&&&&&&&&&&& after remove duplicate length: 32795

mini_batch_src_global generation: 0.002187967300415039
r_  generation: 0.013402700424194336

local_output_nid generation: 0.001390218734741211
local_in_edges_tensor generation: 0.00146484375

&&&&&&&&&&&&&&& before remove duplicate length: 78078
remove duplicated spend time : 0.011039495468139648

&&&&&&&&&&&&&&& after remove duplicate length: 33468

mini_batch_src_global generation: 0.002245664596557617
r_  generation: 0.01347041130065918

local_output_nid generation: 0.0013988018035888672
local_in_edges_tensor generation: 0.0015332698822021484

&&&&&&&&&&&&&&& before remove duplicate length: 78870
remove duplicated spend time : 0.010997533798217773

&&&&&&&&&&&&&&& after remove duplicate length: 33368

mini_batch_src_global generation: 0.002229452133178711
r_  generation: 0.01349329948425293

local_output_nid generation: 0.0013859272003173828
local_in_edges_tensor generation: 0.0014612674713134766

&&&&&&&&&&&&&&& before remove duplicate length: 78648
remove duplicated spend time : 0.010827302932739258

&&&&&&&&&&&&&&& after remove duplicate length: 31637

mini_batch_src_global generation: 0.0026197433471679688
r_  generation: 0.012934684753417969


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6669631004333496
gen group dst list time:  0.05698060989379883
check_connections_block*********************************
time for parepare 1: 0.3720574378967285
local_output_nid generation: 0.010369539260864258
local_in_edges_tensor generation: 0.07181572914123535

&&&&&&&&&&&&&&& before remove duplicate length: 344104
remove duplicated spend time : 0.05999183654785156

&&&&&&&&&&&&&&& after remove duplicate length: 132117

mini_batch_src_global generation: 0.007245540618896484
r_  generation: 0.06630849838256836

local_output_nid generation: 0.008900642395019531
local_in_edges_tensor generation: 0.008402824401855469

&&&&&&&&&&&&&&& before remove duplicate length: 243119
remove duplicated spend time : 0.03802084922790527

&&&&&&&&&&&&&&& after remove duplicate length: 79781

mini_batch_src_global generation: 0.00591731071472168
r_  generation: 0.04653477668762207

local_output_nid generation: 0.010576725006103516
local_in_edges_tensor generation: 0.010018348693847656

&&&&&&&&&&&&&&& before remove duplicate length: 295834
remove duplicated spend time : 0.054518699645996094

&&&&&&&&&&&&&&& after remove duplicate length: 117155

mini_batch_src_global generation: 0.008318424224853516
r_  generation: 0.06639671325683594

local_output_nid generation: 0.009632110595703125
local_in_edges_tensor generation: 0.009128570556640625

&&&&&&&&&&&&&&& before remove duplicate length: 293734
remove duplicated spend time : 0.05606722831726074

&&&&&&&&&&&&&&& after remove duplicate length: 87564

mini_batch_src_global generation: 0.007013559341430664
r_  generation: 0.05933976173400879

local_output_nid generation: 0.009319782257080078
local_in_edges_tensor generation: 0.008295059204101562

&&&&&&&&&&&&&&& before remove duplicate length: 262708
remove duplicated spend time : 0.04536771774291992

&&&&&&&&&&&&&&& after remove duplicate length: 87223

mini_batch_src_global generation: 0.006468534469604492
r_  generation: 0.04925799369812012

local_output_nid generation: 0.008158683776855469
local_in_edges_tensor generation: 0.007514476776123047

&&&&&&&&&&&&&&& before remove duplicate length: 241817
remove duplicated spend time : 0.04034090042114258

&&&&&&&&&&&&&&& after remove duplicate length: 79456

mini_batch_src_global generation: 0.005970954895019531
r_  generation: 0.04619741439819336

local_output_nid generation: 0.011200666427612305
local_in_edges_tensor generation: 0.01179647445678711

&&&&&&&&&&&&&&& before remove duplicate length: 353373
remove duplicated spend time : 0.07127618789672852

&&&&&&&&&&&&&&& after remove duplicate length: 131258

mini_batch_src_global generation: 0.01011204719543457
r_  generation: 0.07686924934387207

local_output_nid generation: 0.01141500473022461
local_in_edges_tensor generation: 0.01271367073059082

&&&&&&&&&&&&&&& before remove duplicate length: 345684
remove duplicated spend time : 0.06997060775756836

&&&&&&&&&&&&&&& after remove duplicate length: 126381

mini_batch_src_global generation: 0.010537862777709961
r_  generation: 0.07952642440795898

local_output_nid generation: 0.009848594665527344
local_in_edges_tensor generation: 0.009050846099853516

&&&&&&&&&&&&&&& before remove duplicate length: 294175
remove duplicated spend time : 0.05906057357788086

&&&&&&&&&&&&&&& after remove duplicate length: 106705

mini_batch_src_global generation: 0.008657217025756836
r_  generation: 0.06600499153137207

local_output_nid generation: 0.01585245132446289
local_in_edges_tensor generation: 0.00768280029296875

&&&&&&&&&&&&&&& before remove duplicate length: 251731
remove duplicated spend time : 0.04482316970825195

&&&&&&&&&&&&&&& after remove duplicate length: 77043

mini_batch_src_global generation: 0.006082057952880859
r_  generation: 0.04613232612609863

local_output_nid generation: 0.011095523834228516
local_in_edges_tensor generation: 0.009924650192260742

&&&&&&&&&&&&&&& before remove duplicate length: 295379
remove duplicated spend time : 0.05928993225097656

&&&&&&&&&&&&&&& after remove duplicate length: 116232

mini_batch_src_global generation: 0.008635997772216797
r_  generation: 0.06805205345153809

local_output_nid generation: 0.010478496551513672
local_in_edges_tensor generation: 0.010543584823608398

&&&&&&&&&&&&&&& before remove duplicate length: 322572
remove duplicated spend time : 0.0645751953125

&&&&&&&&&&&&&&& after remove duplicate length: 100389

mini_batch_src_global generation: 0.00841832160949707
r_  generation: 0.06584453582763672

local_output_nid generation: 0.009628057479858398
local_in_edges_tensor generation: 0.008710384368896484

&&&&&&&&&&&&&&& before remove duplicate length: 290170
remove duplicated spend time : 0.05154132843017578

&&&&&&&&&&&&&&& after remove duplicate length: 81791

mini_batch_src_global generation: 0.006451845169067383
r_  generation: 0.05044269561767578

local_output_nid generation: 0.008175849914550781
local_in_edges_tensor generation: 0.007467746734619141

&&&&&&&&&&&&&&& before remove duplicate length: 237089
remove duplicated spend time : 0.039008140563964844

&&&&&&&&&&&&&&& after remove duplicate length: 71247

mini_batch_src_global generation: 0.0054624080657958984
r_  generation: 0.041672706604003906

local_output_nid generation: 0.009093761444091797
local_in_edges_tensor generation: 0.008823394775390625

&&&&&&&&&&&&&&& before remove duplicate length: 272687
remove duplicated spend time : 0.04776883125305176

&&&&&&&&&&&&&&& after remove duplicate length: 85932

mini_batch_src_global generation: 0.006432294845581055
r_  generation: 0.049962759017944336

local_output_nid generation: 0.010331153869628906
local_in_edges_tensor generation: 0.0095672607421875

&&&&&&&&&&&&&&& before remove duplicate length: 316506
remove duplicated spend time : 0.06495022773742676

&&&&&&&&&&&&&&& after remove duplicate length: 106804

mini_batch_src_global generation: 0.00840306282043457
r_  generation: 0.06610250473022461

local_output_nid generation: 0.012154817581176758
local_in_edges_tensor generation: 0.013494491577148438

&&&&&&&&&&&&&&& before remove duplicate length: 369217
remove duplicated spend time : 0.07704353332519531

&&&&&&&&&&&&&&& after remove duplicate length: 138157

mini_batch_src_global generation: 0.011906862258911133
r_  generation: 0.08616828918457031

local_output_nid generation: 0.010731220245361328
local_in_edges_tensor generation: 0.009850263595581055

&&&&&&&&&&&&&&& before remove duplicate length: 320998
remove duplicated spend time : 0.06875491142272949

&&&&&&&&&&&&&&& after remove duplicate length: 125974

mini_batch_src_global generation: 0.011021852493286133
r_  generation: 0.07874059677124023

local_output_nid generation: 0.011183977127075195
local_in_edges_tensor generation: 0.010576009750366211

&&&&&&&&&&&&&&& before remove duplicate length: 335816
remove duplicated spend time : 0.07231760025024414

&&&&&&&&&&&&&&& after remove duplicate length: 108296

mini_batch_src_global generation: 0.008914709091186523
r_  generation: 0.07223391532897949

local_output_nid generation: 0.01605510711669922
local_in_edges_tensor generation: 0.010121583938598633

&&&&&&&&&&&&&&& before remove duplicate length: 317018
remove duplicated spend time : 0.0654761791229248

&&&&&&&&&&&&&&& after remove duplicate length: 110572

mini_batch_src_global generation: 0.008950233459472656
r_  generation: 0.06870198249816895

local_output_nid generation: 0.012167692184448242
local_in_edges_tensor generation: 0.010199546813964844

&&&&&&&&&&&&&&& before remove duplicate length: 301111
remove duplicated spend time : 0.0662240982055664

&&&&&&&&&&&&&&& after remove duplicate length: 121436

mini_batch_src_global generation: 0.00988626480102539
r_  generation: 0.07455134391784668

local_output_nid generation: 0.011205434799194336
local_in_edges_tensor generation: 0.010011911392211914

&&&&&&&&&&&&&&& before remove duplicate length: 307040
remove duplicated spend time : 0.06640243530273438

&&&&&&&&&&&&&&& after remove duplicate length: 110821

mini_batch_src_global generation: 0.009311437606811523
r_  generation: 0.07060599327087402

local_output_nid generation: 0.010675907135009766
local_in_edges_tensor generation: 0.009809017181396484

&&&&&&&&&&&&&&& before remove duplicate length: 291748
remove duplicated spend time : 0.06450486183166504

&&&&&&&&&&&&&&& after remove duplicate length: 120554

mini_batch_src_global generation: 0.009790658950805664
r_  generation: 0.07252836227416992

local_output_nid generation: 0.01133584976196289
local_in_edges_tensor generation: 0.0105743408203125

&&&&&&&&&&&&&&& before remove duplicate length: 311998
remove duplicated spend time : 0.07160067558288574

&&&&&&&&&&&&&&& after remove duplicate length: 135470

mini_batch_src_global generation: 0.01122736930847168
r_  generation: 0.08239483833312988

local_output_nid generation: 0.011630058288574219
local_in_edges_tensor generation: 0.011784076690673828

&&&&&&&&&&&&&&& before remove duplicate length: 324424
remove duplicated spend time : 0.07109808921813965

&&&&&&&&&&&&&&& after remove duplicate length: 129251

mini_batch_src_global generation: 0.011016845703125
r_  generation: 0.08130645751953125

local_output_nid generation: 0.011153459548950195
local_in_edges_tensor generation: 0.00994110107421875

&&&&&&&&&&&&&&& before remove duplicate length: 307747
remove duplicated spend time : 0.07077217102050781

&&&&&&&&&&&&&&& after remove duplicate length: 110497

mini_batch_src_global generation: 0.009432792663574219
r_  generation: 0.07199883460998535

local_output_nid generation: 0.009996414184570312
local_in_edges_tensor generation: 0.009025096893310547

&&&&&&&&&&&&&&& before remove duplicate length: 274747
remove duplicated spend time : 0.05921196937561035

&&&&&&&&&&&&&&& after remove duplicate length: 104631

mini_batch_src_global generation: 0.008510112762451172
r_  generation: 0.06710577011108398

local_output_nid generation: 0.010175943374633789
local_in_edges_tensor generation: 0.008938074111938477

&&&&&&&&&&&&&&& before remove duplicate length: 301367
remove duplicated spend time : 0.06386828422546387

&&&&&&&&&&&&&&& after remove duplicate length: 109653

mini_batch_src_global generation: 0.008814811706542969
r_  generation: 0.0717003345489502

local_output_nid generation: 0.009450197219848633
local_in_edges_tensor generation: 0.008470296859741211

&&&&&&&&&&&&&&& before remove duplicate length: 290673
remove duplicated spend time : 0.059607744216918945

&&&&&&&&&&&&&&& after remove duplicate length: 91956

mini_batch_src_global generation: 0.007566213607788086
r_  generation: 0.06099081039428711

local_output_nid generation: 0.01313471794128418
local_in_edges_tensor generation: 0.01253652572631836

&&&&&&&&&&&&&&& before remove duplicate length: 385679
remove duplicated spend time : 0.08483362197875977

&&&&&&&&&&&&&&& after remove duplicate length: 153472

mini_batch_src_global generation: 0.013049602508544922
r_  generation: 0.0978248119354248

local_output_nid generation: 0.01186823844909668
local_in_edges_tensor generation: 0.012679100036621094

&&&&&&&&&&&&&&& before remove duplicate length: 335720
remove duplicated spend time : 0.07259249687194824

&&&&&&&&&&&&&&& after remove duplicate length: 122900

mini_batch_src_global generation: 0.011211633682250977
r_  generation: 0.08109617233276367

local_output_nid generation: 0.012704610824584961
local_in_edges_tensor generation: 0.0114593505859375

&&&&&&&&&&&&&&& before remove duplicate length: 370677
remove duplicated spend time : 0.08342814445495605

&&&&&&&&&&&&&&& after remove duplicate length: 143795

mini_batch_src_global generation: 0.01252889633178711
r_  generation: 0.09199833869934082

local_output_nid generation: 0.008158683776855469
local_in_edges_tensor generation: 0.0070323944091796875

&&&&&&&&&&&&&&& before remove duplicate length: 231831
remove duplicated spend time : 0.04137539863586426

&&&&&&&&&&&&&&& after remove duplicate length: 69297

mini_batch_src_global generation: 0.005814790725708008
r_  generation: 0.04492497444152832

local_output_nid generation: 0.008767843246459961
local_in_edges_tensor generation: 0.00763249397277832

&&&&&&&&&&&&&&& before remove duplicate length: 277919
remove duplicated spend time : 0.04631185531616211

&&&&&&&&&&&&&&& after remove duplicate length: 85781

mini_batch_src_global generation: 0.0063915252685546875
r_  generation: 0.05122828483581543

local_output_nid generation: 0.010872840881347656
local_in_edges_tensor generation: 0.010343551635742188

&&&&&&&&&&&&&&& before remove duplicate length: 328131
remove duplicated spend time : 0.07018017768859863

&&&&&&&&&&&&&&& after remove duplicate length: 128124

mini_batch_src_global generation: 0.010088443756103516
r_  generation: 0.07575321197509766

local_output_nid generation: 0.010229825973510742
local_in_edges_tensor generation: 0.009253978729248047

&&&&&&&&&&&&&&& before remove duplicate length: 287970
remove duplicated spend time : 0.06389927864074707

&&&&&&&&&&&&&&& after remove duplicate length: 124080

mini_batch_src_global generation: 0.010468721389770508
r_  generation: 0.07533764839172363

local_output_nid generation: 0.01027989387512207
local_in_edges_tensor generation: 0.009685277938842773

&&&&&&&&&&&&&&& before remove duplicate length: 292430
remove duplicated spend time : 0.06509542465209961

&&&&&&&&&&&&&&& after remove duplicate length: 123441

mini_batch_src_global generation: 0.01027989387512207
r_  generation: 0.0763406753540039

local_output_nid generation: 0.011929988861083984
local_in_edges_tensor generation: 0.012377738952636719

&&&&&&&&&&&&&&& before remove duplicate length: 350184
remove duplicated spend time : 0.07991862297058105

&&&&&&&&&&&&&&& after remove duplicate length: 144312

mini_batch_src_global generation: 0.012410879135131836
r_  generation: 0.08917737007141113

local_output_nid generation: 0.009243965148925781
local_in_edges_tensor generation: 0.007824897766113281

&&&&&&&&&&&&&&& before remove duplicate length: 288398
remove duplicated spend time : 0.05897212028503418

&&&&&&&&&&&&&&& after remove duplicate length: 89235

mini_batch_src_global generation: 0.007456779479980469
r_  generation: 0.06112194061279297

local_output_nid generation: 0.008072376251220703
local_in_edges_tensor generation: 0.007039070129394531

&&&&&&&&&&&&&&& before remove duplicate length: 255388
remove duplicated spend time : 0.04368329048156738

&&&&&&&&&&&&&&& after remove duplicate length: 76468

mini_batch_src_global generation: 0.00674128532409668
r_  generation: 0.04582548141479492

local_output_nid generation: 0.01004648208618164
local_in_edges_tensor generation: 0.009686946868896484

&&&&&&&&&&&&&&& before remove duplicate length: 289213
remove duplicated spend time : 0.0624232292175293

&&&&&&&&&&&&&&& after remove duplicate length: 137613

mini_batch_src_global generation: 0.010056495666503906
r_  generation: 0.08021759986877441

local_output_nid generation: 0.012172698974609375
local_in_edges_tensor generation: 0.014605283737182617

&&&&&&&&&&&&&&& before remove duplicate length: 359982
remove duplicated spend time : 0.08134174346923828

&&&&&&&&&&&&&&& after remove duplicate length: 147726

mini_batch_src_global generation: 0.013010263442993164
r_  generation: 0.09214663505554199

local_output_nid generation: 0.01178741455078125
local_in_edges_tensor generation: 0.010612726211547852

&&&&&&&&&&&&&&& before remove duplicate length: 341674
remove duplicated spend time : 0.07998347282409668

&&&&&&&&&&&&&&& after remove duplicate length: 149176

mini_batch_src_global generation: 0.013478517532348633
r_  generation: 0.09274077415466309

local_output_nid generation: 0.011684656143188477
local_in_edges_tensor generation: 0.011220455169677734

&&&&&&&&&&&&&&& before remove duplicate length: 370601
remove duplicated spend time : 0.08170700073242188

&&&&&&&&&&&&&&& after remove duplicate length: 135277

mini_batch_src_global generation: 0.011856555938720703
r_  generation: 0.08840131759643555

local_output_nid generation: 0.010020732879638672
local_in_edges_tensor generation: 0.009187459945678711

&&&&&&&&&&&&&&& before remove duplicate length: 290910
remove duplicated spend time : 0.06399035453796387

&&&&&&&&&&&&&&& after remove duplicate length: 128981

mini_batch_src_global generation: 0.01081395149230957
r_  generation: 0.07665657997131348

local_output_nid generation: 0.009280920028686523
local_in_edges_tensor generation: 0.008467674255371094

&&&&&&&&&&&&&&& before remove duplicate length: 270254
remove duplicated spend time : 0.060828208923339844

&&&&&&&&&&&&&&& after remove duplicate length: 114123

mini_batch_src_global generation: 0.009419918060302734
r_  generation: 0.07157588005065918

local_output_nid generation: 0.010559797286987305
local_in_edges_tensor generation: 0.009861946105957031

&&&&&&&&&&&&&&& before remove duplicate length: 304190
remove duplicated spend time : 0.06887316703796387

&&&&&&&&&&&&&&& after remove duplicate length: 131267

mini_batch_src_global generation: 0.010668277740478516
r_  generation: 0.07834601402282715

local_output_nid generation: 0.01167917251586914
local_in_edges_tensor generation: 0.011221170425415039

&&&&&&&&&&&&&&& before remove duplicate length: 320885
remove duplicated spend time : 0.07827615737915039

&&&&&&&&&&&&&&& after remove duplicate length: 172957

mini_batch_src_global generation: 0.015165328979492188
r_  generation: 0.10032892227172852

local_output_nid generation: 0.01268768310546875
local_in_edges_tensor generation: 0.012563467025756836

&&&&&&&&&&&&&&& before remove duplicate length: 384284
remove duplicated spend time : 0.08307456970214844

&&&&&&&&&&&&&&& after remove duplicate length: 129063

mini_batch_src_global generation: 0.011821746826171875
r_  generation: 0.08842062950134277

local_output_nid generation: 0.011377096176147461
local_in_edges_tensor generation: 0.010126590728759766

&&&&&&&&&&&&&&& before remove duplicate length: 339142
remove duplicated spend time : 0.07686758041381836

&&&&&&&&&&&&&&& after remove duplicate length: 125977

mini_batch_src_global generation: 0.011000633239746094
r_  generation: 0.08056330680847168

local_output_nid generation: 0.008765935897827148
local_in_edges_tensor generation: 0.007938623428344727

&&&&&&&&&&&&&&& before remove duplicate length: 264902
remove duplicated spend time : 0.04721641540527344

&&&&&&&&&&&&&&& after remove duplicate length: 79026

mini_batch_src_global generation: 0.006573915481567383
r_  generation: 0.04970669746398926

local_output_nid generation: 0.010435342788696289
local_in_edges_tensor generation: 0.009547233581542969

&&&&&&&&&&&&&&& before remove duplicate length: 322645
remove duplicated spend time : 0.06516313552856445

&&&&&&&&&&&&&&& after remove duplicate length: 113329

mini_batch_src_global generation: 0.008817672729492188
r_  generation: 0.06954741477966309

local_output_nid generation: 0.015146970748901367
local_in_edges_tensor generation: 0.01726698875427246

&&&&&&&&&&&&&&& before remove duplicate length: 460348
remove duplicated spend time : 0.1179804801940918

&&&&&&&&&&&&&&& after remove duplicate length: 190453

mini_batch_src_global generation: 0.017736434936523438
r_  generation: 0.12642455101013184

local_output_nid generation: 0.014168024063110352
local_in_edges_tensor generation: 0.013205766677856445

&&&&&&&&&&&&&&& before remove duplicate length: 396503
remove duplicated spend time : 0.09153461456298828

&&&&&&&&&&&&&&& after remove duplicate length: 156527

mini_batch_src_global generation: 0.0157928466796875
r_  generation: 0.10531163215637207

local_output_nid generation: 0.013532161712646484
local_in_edges_tensor generation: 0.011997461318969727

&&&&&&&&&&&&&&& before remove duplicate length: 386774
remove duplicated spend time : 0.08798027038574219

&&&&&&&&&&&&&&& after remove duplicate length: 144997

mini_batch_src_global generation: 0.013296127319335938
r_  generation: 0.09483933448791504

local_output_nid generation: 0.01395726203918457
local_in_edges_tensor generation: 0.013297796249389648

&&&&&&&&&&&&&&& before remove duplicate length: 399149
remove duplicated spend time : 0.10470700263977051

&&&&&&&&&&&&&&& after remove duplicate length: 180770

mini_batch_src_global generation: 0.017209529876708984
r_  generation: 0.12268733978271484

local_output_nid generation: 0.01178884506225586
local_in_edges_tensor generation: 0.010332107543945312

&&&&&&&&&&&&&&& before remove duplicate length: 345530
remove duplicated spend time : 0.07774806022644043

&&&&&&&&&&&&&&& after remove duplicate length: 109361

mini_batch_src_global generation: 0.00981760025024414
r_  generation: 0.07633781433105469

local_output_nid generation: 0.013330936431884766
local_in_edges_tensor generation: 0.012216806411743164

&&&&&&&&&&&&&&& before remove duplicate length: 388350
remove duplicated spend time : 0.08374643325805664

&&&&&&&&&&&&&&& after remove duplicate length: 133889

mini_batch_src_global generation: 0.01069331169128418
r_  generation: 0.08458375930786133

local_output_nid generation: 0.014353752136230469
local_in_edges_tensor generation: 0.013277053833007812

&&&&&&&&&&&&&&& before remove duplicate length: 410289
remove duplicated spend time : 0.09481024742126465

&&&&&&&&&&&&&&& after remove duplicate length: 167609

mini_batch_src_global generation: 0.015505552291870117
r_  generation: 0.10582327842712402

local_output_nid generation: 0.014123201370239258
local_in_edges_tensor generation: 0.012971639633178711

&&&&&&&&&&&&&&& before remove duplicate length: 396250
remove duplicated spend time : 0.11057472229003906

&&&&&&&&&&&&&&& after remove duplicate length: 191676

mini_batch_src_global generation: 0.0189363956451416
r_  generation: 0.129241943359375

local_output_nid generation: 0.010789632797241211
local_in_edges_tensor generation: 0.009124994277954102

&&&&&&&&&&&&&&& before remove duplicate length: 328021
remove duplicated spend time : 0.06891107559204102

&&&&&&&&&&&&&&& after remove duplicate length: 105147

mini_batch_src_global generation: 0.00926351547241211
r_  generation: 0.07372426986694336

local_output_nid generation: 0.010446310043334961
local_in_edges_tensor generation: 0.009276151657104492

&&&&&&&&&&&&&&& before remove duplicate length: 334854
remove duplicated spend time : 0.0646214485168457

&&&&&&&&&&&&&&& after remove duplicate length: 95174

mini_batch_src_global generation: 0.007196664810180664
r_  generation: 0.0624544620513916

local_output_nid generation: 0.011167287826538086
local_in_edges_tensor generation: 0.010263919830322266

&&&&&&&&&&&&&&& before remove duplicate length: 334718
remove duplicated spend time : 0.06589651107788086

&&&&&&&&&&&&&&& after remove duplicate length: 106851

mini_batch_src_global generation: 0.008700370788574219
r_  generation: 0.06748056411743164

local_output_nid generation: 0.010317564010620117
local_in_edges_tensor generation: 0.008906841278076172

&&&&&&&&&&&&&&& before remove duplicate length: 316495
remove duplicated spend time : 0.06245732307434082

&&&&&&&&&&&&&&& after remove duplicate length: 95067

mini_batch_src_global generation: 0.007834911346435547
r_  generation: 0.06242847442626953


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.1326904296875 GB
    Memory Allocated: 0.05411338806152344  GigaBytes
Max Memory Allocated: 0.05411338806152344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.1326904296875 GB
    Memory Allocated: 0.054135799407958984  GigaBytes
Max Memory Allocated: 0.054135799407958984  GigaBytes

first layer input nodes number: 138431
first layer output nodes number: 35345
edges number: 344104
----------------------------------------before model layer 0
 Nvidia-smi: 7.2166748046875 GB
    Memory Allocated: 0.05866432189941406  GigaBytes
Max Memory Allocated: 0.059946537017822266  GigaBytes

torch.Size([138431, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2166748046875 GB
    Memory Allocated: 0.05866432189941406  GigaBytes
Max Memory Allocated: 0.059946537017822266  GigaBytes

m.shape torch.Size([93, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.4530029296875 GB
    Memory Allocated: 0.19123029708862305  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4530029296875 GB
    Memory Allocated: 0.19123029708862305  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

 h.shape torch.Size([1, 93, 100]), torch.Size([1, 93, 100])
----------------------------------------3
 Nvidia-smi: 7.4530029296875 GB
    Memory Allocated: 0.1912999153137207  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4549560546875 GB
    Memory Allocated: 0.19185543060302734  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

rst.shape  torch.Size([1, 93, 100])
m.shape torch.Size([151, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.4549560546875 GB
    Memory Allocated: 0.19193315505981445  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4549560546875 GB
    Memory Allocated: 0.19193315505981445  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

 h.shape torch.Size([1, 151, 100]), torch.Size([1, 151, 100])
----------------------------------------3
 Nvidia-smi: 7.4549560546875 GB
    Memory Allocated: 0.1920456886291504  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4569091796875 GB
    Memory Allocated: 0.19373369216918945  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

rst.shape  torch.Size([1, 151, 100])
m.shape torch.Size([175, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.4569091796875 GB
    Memory Allocated: 0.19387340545654297  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4569091796875 GB
    Memory Allocated: 0.19387340545654297  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

 h.shape torch.Size([1, 175, 100]), torch.Size([1, 175, 100])
----------------------------------------3
 Nvidia-smi: 7.4569091796875 GB
    Memory Allocated: 0.19400405883789062  GigaBytes
Max Memory Allocated: 0.19667720794677734  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.19687414169311523  GigaBytes
Max Memory Allocated: 0.19707012176513672  GigaBytes

rst.shape  torch.Size([1, 175, 100])
m.shape torch.Size([230, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.19715166091918945  GigaBytes
Max Memory Allocated: 0.19716262817382812  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.19715166091918945  GigaBytes
Max Memory Allocated: 0.19716262817382812  GigaBytes

 h.shape torch.Size([1, 230, 100]), torch.Size([1, 230, 100])
----------------------------------------3
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.19732332229614258  GigaBytes
Max Memory Allocated: 0.19732332229614258  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.20229578018188477  GigaBytes
Max Memory Allocated: 0.2026386260986328  GigaBytes

rst.shape  torch.Size([1, 230, 100])
m.shape torch.Size([286, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.2027430534362793  GigaBytes
Max Memory Allocated: 0.2027597427368164  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.2027430534362793  GigaBytes
Max Memory Allocated: 0.2027597427368164  GigaBytes

 h.shape torch.Size([1, 286, 100]), torch.Size([1, 286, 100])
----------------------------------------3
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.2029566764831543  GigaBytes
Max Memory Allocated: 0.2029566764831543  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4744873046875 GB
    Memory Allocated: 0.2106328010559082  GigaBytes
Max Memory Allocated: 0.2111659049987793  GigaBytes

rst.shape  torch.Size([1, 286, 100])
m.shape torch.Size([320, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 0.2112412452697754  GigaBytes
Max Memory Allocated: 0.21126270294189453  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 0.2112412452697754  GigaBytes
Max Memory Allocated: 0.21126270294189453  GigaBytes

 h.shape torch.Size([1, 320, 100]), torch.Size([1, 320, 100])
----------------------------------------3
 Nvidia-smi: 7.4764404296875 GB
    Memory Allocated: 0.21147966384887695  GigaBytes
Max Memory Allocated: 0.21147966384887695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4862060546875 GB
    Memory Allocated: 0.22173166275024414  GigaBytes
Max Memory Allocated: 0.22244691848754883  GigaBytes

rst.shape  torch.Size([1, 320, 100])
m.shape torch.Size([315, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.4862060546875 GB
    Memory Allocated: 0.22243404388427734  GigaBytes
Max Memory Allocated: 0.2224593162536621  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4862060546875 GB
    Memory Allocated: 0.22243404388427734  GigaBytes
Max Memory Allocated: 0.2224593162536621  GigaBytes

 h.shape torch.Size([1, 315, 100]), torch.Size([1, 315, 100])
----------------------------------------3
 Nvidia-smi: 7.4862060546875 GB
    Memory Allocated: 0.2226696014404297  GigaBytes
Max Memory Allocated: 0.2226696014404297  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4998779296875 GB
    Memory Allocated: 0.23441743850708008  GigaBytes
Max Memory Allocated: 0.23523902893066406  GigaBytes

rst.shape  torch.Size([1, 315, 100])
m.shape torch.Size([353, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.4998779296875 GB
    Memory Allocated: 0.2353520393371582  GigaBytes
Max Memory Allocated: 0.23538446426391602  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4998779296875 GB
    Memory Allocated: 0.2353520393371582  GigaBytes
Max Memory Allocated: 0.23538446426391602  GigaBytes

 h.shape torch.Size([1, 353, 100]), torch.Size([1, 353, 100])
----------------------------------------3
 Nvidia-smi: 7.4998779296875 GB
    Memory Allocated: 0.23561525344848633  GigaBytes
Max Memory Allocated: 0.23561525344848633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5155029296875 GB
    Memory Allocated: 0.25061845779418945  GigaBytes
Max Memory Allocated: 0.25167083740234375  GigaBytes

rst.shape  torch.Size([1, 353, 100])
m.shape torch.Size([335, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.5155029296875 GB
    Memory Allocated: 0.25161027908325195  GigaBytes
Max Memory Allocated: 0.25167083740234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5155029296875 GB
    Memory Allocated: 0.25161027908325195  GigaBytes
Max Memory Allocated: 0.25167083740234375  GigaBytes

 h.shape torch.Size([1, 335, 100]), torch.Size([1, 335, 100])
----------------------------------------3
 Nvidia-smi: 7.5155029296875 GB
    Memory Allocated: 0.2518601417541504  GigaBytes
Max Memory Allocated: 0.2518601417541504  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.2678384780883789  GigaBytes
Max Memory Allocated: 0.26896190643310547  GigaBytes

rst.shape  torch.Size([1, 335, 100])
m.shape torch.Size([33087, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.3909726142883301  GigaBytes
Max Memory Allocated: 0.3946704864501953  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.3909726142883301  GigaBytes
Max Memory Allocated: 0.3946704864501953  GigaBytes

 h.shape torch.Size([1, 33087, 100]), torch.Size([1, 33087, 100])
----------------------------------------3
 Nvidia-smi: 7.6854248046875 GB
    Memory Allocated: 0.41562509536743164  GigaBytes
Max Memory Allocated: 0.41562509536743164  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1659083366394043  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 33087, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.0376815795898438  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.0713891983032227  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

h_self size  torch.Size([35345, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.0713891983032227  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

torch.Size([35345, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1050968170166016  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.0713891983032227  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

torch.Size([35345, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1050968170166016  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1135239601135254  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------input nodes number: 35345
----------------output nodes number: 2981
----------------edges number: 71844
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1138100624084473  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.182988166809082  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.182988166809082  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.182997703552246  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1830739974975586  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1830830574035645  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1830830574035645  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.183096408843994  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1832966804504395  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.183307647705078  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.183307647705078  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.183319091796875  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1835708618164062  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1835885047912598  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1835885047912598  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1835999488830566  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.183931827545166  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1839985847473145  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1839985847473145  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1840271949768066  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1850571632385254  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 6, 256])
----------------------------------------1
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.185112476348877  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.185112476348877  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1851353645324707  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.186119556427002  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.186168670654297  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.186168670654297  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.186185836791992  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.187044143676758  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1870970726013184  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1870970726013184  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.187112331390381  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1879820823669434  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1880006790161133  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1880006790161133  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1880064010620117  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1883726119995117  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([11, 10, 256])
----------------------------------------1
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1884756088256836  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1884756088256836  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 9.6346435546875 GB
    Memory Allocated: 2.1884965896606445  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6365966796875 GB
    Memory Allocated: 2.189986228942871  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 11, 256])
----------------------------------------1
 Nvidia-smi: 9.6365966796875 GB
    Memory Allocated: 2.190092086791992  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6365966796875 GB
    Memory Allocated: 2.190092086791992  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 9.6365966796875 GB
    Memory Allocated: 2.190113067626953  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6385498046875 GB
    Memory Allocated: 2.1917495727539062  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 12, 256])
----------------------------------------1
 Nvidia-smi: 9.6385498046875 GB
    Memory Allocated: 2.1918892860412598  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6385498046875 GB
    Memory Allocated: 2.1918892860412598  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 9.6385498046875 GB
    Memory Allocated: 2.1919140815734863  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6405029296875 GB
    Memory Allocated: 2.194021701812744  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 9.6405029296875 GB
    Memory Allocated: 2.194121837615967  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6405029296875 GB
    Memory Allocated: 2.194121837615967  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 9.6405029296875 GB
    Memory Allocated: 2.194139003753662  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6424560546875 GB
    Memory Allocated: 2.195718288421631  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 14, 256])
----------------------------------------1
 Nvidia-smi: 9.6424560546875 GB
    Memory Allocated: 2.1958847045898438  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6424560546875 GB
    Memory Allocated: 2.1958847045898438  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 9.6424560546875 GB
    Memory Allocated: 2.1959095001220703  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6463623046875 GB
    Memory Allocated: 2.1983642578125  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 15, 256])
----------------------------------------1
 Nvidia-smi: 9.6463623046875 GB
    Memory Allocated: 2.1984963417053223  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6463623046875 GB
    Memory Allocated: 2.1984963417053223  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 9.6463623046875 GB
    Memory Allocated: 2.1985154151916504  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6483154296875 GB
    Memory Allocated: 2.2005372047424316  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 16, 256])
----------------------------------------1
 Nvidia-smi: 9.6483154296875 GB
    Memory Allocated: 2.2006664276123047  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6483154296875 GB
    Memory Allocated: 2.2006664276123047  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 9.6483154296875 GB
    Memory Allocated: 2.20068359375  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6502685546875 GB
    Memory Allocated: 2.2026233673095703  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 9.6502685546875 GB
    Memory Allocated: 2.2027292251586914  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6502685546875 GB
    Memory Allocated: 2.2027292251586914  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 9.6502685546875 GB
    Memory Allocated: 2.202742576599121  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6522216796875 GB
    Memory Allocated: 2.2043447494506836  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 9.6522216796875 GB
    Memory Allocated: 2.204476833343506  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6522216796875 GB
    Memory Allocated: 2.204476833343506  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 9.6522216796875 GB
    Memory Allocated: 2.2044920921325684  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6541748046875 GB
    Memory Allocated: 2.206429958343506  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 9.6541748046875 GB
    Memory Allocated: 2.2065505981445312  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6541748046875 GB
    Memory Allocated: 2.2065505981445312  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 9.6541748046875 GB
    Memory Allocated: 2.206563949584961  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6561279296875 GB
    Memory Allocated: 2.208353042602539  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 9.6561279296875 GB
    Memory Allocated: 2.208634853363037  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6561279296875 GB
    Memory Allocated: 2.208634853363037  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 9.6561279296875 GB
    Memory Allocated: 2.2086634635925293  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6600341796875 GB
    Memory Allocated: 2.2126975059509277  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 9.6600341796875 GB
    Memory Allocated: 2.2130064964294434  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6600341796875 GB
    Memory Allocated: 2.2130064964294434  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 9.6600341796875 GB
    Memory Allocated: 2.2130370140075684  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6639404296875 GB
    Memory Allocated: 2.2175536155700684  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 9.6639404296875 GB
    Memory Allocated: 2.217792510986328  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6639404296875 GB
    Memory Allocated: 2.217792510986328  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 9.6639404296875 GB
    Memory Allocated: 2.217815399169922  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6678466796875 GB
    Memory Allocated: 2.221363067626953  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 9.6678466796875 GB
    Memory Allocated: 2.221484661102295  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6678466796875 GB
    Memory Allocated: 2.221484661102295  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 9.6678466796875 GB
    Memory Allocated: 2.221496105194092  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6697998046875 GB
    Memory Allocated: 2.2233500480651855  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 9.6697998046875 GB
    Memory Allocated: 2.223505973815918  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6697998046875 GB
    Memory Allocated: 2.223505973815918  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 9.6697998046875 GB
    Memory Allocated: 2.2235193252563477  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 2.225775718688965  GigaBytes
Max Memory Allocated: 2.2891674041748047  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2756, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.7401123046875 GB
    Memory Allocated: 2.2926888465881348  GigaBytes
Max Memory Allocated: 2.2929458618164062  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7401123046875 GB
    Memory Allocated: 2.2926888465881348  GigaBytes
Max Memory Allocated: 2.2929458618164062  GigaBytes

 h.shape torch.Size([1, 2756, 256]), torch.Size([1, 2756, 256])
----------------------------------------3
 Nvidia-smi: 9.7401123046875 GB
    Memory Allocated: 2.297945499420166  GigaBytes
Max Memory Allocated: 2.297945499420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7088623046875 GB
    Memory Allocated: 3.223672389984131  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2756, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7088623046875 GB
    Memory Allocated: 3.155773162841797  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7088623046875 GB
    Memory Allocated: 3.1562952995300293  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 10.7088623046875 GB
    Memory Allocated: 3.1562952995300293  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.7108154296875 GB
    Memory Allocated: 3.1568174362182617  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7108154296875 GB
    Memory Allocated: 3.1562952995300293  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.05720233917236328  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.08821582794189453  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.08823871612548828  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

first layer input nodes number: 83251
first layer output nodes number: 25075
edges number: 243119
----------------------------------------before model layer 0
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.039811134338378906  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([83251, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.039811134338378906  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([63, 1, 100])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.13296985626220703  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.13296985626220703  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.13301753997802734  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.13339471817016602  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([89, 2, 100])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.1334376335144043  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.1334376335144043  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 89, 100]), torch.Size([1, 89, 100])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.13350439071655273  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.13450288772583008  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 89, 100])
m.shape torch.Size([146, 3, 100])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.13463306427001953  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.13463306427001953  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 146, 100]), torch.Size([1, 146, 100])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.13474273681640625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.13714265823364258  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 146, 100])
m.shape torch.Size([204, 4, 100])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.1373920440673828  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.1373920440673828  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 204, 100]), torch.Size([1, 204, 100])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.1375446319580078  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.14195823669433594  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 204, 100])
m.shape torch.Size([252, 5, 100])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.14235162734985352  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.14235162734985352  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 252, 100]), torch.Size([1, 252, 100])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.14253950119018555  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.14930295944213867  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 252, 100])
m.shape torch.Size([291, 6, 100])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.14985990524291992  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.14985990524291992  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 291, 100]), torch.Size([1, 291, 100])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.15007734298706055  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.1594099998474121  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 291, 100])
m.shape torch.Size([277, 7, 100])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.16002368927001953  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.16002368927001953  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 277, 100]), torch.Size([1, 277, 100])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.1602306365966797  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.17055797576904297  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 277, 100])
m.shape torch.Size([301, 8, 100])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.17135190963745117  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.17135190963745117  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 301, 100]), torch.Size([1, 301, 100])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.17157697677612305  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.1843714714050293  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 301, 100])
m.shape torch.Size([249, 9, 100])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.18509387969970703  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.18509387969970703  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 249, 100]), torch.Size([1, 249, 100])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.18527984619140625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.19716882705688477  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 249, 100])
m.shape torch.Size([23203, 10, 100])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.28351402282714844  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.28351402282714844  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 23203, 100]), torch.Size([1, 23203, 100])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 0.30080223083496094  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5282363891601562  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 23203, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.4378881454467773  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.461801528930664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([25075, 100])
----------------------------------------before rst
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.461801528930664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([25075, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.4857149124145508  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.461801528930664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([25075, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.4857149124145508  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.4916934967041016  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------input nodes number: 25075
----------------output nodes number: 3043
----------------edges number: 73105
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.491903305053711  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5628867149353027  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5628867149353027  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.562894344329834  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.562955379486084  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5629634857177734  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5629634857177734  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5629749298095703  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5631465911865234  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5631585121154785  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5631585121154785  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5631699562072754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5634217262268066  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5634660720825195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5634660720825195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.563490867614746  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5642099380493164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5642504692077637  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5642504692077637  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5642714500427246  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5650267601013184  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.565091609954834  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.565091609954834  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5651164054870605  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5661826133728027  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5662240982055664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5662240982055664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.566239356994629  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.567002296447754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([13, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5670948028564453  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5670948028564453  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5671195983886719  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.568532943725586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5685901641845703  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5685901641845703  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5686054229736328  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5695819854736328  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5696706771850586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5696706771850586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5696897506713867  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5710439682006836  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5711617469787598  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5711617469787598  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5711846351623535  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.572969913482666  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5730972290039062  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5730972290039062  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5731201171875  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5750656127929688  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5752167701721191  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5752167701721191  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5752415657043457  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5775227546691895  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.57761812210083  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.57761812210083  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5776333808898926  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.57914400100708  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5792665481567383  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5792665481567383  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5792837142944336  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5811033248901367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5812792778015137  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5812792778015137  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5813021659851074  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5838885307312012  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.584073543548584  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.584073543548584  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5840964317321777  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5868430137634277  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.587022304534912  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.587022304534912  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.587043285369873  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.589707851409912  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5899896621704102  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5899896621704102  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5900201797485352  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5941095352172852  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5942869186401367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5942869186401367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5943059921264648  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5969953536987305  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5972485542297363  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.5972485542297363  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.597273349761963  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.6009430885314941  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.601290225982666  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.601290225982666  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.6013226509094238  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.6063485145568848  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.606597900390625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.606597900390625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.6066207885742188  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.6103286743164062  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.610525131225586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.610525131225586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.6105422973632812  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7830810546875 GB
    Memory Allocated: 1.613443374633789  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2785, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.7850341796875 GB
    Memory Allocated: 1.6803598403930664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7850341796875 GB
    Memory Allocated: 1.6803598403930664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2785, 256]), torch.Size([1, 2785, 256])
----------------------------------------3
 Nvidia-smi: 10.7850341796875 GB
    Memory Allocated: 1.686509132385254  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7850341796875 GB
    Memory Allocated: 2.640005111694336  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2785, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7850341796875 GB
    Memory Allocated: 2.569605827331543  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7850341796875 GB
    Memory Allocated: 2.570138931274414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([3043, 256])
----------------------------------------before rst
 Nvidia-smi: 10.7850341796875 GB
    Memory Allocated: 2.570138931274414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([3043, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.7850341796875 GB
    Memory Allocated: 2.570672035217285  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7850341796875 GB
    Memory Allocated: 2.570138931274414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([3043, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.03665733337402344  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.0824289321899414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.08245134353637695  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

first layer input nodes number: 122867
first layer output nodes number: 30551
edges number: 295834
----------------------------------------before model layer 0
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.055303096771240234  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([122867, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.055303096771240234  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([74, 1, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16926002502441406  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16926002502441406  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 74, 100]), torch.Size([1, 74, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16931533813476562  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16975784301757812  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 74, 100])
m.shape torch.Size([167, 2, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16985464096069336  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16985464096069336  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 167, 100]), torch.Size([1, 167, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16997957229614258  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17184782028198242  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 167, 100])
m.shape torch.Size([185, 3, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17199230194091797  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17199230194091797  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 185, 100]), torch.Size([1, 185, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17213058471679688  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17516851425170898  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 185, 100])
m.shape torch.Size([256, 4, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17548084259033203  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17548084259033203  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 256, 100]), torch.Size([1, 256, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17567157745361328  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.18120288848876953  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 256, 100])
m.shape torch.Size([292, 5, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.18165159225463867  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.18165159225463867  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 292, 100]), torch.Size([1, 292, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1818699836730957  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1897106170654297  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 292, 100])
m.shape torch.Size([327, 6, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.19033241271972656  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.19033241271972656  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 327, 100]), torch.Size([1, 327, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.19057655334472656  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.20105743408203125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 327, 100])
m.shape torch.Size([350, 7, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.20184850692749023  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.20184850692749023  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 350, 100]), torch.Size([1, 350, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.20210981369018555  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.21515512466430664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 350, 100])
m.shape torch.Size([344, 8, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.2160496711730957  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.2160496711730957  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 344, 100]), torch.Size([1, 344, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.21630620956420898  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.23091745376586914  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 344, 100])
m.shape torch.Size([337, 9, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.2319192886352539  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.2319192886352539  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 337, 100]), torch.Size([1, 337, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.23217105865478516  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.2482585906982422  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 337, 100])
m.shape torch.Size([28219, 10, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.3532567024230957  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.3532567024230957  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 28219, 100]), torch.Size([1, 28219, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.3742823600769043  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8672327995300293  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 28219, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7579913139343262  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7871270179748535  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([30551, 100])
----------------------------------------before rst
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7871270179748535  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([30551, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8162627220153809  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7871270179748535  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([30551, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8162627220153809  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8243975639343262  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------input nodes number: 30551
----------------output nodes number: 2981
----------------edges number: 72373
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8246479034423828  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8943324089050293  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8943324089050293  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8943381309509277  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8943839073181152  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8943910598754883  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8943910598754883  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8944005966186523  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8945436477661133  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.894547939300537  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.894547939300537  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8945536613464355  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8946795463562012  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8947076797485352  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8947076797485352  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8947229385375977  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8951654434204102  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8952012062072754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8952012062072754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8952183723449707  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.895836353302002  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8958568572998047  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8958568572998047  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8958663940429688  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8962764739990234  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.896346092224121  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.896346092224121  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.896367073059082  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.897416114807129  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8974595069885254  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8974595069885254  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.897472858428955  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8982338905334473  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8982620239257812  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8982620239257812  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8982696533203125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8987579345703125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8987927436828613  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8987927436828613  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8988003730773926  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8993420600891113  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8994231224060059  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8994231224060059  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8994383811950684  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9006285667419434  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9007134437561035  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9007134437561035  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.900728702545166  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9020256996154785  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9021682739257812  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9021682739257812  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.902191162109375  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.904296875  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9044203758239746  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9044203758239746  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9044394493103027  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.906327724456787  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9064483642578125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9064483642578125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9064655303955078  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.908285140991211  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9084768295288086  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9084768295288086  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9085016250610352  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9113035202026367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.911470890045166  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.911470890045166  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.911491870880127  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9140095710754395  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.914085865020752  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.914085865020752  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.914095401763916  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.915306568145752  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9155030250549316  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9155030250549316  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9155240058898926  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9183354377746582  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.918555736541748  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.918555736541748  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9185786247253418  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9218058586120605  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9219560623168945  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9219560623168945  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.921971321105957  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.924229621887207  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.924370288848877  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.924370288848877  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9243836402893066  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9264531135559082  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9266676902770996  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9266676902770996  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9266867637634277  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.929776668548584  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9301362037658691  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9301362037658691  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9301667213439941  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9353241920471191  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([2782, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 2.002155303955078  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 2.002155303955078  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2782, 256]), torch.Size([1, 2782, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 2.0074615478515625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 2.957413673400879  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2782, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 2.889078140258789  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 2.8896002769470215  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 2.8896002769470215  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 2.890122413635254  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 2.8896002769470215  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.05140399932861328  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.08539390563964844  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.0854177474975586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

first layer input nodes number: 91240
first layer output nodes number: 30025
edges number: 293734
----------------------------------------before model layer 0
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.04329061508178711  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([91240, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.04329061508178711  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([76, 1, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.15660858154296875  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.15660858154296875  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.15666580200195312  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1571207046508789  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([110, 2, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.15717411041259766  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.15717411041259766  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 110, 100]), torch.Size([1, 110, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1572561264038086  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.15848636627197266  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 110, 100])
m.shape torch.Size([114, 3, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.15857315063476562  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.15857315063476562  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 114, 100]), torch.Size([1, 114, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1586589813232422  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16053438186645508  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 114, 100])
m.shape torch.Size([170, 4, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16074514389038086  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16074514389038086  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 170, 100]), torch.Size([1, 170, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1608719825744629  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1645503044128418  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 170, 100])
m.shape torch.Size([178, 5, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16481876373291016  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16481876373291016  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 178, 100]), torch.Size([1, 178, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.16495227813720703  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1697373390197754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 178, 100])
m.shape torch.Size([213, 6, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17014694213867188  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17014694213867188  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 213, 100]), torch.Size([1, 213, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17030620574951172  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1771373748779297  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 213, 100])
m.shape torch.Size([233, 7, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17766571044921875  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.17766571044921875  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 233, 100]), torch.Size([1, 233, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1778402328491211  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.18653631210327148  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 233, 100])
m.shape torch.Size([235, 8, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1871495246887207  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.1871495246887207  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 235, 100]), torch.Size([1, 235, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.18732500076293945  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.19731569290161133  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 235, 100])
m.shape torch.Size([223, 9, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.19797563552856445  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.19797563552856445  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 223, 100]), torch.Size([1, 223, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.19814252853393555  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.2087850570678711  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 223, 100])
m.shape torch.Size([28473, 10, 100])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.3147721290588379  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.3147721290588379  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 28473, 100]), torch.Size([1, 28473, 100])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 0.3359866142272949  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.842200756072998  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 28473, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.733853816986084  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7624878883361816  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([30025, 100])
----------------------------------------before rst
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7624878883361816  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([30025, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7911219596862793  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7624878883361816  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([30025, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7911219596862793  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7982807159423828  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------input nodes number: 30025
----------------output nodes number: 3145
----------------edges number: 77055
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.7985286712646484  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8727169036865234  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8727169036865234  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.872720718383789  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.872751235961914  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8727593421936035  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8727593421936035  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8727688789367676  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8729119300842285  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8729133605957031  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8729133605957031  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8729171752929688  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8730010986328125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8730149269104004  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8730149269104004  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8730225563049316  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.873243808746338  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8732595443725586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8732595443725586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8732671737670898  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8735418319702148  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8735613822937012  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8735613822937012  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8735690116882324  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8738970756530762  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8739609718322754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8739609718322754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8739800453186035  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8749337196350098  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.874985694885254  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.874985694885254  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8750009536743164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.875870704650879  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8759236335754395  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8759236335754395  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8759369850158691  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8767914772033691  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8768329620361328  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8768329620361328  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8768424987792969  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8775196075439453  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.877546787261963  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.877546787261963  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8775525093078613  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8779988288879395  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8780884742736816  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8780884742736816  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8781037330627441  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8794007301330566  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([3, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8794307708740234  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8794307708740234  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8794364929199219  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8799629211425781  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8800544738769531  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8800544738769531  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8800678253173828  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8813896179199219  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.881455421447754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.881455421447754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.881464958190918  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8824758529663086  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8825483322143555  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8825483322143555  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8825578689575195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8836355209350586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8837618827819824  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8837618827819824  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.883777141571045  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.885608196258545  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.885756492614746  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.885756492614746  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8857736587524414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.887953758239746  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.888073444366455  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.888073444366455  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8880867958068848  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.889875888824463  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8900232315063477  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8900232315063477  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8900384902954102  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8921899795532227  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8922228813171387  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8922228813171387  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8922266960144043  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8927912712097168  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8929800987243652  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8929800987243652  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8929972648620605  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.895658016204834  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8958706855773926  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8958706855773926  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8958897590637207  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.898979663848877  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8990163803100586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8990163803100586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8990201950073242  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.8996648788452148  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3008, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9719395637512207  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9719395637512207  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3008, 256]), torch.Size([1, 3008, 256])
----------------------------------------3
 Nvidia-smi: 10.7889404296875 GB
    Memory Allocated: 1.9785056114196777  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8612060546875 GB
    Memory Allocated: 2.9958224296569824  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3008, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8612060546875 GB
    Memory Allocated: 2.922377109527588  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8612060546875 GB
    Memory Allocated: 2.9229278564453125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([3145, 256])
----------------------------------------before rst
 Nvidia-smi: 10.8612060546875 GB
    Memory Allocated: 2.9229278564453125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([3145, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.8612060546875 GB
    Memory Allocated: 2.923478603363037  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8612060546875 GB
    Memory Allocated: 2.9229278564453125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([3145, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.039652347564697266  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.07370615005493164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.0737299919128418  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

first layer input nodes number: 91412
first layer output nodes number: 26928
edges number: 262708
----------------------------------------before model layer 0
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.04312944412231445  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([91412, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.04312944412231445  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([55, 1, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14473485946655273  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14473485946655273  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 55, 100]), torch.Size([1, 55, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1447758674621582  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14510393142700195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 55, 100])
m.shape torch.Size([121, 2, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1451740264892578  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1451740264892578  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 121, 100]), torch.Size([1, 121, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1452646255493164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1466207504272461  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 121, 100])
m.shape torch.Size([111, 3, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1466999053955078  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1466999053955078  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 111, 100]), torch.Size([1, 111, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14678287506103516  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1486039161682129  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 111, 100])
m.shape torch.Size([198, 4, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14885759353637695  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14885759353637695  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 198, 100]), torch.Size([1, 198, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14900541305541992  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.15328645706176758  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 198, 100])
m.shape torch.Size([167, 5, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.15352392196655273  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.15352392196655273  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 167, 100]), torch.Size([1, 167, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.15364885330200195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.15813207626342773  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 167, 100])
m.shape torch.Size([213, 6, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.15854597091674805  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.15854597091674805  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 213, 100]), torch.Size([1, 213, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1587052345275879  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.16553640365600586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 213, 100])
m.shape torch.Size([235, 7, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.16606998443603516  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.16606998443603516  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 235, 100]), torch.Size([1, 235, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1662454605102539  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.17500925064086914  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 235, 100])
m.shape torch.Size([266, 8, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.17571449279785156  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.17571449279785156  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 266, 100]), torch.Size([1, 266, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.17591285705566406  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.18721961975097656  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 266, 100])
m.shape torch.Size([220, 9, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.18785810470581055  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.18785810470581055  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 220, 100]), torch.Size([1, 220, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.18802213668823242  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.19852018356323242  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 220, 100])
m.shape torch.Size([25342, 10, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.2928447723388672  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.2928447723388672  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 25342, 100]), torch.Size([1, 25342, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.31172657012939453  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6523056030273438  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 25342, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.554520606994629  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5802011489868164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([26928, 100])
----------------------------------------before rst
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5802011489868164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([26928, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.605881690979004  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5802011489868164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([26928, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.605881690979004  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6127333641052246  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------input nodes number: 26928
----------------output nodes number: 3146
----------------edges number: 76881
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6129579544067383  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6878786087036133  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6878786087036133  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.687880516052246  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6878957748413086  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6879029273986816  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6879029273986816  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.687910556793213  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6880249977111816  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6880388259887695  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6880388259887695  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6880502700805664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6883020401000977  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([21, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6883773803710938  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6883773803710938  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6884174346923828  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6895790100097656  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6895785331726074  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6895785331726074  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6895861625671387  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6898608207702637  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6898860931396484  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6898860931396484  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6898956298828125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6903057098388672  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6903347969055176  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6903347969055176  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6903443336486816  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6908211708068848  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6908936500549316  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6908936500549316  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6909127235412598  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.691999912261963  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6920166015625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6920166015625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6920223236083984  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6923885345458984  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6924338340759277  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6924338340759277  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6924433708190918  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6931204795837402  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6931686401367188  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6931686401367188  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6931781768798828  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6939220428466797  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6939520835876465  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6939520835876465  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.693957805633545  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.694444179534912  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6945042610168457  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6945042610168457  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6945137977600098  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6953911781311035  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6954541206359863  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6954541206359863  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6954636573791504  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6964077949523926  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6964898109436035  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6964898109436035  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6965012550354004  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6977143287658691  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.697770118713379  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.697770118713379  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6977777481079102  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6986398696899414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6986689567565918  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6986689567565918  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6986727714538574  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6991305351257324  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6992673873901367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6992673873901367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6992826461791992  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7012205123901367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7013773918151855  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7013773918151855  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7013945579528809  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7036948204040527  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7038211822509766  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7038211822509766  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7038345336914062  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7057170867919922  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.70573091506958  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.70573091506958  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.705732822418213  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7060151100158691  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7061834335327148  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7061834335327148  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7061986923217773  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7085638046264648  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7086448669433594  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7086448669433594  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7086524963378906  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7098884582519531  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7100000381469727  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7100000381469727  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7100095748901367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7116212844848633  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3010, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7844429016113281  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7844429016113281  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3010, 256]), torch.Size([1, 3010, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.7901840209960938  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.8083181381225586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3010, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.734137535095215  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.7346887588500977  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([3146, 256])
----------------------------------------before rst
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.7346887588500977  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([3146, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.7352399826049805  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.7346887588500977  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([3146, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.03971672058105469  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.07058954238891602  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.07061338424682617  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

first layer input nodes number: 82873
first layer output nodes number: 24668
edges number: 241817
----------------------------------------before model layer 0
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.039722442626953125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([82873, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.039722442626953125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([27, 1, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13236045837402344  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13236045837402344  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 27, 100]), torch.Size([1, 27, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13238143920898438  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13254499435424805  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 27, 100])
m.shape torch.Size([60, 2, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13257932662963867  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13257932662963867  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 60, 100]), torch.Size([1, 60, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13262414932250977  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13329648971557617  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 60, 100])
m.shape torch.Size([95, 3, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13338041305541992  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13338041305541992  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 95, 100]), torch.Size([1, 95, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1334519386291504  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13501262664794922  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 95, 100])
m.shape torch.Size([126, 4, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13516473770141602  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13516473770141602  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 126, 100]), torch.Size([1, 126, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13525915145874023  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1379857063293457  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 126, 100])
m.shape torch.Size([168, 5, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13825178146362305  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13825178146362305  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 168, 100]), torch.Size([1, 168, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.13837766647338867  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14288806915283203  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 168, 100])
m.shape torch.Size([180, 6, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14322757720947266  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14322757720947266  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 180, 100]), torch.Size([1, 180, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14336204528808594  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14913558959960938  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 180, 100])
m.shape torch.Size([183, 7, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14954566955566406  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14954566955566406  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 183, 100]), torch.Size([1, 183, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.14968204498291016  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.15650081634521484  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 183, 100])
m.shape torch.Size([195, 8, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1570138931274414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.1570138931274414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 195, 100]), torch.Size([1, 195, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.15715980529785156  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.16545391082763672  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 195, 100])
m.shape torch.Size([220, 9, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.16611862182617188  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.16611862182617188  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 220, 100]), torch.Size([1, 220, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.16628265380859375  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.17678070068359375  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 220, 100])
m.shape torch.Size([23414, 10, 100])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.26392269134521484  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.26392269134521484  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 23414, 100]), torch.Size([1, 23414, 100])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 0.2813682556152344  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.519986629486084  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 23414, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.4299020767211914  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.4534273147583008  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([24668, 100])
----------------------------------------before rst
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.4534273147583008  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([24668, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.4769525527954102  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.4534273147583008  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([24668, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.4769525527954102  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.4828338623046875  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------input nodes number: 24668
----------------output nodes number: 3163
----------------edges number: 78153
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.483041763305664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5582828521728516  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5582828521728516  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5582847595214844  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5583000183105469  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.558302402496338  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.558302402496338  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5583043098449707  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5583462715148926  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.558349609375  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.558349609375  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5583515167236328  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5584068298339844  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.55842924118042  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.55842924118042  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5584368705749512  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.558764934539795  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.558781623840332  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.558781623840332  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5587873458862305  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5590734481811523  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5591168403625488  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5591168403625488  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5591282844543457  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5597805976867676  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.559809684753418  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.559809684753418  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5598173141479492  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5603055953979492  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5603117942810059  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5603117942810059  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5603137016296387  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5604491233825684  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5605010986328125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5605010986328125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5605106353759766  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5612545013427734  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.561295986175537  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.561295986175537  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5613036155700684  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5619521141052246  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.562023639678955  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.562023639678955  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.562035083770752  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5630879402160645  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5631632804870605  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5631632804870605  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5631747245788574  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.564307689666748  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5643744468688965  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5643744468688965  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5643839836120605  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5653948783874512  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5654826164245605  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5654826164245605  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5654940605163574  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5667872428894043  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.566847324371338  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.566847324371338  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5668549537658691  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5677704811096191  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5678362846374512  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5678362846374512  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5678439140319824  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5688128471374512  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5689005851745605  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5689005851745605  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5689101219177246  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.570188045501709  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.570298671722412  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.570298671722412  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.570310115814209  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5719237327575684  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5720796585083008  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5720796585083008  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5720949172973633  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5743532180786133  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5744304656982422  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5744304656982422  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5744380950927734  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5756206512451172  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5757055282592773  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5757055282592773  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5757131576538086  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.576949119567871  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.57712984085083  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.57712984085083  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.5771450996398926  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.579723834991455  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([3067, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6534109115600586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.6534109115600586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3067, 256]), torch.Size([1, 3067, 256])
----------------------------------------3
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 1.659402847290039  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.6918373107910156  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3067, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.617307662963867  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.617861747741699  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.617861747741699  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.6184158325195312  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9354248046875 GB
    Memory Allocated: 2.617861747741699  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([3163, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 11.0115966796875 GB
    Memory Allocated: 0.03653860092163086  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0115966796875 GB
    Memory Allocated: 0.08762359619140625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0115966796875 GB
    Memory Allocated: 0.0876474380493164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

first layer input nodes number: 137130
first layer output nodes number: 35730
edges number: 353373
----------------------------------------before model layer 0
 Nvidia-smi: 11.0115966796875 GB
    Memory Allocated: 0.06158781051635742  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([137130, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0115966796875 GB
    Memory Allocated: 0.06158781051635742  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([40, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.19695138931274414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.19695138931274414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 40, 100]), torch.Size([1, 40, 100])
----------------------------------------3
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.19698190689086914  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.1972217559814453  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 40, 100])
m.shape torch.Size([57, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.1972494125366211  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.1972494125366211  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 57, 100]), torch.Size([1, 57, 100])
----------------------------------------3
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.19729232788085938  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.19793319702148438  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 57, 100])
m.shape torch.Size([63, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.1979823112487793  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.1979823112487793  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.1980299949645996  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.199066162109375  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([134, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.19924211502075195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.19924211502075195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 134, 100]), torch.Size([1, 134, 100])
----------------------------------------3
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.1993422508239746  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.2022404670715332  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 134, 100])
m.shape torch.Size([107, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.20238971710205078  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.20238971710205078  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 107, 100]), torch.Size([1, 107, 100])
----------------------------------------3
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.2024698257446289  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.20534658432006836  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 107, 100])
m.shape torch.Size([133, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.20560407638549805  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.20560407638549805  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 133, 100]), torch.Size([1, 133, 100])
----------------------------------------3
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.2057032585144043  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.20996809005737305  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 133, 100])
m.shape torch.Size([107, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.21019792556762695  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.21019792556762695  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 107, 100]), torch.Size([1, 107, 100])
----------------------------------------3
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.21027803421020508  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.21427345275878906  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 107, 100])
m.shape torch.Size([160, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.21471023559570312  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.21471023559570312  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 160, 100]), torch.Size([1, 160, 100])
----------------------------------------3
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.2148294448852539  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.22162437438964844  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 160, 100])
m.shape torch.Size([158, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.22209453582763672  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.22209453582763672  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 158, 100]), torch.Size([1, 158, 100])
----------------------------------------3
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.2222127914428711  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1444091796875 GB
    Memory Allocated: 0.22975540161132812  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 158, 100])
m.shape torch.Size([34771, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.2752685546875 GB
    Memory Allocated: 0.35922861099243164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2752685546875 GB
    Memory Allocated: 0.35922861099243164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 34771, 100]), torch.Size([1, 34771, 100])
----------------------------------------3
 Nvidia-smi: 11.2752685546875 GB
    Memory Allocated: 0.38657236099243164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2583298683166504  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 34771, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.1252946853637695  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.159369468688965  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

h_self size  torch.Size([35730, 100])
----------------------------------------before rst
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.159369468688965  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([35730, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.19344425201416  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.159369468688965  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

torch.Size([35730, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.19344425201416  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.201962947845459  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------input nodes number: 35730
----------------output nodes number: 3161
----------------edges number: 78181
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2022533416748047  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.277522563934326  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.277522563934326  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.277524471282959  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2775397300720215  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2775421142578125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2775421142578125  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2775440216064453  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.277585983276367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2775931358337402  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2775931358337402  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.277596950531006  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.277707576751709  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2777204513549805  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2777204513549805  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.277726173400879  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2779321670532227  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2779698371887207  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2779698371887207  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2779831886291504  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.278557300567627  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.278557777404785  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.278557777404785  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.278559684753418  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2786550521850586  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.278669834136963  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.278669834136963  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2786736488342285  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.278891086578369  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.278923988342285  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.278923988342285  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2789316177368164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2794198989868164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.279445171356201  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.279445171356201  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2794508934020996  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2798571586608887  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2798967361450195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2798967361450195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.279904365539551  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2804994583129883  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2805418968200684  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2805418968200684  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2805495262145996  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.281198024749756  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.281248092651367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.281248092651367  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2812557220458984  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.282011032104492  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2820940017700195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2820940017700195  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2821054458618164  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.283318519592285  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.28334379196167  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.28334379196167  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2833476066589355  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.283778667449951  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2838587760925293  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2838587760925293  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2838683128356934  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.285012722015381  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.285059928894043  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.285059928894043  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2850656509399414  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.285792350769043  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2858262062072754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2858262062072754  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.285830020904541  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2863411903381348  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2865123748779297  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2865123748779297  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.286529541015625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.288949966430664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2890625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2890625  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.289073944091797  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2907676696777344  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.290910243988037  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.290910243988037  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.290923595428467  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2929930686950684  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2930307388305664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2930307388305664  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.293034553527832  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2936525344848633  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2937660217285156  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2937660217285156  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2937755584716797  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.2953872680664062  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3078, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.3693413734436035  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.3693413734436035  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

 h.shape torch.Size([1, 3078, 256]), torch.Size([1, 3078, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 2.375476837158203  GigaBytes
Max Memory Allocated: 3.290078639984131  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4295654296875 GB
    Memory Allocated: 3.4210519790649414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3078, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.4295654296875 GB
    Memory Allocated: 3.347228527069092  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.4295654296875 GB
    Memory Allocated: 3.3477821350097656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([3161, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4295654296875 GB
    Memory Allocated: 3.3477821350097656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4295654296875 GB
    Memory Allocated: 3.3483357429504395  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4295654296875 GB
    Memory Allocated: 3.3477821350097656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3161, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.05675029754638672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.10581254959106445  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.10583639144897461  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

first layer input nodes number: 131700
first layer output nodes number: 34789
edges number: 345684
----------------------------------------before model layer 0
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.05955982208251953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([131700, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.05955982208251953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([26, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19209575653076172  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19209575653076172  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 26, 100]), torch.Size([1, 26, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19211578369140625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19227313995361328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 26, 100])
m.shape torch.Size([34, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19228887557983398  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19228887557983398  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 34, 100]), torch.Size([1, 34, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19231462478637695  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19269800186157227  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 34, 100])
m.shape torch.Size([35, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19272470474243164  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19272470474243164  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 35, 100]), torch.Size([1, 35, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19275140762329102  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.1933302879333496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 35, 100])
m.shape torch.Size([56, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19340038299560547  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19340038299560547  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 56, 100]), torch.Size([1, 56, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19344234466552734  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19465351104736328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 56, 100])
m.shape torch.Size([61, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.1947464942932129  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.1947464942932129  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 61, 100]), torch.Size([1, 61, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.1947922706604004  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19643306732177734  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 61, 100])
m.shape torch.Size([74, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19657564163208008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19657564163208008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 74, 100]), torch.Size([1, 74, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19663095474243164  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19900941848754883  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 74, 100])
m.shape torch.Size([86, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19920635223388672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19920635223388672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 86, 100]), torch.Size([1, 86, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19927120208740234  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.2024836540222168  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 86, 100])
m.shape torch.Size([76, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.20267772674560547  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.20267772674560547  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.20273494720458984  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.20597362518310547  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([108, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.20630741119384766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.20630741119384766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.2063884735107422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.21155071258544922  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([34233, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.3390383720397949  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.3390383720397949  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 34233, 100]), torch.Size([1, 34233, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.3663821220397949  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.197510242462158  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 34233, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.067028045654297  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.100205421447754  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([34789, 100])
----------------------------------------before rst
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.100205421447754  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([34789, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.133382797241211  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.100205421447754  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([34789, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.133382797241211  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.1416773796081543  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------input nodes number: 34789
----------------output nodes number: 3162
----------------edges number: 78386
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.141960620880127  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2174253463745117  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2174253463745117  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2174291610717773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2174596786499023  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2174620628356934  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2174620628356934  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.217465877532959  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2175230979919434  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.217529296875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.217529296875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2175331115722656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2176437377929688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2176480293273926  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2176480293273926  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2176499366760254  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2177319526672363  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2177391052246094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2177391052246094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.217741012573242  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2178497314453125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([18, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2180047035217285  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2180047035217285  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.218039035797119  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.220236301422119  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.22023868560791  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.22023868560791  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.220242500305176  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.220513343811035  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.220522403717041  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.220522403717041  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.220524311065674  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.220673084259033  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2206954956054688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2206954956054688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2206993103027344  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2210235595703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.221034526824951  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.221034526824951  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.221036434173584  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2212119102478027  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2212400436401367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2212400436401367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2212438583374023  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2216482162475586  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2216620445251465  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2216620445251465  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2216639518737793  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.221879482269287  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.221895217895508  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.221895217895508  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2218971252441406  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.222126007080078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2221426963806152  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2221426963806152  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.222144603729248  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2223868370056152  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2224955558776855  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2224955558776855  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2225069999694824  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2240405082702637  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.224112033843994  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.224112033843994  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2241196632385254  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2251954078674316  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2252321243286133  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2252321243286133  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.225235939025879  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2258005142211914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2258200645446777  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2258200645446777  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2258219718933105  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2261176109313965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2261834144592285  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2261834144592285  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.226189136505127  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.227116107940674  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2272286415100098  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2272286415100098  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.227238178253174  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.2288498878479004  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3104, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.3034286499023438  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.3034286499023438  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3104, 256]), torch.Size([1, 3104, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 2.3101840019226074  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 3.3587584495544434  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3104, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 3.2844491004943848  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 3.285003185272217  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 3.285003185272217  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 3.285557270050049  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 3.285003185272217  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3162, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.054728031158447266  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.09613990783691406  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.09616231918334961  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

first layer input nodes number: 111164
first layer output nodes number: 30351
edges number: 294175
----------------------------------------before model layer 0
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.050838470458984375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([111164, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.050838470458984375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([88, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16416549682617188  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16416549682617188  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 88, 100]), torch.Size([1, 88, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.1642313003540039  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16475629806518555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 88, 100])
m.shape torch.Size([142, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16482925415039062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16482925415039062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 142, 100]), torch.Size([1, 142, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16493511199951172  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16652297973632812  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 142, 100])
m.shape torch.Size([169, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16665935516357422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16665935516357422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 169, 100]), torch.Size([1, 169, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16678619384765625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16956377029418945  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 169, 100])
m.shape torch.Size([230, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16984319686889648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.16984319686889648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 230, 100]), torch.Size([1, 230, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.1700148582458496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.1749873161315918  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 230, 100])
m.shape torch.Size([294, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.17544937133789062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.17544937133789062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 294, 100]), torch.Size([1, 294, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.17566871643066406  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.18355798721313477  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 294, 100])
m.shape torch.Size([313, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.18414831161499023  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.18414831161499023  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 313, 100]), torch.Size([1, 313, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.18438196182250977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19442033767700195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 313, 100])
m.shape torch.Size([349, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19521379470825195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19521379470825195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 349, 100]), torch.Size([1, 349, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.19547414779663086  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.2084817886352539  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 349, 100])
m.shape torch.Size([365, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.20943975448608398  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.20943975448608398  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 365, 100]), torch.Size([1, 365, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.20971250534057617  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.22522497177124023  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 365, 100])
m.shape torch.Size([345, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.22624540328979492  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.22624540328979492  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 345, 100]), torch.Size([1, 345, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.2265028953552246  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.24296951293945312  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 345, 100])
m.shape torch.Size([28056, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.34735774993896484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.34735774993896484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 28056, 100]), torch.Size([1, 28056, 100])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 0.36826133728027344  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8528776168823242  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 28056, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.7443928718566895  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.7733378410339355  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([30351, 100])
----------------------------------------before rst
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.7733378410339355  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([30351, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8022828102111816  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.7733378410339355  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([30351, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8022828102111816  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8095192909240723  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------input nodes number: 30351
----------------output nodes number: 2981
----------------edges number: 69056
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8097681999206543  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.876816749572754  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.876816749572754  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8768377304077148  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8770055770874023  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8770146369934082  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8770146369934082  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8770337104797363  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8773198127746582  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8773307800292969  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8773307800292969  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8773441314697266  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8776378631591797  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([16, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.877692699432373  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.877692699432373  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.877723217010498  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.878608226776123  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8786797523498535  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8786797523498535  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8787140846252441  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8799500465393066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.880053997039795  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.880053997039795  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.880094051361084  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8818163871765137  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8819446563720703  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8819446563720703  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8819866180419922  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.884084701538086  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8842482566833496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8842482566833496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.884294033050537  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8869032859802246  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8870882987976074  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8870882987976074  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.887134075164795  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.890063762664795  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([30, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.890329360961914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.890329360961914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8903865814208984  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.894449234008789  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.894632339477539  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.894632339477539  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8946704864501953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8976459503173828  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8978347778320312  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8978347778320312  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.8978691101074219  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.900787353515625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9010577201843262  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9010577201843262  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9011015892028809  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.905137538909912  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9054388999938965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9054388999938965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.905484676361084  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9100165367126465  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9102678298950195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9102678298950195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.910304069519043  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9141454696655273  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9144196510314941  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9144196510314941  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9144558906555176  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.918550968170166  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9188761711120605  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9188761711120605  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9189162254333496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.923722743988037  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.923996925354004  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.923996925354004  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.5057373046875 GB
    Memory Allocated: 1.9240293502807617  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5096435546875 GB
    Memory Allocated: 1.928147315979004  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.5096435546875 GB
    Memory Allocated: 1.9285330772399902  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5096435546875 GB
    Memory Allocated: 1.9285330772399902  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 12.5096435546875 GB
    Memory Allocated: 1.928575038909912  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5155029296875 GB
    Memory Allocated: 1.9341979026794434  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.5155029296875 GB
    Memory Allocated: 1.934427261352539  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5155029296875 GB
    Memory Allocated: 1.934427261352539  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 12.5155029296875 GB
    Memory Allocated: 1.9344520568847656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5194091796875 GB
    Memory Allocated: 1.937948226928711  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.5194091796875 GB
    Memory Allocated: 1.9382591247558594  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5194091796875 GB
    Memory Allocated: 1.9382591247558594  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5194091796875 GB
    Memory Allocated: 1.9382896423339844  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5252685546875 GB
    Memory Allocated: 1.9428062438964844  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.5252685546875 GB
    Memory Allocated: 1.9432353973388672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5252685546875 GB
    Memory Allocated: 1.9432353973388672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 12.5252685546875 GB
    Memory Allocated: 1.9432754516601562  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5311279296875 GB
    Memory Allocated: 1.949483871459961  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.5311279296875 GB
    Memory Allocated: 1.9499282836914062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5311279296875 GB
    Memory Allocated: 1.9499282836914062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 12.5311279296875 GB
    Memory Allocated: 1.9499683380126953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5389404296875 GB
    Memory Allocated: 1.9564571380615234  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5389404296875 GB
    Memory Allocated: 1.9568986892700195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5389404296875 GB
    Memory Allocated: 1.9568986892700195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.5389404296875 GB
    Memory Allocated: 1.9569368362426758  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5447998046875 GB
    Memory Allocated: 1.963383674621582  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([2524, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5467529296875 GB
    Memory Allocated: 2.0240116119384766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5467529296875 GB
    Memory Allocated: 2.0240116119384766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2524, 256]), torch.Size([1, 2524, 256])
----------------------------------------3
 Nvidia-smi: 12.5467529296875 GB
    Memory Allocated: 2.0288257598876953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5467529296875 GB
    Memory Allocated: 2.8791370391845703  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2524, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5467529296875 GB
    Memory Allocated: 2.8139657974243164  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5467529296875 GB
    Memory Allocated: 2.814487934112549  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 12.5467529296875 GB
    Memory Allocated: 2.814487934112549  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5467529296875 GB
    Memory Allocated: 2.8150100708007812  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.5467529296875 GB
    Memory Allocated: 2.814487934112549  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.04704427719116211  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.07696199417114258  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.07698440551757812  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

first layer input nodes number: 80309
first layer output nodes number: 25951
edges number: 251731
----------------------------------------before model layer 0
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.03873872756958008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([80309, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.03873872756958008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([78, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13520145416259766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13520145416259766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 78, 100]), torch.Size([1, 78, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13525962829589844  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1357250213623047  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 78, 100])
m.shape torch.Size([130, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13579320907592773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13579320907592773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 130, 100]), torch.Size([1, 130, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13589048385620117  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13734674453735352  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 130, 100])
m.shape torch.Size([146, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13746166229248047  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13746166229248047  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 146, 100]), torch.Size([1, 146, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1375713348388672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13997125625610352  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 146, 100])
m.shape torch.Size([190, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1401996612548828  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1401996612548828  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 190, 100]), torch.Size([1, 190, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14034175872802734  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14445114135742188  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 190, 100])
m.shape torch.Size([235, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14481782913208008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14481782913208008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 235, 100]), torch.Size([1, 235, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14499330520629883  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15130329132080078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 235, 100])
m.shape torch.Size([253, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1517810821533203  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1517810821533203  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 253, 100]), torch.Size([1, 253, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15196990966796875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1600809097290039  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 253, 100])
m.shape torch.Size([275, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1607036590576172  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1607036590576172  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 275, 100]), torch.Size([1, 275, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16090869903564453  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17116069793701172  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 275, 100])
m.shape torch.Size([281, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17189598083496094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17189598083496094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 281, 100]), torch.Size([1, 281, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1721057891845703  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1840534210205078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 281, 100])
m.shape torch.Size([301, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18495798110961914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18495798110961914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 301, 100]), torch.Size([1, 301, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18518304824829102  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19954872131347656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 301, 100])
m.shape torch.Size([24062, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.2890744209289551  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.2890744209289551  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 24062, 100]), torch.Size([1, 24062, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.30700254440307617  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5798707008361816  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 24062, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.4863052368164062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5110540390014648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([25951, 100])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5110540390014648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([25951, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5358028411865234  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5110540390014648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([25951, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5358028411865234  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5419902801513672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------input nodes number: 25951
----------------output nodes number: 2981
----------------edges number: 69804
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5422062873840332  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([14, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.609428882598877  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.609428882598877  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6094555854797363  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6096692085266113  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6096887588500977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6096887588500977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6097211837768555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6102075576782227  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6102232933044434  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6102232933044434  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6102442741394043  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.610705852508545  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6107687950134277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6107687950134277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6108050346374512  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6118559837341309  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.611905574798584  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.611905574798584  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6119322776794434  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6128935813903809  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6129727363586426  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6129727363586426  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6130032539367676  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6143155097961426  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.614455223083496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.614455223083496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6144990921020508  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6166925430297852  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.616786003112793  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.616786003112793  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6168146133422852  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6184453964233398  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6185522079467773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6185522079467773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6185789108276367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6202878952026367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6204285621643066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6204285621643066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6204590797424316  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6226258277893066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6228537559509277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6228537559509277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6228976249694824  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.626319408416748  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6265168190002441  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6265168190002441  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6265530586242676  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6296334266662598  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6298279762268066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6298279762268066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6298604011535645  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6328434944152832  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6329889297485352  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6329889297485352  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.633011817932129  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6352777481079102  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6355547904968262  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6355547904968262  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6355929374694824  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.639636516571045  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.639817714691162  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.639817714691162  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6398425102233887  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6426444053649902  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6428117752075195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6428117752075195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6428327560424805  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.645350456237793  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.645547866821289  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.645547866821289  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6455707550048828  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.648477554321289  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.648648738861084  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.648648738861084  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.648667812347412  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6512236595153809  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6514067649841309  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6514067649841309  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.651425838470459  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6541152000427246  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6544084548950195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6544084548950195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6544370651245117  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6586713790893555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6588263511657715  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6588263511657715  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.658841609954834  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6612067222595215  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.661552906036377  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.661552906036377  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.661583423614502  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.666527271270752  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6668810844421387  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6668810844421387  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6669116020202637  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6720690727233887  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([2620, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7350077629089355  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7350077629089355  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2620, 256]), torch.Size([1, 2620, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7405171394348145  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.6256370544433594  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2620, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.5593271255493164  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.559849262237549  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.559849262237549  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.5603713989257812  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.559849262237549  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.03555011749267578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.08081769943237305  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.0808415412902832  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

first layer input nodes number: 121514
first layer output nodes number: 30433
edges number: 295379
----------------------------------------before model layer 0
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.054807186126708984  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([121514, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.054807186126708984  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([83, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16799163818359375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16799163818359375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 83, 100]), torch.Size([1, 83, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16805362701416016  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1685495376586914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 83, 100])
m.shape torch.Size([138, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16862154006958008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16862154006958008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 138, 100]), torch.Size([1, 138, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16872453689575195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17026948928833008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 138, 100])
m.shape torch.Size([169, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17040729522705078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17040729522705078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 169, 100]), torch.Size([1, 169, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1705341339111328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17331171035766602  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 169, 100])
m.shape torch.Size([225, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.173583984375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.173583984375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 225, 100]), torch.Size([1, 225, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1737518310546875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.178619384765625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 225, 100])
m.shape torch.Size([266, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1790313720703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1790313720703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 266, 100]), torch.Size([1, 266, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.179229736328125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.186370849609375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 266, 100])
m.shape torch.Size([309, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18696260452270508  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18696260452270508  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 309, 100]), torch.Size([1, 309, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1871933937072754  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19710016250610352  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 309, 100])
m.shape torch.Size([342, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1978769302368164  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1978769302368164  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 342, 100]), torch.Size([1, 342, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19813251495361328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.21088171005249023  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 342, 100])
m.shape torch.Size([332, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.21186542510986328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.21186542510986328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 332, 100]), torch.Size([1, 332, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.2121133804321289  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.22622394561767578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 332, 100])
m.shape torch.Size([311, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.2271428108215332  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.2271428108215332  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 311, 100]), torch.Size([1, 311, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.22737455368041992  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.24220609664916992  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 311, 100])
m.shape torch.Size([28258, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.34735965728759766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.34735965728759766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 28258, 100]), torch.Size([1, 28258, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.3685626983642578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8635005950927734  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 28258, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7544598579406738  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7834830284118652  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([30433, 100])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7834830284118652  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([30433, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8125061988830566  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7834830284118652  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([30433, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8125061988830566  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8197622299194336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------input nodes number: 30433
----------------output nodes number: 3155
----------------edges number: 76740
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8200130462646484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8938980102539062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8938980102539062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.893899917602539  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8939151763916016  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8939204216003418  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8939204216003418  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8939261436462402  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8940119743347168  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8940238952636719  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8940238952636719  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.894033432006836  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8942432403564453  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8942618370056152  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8942618370056152  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.894273281097412  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8946051597595215  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8946332931518555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8946332931518555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8946466445922852  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.895127296447754  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8951325416564941  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8951325416564941  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8951363563537598  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8953003883361816  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8953590393066406  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8953590393066406  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.895376205444336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8962345123291016  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.896287441253662  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.896287441253662  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8963027000427246  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.897172451019287  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8972601890563965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8972601890563965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8972811698913574  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8986239433288574  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.898719310760498  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.898719310760498  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.898740291595459  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9002299308776855  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9003043174743652  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9003043174743652  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9003195762634277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9015097618103027  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.901594638824463  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.901594638824463  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9016098976135254  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.902906894683838  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9029746055603027  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9029746055603027  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9029860496520996  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.904038906097412  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9041681289672852  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9041681289672852  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9041872024536133  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9060754776000977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.906196117401123  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.906196117401123  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9062132835388184  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9080328941345215  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.908163070678711  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.908163070678711  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9081802368164062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9101200103759766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9103078842163086  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9103078842163086  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9103307723999023  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9130773544311523  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9132566452026367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9132566452026367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9132776260375977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9159421920776367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.916132926940918  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.916132926940918  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.916153907775879  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9189653396606445  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.919243335723877  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.919243335723877  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9192719459533691  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9233059883117676  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.923412799835205  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.923412799835205  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.923424243927002  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9251179695129395  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9254083633422852  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9254083633422852  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9254350662231445  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9295740127563477  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9298481941223145  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9298481941223145  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.929872989654541  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9338898658752441  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9342007637023926  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9342007637023926  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.934227466583252  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9387402534484863  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([2946, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0095882415771484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0095882415771484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2946, 256]), torch.Size([1, 2946, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.015207290649414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 3.0210342407226562  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2946, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.947957992553711  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.9485106468200684  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([3155, 256])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.9485106468200684  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3155, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.949063301086426  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.9485106468200684  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3155, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.05093193054199219  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.09006690979003906  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.09009075164794922  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

first layer input nodes number: 105052
first layer output nodes number: 32575
edges number: 322572
----------------------------------------before model layer 0
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.048811912536621094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([105052, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.048811912536621094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([30, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17237281799316406  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17237281799316406  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 30, 100]), torch.Size([1, 30, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1723957061767578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1725759506225586  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 30, 100])
m.shape torch.Size([60, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1726093292236328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1726093292236328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 60, 100]), torch.Size([1, 60, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1726541519165039  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1733264923095703  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 60, 100])
m.shape torch.Size([52, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17336225509643555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17336225509643555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 52, 100]), torch.Size([1, 52, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1734013557434082  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1742572784423828  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 52, 100])
m.shape torch.Size([75, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17434978485107422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17434978485107422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1744060516357422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17603206634521484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([104, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17619800567626953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17619800567626953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 104, 100]), torch.Size([1, 104, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17627620697021484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17906999588012695  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 104, 100])
m.shape torch.Size([111, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17927932739257812  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17927932739257812  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 111, 100]), torch.Size([1, 111, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17936229705810547  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1829214096069336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 111, 100])
m.shape torch.Size([96, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18313026428222656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18313026428222656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 96, 100]), torch.Size([1, 96, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18320178985595703  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18677806854248047  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 96, 100])
m.shape torch.Size([113, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18707942962646484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18707942962646484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.187164306640625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19197940826416016  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([136, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19239330291748047  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19239330291748047  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 136, 100]), torch.Size([1, 136, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19249534606933594  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19898748397827148  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 136, 100])
m.shape torch.Size([31798, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.31739330291748047  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.31739330291748047  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 31798, 100]), torch.Size([1, 31798, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.34108543395996094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.023183822631836  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 31798, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9026904106140137  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9337563514709473  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([32575, 100])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9337563514709473  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([32575, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9648222923278809  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9337563514709473  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([32575, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9648222923278809  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9725890159606934  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------input nodes number: 32575
----------------output nodes number: 3159
----------------edges number: 78140
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.972855567932129  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0481081008911133  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0481081008911133  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.04813289642334  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0485048294067383  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0485005378723145  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0485005378723145  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.04850435256958  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.048614978790283  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0486326217651367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0486326217651367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.048640251159668  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.048914909362793  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.048945903778076  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.048945903778076  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.048957347869873  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0494494438171387  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.049457550048828  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.049457550048828  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0494613647460938  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.049652099609375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0496582984924316  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0496582984924316  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0496602058410645  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0497689247131348  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.049777030944824  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.049777030944824  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.049778938293457  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.049901008605957  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.049929141998291  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.049929141998291  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0499348640441895  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0503411293029785  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0503597259521484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0503597259521484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.050363540649414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.050661087036133  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.050693988800049  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.050693988800049  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0506997108459473  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0511860847473145  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.051210403442383  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.051210403442383  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0512142181396484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0515918731689453  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.051619052886963  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.051619052886963  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0516228675842285  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0520272254943848  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0520410537719727  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0520410537719727  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0520429611206055  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0522584915161133  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.052274227142334  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.052274227142334  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.052276134490967  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0525050163269043  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0525217056274414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0525217056274414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.052523612976074  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0527658462524414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0528016090393066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0528016090393066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0528054237365723  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.053316593170166  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0533533096313477  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0533533096313477  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0533571243286133  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0538949966430664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.053933620452881  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.053933620452881  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0539374351501465  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.054502010345459  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0546274185180664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0546274185180664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0546388626098633  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.056412696838379  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0564513206481934  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0564513206481934  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.056455135345459  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0570731163024902  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0570945739746094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0570945739746094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.057096481323242  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0574188232421875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3100, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.132214069366455  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.132214069366455  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3100, 256]), torch.Size([1, 3100, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.1390109062194824  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 3.192225456237793  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3100, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 3.117672920227051  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 3.1182260513305664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([3159, 256])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 3.1182260513305664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3159, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 3.118779182434082  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 3.1182260513305664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3159, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.0447998046875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.07644033432006836  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.07646322250366211  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

first layer input nodes number: 84934
first layer output nodes number: 29784
edges number: 290170
----------------------------------------before model layer 0
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.04085683822631836  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([84934, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.04085683822631836  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([48, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15293645858764648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15293645858764648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15297269821166992  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1532597541809082  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([92, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15331029891967773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15331029891967773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 92, 100]), torch.Size([1, 92, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15337896347045898  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15440893173217773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 92, 100])
m.shape torch.Size([144, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15453577041625977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15453577041625977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 144, 100]), torch.Size([1, 144, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15464353561401367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15700578689575195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 144, 100])
m.shape torch.Size([179, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15721893310546875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15721893310546875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 179, 100]), torch.Size([1, 179, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15735244750976562  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.161224365234375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 179, 100])
m.shape torch.Size([254, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16163110733032227  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16163110733032227  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 254, 100]), torch.Size([1, 254, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1618208885192871  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1686387062072754  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 254, 100])
m.shape torch.Size([289, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1691899299621582  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1691899299621582  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 289, 100]), torch.Size([1, 289, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16940546035766602  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17867326736450195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 289, 100])
m.shape torch.Size([317, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17939233779907227  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17939233779907227  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 317, 100]), torch.Size([1, 317, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17962884902954102  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19144439697265625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 317, 100])
m.shape torch.Size([341, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19234275817871094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19234275817871094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 341, 100]), torch.Size([1, 341, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1925973892211914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.20708847045898438  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 341, 100])
m.shape torch.Size([361, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.20817184448242188  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.20817184448242188  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 361, 100]), torch.Size([1, 361, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.20844173431396484  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.2256760597229004  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 361, 100])
m.shape torch.Size([27759, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.3289518356323242  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.3289518356323242  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 27759, 100]), torch.Size([1, 27759, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.34963417053222656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8180656433105469  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 27759, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.71140718460083  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7398114204406738  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([29784, 100])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7398114204406738  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([29784, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7682156562805176  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7398114204406738  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([29784, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7682156562805176  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7753167152404785  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------input nodes number: 29784
----------------output nodes number: 3053
----------------edges number: 71757
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.775561809539795  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8446555137634277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8446555137634277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8446688652038574  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.844775676727295  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8447866439819336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8447866439819336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.844803810119629  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8450613021850586  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([19, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8451075553894043  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8451075553894043  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8451437950134277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8459410667419434  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8459806442260742  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8459806442260742  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8460092544555664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8468389511108398  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8468823432922363  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8468823432922363  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.84690523147583  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.847729206085205  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8478217124938965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8478217124938965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.847856044769287  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.849332332611084  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8494162559509277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8494162559509277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.84944486618042  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8508753776550293  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8509998321533203  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8509998321533203  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.851034164428711  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8529911041259766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8531298637390137  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8531298637390137  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8531641960144043  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8553614616394043  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([10, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.855440616607666  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.855440616607666  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8554596900939941  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.856813907623291  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([17, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8569841384887695  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8569841384887695  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8570165634155273  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8595457077026367  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8597025871276855  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8597025871276855  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8597311973571777  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8621630668640137  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.862349033355713  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.862349033355713  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.862379550933838  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.865187168121338  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.865400791168213  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.865400791168213  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8654332160949707  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8686432838439941  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8689155578613281  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8689155578613281  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8689537048339844  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8729972839355469  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8732857704162598  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8732857704162598  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.873323917388916  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8776345252990723  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8779096603393555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8779096603393555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.877943992614746  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.882063865661621  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8823585510253906  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8823585510253906  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8823928833007812  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8867530822753906  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8872838020324707  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8872838020324707  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.887341022491455  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8950085639953613  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.895268440246582  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.895268440246582  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8952970504760742  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8993310928344727  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8995389938354492  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8995389938354492  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8995599746704102  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.902665138244629  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9030356407165527  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9030356407165527  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9030699729919434  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9083914756774902  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9087281227111816  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9087281227111816  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9087586402893066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9137024879455566  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9140796661376953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9140796661376953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9141120910644531  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9195919036865234  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([2664, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9835867881774902  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9835867881774902  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2664, 256]), torch.Size([1, 2664, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9890189170837402  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.9069113731384277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2664, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.838414192199707  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.838949203491211  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([3053, 256])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.838949203491211  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3053, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.839484214782715  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.838949203491211  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3053, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.03728628158569336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.06482791900634766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.0648503303527832  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

first layer input nodes number: 73931
first layer output nodes number: 24401
edges number: 237089
----------------------------------------before model layer 0
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.036210060119628906  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([73931, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.036210060119628906  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([37, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.12704896926879883  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.12704896926879883  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 37, 100]), torch.Size([1, 37, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1270766258239746  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.12729787826538086  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 37, 100])
m.shape torch.Size([76, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.12734079360961914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.12734079360961914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.12739801406860352  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1282505989074707  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([117, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.12835311889648438  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.12835311889648438  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 117, 100]), torch.Size([1, 117, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.12844085693359375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13036251068115234  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 117, 100])
m.shape torch.Size([144, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13053321838378906  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13053321838378906  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 144, 100]), torch.Size([1, 144, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13064098358154297  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.13375473022460938  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 144, 100])
m.shape torch.Size([227, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1341238021850586  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1341238021850586  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 227, 100]), torch.Size([1, 227, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1342935562133789  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14039039611816406  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 227, 100])
m.shape torch.Size([275, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14092063903808594  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14092063903808594  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 275, 100]), torch.Size([1, 275, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14112567901611328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14994239807128906  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 275, 100])
m.shape torch.Size([334, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1507110595703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1507110595703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 334, 100]), torch.Size([1, 334, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15095996856689453  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1634054183959961  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 334, 100])
m.shape torch.Size([353, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16433334350585938  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16433334350585938  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 353, 100]), torch.Size([1, 353, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1645965576171875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17959976196289062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 353, 100])
m.shape torch.Size([354, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18065547943115234  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18065547943115234  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 354, 100]), torch.Size([1, 354, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18091964721679688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1978135108947754  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 354, 100])
m.shape torch.Size([22484, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.28144121170043945  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.28144121170043945  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 22484, 100]), torch.Size([1, 22484, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.29819345474243164  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.4875884056091309  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 22484, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.3995165824890137  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.4227871894836426  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([24401, 100])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.4227871894836426  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([24401, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.4460577964782715  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.4227871894836426  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([24401, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.4460577964782715  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.4522509574890137  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------input nodes number: 24401
----------------output nodes number: 2981
----------------edges number: 70050
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.4524555206298828  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5199050903320312  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5199050903320312  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5199127197265625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5199737548828125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5199761390686035  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5199761390686035  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.519981861114502  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5200676918029785  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.520085334777832  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.520085334777832  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5200986862182617  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5203924179077148  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5204243659973145  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5204243659973145  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5204434394836426  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5209965705871582  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([20, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5210833549499512  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5210833549499512  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5211215019226074  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5224947929382324  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5225911140441895  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5225911140441895  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5226292610168457  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5242695808410645  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.52437162399292  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.52437162399292  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5244059562683105  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5261225700378418  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.526259422302246  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.526259422302246  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5262975692749023  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5284719467163086  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5285568237304688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5285568237304688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5285797119140625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5300445556640625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([25, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5302734375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5302734375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5303211212158203  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5337066650390625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5338101387023926  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5338101387023926  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5338330268859863  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5356183052062988  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5357685089111328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5357685089111328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5357952117919922  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.538064956665039  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([28, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5384016036987305  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5384016036987305  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5384550094604492  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5433683395385742  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5436110496520996  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5436110496520996  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5436491966247559  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5474257469177246  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5477094650268555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5477094650268555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5477495193481445  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5519952774047852  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.552206039428711  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.552206039428711  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5522346496582031  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5554676055908203  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5559272766113281  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5559272766113281  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5559825897216797  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5626201629638672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5629558563232422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5629558563232422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5629959106445312  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5680828094482422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5683188438415527  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5683188438415527  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.568345546722412  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5719237327575684  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5720834732055664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5720834732055664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5721006393432617  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5745210647583008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5749163627624512  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5749163627624512  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5749545097351074  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5806002616882324  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5809197425842285  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5809197425842285  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5809502601623535  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5856804847717285  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5859527587890625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5859527587890625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.585977554321289  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5899944305419922  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5904898643493652  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.5904898643493652  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.590531826019287  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.597623348236084  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([2588, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6597871780395508  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6597871780395508  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2588, 256]), torch.Size([1, 2588, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.665043830871582  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.552888870239258  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2588, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.4863743782043457  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.486896514892578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.486896514892578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.4874186515808105  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.486896514892578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.03317403793334961  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.06655550003051758  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.06657838821411133  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

first layer input nodes number: 89607
first layer output nodes number: 28047
edges number: 272687
----------------------------------------before model layer 0
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.04245901107788086  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([89607, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.04245901107788086  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([64, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14748573303222656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14748573303222656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14753341674804688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14791488647460938  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([143, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14799785614013672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14799785614013672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 143, 100]), torch.Size([1, 143, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14810466766357422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1497039794921875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 143, 100])
m.shape torch.Size([148, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14981603622436523  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14981603622436523  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 148, 100]), torch.Size([1, 148, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.14992666244506836  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15235614776611328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 148, 100])
m.shape torch.Size([180, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15256929397583008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15256929397583008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 180, 100]), torch.Size([1, 180, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15270376205444336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15659761428833008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 180, 100])
m.shape torch.Size([216, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15693283081054688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15693283081054688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 216, 100]), torch.Size([1, 216, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.15709400177001953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1628890037536621  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 216, 100])
m.shape torch.Size([273, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16341876983642578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16341876983642578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 273, 100]), torch.Size([1, 273, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.16362285614013672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17238140106201172  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 273, 100])
m.shape torch.Size([269, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17298126220703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17298126220703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 269, 100]), torch.Size([1, 269, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17318248748779297  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1832137107849121  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 269, 100])
m.shape torch.Size([326, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18408489227294922  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18408489227294922  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 326, 100]), torch.Size([1, 326, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1843280792236328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19817829132080078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 326, 100])
m.shape torch.Size([316, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19911623001098633  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19911623001098633  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 316, 100]), torch.Size([1, 316, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19935178756713867  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.21442747116088867  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 316, 100])
m.shape torch.Size([26112, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.31158447265625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.31158447265625  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 26112, 100]), torch.Size([1, 26112, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.3310394287109375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.71234130859375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 26112, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6109466552734375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6376943588256836  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([28047, 100])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6376943588256836  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([28047, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6644420623779297  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6376943588256836  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([28047, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6644420623779297  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6711292266845703  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------input nodes number: 28047
----------------output nodes number: 3061
----------------edges number: 71798
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.6713614463806152  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.740499496459961  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.740499496459961  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7405204772949219  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7406883239746094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7407050132751465  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7407050132751465  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7407317161560059  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7411322593688965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.741170883178711  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.741170883178711  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7412052154541016  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7419605255126953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7420129776000977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7420129776000977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7420473098754883  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7430429458618164  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.743098258972168  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.743098258972168  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7431268692016602  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.744156837463379  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.744246482849121  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.744246482849121  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7442808151245117  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7457571029663086  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7458610534667969  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7458610534667969  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7458953857421875  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7476119995117188  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.747779369354248  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.747779369354248  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7478251457214355  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.750434398651123  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.750558853149414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.750558853149414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7505912780761719  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7526664733886719  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7526984214782715  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7526984214782715  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7527079582214355  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.753385066986084  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([22, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.753612995147705  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.753612995147705  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.753654956817627  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7569279670715332  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7570457458496094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7570457458496094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7570686340332031  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7590141296386719  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.759152889251709  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.759152889251709  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7591757774353027  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7612814903259277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7614989280700684  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7614989280700684  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7615313529968262  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7647414207458496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7649273872375488  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7649273872375488  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7649540901184082  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.767784595489502  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7680020332336426  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7680020332336426  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7680306434631348  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.771263599395752  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.771592617034912  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.771592617034912  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7716326713562012  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7764391899108887  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7766790390014648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7766790390014648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.776707649230957  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7803411483764648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7806191444396973  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7806191444396973  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7806496620178223  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7847390174865723  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7850313186645508  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7850313186645508  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7850618362426758  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7893648147583008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7895917892456055  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7895917892456055  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7896146774291992  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7930021286010742  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7932448387145996  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7932448387145996  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7932677268981934  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7968153953552246  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7971138954162598  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7971138954162598  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.7971405982971191  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.801466464996338  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8017992973327637  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8017992973327637  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8018279075622559  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8066630363464355  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([2690, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8712844848632812  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8712844848632812  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2690, 256]), torch.Size([1, 2690, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8764152526855469  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.798096179962158  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2690, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.729184627532959  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.7297205924987793  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([3061, 256])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.7297205924987793  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3061, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.7302565574645996  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.7297205924987793  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([3061, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.039028167724609375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.08073139190673828  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.08075380325317383  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

first layer input nodes number: 111946
first layer output nodes number: 32192
edges number: 316506
----------------------------------------before model layer 0
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.05131816864013672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([111946, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.05131816864013672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([40, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17256689071655273  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17256689071655273  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 40, 100]), torch.Size([1, 40, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17259740829467773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1728372573852539  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 40, 100])
m.shape torch.Size([80, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1728816032409668  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1728816032409668  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 80, 100]), torch.Size([1, 80, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1729416847229004  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17383718490600586  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 80, 100])
m.shape torch.Size([105, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17392492294311523  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17392492294311523  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 105, 100]), torch.Size([1, 105, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17400407791137695  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17573261260986328  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 105, 100])
m.shape torch.Size([146, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17591094970703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17591094970703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 146, 100]), torch.Size([1, 146, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17602062225341797  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1791839599609375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 146, 100])
m.shape torch.Size([172, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17944955825805664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17944955825805664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 172, 100]), torch.Size([1, 172, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.17957830429077148  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18419885635375977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 172, 100])
m.shape torch.Size([178, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18453264236450195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18453264236450195  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 178, 100]), torch.Size([1, 178, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.18466615676879883  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19038152694702148  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 178, 100])
m.shape torch.Size([200, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19083642959594727  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19083642959594727  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 200, 100]), torch.Size([1, 200, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19098615646362305  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1984424591064453  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 200, 100])
m.shape torch.Size([198, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1989579200744629  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.1989579200744629  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 198, 100]), torch.Size([1, 198, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.19910573959350586  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.2075200080871582  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 198, 100])
m.shape torch.Size([235, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.20823431015014648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.20823431015014648  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 235, 100]), torch.Size([1, 235, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.20840978622436523  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.21962738037109375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 235, 100])
m.shape torch.Size([30838, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.33442020416259766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.33442020416259766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 30838, 100]), torch.Size([1, 30838, 100])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.35785770416259766  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9942398071289062  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 30838, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.8757648468017578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9064655303955078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([32192, 100])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9064655303955078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([32192, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9371662139892578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9064655303955078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([32192, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9371662139892578  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.9448413848876953  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------input nodes number: 32192
----------------output nodes number: 2981
----------------edges number: 71875
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 1.945103645324707  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014308452606201  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014308452606201  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014312267303467  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014342784881592  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014352798461914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014352798461914  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014364242553711  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014535903930664  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014556407928467  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014556407928467  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014573574066162  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.014951229095459  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([17, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0150084495544434  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0150084495544434  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.015040874481201  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0159811973571777  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0160226821899414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0160226821899414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.016045570373535  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.01686954498291  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0169100761413574  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0169100761413574  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0169272422790527  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.017665386199951  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0177245140075684  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0177245140075684  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0177435874938965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0186972618103027  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.018772602081299  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.018772602081299  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0187935829162598  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.019989490509033  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.020057201385498  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.020057201385498  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0200743675231934  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0211730003356934  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.021279811859131  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.021279811859131  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0213027000427246  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.022927761077881  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.023001194000244  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.023001194000244  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0230164527893066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0242066383361816  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.024291515350342  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.024291515350342  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0243067741394043  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.025603771209717  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0256714820861816  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0256714820861816  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0256829261779785  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.026735782623291  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0268378257751465  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0268378257751465  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.026853084564209  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0283637046813965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.028442859649658  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.028442859649658  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.028454303741455  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.029667377471924  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0297389030456543  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0297389030456543  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0297484397888184  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0308260917663574  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.03096866607666  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.03096866607666  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0309858322143555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.033045768737793  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0331759452819824  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0331759452819824  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.033191204071045  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0351290702819824  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0352859497070312  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0352859497070312  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0353031158447266  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0376033782958984  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.037806510925293  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.037806510925293  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.037827491760254  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.040785789489746  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0409774780273438  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0409774780273438  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.040996551513672  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0438194274902344  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0439791679382324  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0439791679382324  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.043994426727295  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0463595390319824  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0465288162231445  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0465288162231445  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.046544075012207  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.049015998840332  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0492162704467773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0492162704467773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0492334365844727  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.0521345138549805  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2771, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.119048595428467  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.119048595428467  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2771, 256]), torch.Size([1, 2771, 256])
----------------------------------------3
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.1243338584899902  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 3.0664172172546387  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2771, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.9984169006347656  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.998939037322998  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.998939037322998  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.9994611740112305  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 2.998939037322998  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.04733562469482422  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.10109519958496094  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.10111856460571289  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

first layer input nodes number: 144309
first layer output nodes number: 37239
edges number: 369217
----------------------------------------before model layer 0
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.06407499313354492  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([144309, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.5506591796875 GB
    Memory Allocated: 0.06407499313354492  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([37, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20550012588500977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20550012588500977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 37, 100]), torch.Size([1, 37, 100])
----------------------------------------3
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20552778244018555  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2057490348815918  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 37, 100])
m.shape torch.Size([46, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20576953887939453  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20576953887939453  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 46, 100]), torch.Size([1, 46, 100])
----------------------------------------3
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20580387115478516  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20631885528564453  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 46, 100])
m.shape torch.Size([64, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2063732147216797  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2063732147216797  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2064208984375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20746994018554688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([65, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20754337310791016  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20754337310791016  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 65, 100]), torch.Size([1, 65, 100])
----------------------------------------3
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20759201049804688  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.20900249481201172  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 65, 100])
m.shape torch.Size([101, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2091665267944336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2091665267944336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 101, 100]), torch.Size([1, 101, 100])
----------------------------------------3
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2092418670654297  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.21195411682128906  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 101, 100])
m.shape torch.Size([103, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.21214675903320312  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.21214675903320312  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 103, 100]), torch.Size([1, 103, 100])
----------------------------------------3
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.21222400665283203  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2155284881591797  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 103, 100])
m.shape torch.Size([113, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.21578454971313477  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.21578454971313477  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.21586942672729492  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2200932502746582  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([122, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2204146385192871  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2204146385192871  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 122, 100]), torch.Size([1, 122, 100])
----------------------------------------3
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2205061912536621  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.22570180892944336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 122, 100])
m.shape torch.Size([134, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2261056900024414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.2261056900024414  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 134, 100]), torch.Size([1, 134, 100])
----------------------------------------3
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.22620582580566406  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.6893310546875 GB
    Memory Allocated: 0.23260164260864258  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 134, 100])
m.shape torch.Size([36454, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.8260498046875 GB
    Memory Allocated: 0.36927032470703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.8260498046875 GB
    Memory Allocated: 0.36927032470703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 36454, 100]), torch.Size([1, 36454, 100])
----------------------------------------3
 Nvidia-smi: 12.8260498046875 GB
    Memory Allocated: 0.39661407470703125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3310532569885254  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 36454, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.1929173469543457  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.228431224822998  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

h_self size  torch.Size([37239, 100])
----------------------------------------before rst
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.228431224822998  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([37239, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.2639451026916504  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.228431224822998  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

torch.Size([37239, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.2639451026916504  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.2728238105773926  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------input nodes number: 37239
----------------output nodes number: 3116
----------------edges number: 77530
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.2731246948242188  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.347768783569336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.347768783569336  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3477745056152344  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.347940444946289  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.347947597503662  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.347947597503662  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3479514122009277  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3480887413024902  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348102569580078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348102569580078  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3481063842773438  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3483238220214844  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348331928253174  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348331928253174  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3483338356018066  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3484692573547363  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348480224609375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348480224609375  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348482131958008  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348644256591797  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348693370819092  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348693370819092  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.348701000213623  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.349402904510498  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.34942626953125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.34942626953125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3494300842285156  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3498077392578125  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.34983491897583  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.34983491897583  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3498387336730957  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.350243091583252  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.350287437438965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.350287437438965  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3502931594848633  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3509397506713867  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3509535789489746  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3509535789489746  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3509554862976074  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.351184368133545  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3512353897094727  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3512353897094727  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.351241111755371  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3519678115844727  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.352019786834717  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.352019786834717  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3520255088806152  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.352792263031006  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.352847099304199  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.352847099304199  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3528528213500977  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3536596298217773  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3537778854370117  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3537778854370117  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3537893295288086  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.355483055114746  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3555235862731934  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3555235862731934  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.355527400970459  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.3561720848083496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3078, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.430129051208496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.430129051208496  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

 h.shape torch.Size([1, 3078, 256]), torch.Size([1, 3078, 256])
----------------------------------------3
 Nvidia-smi: 13.5643310546875 GB
    Memory Allocated: 2.435999870300293  GigaBytes
Max Memory Allocated: 3.4952707290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.48150634765625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3078, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.4075236320495605  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.408069610595703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([3116, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.408069610595703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3116, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.4086155891418457  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.408069610595703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3116, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.059416770935058594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.10854625701904297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.10856914520263672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 131880
first layer output nodes number: 32648
edges number: 320998
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05941438674926758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([131880, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05941438674926758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([41, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18238449096679688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18238449096679688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 41, 100]), torch.Size([1, 41, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18241596221923828  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1826634407043457  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 41, 100])
m.shape torch.Size([84, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1827106475830078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1827106475830078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 84, 100]), torch.Size([1, 84, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18277359008789062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1837148666381836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 84, 100])
m.shape torch.Size([104, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18379974365234375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18379974365234375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 104, 100]), torch.Size([1, 104, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18387794494628906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18558549880981445  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 104, 100])
m.shape torch.Size([146, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18576431274414062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18576431274414062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 146, 100]), torch.Size([1, 146, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18587398529052734  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18903732299804688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 146, 100])
m.shape torch.Size([163, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1892862319946289  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1892862319946289  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 163, 100]), torch.Size([1, 163, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1894083023071289  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1937885284423828  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 163, 100])
m.shape torch.Size([192, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19415664672851562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19415664672851562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 192, 100]), torch.Size([1, 192, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19429969787597656  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20045089721679688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 192, 100])
m.shape torch.Size([194, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20088529586791992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20088529586791992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 194, 100]), torch.Size([1, 194, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20103025436401367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2082681655883789  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 194, 100])
m.shape torch.Size([223, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2088603973388672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2088603973388672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 223, 100]), torch.Size([1, 223, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20902729034423828  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.218505859375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 223, 100])
m.shape torch.Size([226, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21918058395385742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21918058395385742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 226, 100]), torch.Size([1, 226, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21934938430786133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.23013973236083984  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 226, 100])
m.shape torch.Size([31275, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.34656381607055664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.34656381607055664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 31275, 100]), torch.Size([1, 31275, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.37000131607055664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0259242057800293  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 31275, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9061012268066406  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9372367858886719  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([32648, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9372367858886719  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([32648, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9683723449707031  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9372367858886719  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([32648, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9683723449707031  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9768638610839844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 32648
----------------output nodes number: 3036
----------------edges number: 74304
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.97713041305542  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0486741065979004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0486741065979004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0486817359924316  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0487427711486816  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0487451553344727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0487451553344727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.048750877380371  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0488367080688477  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.048840045928955  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.048840045928955  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0488438606262207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0489277839660645  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.048933982849121  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.048933982849121  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0489377975463867  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.04904842376709  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0490660667419434  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0490660667419434  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0490736961364746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0493483543395996  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.049367904663086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.049367904663086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.049375534057617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.049703598022461  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.049760341644287  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.049760341644287  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0497775077819824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.050635814666748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.050665855407715  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.050665855407715  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.050675392150879  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0512189865112305  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.051257610321045  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.051257610321045  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.051267147064209  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.051877498626709  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.051940441131592  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.051940441131592  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0519537925720215  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0529017448425293  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.052990436553955  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.052990436553955  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0530076026916504  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0543465614318848  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0544075965881348  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0544075965881348  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0544190406799316  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.055391788482666  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0554986000061035  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0554986000061035  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.055515766143799  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0570950508117676  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.057140350341797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.057140350341797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.057147979736328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.057903289794922  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0580148696899414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0580148696899414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.058030128479004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.059647560119629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.059762954711914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.059762954711914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0597782135009766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.061502456665039  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.06156063079834  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.06156063079834  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.061568260192871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.062483787536621  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0625839233398438  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0625839233398438  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0625953674316406  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0640487670898438  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.064171314239502  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.064171314239502  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0641846656799316  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0659737586975098  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0661211013793945  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0661211013793945  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.066136360168457  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0682878494262695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0684218406677246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0684218406677246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0684351921081543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.070411205291748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0707221031188965  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0707221031188965  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0707507133483887  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0751852989196777  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0752816200256348  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0752816200256348  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.075291156768799  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.076836109161377  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0770621299743652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0770621299743652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0770812034606934  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0803046226501465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2885, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.149616241455078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.149616241455078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2885, 256]), torch.Size([1, 2885, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1553945541381836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.146815776824951  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2885, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.075864791870117  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0763964653015137  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([3036, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0763964653015137  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3036, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.07692813873291  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0763964653015137  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3036, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05477190017700195  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.09679937362670898  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.09682178497314453  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 112816
first layer output nodes number: 33750
edges number: 335816
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05182218551635742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([112816, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05182218551635742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([16, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18044519424438477  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18044519424438477  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 16, 100]), torch.Size([1, 16, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18045759201049805  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18055391311645508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 16, 100])
m.shape torch.Size([33, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.180572509765625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.180572509765625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 33, 100]), torch.Size([1, 33, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18059730529785156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18096923828125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 33, 100])
m.shape torch.Size([30, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18099069595336914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18099069595336914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 30, 100]), torch.Size([1, 30, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1810135841369629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18150854110717773  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 30, 100])
m.shape torch.Size([41, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18155860900878906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18155860900878906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 41, 100]), torch.Size([1, 41, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18159008026123047  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18248558044433594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 41, 100])
m.shape torch.Size([45, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18255376815795898  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18255376815795898  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 45, 100]), torch.Size([1, 45, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1825881004333496  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18380260467529297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 45, 100])
m.shape torch.Size([56, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18391084671020508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18391084671020508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 56, 100]), torch.Size([1, 56, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18395280838012695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18574857711791992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 56, 100])
m.shape torch.Size([58, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18587923049926758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18587923049926758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 58, 100]), torch.Size([1, 58, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18592309951782227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1880965232849121  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 58, 100])
m.shape torch.Size([68, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1882772445678711  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1882772445678711  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 68, 100]), torch.Size([1, 68, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18832874298095703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19122982025146484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 68, 100])
m.shape torch.Size([61, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19140863418579102  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19140863418579102  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 61, 100]), torch.Size([1, 61, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19145441055297852  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19437122344970703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 61, 100])
m.shape torch.Size([33342, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3193483352661133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3193483352661133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 33342, 100]), torch.Size([1, 33342, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3441905975341797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1079626083374023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 33342, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9823756217956543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0145621299743652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([33750, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0145621299743652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([33750, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.046748638153076  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0145621299743652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([33750, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.046748638153076  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.054795265197754  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 33750
----------------output nodes number: 2998
----------------edges number: 74820
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0550694465637207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.128006935119629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.128006935119629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1280107498168945  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1281747817993164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1281800270080566  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1281800270080566  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1281819343566895  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.12827730178833  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.128297805786133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.128297805786133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1283016204833984  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.128599166870117  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1286091804504395  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1286091804504395  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1286110877990723  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1287732124328613  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1288013458251953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1288013458251953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.128805160522461  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.129209518432617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1292271614074707  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1292271614074707  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1292290687561035  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.12949800491333  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1295175552368164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1295175552368164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.129519462585449  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1298017501831055  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.129845142364502  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.129845142364502  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1298489570617676  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.130466938018799  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2986, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.2022132873535156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.2022132873535156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2986, 256]), torch.Size([1, 2986, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.2082910537719727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.2289624214172363  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2986, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.156460762023926  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.1569857597351074  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([2998, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.1569857597351074  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([2998, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.157510757446289  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.1569857597351074  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([2998, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.04766273498535156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.09064388275146484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.0906667709350586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 115376
first layer output nodes number: 32247
edges number: 317018
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05262947082519531  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([115376, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05262947082519531  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([42, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17407560348510742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17407560348510742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 42, 100]), torch.Size([1, 42, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17410707473754883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17435884475708008  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 42, 100])
m.shape torch.Size([65, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1743917465209961  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1743917465209961  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 65, 100]), torch.Size([1, 65, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1744403839111328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1751699447631836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 65, 100])
m.shape torch.Size([97, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17525434494018555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17525434494018555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 97, 100]), torch.Size([1, 97, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17532682418823242  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17692136764526367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 97, 100])
m.shape torch.Size([137, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17708969116210938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17708969116210938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 137, 100]), torch.Size([1, 137, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17719268798828125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1801624298095703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 137, 100])
m.shape torch.Size([197, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18047809600830078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18047809600830078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 197, 100]), torch.Size([1, 197, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18062496185302734  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1859121322631836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 197, 100])
m.shape torch.Size([186, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18625450134277344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18625450134277344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 186, 100]), torch.Size([1, 186, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18639373779296875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19236373901367188  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 186, 100])
m.shape torch.Size([225, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19288110733032227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19288110733032227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 225, 100]), torch.Size([1, 225, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19304895401000977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20144128799438477  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 225, 100])
m.shape torch.Size([226, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20203113555908203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20203113555908203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 226, 100]), torch.Size([1, 226, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20219993591308594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21181011199951172  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 226, 100])
m.shape torch.Size([197, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2123866081237793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2123866081237793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 197, 100]), torch.Size([1, 197, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21253347396850586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.22193288803100586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 197, 100])
m.shape torch.Size([30875, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.33687782287597656  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.33687782287597656  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 30875, 100]), torch.Size([1, 30875, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.36031532287597656  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.998356819152832  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 30875, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8797249794006348  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.910478115081787  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([32247, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.910478115081787  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([32247, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9412312507629395  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.910478115081787  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([32247, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9412312507629395  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9489197731018066  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 32247
----------------output nodes number: 3016
----------------edges number: 73759
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9491829872131348  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.020200252532959  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.020200252532959  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0202040672302246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0202345848083496  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0202407836914062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0202407836914062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0202484130859375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0203628540039062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0203680992126465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0203680992126465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.020373821258545  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0204997062683105  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.020512580871582  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.020512580871582  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0205202102661133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0207414627075195  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0207715034484863  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0207715034484863  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.020784854888916  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0212655067443848  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.021282196044922  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.021282196044922  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.021289825439453  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.021617889404297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.021667957305908  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.021667957305908  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0216832160949707  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0224461555480957  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0224924087524414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0224924087524414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.022505760192871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0232667922973633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0233383178710938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0233383178710938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.023355484008789  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.024454116821289  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0245132446289062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0245132446289062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.024526596069336  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0254745483398438  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.025552749633789  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.025552749633789  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0255680084228516  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0267581939697266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.026796817779541  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.026796817779541  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0268044471740723  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0274529457092285  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.027561664581299  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.027561664581299  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.027578830718994  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.029158115386963  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0291900634765625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0291900634765625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.029195785522461  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0297622680664062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0298895835876465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0298895835876465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.029906749725342  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.031726360321045  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.031764030456543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.031764030456543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0317697525024414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.032416343688965  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0325279235839844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0325279235839844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.032541275024414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0341434478759766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0342063903808594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0342063903808594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0342140197753906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0351829528808594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.035252571105957  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.035252571105957  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0352602005004883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.036282539367676  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0363364219665527  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0363364219665527  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.036342144012451  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.037148952484131  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0373077392578125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0373077392578125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.037322998046875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.039581298828125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.039721965789795  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.039721965789795  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0397353172302246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.041804790496826  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0419750213623047  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0419750213623047  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.041990280151367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.044462203979492  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0446624755859375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0446624755859375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.044679641723633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0475807189941406  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2875, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1166534423828125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1166534423828125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2875, 256]), torch.Size([1, 2875, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1221370697021484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.111776351928711  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2875, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.041290760040283  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0418190956115723  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([3016, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0418190956115723  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3016, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0423474311828613  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0418190956115723  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3016, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.04862022399902344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.09610366821289062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.09612607955932617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 127462
first layer output nodes number: 30824
edges number: 301111
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05709028244018555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([127462, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05709028244018555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([52, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17245197296142578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17245197296142578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 52, 100]), torch.Size([1, 52, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17249107360839844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17280244827270508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 52, 100])
m.shape torch.Size([99, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17285680770874023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17285680770874023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 99, 100]), torch.Size([1, 99, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17293119430541992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1740412712097168  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 99, 100])
m.shape torch.Size([157, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1741795539855957  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1741795539855957  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 157, 100]), torch.Size([1, 157, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17429685592651367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17687320709228516  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 157, 100])
m.shape torch.Size([181, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17708444595336914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17708444595336914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 181, 100]), torch.Size([1, 181, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17721986770629883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1811356544494629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 181, 100])
m.shape torch.Size([211, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18146133422851562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18146133422851562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 211, 100]), torch.Size([1, 211, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18161869049072266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18728351593017578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 211, 100])
m.shape torch.Size([221, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1876988410949707  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1876988410949707  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 221, 100]), torch.Size([1, 221, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18786382675170898  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19494962692260742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 221, 100])
m.shape torch.Size([307, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19566774368286133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19566774368286133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 307, 100]), torch.Size([1, 307, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19589662551879883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20734071731567383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 307, 100])
m.shape torch.Size([264, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20801305770874023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20801305770874023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 264, 100]), torch.Size([1, 264, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20821046829223633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21942853927612305  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 264, 100])
m.shape torch.Size([296, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2203836441040039  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2203836441040039  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 296, 100]), torch.Size([1, 296, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.22060489654541016  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2347264289855957  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 296, 100])
m.shape torch.Size([29036, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.34278345108032227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.34278345108032227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 29036, 100]), torch.Size([1, 29036, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.36622095108032227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.922050952911377  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 29036, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8086295127868652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8380255699157715  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([30824, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8380255699157715  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([30824, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8674216270446777  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8380255699157715  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([30824, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8674216270446777  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8749356269836426  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 30824
----------------output nodes number: 2981
----------------edges number: 73004
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.875187873840332  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9461688995361328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9461688995361328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9461708068847656  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9461860656738281  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9461874961853027  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9461874961853027  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9461894035339355  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9462180137634277  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9462347030639648  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9462347030639648  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9462461471557617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.946497917175293  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9465079307556152  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9465079307556152  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9465155601501465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9467368125915527  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9467620849609375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9467620849609375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9467735290527344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9471855163574219  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9472146034240723  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9472146034240723  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9472260475158691  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9477181434631348  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.947739601135254  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.947739601135254  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9477472305297852  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9481287002563477  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.948148250579834  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.948148250579834  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9481539726257324  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9484801292419434  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9485468864440918  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9485468864440918  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9485621452331543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9495387077331543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.94962739944458  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.94962739944458  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9496464729309082  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.951000690460205  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9510550498962402  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9510550498962402  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.951066493988037  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9519591331481934  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9519996643066406  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9519996643066406  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9520072937011719  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9526557922363281  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9527273178100586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9527273178100586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9527387619018555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.953791618347168  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9538936614990234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9538936614990234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.953908920288086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9554195404052734  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.955484390258789  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.955484390258789  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9554939270019531  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9565048217773438  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9565463066101074  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9565463066101074  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9565520286560059  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9571986198425293  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9573431015014648  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9573431015014648  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9573602676391602  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9594202041625977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9595327377319336  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9595327377319336  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9595460891723633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9612417221069336  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.961308479309082  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.961308479309082  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9613161087036133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9623384475708008  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.962411880493164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.962411880493164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9624195098876953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9634952545166016  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9636125564575195  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9636125564575195  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9636240005493164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.965317726135254  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9655871391296387  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9655871391296387  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9656119346618652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9694552421569824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9695978164672852  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9695978164672852  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9696111679077148  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9717741012573242  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.971951961517334  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.971951961517334  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9719672203063965  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.974545955657959  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2842, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0428266525268555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0428266525268555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2842, 256]), torch.Size([1, 2842, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0482473373413086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0294313430786133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2842, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.9600696563720703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.9605917930603027  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.9605917930603027  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.961113929748535  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.9605917930603027  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.0531158447265625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.09623575210571289  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.09625959396362305  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 115749
first layer output nodes number: 31396
edges number: 307040
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05271720886230469  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([115749, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05271720886230469  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([70, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17035675048828125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17035675048828125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 70, 100]), torch.Size([1, 70, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1704092025756836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17082738876342773  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 70, 100])
m.shape torch.Size([77, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17085886001586914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17085886001586914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 77, 100]), torch.Size([1, 77, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17091703414916992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17178106307983398  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 77, 100])
m.shape torch.Size([121, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17188739776611328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17188739776611328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 121, 100]), torch.Size([1, 121, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17197799682617188  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1739668846130371  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 121, 100])
m.shape torch.Size([172, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1741781234741211  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1741781234741211  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 172, 100]), torch.Size([1, 172, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17430686950683594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17802906036376953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 172, 100])
m.shape torch.Size([226, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17838573455810547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17838573455810547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 226, 100]), torch.Size([1, 226, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17855453491210938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18462419509887695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 226, 100])
m.shape torch.Size([281, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18516826629638672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18516826629638672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 281, 100]), torch.Size([1, 281, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1853780746459961  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19439125061035156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 281, 100])
m.shape torch.Size([249, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19493579864501953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19493579864501953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 249, 100]), torch.Size([1, 249, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19512176513671875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20441007614135742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 249, 100])
m.shape torch.Size([260, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2050919532775879  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2050919532775879  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 260, 100]), torch.Size([1, 260, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20528650283813477  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21634149551391602  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 260, 100])
m.shape torch.Size([274, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2171630859375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2171630859375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 274, 100]), torch.Size([1, 274, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21736812591552734  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2304520606994629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 274, 100])
m.shape torch.Size([29666, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3408641815185547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3408641815185547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 29666, 100]), torch.Size([1, 29666, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3643016815185547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.948298454284668  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 29666, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8326773643493652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8626189231872559  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([31396, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8626189231872559  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([31396, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8925604820251465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8626189231872559  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([31396, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8925604820251465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9000458717346191  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 31396
----------------output nodes number: 3162
----------------edges number: 77610
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.900303840637207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.975234031677246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.975234031677246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9752435684204102  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9753198623657227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9753174781799316  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9753174781799316  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9753193855285645  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9753479957580566  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9753532409667969  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9753532409667969  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9753570556640625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9754409790039062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9754548072814941  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9754548072814941  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9754624366760254  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9756836891174316  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9756898880004883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9756898880004883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.975693702697754  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9758310317993164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.975858211517334  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.975858211517334  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.975867748260498  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9762778282165527  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.976313591003418  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.976313591003418  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9763250350952148  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9768972396850586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9769225120544434  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9769225120544434  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9769301414489746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9773650169372559  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9774394035339355  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9774394035339355  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9774565696716309  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9785552024841309  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9785757064819336  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9785757064819336  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.978581428527832  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.978987693786621  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.979027271270752  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.979027271270752  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9790349006652832  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9796299934387207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9797072410583496  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9797072410583496  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9797205924987793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9808554649353027  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9808988571166992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9808988571166992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9809064865112305  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9816083908081055  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9817256927490234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9817256927490234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9817428588867188  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9834423065185547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.983534812927246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.983534812927246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9835481643676758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9849634170532227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9850645065307617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9850645065307617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9850778579711914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.986586570739746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.986727237701416  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.986727237701416  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9867444038391113  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9888043403625488  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9889345169067383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9889345169067383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9889497756958008  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9908876419067383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.990971565246582  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.990971565246582  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.990981101989746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9922590255737305  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9923505783081055  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9923505783081055  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9923601150512695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9937047958374023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9938011169433594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9938011169433594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9938106536865234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9952220916748047  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.995344638824463  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.995344638824463  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9953560829162598  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9971299171447754  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9973011016845703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9973011016845703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9973163604736328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9997882843017578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9998960494995117  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9998960494995117  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9999055862426758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0015172958374023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3032, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0743660926818848  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0743660926818848  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3032, 256]), torch.Size([1, 3032, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.080343246459961  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.122952938079834  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3032, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0479745864868164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0485286712646484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0485286712646484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0490827560424805  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0485286712646484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3162, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.04878568649291992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.09576272964477539  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.09578514099121094  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 126103
first layer output nodes number: 29750
edges number: 291748
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05652189254760742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([126103, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05652189254760742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([53, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1688375473022461  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1688375473022461  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 53, 100]), torch.Size([1, 53, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16887760162353516  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16919517517089844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 53, 100])
m.shape torch.Size([83, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1692371368408203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1692371368408203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 83, 100]), torch.Size([1, 83, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16929912567138672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1702289581298828  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 83, 100])
m.shape torch.Size([103, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17031335830688477  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17031335830688477  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 103, 100]), torch.Size([1, 103, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17039060592651367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17208147048950195  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 103, 100])
m.shape torch.Size([146, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17226076126098633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17226076126098633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 146, 100]), torch.Size([1, 146, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17237043380737305  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17553377151489258  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 146, 100])
m.shape torch.Size([181, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17581653594970703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17581653594970703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 181, 100]), torch.Size([1, 181, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17595195770263672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18081283569335938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 181, 100])
m.shape torch.Size([184, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18115663528442383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18115663528442383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 184, 100]), torch.Size([1, 184, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18129396438598633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18719053268432617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 184, 100])
m.shape torch.Size([239, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1877455711364746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1877455711364746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 239, 100]), torch.Size([1, 239, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18792390823364258  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19683074951171875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 239, 100])
m.shape torch.Size([215, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19738245010375977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19738245010375977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 215, 100]), torch.Size([1, 215, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19754266738891602  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20667505264282227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 215, 100])
m.shape torch.Size([226, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2073531150817871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2073531150817871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 226, 100]), torch.Size([1, 226, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20752191543579102  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21831226348876953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 226, 100])
m.shape torch.Size([28320, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.323728084564209  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.323728084564209  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 28320, 100]), torch.Size([1, 28320, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.34490966796875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.843012809753418  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 28320, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.735569953918457  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.763941764831543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([29750, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.763941764831543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([29750, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.792313575744629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.763941764831543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([29750, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.792313575744629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7994065284729004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 29750
----------------output nodes number: 2981
----------------edges number: 73027
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7996506690979004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8706331253051758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8706331253051758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.870640754699707  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.870701789855957  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.870704174041748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.870704174041748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8707079887390137  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8707919120788574  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8708133697509766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8708133697509766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8708248138427734  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8711566925048828  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8711848258972168  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8711848258972168  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8711981773376465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8716788291931152  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8717012405395508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8717012405395508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8717107772827148  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8721208572387695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8721766471862793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8721766471862793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8721938133239746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8730521202087402  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.873051643371582  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.873051643371582  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8730535507202148  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8731622695922852  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.87318754196167  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.87318754196167  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8731932640075684  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8735594749450684  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.873633861541748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.873633861541748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8736491203308105  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.874732494354248  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.874788761138916  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.874788761138916  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.874800205230713  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8756928443908691  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8757681846618652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8757681846618652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.875781536102295  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8769164085388184  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.876922607421875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.876922607421875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8769245147705078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8770999908447266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([8, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.877206802368164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.877206802368164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8772220611572266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.878732681274414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.878840446472168  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.878840446472168  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8788557052612305  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8804731369018555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8805427551269531  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8805427551269531  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8805522918701172  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8816299438476562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.881772518157959  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.881772518157959  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8817896842956543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8838496208190918  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8840489387512207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8840489387512207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8840718269348145  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8869786262512207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8870587348937988  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8870587348937988  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.887068271636963  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8883461952209473  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8884186744689941  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8884186744689941  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8884263038635254  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8895020484924316  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8895587921142578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8895587921142578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8895645141601562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.890411376953125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.890556812286377  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.890556812286377  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8905701637268066  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8926396369934082  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8926773071289062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8926773071289062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8926811218261719  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8932991027832031  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8934588432312012  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8934588432312012  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8934721946716309  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.895728588104248  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2852, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9642505645751953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9642505645751953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2852, 256]), torch.Size([1, 2852, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9696903228759766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.9569015502929688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2852, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.885895252227783  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.8864173889160156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.8864173889160156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.886939525604248  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.8864173889160156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05260944366455078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.10548257827758789  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.10550498962402344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 141930
first layer output nodes number: 31957
edges number: 311998
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.06331729888916016  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([141930, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.06331729888916016  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([85, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18286514282226562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18286514282226562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 85, 100]), torch.Size([1, 85, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18292903900146484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18343734741210938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 85, 100])
m.shape torch.Size([105, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18348407745361328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18348407745361328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 105, 100]), torch.Size([1, 105, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.183563232421875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18474197387695312  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 105, 100])
m.shape torch.Size([141, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1848602294921875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1848602294921875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 141, 100]), torch.Size([1, 141, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1849660873413086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18728208541870117  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 141, 100])
m.shape torch.Size([195, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18752002716064453  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18752002716064453  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 195, 100]), torch.Size([1, 195, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1876659393310547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19188594818115234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 195, 100])
m.shape torch.Size([214, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19221162796020508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19221162796020508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 214, 100]), torch.Size([1, 214, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19237184524536133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1981182098388672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 214, 100])
m.shape torch.Size([269, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1986393928527832  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1986393928527832  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 269, 100]), torch.Size([1, 269, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19884061813354492  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20746755599975586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 269, 100])
m.shape torch.Size([273, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20807886123657227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20807886123657227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 273, 100]), torch.Size([1, 273, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2082829475402832  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21846723556518555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 273, 100])
m.shape torch.Size([278, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2191939353942871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2191939353942871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 278, 100]), torch.Size([1, 278, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21940183639526367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2312178611755371  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 278, 100])
m.shape torch.Size([289, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.23208332061767578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.23208332061767578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 289, 100]), torch.Size([1, 289, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2322988510131836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2460927963256836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 289, 100])
m.shape torch.Size([30108, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.35814619064331055  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.35814619064331055  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 30108, 100]), torch.Size([1, 30108, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.38158369064331055  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9853358268737793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 30108, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.869117259979248  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8995938301086426  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([31957, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8995938301086426  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([31957, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.930070400238037  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8995938301086426  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([31957, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.930070400238037  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9376897811889648  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 31957
----------------output nodes number: 2999
----------------edges number: 72231
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.937950611114502  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([32, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.007526397705078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.007526397705078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.007587432861328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.008075714111328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.008049488067627  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.008049488067627  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0080533027648926  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.008110523223877  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0081233978271484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0081233978271484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0081329345703125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.008342742919922  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.008357524871826  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.008357524871826  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0083670616149902  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.008643627166748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0086774826049805  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0086774826049805  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.008692741394043  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.009242057800293  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.009274959564209  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.009274959564209  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0092883110046387  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0098624229431152  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.009916305541992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.009916305541992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0099334716796875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.010791778564453  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.010875701904297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.010875701904297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0108985900878906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0122032165527344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.012235164642334  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.012235164642334  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.012244701385498  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.012855052947998  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0128984451293945  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0128984451293945  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0129079818725586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.013585090637207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.013686180114746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.013686180114746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.013705253601074  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.015192985534668  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0152645111083984  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0152645111083984  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.015277862548828  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0164127349853516  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0165061950683594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0165061950683594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.016521453857422  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.017925262451172  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.018038749694824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.018038749694824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0180559158325195  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0197553634643555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.019963264465332  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.019963264465332  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.019991874694824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.023024559020996  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.023087501525879  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.023087501525879  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.023097038269043  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.024174690246582  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.024251937866211  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.024251937866211  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.024261474609375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0254058837890625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.025470733642578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.025470733642578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0254783630371094  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.026447296142578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.026662826538086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.026662826538086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0266857147216797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.029752731323242  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0299530029296875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0299530029296875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0299739837646484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0329322814941406  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0331239700317383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0331239700317383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0331430435180664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.035965919494629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.036062240600586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.036062240600586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.03607177734375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0375499725341797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.037810802459717  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.037810802459717  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0378336906433105  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.041541576385498  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0416688919067383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0416688919067383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.041680335998535  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.043614387512207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2790, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.110647201538086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.110647201538086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2790, 256]), torch.Size([1, 2790, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.11639404296875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0717201232910156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2790, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0027480125427246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0032734870910645  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([2999, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0032734870910645  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([2999, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0037989616394043  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0032734870910645  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([2999, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.058508872985839844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.10929012298583984  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.10931253433227539  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 135099
first layer output nodes number: 33654
edges number: 324424
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.060622215270996094  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([135099, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.060622215270996094  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([110, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18494796752929688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18494796752929688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 110, 100]), torch.Size([1, 110, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1850299835205078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1856861114501953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 110, 100])
m.shape torch.Size([186, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18578386306762695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18578386306762695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 186, 100]), torch.Size([1, 186, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18592309951782227  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18800592422485352  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 186, 100])
m.shape torch.Size([249, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18821477890014648  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18821477890014648  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 249, 100]), torch.Size([1, 249, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1884007453918457  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1924877166748047  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 249, 100])
m.shape torch.Size([343, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19290590286254883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19290590286254883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 343, 100]), torch.Size([1, 343, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1931614875793457  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20057344436645508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 343, 100])
m.shape torch.Size([351, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20109987258911133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20109987258911133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 351, 100]), torch.Size([1, 351, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20136213302612305  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21078205108642578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 351, 100])
m.shape torch.Size([401, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2115473747253418  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2115473747253418  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 401, 100]), torch.Size([1, 401, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21184682846069336  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.22470617294311523  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 401, 100])
m.shape torch.Size([401, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.22628116607666016  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.22628116607666016  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 401, 100]), torch.Size([1, 401, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.22658061981201172  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2415332794189453  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 401, 100])
m.shape torch.Size([417, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.24262666702270508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.24262666702270508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 417, 100]), torch.Size([1, 417, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.24293756484985352  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.26065874099731445  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 417, 100])
m.shape torch.Size([441, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2619819641113281  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2619819641113281  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 441, 100]), torch.Size([1, 441, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2623109817504883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2833552360534668  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 441, 100])
m.shape torch.Size([30755, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3977622985839844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3977622985839844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 30755, 100]), torch.Size([1, 30755, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.4211997985839844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0538768768310547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 30755, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9329414367675781  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.965036392211914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([33654, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.965036392211914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([33654, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.99713134765625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.965036392211914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([33654, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.99713134765625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.005155086517334  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 33654
----------------output nodes number: 2981
----------------edges number: 71099
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0054283142089844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.073884963989258  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.073884963989258  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0738887786865234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0739192962646484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0739331245422363  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0739331245422363  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.073948383331299  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0741772651672363  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([16, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.074215888977051  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.074215888977051  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.074246406555176  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.074917793273926  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.074972152709961  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.074972152709961  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0750064849853516  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0760021209716797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.076042652130127  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.076042652130127  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0760655403137207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0768895149230957  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0769243240356445  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0769243240356445  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.076939582824707  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0775957107543945  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0776286125183105  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0776286125183105  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0776400566101074  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.078212261199951  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0782761573791504  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0782761573791504  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0782933235168457  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0792717933654785  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.079375743865967  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.079375743865967  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0794005393981934  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0809874534606934  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0810904502868652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0810904502868652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.081113338470459  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0827383995056152  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.08284330368042  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.08284330368042  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.082864284515381  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.084500789642334  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0846290588378906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0846290588378906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0846519470214844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.086597442626953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0867738723754883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0867738723754883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0868024826049805  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0894346237182617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.089609146118164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.089609146118164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0896358489990234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0922794342041016  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0924391746520996  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0924391746520996  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0924620628356934  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.094888210296631  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.095015525817871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.095015525817871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0950326919555664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0969724655151367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0972747802734375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0972747802734375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.097311019897461  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1016597747802734  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1019015312194824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1019015312194824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1019301414489746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1055636405944824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1058783531188965  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1058783531188965  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.105912685394287  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.110513210296631  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1107654571533203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1107654571533203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1107921600341797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1145572662353516  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.114786148071289  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.114786148071289  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.114809036254883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.118196487426758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.118481159210205  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.118481159210205  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1185078620910645  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1226468086242676  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.123053550720215  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.123053550720215  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1230897903442383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.128960609436035  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.129288673400879  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.129288673400879  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.129317283630371  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.134152412414551  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([2678, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.198485851287842  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.198485851287842  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2678, 256]), torch.Size([1, 2678, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.2035975456237793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.122851848602295  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2678, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.055422782897949  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0559449195861816  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0559449195861816  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.056467056274414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0559449195861816  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05641365051269531  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.0991673469543457  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.09919118881225586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 114766
first layer output nodes number: 31806
edges number: 307747
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05234193801879883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([114766, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05234193801879883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([81, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17026710510253906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17026710510253906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 81, 100]), torch.Size([1, 81, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17032814025878906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17081356048583984  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 81, 100])
m.shape torch.Size([165, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17090606689453125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17090606689453125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 165, 100]), torch.Size([1, 165, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17102909088134766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17287445068359375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 165, 100])
m.shape torch.Size([235, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17307567596435547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17307567596435547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 235, 100]), torch.Size([1, 235, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17325115203857422  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1771073341369629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 235, 100])
m.shape torch.Size([263, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17741155624389648  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17741155624389648  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 263, 100]), torch.Size([1, 263, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17760801315307617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18329381942749023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 263, 100])
m.shape torch.Size([315, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18378257751464844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18378257751464844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 315, 100]), torch.Size([1, 315, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18401813507080078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19247674942016602  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 315, 100])
m.shape torch.Size([317, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1930675506591797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1930675506591797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 317, 100]), torch.Size([1, 317, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19330406188964844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20346546173095703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 317, 100])
m.shape torch.Size([375, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20432519912719727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20432519912719727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 375, 100]), torch.Size([1, 375, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2046046257019043  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21857595443725586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 375, 100])
m.shape torch.Size([338, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21944379806518555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21944379806518555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 338, 100]), torch.Size([1, 338, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2196965217590332  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.23406744003295898  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 338, 100])
m.shape torch.Size([397, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2353959083557129  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2353959083557129  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 397, 100]), torch.Size([1, 397, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.23569250106811523  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2546358108520508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 397, 100])
m.shape torch.Size([29320, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.36371326446533203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.36371326446533203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 29320, 100]), torch.Size([1, 29320, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.38715076446533203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9556694030761719  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 29320, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8397560119628906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8700885772705078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([31806, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8700885772705078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([31806, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.900421142578125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8700885772705078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([31806, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.900421142578125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9080042839050293  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 31806
----------------output nodes number: 3156
----------------edges number: 76180
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9082651138305664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.981611728668213  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.981611728668213  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9816155433654785  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9816460609436035  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9816503524780273  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9816503524780273  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9816560745239258  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9817419052124023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9817509651184082  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9817509651184082  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9817585945129395  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.981926441192627  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9819459915161133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9819459915161133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9819574356079102  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9822893142700195  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9823126792907715  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9823126792907715  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9823241233825684  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9827361106872559  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9827651977539062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9827651977539062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9827766418457031  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9832687377929688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.98333740234375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.98333740234375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.983358383178711  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9844074249267578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9844741821289062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9844741821289062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9844932556152344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9855804443359375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9856748580932617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9856748580932617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9856977462768555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9871625900268555  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9872956275939941  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9872956275939941  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9873242378234863  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9893555641174316  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9894471168518066  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9894471168518066  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9894661903381348  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9909539222717285  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9910597801208496  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9910597801208496  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9910788536071777  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9927000999450684  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([18, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9929156303405762  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9929156303405762  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9929499626159668  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9961085319519043  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9962396621704102  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9962396621704102  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.996260643005371  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.998337745666504  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9985580444335938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9985580444335938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9985885620117188  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0018234252929688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.002054214477539  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.002054214477539  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.002084732055664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.005533218383789  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.005746841430664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.005746841430664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0057735443115234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0089778900146484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.009120464324951  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.009120464324951  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0091376304626465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.011317729949951  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.011620044708252  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.011620044708252  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0116524696350098  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0159974098205566  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0162315368652344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0162315368652344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.016256332397461  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0197525024414062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0198817253112793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0198817253112793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.019895076751709  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0218710899353027  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.02211856842041  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.02211856842041  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.022141456604004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.025689125061035  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.026142120361328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.026142120361328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.026182174682617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0326709747314453  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.032905101776123  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.032905101776123  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.032926082611084  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.0364718437194824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([2896, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1060471534729004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1060471534729004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2896, 256]), torch.Size([1, 2896, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.1115708351135254  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.104952335357666  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2896, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0320024490356445  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.032555103302002  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([3156, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.032555103302002  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3156, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0331077575683594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.032555103302002  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3156, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.04841804504394531  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.08919906616210938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.08922195434570312  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 109470
first layer output nodes number: 28738
edges number: 274747
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05006217956542969  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([109470, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.05006217956542969  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([139, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1553802490234375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1553802490234375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 139, 100]), torch.Size([1, 139, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15548419952392578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15631437301635742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 139, 100])
m.shape torch.Size([217, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15642452239990234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15642452239990234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 217, 100]), torch.Size([1, 217, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1565866470336914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15901565551757812  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 217, 100])
m.shape torch.Size([261, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1592264175415039  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1592264175415039  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 261, 100]), torch.Size([1, 261, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15942096710205078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16370105743408203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 261, 100])
m.shape torch.Size([309, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1640644073486328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1640644073486328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 309, 100]), torch.Size([1, 309, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16429519653320312  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1709766387939453  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 309, 100])
m.shape torch.Size([380, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1715693473815918  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1715693473815918  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 380, 100]), torch.Size([1, 380, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17185258865356445  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18204927444458008  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 380, 100])
m.shape torch.Size([396, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18279314041137695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18279314041137695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 396, 100]), torch.Size([1, 396, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1830887794494629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1957840919494629  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 396, 100])
m.shape torch.Size([394, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19666385650634766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19666385650634766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 394, 100]), torch.Size([1, 394, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19695758819580078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21164417266845703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 394, 100])
m.shape torch.Size([456, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21285629272460938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21285629272460938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 456, 100]), torch.Size([1, 456, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2131967544555664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.23256874084472656  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 456, 100])
m.shape torch.Size([387, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.23369646072387695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.23369646072387695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 387, 100]), torch.Size([1, 387, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.23398542404174805  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2524533271789551  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 387, 100])
m.shape torch.Size([25799, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3484177589416504  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3484177589416504  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 25799, 100]), torch.Size([1, 25799, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.36764001846313477  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7323918342590332  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 25799, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.6305880546569824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.6579947471618652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([28738, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.6579947471618652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([28738, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.685401439666748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.6579947471618652  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([28738, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.685401439666748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.6922531127929688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 28738
----------------output nodes number: 3029
----------------edges number: 72389
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.692490577697754  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7621893882751465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7621893882751465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.762195110321045  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7622408866882324  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7622461318969727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7622461318969727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.762253761291504  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7623682022094727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7623820304870605  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7623820304870605  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7623934745788574  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7626452445983887  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7626628875732422  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7626628875732422  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.762674331665039  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7630062103271484  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7630486488342285  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7630486488342285  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7630677223205566  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7637543678283691  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7637968063354492  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7637968063354492  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7638139724731445  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.764552116394043  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([18, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.764664649963379  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.764664649963379  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7646989822387695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7664155960083008  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7664756774902344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7664756774902344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7664947509765625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7675819396972656  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7676677703857422  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7676677703857422  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7676887512207031  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7690315246582031  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7691845893859863  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7691845893859863  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7692170143127441  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7715191841125488  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7715983390808105  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7715983390808105  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7716155052185059  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7729544639587402  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7730960845947266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7730960845947266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7731208801269531  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.775228500366211  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([21, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7754788398742676  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7754788398742676  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7755188941955566  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7792038917541504  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7794532775878906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7794532775878906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7794914245605469  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7832679748535156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7834653854370117  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7834653854370117  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.783493995666504  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7865266799926758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7868661880493164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7868661880493164  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.786910057067871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7918672561645508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7920904159545898  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7920904159545898  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.792119026184082  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7955522537231445  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7957286834716797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7957286834716797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7957496643066406  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7984142303466797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.798604965209961  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.798604965209961  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7986259460449219  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8014373779296875  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.80171537399292  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.80171537399292  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.801743984222412  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8057780265808105  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8061676025390625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8061676025390625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8062057495117188  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8118515014648438  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8120651245117188  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8120651245117188  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8120861053466797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.815338134765625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8156375885009766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8156375885009766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.815664291381836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8199901580810547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8203229904174805  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8203229904174805  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8203516006469727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8251867294311523  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([2722, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8905773162841797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8905773162841797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2722, 256]), torch.Size([1, 2722, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8957691192626953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.824066162109375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2722, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.7546520233154297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.7551827430725098  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([3029, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.7551827430725098  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3029, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.75571346282959  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.7551827430725098  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3029, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.046422481536865234  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.08932256698608398  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.08934545516967773  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 115158
first layer output nodes number: 30973
edges number: 301367
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.0524287223815918  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([115158, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.0524287223815918  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([55, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1678934097290039  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1678934097290039  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 55, 100]), torch.Size([1, 55, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16793441772460938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16826248168945312  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 55, 100])
m.shape torch.Size([94, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16831207275390625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16831207275390625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 94, 100]), torch.Size([1, 94, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1683826446533203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1694355010986328  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 94, 100])
m.shape torch.Size([160, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16957902908325195  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16957902908325195  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 160, 100]), torch.Size([1, 160, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16969823837280273  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17232084274291992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 160, 100])
m.shape torch.Size([234, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17261028289794922  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17261028289794922  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 234, 100]), torch.Size([1, 234, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17278480529785156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17784595489501953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 234, 100])
m.shape torch.Size([258, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1782393455505371  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1782393455505371  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 258, 100]), torch.Size([1, 258, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17843198776245117  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18535995483398438  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 258, 100])
m.shape torch.Size([308, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18595218658447266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18595218658447266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 308, 100]), torch.Size([1, 308, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18618202209472656  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19605636596679688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 308, 100])
m.shape torch.Size([330, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19680213928222656  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19680213928222656  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 330, 100]), torch.Size([1, 330, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19704818725585938  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2093505859375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 330, 100])
m.shape torch.Size([359, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2102975845336914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2102975845336914  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 359, 100]), torch.Size([1, 359, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.21056556701660156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.22581768035888672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 359, 100])
m.shape torch.Size([362, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2268977165222168  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.2268977165222168  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 362, 100]), torch.Size([1, 362, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.22716760635375977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.24444055557250977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 362, 100])
m.shape torch.Size([28813, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3516426086425781  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3516426086425781  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 28813, 100]), torch.Size([1, 28813, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3731107711791992  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8973073959350586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 28813, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.785618782043457  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8151569366455078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([30973, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8151569366455078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([30973, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8446950912475586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8151569366455078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([30973, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8446950912475586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.852541446685791  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 30973
----------------output nodes number: 3033
----------------edges number: 74023
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.852795124053955  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9240665435791016  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9240665435791016  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9240703582763672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9241275787353516  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9241375923156738  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9241375923156738  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.924145221710205  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9243130683898926  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9243135452270508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9243135452270508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9243154525756836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9243707656860352  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9243988990783691  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9243988990783691  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.924410343170166  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9248223304748535  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9248571395874023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9248571395874023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.924870491027832  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9254446029663086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9254851341247559  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9254851341247559  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9254984855651855  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.92616605758667  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9262056350708008  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9262056350708008  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9262170791625977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9268693923950195  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9268898963928223  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9268898963928223  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9268956184387207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9272618293762207  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9273266792297363  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9273266792297363  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.927340030670166  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9282879829406738  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9283661842346191  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9283661842346191  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9283814430236816  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9295716285705566  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.929633617401123  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.929633617401123  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.92964506149292  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9306178092956543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([12, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9307622909545898  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9307622909545898  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9307851791381836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9328908920288086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9330544471740723  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9330544471740723  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9330792427062988  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9355340003967285  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9356369972229004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9356369972229004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.935652256011963  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.937269687652588  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.937354564666748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.937354564666748  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.937366008758545  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9386591911315918  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9389152526855469  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9389152526855469  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9389457702636719  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9426078796386719  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.942800521850586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.942800521850586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9428234100341797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.945730209350586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9458284378051758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9458284378051758  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9458398818969727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.947373390197754  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9475793838500977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9475793838500977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9476003646850586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9505586624145508  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9508109092712402  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9508109092712402  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9508357048034668  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.954505443572998  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9545989036560059  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9545989036560059  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.95460844039917  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9560866355895996  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9563031196594238  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9563031196594238  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.956322193145752  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9594120979309082  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9596796035766602  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9596796035766602  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.959702491760254  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9635705947875977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([2852, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.032087802886963  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.032087802886963  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2852, 256]), torch.Size([1, 2852, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.037527561187744  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 3.0209450721740723  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 2852, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.949655055999756  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.950186252593994  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([3033, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.950186252593994  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3033, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.9507174491882324  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.950186252593994  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3033, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.048542022705078125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.08426856994628906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.08429241180419922  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 95902
first layer output nodes number: 29614
edges number: 290673
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.045044898986816406  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([95902, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.045044898986816406  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([41, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15729141235351562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15729141235351562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 41, 100]), torch.Size([1, 41, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15732288360595703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15757036209106445  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 41, 100])
m.shape torch.Size([77, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15761232376098633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15761232376098633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 77, 100]), torch.Size([1, 77, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1576704978942871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15853452682495117  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 77, 100])
m.shape torch.Size([121, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15864086151123047  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15864086151123047  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 121, 100]), torch.Size([1, 121, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.15873146057128906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1607203483581543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 121, 100])
m.shape torch.Size([130, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16086912155151367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16086912155151367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 130, 100]), torch.Size([1, 130, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1609663963317871  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16378164291381836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 130, 100])
m.shape torch.Size([166, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16404247283935547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16404247283935547  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 166, 100]), torch.Size([1, 166, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16416645050048828  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16862249374389648  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 166, 100])
m.shape torch.Size([190, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16898536682128906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.16898536682128906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 190, 100]), torch.Size([1, 190, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1691274642944336  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17522048950195312  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 190, 100])
m.shape torch.Size([218, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1757183074951172  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1757183074951172  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 218, 100]), torch.Size([1, 218, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.17588138580322266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18401527404785156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 218, 100])
m.shape torch.Size([195, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18451499938964844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.18451499938964844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 195, 100]), torch.Size([1, 195, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1846609115600586  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19295501708984375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 195, 100])
m.shape torch.Size([221, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19362306594848633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.19362306594848633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 221, 100]), torch.Size([1, 221, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.1937880516052246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.20433425903320312  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 221, 100])
m.shape torch.Size([28255, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3095102310180664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3095102310180664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 28255, 100]), torch.Size([1, 28255, 100])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.3305625915527344  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8253421783447266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 28255, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7183747291564941  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7466168403625488  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([29614, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7466168403625488  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([29614, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7748589515686035  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7466168403625488  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([29614, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7748589515686035  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7819194793701172  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 29614
----------------output nodes number: 3142
----------------edges number: 76992
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.7821640968322754  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8570842742919922  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8570842742919922  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.857086181640625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8571147918701172  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8571257591247559  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8571257591247559  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.857133388519287  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8573012351989746  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.857320785522461  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.857320785522461  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8573322296142578  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8576641082763672  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8577065467834473  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8577065467834473  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8577256202697754  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.858412265777588  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8584375381469727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8584375381469727  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8584489822387695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8589410781860352  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8589825630187988  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8589825630187988  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8589959144592285  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.859663486480713  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8596954345703125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8596954345703125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8597049713134766  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8602485656738281  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8602957725524902  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8602957725524902  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.860307216644287  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.861039638519287  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8611016273498535  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8611016273498535  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8611149787902832  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.862062931060791  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8621091842651367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8621091842651367  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8621187210083008  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8628625869750977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8629155158996582  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8629155158996582  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8629250526428223  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8637356758117676  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8637938499450684  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8637938499450684  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8638033866882324  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8646807670593262  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8647570610046387  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8647570610046387  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8647685050964355  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8659014701843262  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8659534454345703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8659534454345703  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8659610748291016  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.866769790649414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8669047355651855  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8669047355651855  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8669219017028809  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8688616752624512  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8689513206481934  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8689513206481934  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8689627647399902  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8703360557556152  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8704171180725098  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8704171180725098  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8704266548156738  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8716378211975098  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.871706485748291  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.871706485748291  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8717141151428223  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8727364540100098  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8728866577148438  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8728866577148438  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8729019165039062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8750534057617188  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8751468658447266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8751468658447266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8751564025878906  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8765678405761719  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.87669038772583  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.87669038772583  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.876701831817627  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8784756660461426  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.878669261932373  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.878669261932373  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8786864280700684  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.881467342376709  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8816895484924316  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8816895484924316  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.8817086219787598  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.884932041168213  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([3003, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9577479362487793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.9577479362487793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 3003, 256]), torch.Size([1, 3003, 256])
----------------------------------------3
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 1.964245319366455  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.981473445892334  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 3003, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.9072980880737305  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.907848358154297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([3142, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.907848358154297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3142, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.9083986282348633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 2.907848358154297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([3142, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.041388511657714844  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.10104799270629883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.10107088088989258  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

first layer input nodes number: 160146
first layer output nodes number: 39885
edges number: 385679
----------------------------------------before model layer 0
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.0702219009399414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([160146, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.6385498046875 GB
    Memory Allocated: 0.0702219009399414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([131, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.21909427642822266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.21909427642822266  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 131, 100]), torch.Size([1, 131, 100])
----------------------------------------3
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.2191925048828125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.21997547149658203  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 131, 100])
m.shape torch.Size([179, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.22005987167358398  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.22005987167358398  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 179, 100]), torch.Size([1, 179, 100])
----------------------------------------3
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.22019338607788086  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.22219610214233398  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 179, 100])
m.shape torch.Size([248, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.22240686416625977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.22240686416625977  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 248, 100]), torch.Size([1, 248, 100])
----------------------------------------3
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.22259187698364258  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.22665786743164062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 248, 100])
m.shape torch.Size([368, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.2271137237548828  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.2271137237548828  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 368, 100]), torch.Size([1, 368, 100])
----------------------------------------3
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.2273883819580078  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.23534202575683594  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 368, 100])
m.shape torch.Size([425, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.23599672317504883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.23599672317504883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 425, 100]), torch.Size([1, 425, 100])
----------------------------------------3
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.2363142967224121  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.2477254867553711  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 425, 100])
m.shape torch.Size([436, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.24854135513305664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.24854135513305664  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 436, 100]), torch.Size([1, 436, 100])
----------------------------------------3
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.24886655807495117  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.26284170150756836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 436, 100])
m.shape torch.Size([487, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.2639493942260742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.2639493942260742  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 487, 100]), torch.Size([1, 487, 100])
----------------------------------------3
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.264312744140625  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.28246021270751953  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 487, 100])
m.shape torch.Size([421, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.28368711471557617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.28368711471557617  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 421, 100]), torch.Size([1, 421, 100])
----------------------------------------3
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.28400087356567383  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.30188512802124023  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 421, 100])
m.shape torch.Size([444, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.30321693420410156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.30321693420410156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 444, 100]), torch.Size([1, 444, 100])
----------------------------------------3
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.30354785919189453  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.32472705841064453  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 444, 100])
m.shape torch.Size([36746, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.46145153045654297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.46145153045654297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 36746, 100]), torch.Size([1, 36746, 100])
----------------------------------------3
 Nvidia-smi: 13.7830810546875 GB
    Memory Allocated: 0.4888296127319336  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.432673454284668  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 36746, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.2885613441467285  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.326598644256592  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

h_self size  torch.Size([39885, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.326598644256592  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([39885, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.364635944366455  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.326598644256592  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

torch.Size([39885, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.364635944366455  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3741455078125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------input nodes number: 39885
----------------output nodes number: 3009
----------------edges number: 71884
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3744659423828125  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4436774253845215  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4436774253845215  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4436793327331543  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.443694591522217  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4437074661254883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4437074661254883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.443720817565918  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4439210891723633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4439377784729004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4439377784729004  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.443953037261963  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.444288730621338  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4443235397338867  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4443235397338867  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4443445205688477  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.444952964782715  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.444985866546631  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.444985866546631  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.445003032684326  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4456210136413574  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([16, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.445704936981201  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.445704936981201  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.445735454559326  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.447047710418701  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4471335411071777  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4471335411071777  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.44716215133667  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4485926628112793  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.448686122894287  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.448686122894287  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4487128257751465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.450234889984131  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.450316905975342  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.450316905975342  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4503378868103027  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4516806602478027  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4517955780029297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4517955780029297  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4518203735351562  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.453580856323242  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.453695774078369  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.453695774078369  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.453718662261963  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4555039405822754  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4556541442871094  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4556541442871094  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4556808471679688  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4579505920410156  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4581122398376465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4581122398376465  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.458138942718506  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4605956077575684  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4607439041137695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4607439041137695  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4607667922973633  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4630327224731445  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4632091522216797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4632091522216797  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4632339477539062  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.465862274169922  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.466050148010254  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.466050148010254  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4660749435424805  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.468876838684082  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4690771102905273  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4690771102905273  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.469101905822754  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4720773696899414  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.472376823425293  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.472376823425293  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4724111557006836  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.476771354675293  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.476973533630371  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.476973533630371  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.476996421813965  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4800634384155273  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.480282783508301  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.480282783508301  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4803056716918945  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4835329055786133  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.483743667602539  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.483743667602539  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4837646484375  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4868698120117188  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4871554374694824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4871554374694824  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.487182140350342  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.491321086883545  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4916396141052246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4916396141052246  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.491668224334717  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.496303081512451  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4965429306030273  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4965429306030273  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4965639114379883  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.5001096725463867  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([2720, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.565455913543701  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.565455913543701  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

 h.shape torch.Size([1, 2720, 256]), torch.Size([1, 2720, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.570643901824951  GigaBytes
Max Memory Allocated: 3.55572509765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.5058188438415527  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 2720, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.436903476715088  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.4374303817749023  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

h_self size  torch.Size([3009, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.4374303817749023  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

torch.Size([3009, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.437957286834717  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.4374303817749023  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

torch.Size([3009, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.06529712677001953  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.11303186416625977  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.11305522918701172  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

first layer input nodes number: 128136
first layer output nodes number: 34583
edges number: 335720
----------------------------------------before model layer 0
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.058190345764160156  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

torch.Size([128136, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.058190345764160156  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

m.shape torch.Size([97, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.18683195114135742  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.18683195114135742  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 97, 100]), torch.Size([1, 97, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.1869044303894043  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.1874842643737793  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 97, 100])
m.shape torch.Size([154, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.1875629425048828  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.1875629425048828  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 154, 100]), torch.Size([1, 154, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.18767833709716797  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.18940353393554688  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 154, 100])
m.shape torch.Size([206, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.1895761489868164  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.1895761489868164  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 206, 100]), torch.Size([1, 206, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.1897296905517578  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.19310760498046875  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 206, 100])
m.shape torch.Size([253, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.19340801239013672  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.19340801239013672  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 253, 100]), torch.Size([1, 253, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.19359683990478516  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.1990671157836914  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 253, 100])
m.shape torch.Size([303, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.1995372772216797  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.1995372772216797  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 303, 100]), torch.Size([1, 303, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.19976329803466797  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.20789289474487305  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 303, 100])
m.shape torch.Size([327, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2085108757019043  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2085108757019043  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 327, 100]), torch.Size([1, 327, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2087550163269043  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.21923589706420898  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 327, 100])
m.shape torch.Size([362, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.22005796432495117  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.22005796432495117  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 362, 100]), torch.Size([1, 362, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.22032785415649414  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.23382234573364258  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 362, 100])
m.shape torch.Size([366, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.23502635955810547  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.23502635955810547  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 366, 100]), torch.Size([1, 366, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.23529911041259766  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.25084590911865234  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 366, 100])
m.shape torch.Size([404, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.25206422805786133  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.25206422805786133  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 404, 100]), torch.Size([1, 404, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2523655891418457  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2716398239135742  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 404, 100])
m.shape torch.Size([32111, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.3911123275756836  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.3911123275756836  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 32111, 100]), torch.Size([1, 32111, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.4150371551513672  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1136856079101562  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 32111, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 1.9896769523620605  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.022657871246338  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

h_self size  torch.Size([34583, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.022657871246338  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

torch.Size([34583, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.0556387901306152  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.022657871246338  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

torch.Size([34583, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.0556387901306152  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.0638842582702637  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------input nodes number: 34583
----------------output nodes number: 3075
----------------edges number: 74836
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.0641655921936035  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137118339538574  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137118339538574  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1371259689331055  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1371870040893555  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137185573577881  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137185573577881  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1371874809265137  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137216091156006  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1372299194335938  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1372299194335938  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137239456176758  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137449264526367  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137448787689209  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137448787689209  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137450695037842  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1375060081481934  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1375246047973633  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1375246047973633  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1375322341918945  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1378068923950195  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137855052947998  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.137855052947998  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1378722190856934  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.138610363006592  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1386356353759766  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1386356353759766  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1386451721191406  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1391220092773438  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.139155864715576  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.139155864715576  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1391654014587402  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.139708995819092  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([14, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1398253440856934  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1398253440856934  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1398520469665527  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1415610313415527  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.141624927520752  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.141624927520752  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1416401863098145  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.142723560333252  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([13, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1428537368774414  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1428537368774414  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.142878532409668  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.14481258392334  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.144904136657715  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.144904136657715  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.14492130279541  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1463804244995117  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.146484375  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.146484375  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1465015411376953  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.148080825805664  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1482205390930176  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1482205390930176  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1482415199279785  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1503186225891113  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.15040922164917  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.15040922164917  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1504225730895996  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1518378257751465  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1520156860351562  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1520156860351562  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.15203857421875  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1546249389648438  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.154695510864258  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.154695510864258  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.154705047607422  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1558494567871094  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.155965805053711  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.155965805053711  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1559791564941406  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.157674789428711  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.157850742340088  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.157850742340088  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.157869815826416  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1604256629943848  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.160627841949463  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.160627841949463  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.160648822784424  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.163607120513916  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1638593673706055  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1638593673706055  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.163884162902832  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1675539016723633  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1677956581115723  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1677956581115723  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.167818546295166  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1713662147521973  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1715540885925293  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1715540885925293  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1715712547302246  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1743521690368652  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1744132041931152  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1744132041931152  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1744189262390137  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.1753859519958496  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2888, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.244776725769043  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.244776725769043  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 2888, 256]), torch.Size([1, 2888, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.250640869140625  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.26198148727417  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 2888, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.1898045539855957  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.1903433799743652  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

h_self size  torch.Size([3075, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.1903433799743652  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

torch.Size([3075, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.1908822059631348  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.1903433799743652  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

torch.Size([3075, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.05338478088378906  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.11002540588378906  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.11004924774169922  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

first layer input nodes number: 150229
first layer output nodes number: 38438
edges number: 370677
----------------------------------------before model layer 0
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.06702280044555664  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

torch.Size([150229, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.06702280044555664  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

m.shape torch.Size([155, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2096695899963379  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2096695899963379  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 155, 100]), torch.Size([1, 155, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.20978593826293945  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.21071243286132812  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 155, 100])
m.shape torch.Size([193, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2107982635498047  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2107982635498047  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 193, 100]), torch.Size([1, 193, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.21094226837158203  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2131023406982422  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 193, 100])
m.shape torch.Size([274, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.21333694458007812  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.21333694458007812  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 274, 100]), torch.Size([1, 274, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.21354198455810547  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.21803998947143555  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 274, 100])
m.shape torch.Size([329, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2184281349182129  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2184281349182129  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 329, 100]), torch.Size([1, 329, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2186741828918457  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.22579240798950195  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 329, 100])
m.shape torch.Size([428, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.22646665573120117  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.22646665573120117  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 428, 100]), torch.Size([1, 428, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.22678613662719727  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.23827314376831055  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 428, 100])
m.shape torch.Size([477, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2391796112060547  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2391796112060547  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 477, 100]), torch.Size([1, 477, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.23953533172607422  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2548227310180664  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 477, 100])
m.shape torch.Size([460, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2558445930480957  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2558445930480957  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 460, 100]), torch.Size([1, 460, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.25618791580200195  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2733340263366699  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 460, 100])
m.shape torch.Size([485, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.27460813522338867  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.27460813522338867  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 485, 100]), torch.Size([1, 485, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.27496957778930664  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.29557180404663086  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 485, 100])
m.shape torch.Size([474, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2969803810119629  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2969803810119629  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 474, 100]), torch.Size([1, 474, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.2973341941833496  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.31995248794555664  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 474, 100])
m.shape torch.Size([35163, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.45076799392700195  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.45076799392700195  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 35163, 100]), torch.Size([1, 35163, 100])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.47811174392700195  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3572158813476562  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 35163, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.2178916931152344  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.254549026489258  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

h_self size  torch.Size([38438, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.254549026489258  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

torch.Size([38438, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.2912063598632812  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.254549026489258  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

torch.Size([38438, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.2912063598632812  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3013358116149902  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------input nodes number: 38438
----------------output nodes number: 3163
----------------edges number: 75610
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3016462326049805  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3746047019958496  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3746047019958496  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3746142387390137  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.374690532684326  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.374697685241699  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.374697685241699  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.374709129333496  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.374880790710449  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3748841285705566  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3748841285705566  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.374889850616455  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3750157356262207  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3750438690185547  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3750438690185547  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.375059127807617  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3755016326904297  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.375527858734131  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.375527858734131  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3755412101745605  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3760218620300293  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([16, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.376107692718506  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.376107692718506  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.376138210296631  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.377450466156006  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3775296211242676  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3775296211242676  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.377556324005127  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3788914680480957  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.378993511199951  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.378993511199951  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3790221214294434  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.380652904510498  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3807339668273926  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3807339668273926  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3807549476623535  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3820977210998535  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3822507858276367  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3822507858276367  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3822832107543945  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.384585380554199  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3848018646240234  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3848018646240234  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3848438262939453  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3881168365478516  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.388223171234131  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.388223171234131  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.388244152069092  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3900275230407715  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([24, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.390316963195801  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.390316963195801  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3903627395629883  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3945741653442383  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.394726276397705  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.394726276397705  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3947510719299316  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3972058296203613  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3973379135131836  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3973379135131836  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3973569869995117  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.399378776550293  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.399600028991699  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.399600028991699  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.3996286392211914  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4028615951538086  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.403141498565674  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.403141498565674  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4031758308410645  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4072957038879395  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4075207710266113  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4075207710266113  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4075474739074707  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4109387397766113  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4111266136169434  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4111266136169434  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4111475944519043  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.41395902633667  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4140448570251465  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4140448570251465  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4140543937683105  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4153990745544434  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.415677070617676  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.415677070617676  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.415703773498535  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4196557998657227  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.419854164123535  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.419854164123535  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4198732376098633  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4228296279907227  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4232401847839355  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4232401847839355  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.423276424407959  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.429147243499756  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4295215606689453  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4295215606689453  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.429553985595703  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.4350337982177734  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([2858, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.503690242767334  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.503690242767334  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

 h.shape torch.Size([1, 2858, 256]), torch.Size([1, 2858, 256])
----------------------------------------3
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 2.509141445159912  GigaBytes
Max Memory Allocated: 3.5706686973571777  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.512885570526123  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2858, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.440195083618164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.440749168395996  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.440749168395996  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.441303253173828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 3.440749168395996  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3163, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.06230640411376953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.08975028991699219  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.08977365493774414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 73668
first layer output nodes number: 23963
edges number: 231831
----------------------------------------before model layer 0
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.036113739013671875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([73668, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.036113739013671875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([11, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12493181228637695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12493181228637695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 100]), torch.Size([1, 11, 100])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12494039535522461  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12500762939453125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 100])
m.shape torch.Size([40, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12503337860107422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12503337860107422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 40, 100]), torch.Size([1, 40, 100])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12506389617919922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12551307678222656  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 40, 100])
m.shape torch.Size([100, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.1256098747253418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.1256098747253418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 100, 100]), torch.Size([1, 100, 100])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.1256852149963379  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12732982635498047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 100, 100])
m.shape torch.Size([228, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12763214111328125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12763214111328125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 228, 100]), torch.Size([1, 228, 100])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.12780284881591797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.1327362060546875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 228, 100])
m.shape torch.Size([314, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.13323593139648438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.13323593139648438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 314, 100]), torch.Size([1, 314, 100])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.1334705352783203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.14190196990966797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 314, 100])
m.shape torch.Size([340, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.14254474639892578  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.14254474639892578  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 340, 100]), torch.Size([1, 340, 100])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.14279842376708984  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.15369796752929688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 340, 100])
m.shape torch.Size([374, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.15454673767089844  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.15454673767089844  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 374, 100]), torch.Size([1, 374, 100])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.15482616424560547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.16876745223999023  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 374, 100])
m.shape torch.Size([412, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.16985559463500977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.16985559463500977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 412, 100]), torch.Size([1, 412, 100])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.17016267776489258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.1876664161682129  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 412, 100])
m.shape torch.Size([436, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.18897485733032227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.18897485733032227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 436, 100]), torch.Size([1, 436, 100])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.1893000602722168  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.2101001739501953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 436, 100])
m.shape torch.Size([21708, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.29080629348754883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.29080629348754883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 21708, 100]), torch.Size([1, 21708, 100])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.30792236328125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4562702178955078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 21708, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.370290756225586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.3936281204223633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([23963, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.3936281204223633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([23963, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4164810180664062  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.393143653869629  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([23963, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4159965515136719  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.422769546508789  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 23963
----------------output nodes number: 3118
----------------edges number: 73492
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4229717254638672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.493955135345459  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.493955135345459  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4939570426940918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.493985652923584  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4939966201782227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4939966201782227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.494004249572754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4941720962524414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4942069053649902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4942069053649902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4942259788513184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.494779109954834  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4948129653930664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4948129653930664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4948301315307617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.495448112487793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([16, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4955320358276367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4955320358276367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4955625534057617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4968748092651367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4969472885131836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4969472885131836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4969720840454102  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4982118606567383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([25, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.498392105102539  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.498392105102539  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.4984397888183594  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5011577606201172  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5014023780822754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5014023780822754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5014615058898926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5052456855773926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.505408763885498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.505408763885498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5054469108581543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.508155345916748  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5084009170532227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5084009170532227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.508448600769043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5121679306030273  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5123519897460938  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5123519897460938  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5123863220214844  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5153045654296875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5155625343322754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5155625343322754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5156044960021973  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5194649696350098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5197672843933105  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5197672843933105  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.519813060760498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5243449211120605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.524552822113037  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.524552822113037  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.524583339691162  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.527818202972412  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.528203010559082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.528203010559082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5282526016235352  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5338563919067383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.534174919128418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.534174919128418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.534214973449707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5390214920043945  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5393996238708496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5393996238708496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5394434928894043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5450148582458496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5452852249145508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5452852249145508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5453157424926758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5494050979614258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5496973991394043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5496973991394043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5497279167175293  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5540308952331543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5542984008789062  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5542984008789062  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5543251037597656  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5582771301269531  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5587925910949707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5587925910949707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.558840274810791  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5662312507629395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5666718482971191  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5666718482971191  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5667119026184082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5732007026672363  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5735039710998535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5735039710998535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.573530673980713  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.5780434608459473  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([2708, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.6430983543395996  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.6430983543395996  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2708, 256]), torch.Size([1, 2708, 256])
----------------------------------------3
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 1.6486811637878418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 2.576669216156006  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2708, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 2.5063071250915527  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 2.5068531036376953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3118, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 2.5068531036376953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3118, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2655029296875 GB
    Memory Allocated: 2.507399082183838  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2655029296875 GB
    Memory Allocated: 2.5068531036376953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3118, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.03310108184814453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.06697368621826172  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.06699705123901367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 90926
first layer output nodes number: 29127
edges number: 277919
----------------------------------------before model layer 0
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.0430445671081543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([90926, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.0430445671081543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([51, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1498708724975586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1498708724975586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 51, 100]), torch.Size([1, 51, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.14990901947021484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.15021419525146484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 51, 100])
m.shape torch.Size([93, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.15026473999023438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.15026473999023438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 93, 100]), torch.Size([1, 93, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.15033435821533203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.15137577056884766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 93, 100])
m.shape torch.Size([216, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1515827178955078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1515827178955078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 216, 100]), torch.Size([1, 216, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.15174388885498047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.15528535842895508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 216, 100])
m.shape torch.Size([337, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.15570735931396484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.15570735931396484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 337, 100]), torch.Size([1, 337, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1559591293334961  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.16324901580810547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 337, 100])
m.shape torch.Size([491, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.16403770446777344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.16403770446777344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 491, 100]), torch.Size([1, 491, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.16440391540527344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1775803565979004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 491, 100])
m.shape torch.Size([565, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.17866039276123047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.17866039276123047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 565, 100]), torch.Size([1, 565, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.17908191680908203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1971902847290039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 565, 100])
m.shape torch.Size([636, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1986384391784668  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1986384391784668  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 636, 100]), torch.Size([1, 636, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1991124153137207  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.22281122207641602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 636, 100])
m.shape torch.Size([664, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.22455310821533203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.22455310821533203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 664, 100]), torch.Size([1, 664, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.22504806518554688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.25528812408447266  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 664, 100])
m.shape torch.Size([663, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.2572636604309082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.2572636604309082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 663, 100]), torch.Size([1, 663, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.25775766372680664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.29082822799682617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 663, 100])
m.shape torch.Size([25411, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.38524484634399414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.38524484634399414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 25411, 100]), torch.Size([1, 25411, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.4041781425476074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7484135627746582  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 25411, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.6474494934082031  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.675227165222168  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([29127, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.675227165222168  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29127, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7030048370361328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.675227165222168  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29127, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7030048370361328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7099494934082031  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 29127
----------------output nodes number: 3115
----------------edges number: 73527
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7101902961730957  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7811741828918457  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7811741828918457  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7811760902404785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.781191349029541  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7812061309814453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7812061309814453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7812213897705078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7814502716064453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7814860343933105  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7814860343933105  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7815146446228027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7821440696716309  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7821455001831055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7821455001831055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7821531295776367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.782374382019043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7824044227600098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7824044227600098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7824177742004395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7828984260559082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7829556465148926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7829556465148926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7829766273498535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7838788032531738  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([21, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7840099334716797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7840099334716797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7840499877929688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7860527038574219  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7861480712890625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7861480712890625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7861766815185547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7878074645996094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.787862777709961  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.787862777709961  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7878780364990234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7888545989990234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([27, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.789106845855713  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.789106845855713  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7891583442687988  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7928147315979004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7930216789245605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7930216789245605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7930636405944824  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7963366508483887  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7964887619018555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7964887619018555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7965173721313477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7989492416381836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7991852760314941  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7991852760314941  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.7992234230041504  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8027329444885254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8030238151550293  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8030238151550293  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.803067684173584  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.807410717010498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8078069686889648  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8078069686889648  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8078622817993164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.813725471496582  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8142056465148926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8142056465148926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8142685890197754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8213810920715332  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.821709156036377  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.821709156036377  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8217511177062988  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8267865180969238  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8269734382629395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8269734382629395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8269963264465332  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8299031257629395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.830183982849121  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.830183982849121  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.830214500427246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.834303855895996  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8345580101013184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8345580101013184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8345847129821777  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8383498191833496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8388209342956543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8388209342956543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8388667106628418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8456416130065918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8459362983703613  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8459362983703613  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8459649085998535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8503994941711426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8508939743041992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8508939743041992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.850937843322754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8580446243286133  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8583688735961914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8583688735961914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8583974838256836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.8632326126098633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([2715, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.928454875946045  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.928454875946045  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2715, 256]), torch.Size([1, 2715, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.9336333274841309  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.8624587059020996  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2715, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.7913341522216797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.791879653930664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3115, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.791879653930664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3115, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.7924251556396484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.791879653930664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3115, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.03952932357788086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.09031057357788086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.0903329849243164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 135522
first layer output nodes number: 33640
edges number: 328131
----------------------------------------before model layer 0
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.0606694221496582  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([135522, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.0606694221496582  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([19, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18668556213378906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18668556213378906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 19, 100]), torch.Size([1, 19, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18669986724853516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1868143081665039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 19, 100])
m.shape torch.Size([57, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18685007095336914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18685007095336914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 57, 100]), torch.Size([1, 57, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18689298629760742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18753385543823242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 57, 100])
m.shape torch.Size([100, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18762445449829102  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18762445449829102  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 100, 100]), torch.Size([1, 100, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1876997947692871  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1893444061279297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 100, 100])
m.shape torch.Size([229, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18964815139770508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.18964815139770508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 229, 100]), torch.Size([1, 229, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.1898188591003418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.19476938247680664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 229, 100])
m.shape torch.Size([339, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.19531583786010742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.19531583786010742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 339, 100]), torch.Size([1, 339, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.19556856155395508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.2046666145324707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 339, 100])
m.shape torch.Size([358, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.20534086227416992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.20534086227416992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 358, 100]), torch.Size([1, 358, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.20560789108276367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.21708154678344727  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 358, 100])
m.shape torch.Size([371, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.21791553497314453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.21791553497314453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 371, 100]), torch.Size([1, 371, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.21819210052490234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.23202037811279297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 371, 100])
m.shape torch.Size([436, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.23318147659301758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.23318147659301758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 436, 100]), torch.Size([1, 436, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.2335066795349121  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.2520318031311035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 436, 100])
m.shape torch.Size([456, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.25339841842651367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.25339841842651367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 456, 100]), torch.Size([1, 456, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.2537388801574707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.27548980712890625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 456, 100])
m.shape torch.Size([31275, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.3918280601501465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.3918280601501465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 31275, 100]), torch.Size([1, 31275, 100])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 0.4152655601501465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.071188449859619  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 31275, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.949061393737793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.9811429977416992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([33640, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.9811429977416992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([33640, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0132246017456055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 1.9811429977416992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([33640, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0132246017456055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0217161178588867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 33640
----------------output nodes number: 2981
----------------edges number: 70543
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.021989345550537  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0899109840393066  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0899109840393066  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0899147987365723  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0899453163146973  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0899477005004883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0899477005004883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.089951515197754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0900087356567383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.090013027191162  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.090013027191162  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0900168418884277  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0901007652282715  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0901107788085938  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0901107788085938  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.090116500854492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.090282440185547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.090308666229248  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.090308666229248  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.090320110321045  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0907320976257324  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0907726287841797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0907726287841797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.090787887573242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0914440155029297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0914902687072754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0914902687072754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.091505527496338  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.092268466949463  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0923304557800293  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0923304557800293  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0923476219177246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0933260917663574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([21, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.093499183654785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.093499183654785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.093539237976074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.096102714538574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([36, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.096428871154785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.096428871154785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.0964975357055664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.101372718811035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1016030311584473  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1016030311584473  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1016507148742676  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.105370044708252  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1056461334228516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1056461334228516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1056957244873047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1099109649658203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1101737022399902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1101737022399902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.110217571258545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.114253520965576  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1145009994506836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1145009994506836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.11453914642334  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1183156967163086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.118642807006836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.118642807006836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1186885833740234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1235408782958984  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1239027976989746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1239027976989746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.123950481414795  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1293387413024902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1295275688171387  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1295275688171387  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1295523643493652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1325278282165527  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.132948398590088  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.132948398590088  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.132996082305908  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.139051914215088  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.139338970184326  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.139338970184326  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.139371395111084  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.143716335296631  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1440463066101074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1440463066101074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.144080638885498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.148921489715576  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.149348735809326  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.149348735809326  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.149390697479248  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1556010246276855  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.155961036682129  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.155961036682129  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1559953689575195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1613168716430664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1619629859924316  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1619629859924316  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.162020206451416  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1712899208068848  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1715846061706543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1715846061706543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.1716113090515137  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.176124095916748  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([2584, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.2381997108459473  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.2381997108459473  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2584, 256]), torch.Size([1, 2584, 256])
----------------------------------------3
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 2.243701457977295  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 3.1130099296569824  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2584, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 3.046029567718506  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 3.0465517044067383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 3.0465517044067383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 3.0470738410949707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 3.0465517044067383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.05641365051269531  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.10525846481323242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 131056
first layer output nodes number: 29525
edges number: 287970
----------------------------------------before model layer 0
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.059207916259765625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([131056, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.059207916259765625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([21, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.16952848434448242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.16952848434448242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 21, 100]), torch.Size([1, 21, 100])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.16954469680786133  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.16967153549194336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 21, 100])
m.shape torch.Size([49, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.16970014572143555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.16970014572143555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 49, 100]), torch.Size([1, 49, 100])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.1697373390197754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.1702895164489746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 49, 100])
m.shape torch.Size([94, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17037630081176758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17037630081176758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 94, 100]), torch.Size([1, 94, 100])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17044687271118164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17199087142944336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 94, 100])
m.shape torch.Size([179, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17222261428833008  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17222261428833008  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 179, 100]), torch.Size([1, 179, 100])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17235612869262695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17622804641723633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 179, 100])
m.shape torch.Size([266, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17665719985961914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17665719985961914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 266, 100]), torch.Size([1, 266, 100])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.17685556411743164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.18399667739868164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 266, 100])
m.shape torch.Size([306, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.18458175659179688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.18458175659179688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 306, 100]), torch.Size([1, 306, 100])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.18481063842773438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.1946268081665039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 306, 100])
m.shape torch.Size([396, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.19554519653320312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.19554519653320312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 396, 100]), torch.Size([1, 396, 100])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.19584083557128906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.2106027603149414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 396, 100])
m.shape torch.Size([407, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.2116680145263672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.2116680145263672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 407, 100]), torch.Size([1, 407, 100])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.21197128295898438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.22925758361816406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 407, 100])
m.shape torch.Size([411, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.2304840087890625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.2304840087890625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 411, 100]), torch.Size([1, 411, 100])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.2307910919189453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.25040578842163086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 411, 100])
m.shape torch.Size([27396, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.3523106575012207  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.3523106575012207  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 27396, 100]), torch.Size([1, 27396, 100])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.3727231025695801  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8219637870788574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 27396, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.7163572311401367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.7445144653320312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([29525, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.7445144653320312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29525, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.7726716995239258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.7445144653320312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29525, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.7726716995239258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.7797112464904785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 29525
----------------output nodes number: 3007
----------------edges number: 70342
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.779953956604004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8476791381835938  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8476791381835938  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8476829528808594  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8477134704589844  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.847714900970459  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.847714900970459  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8477168083190918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8477587699890137  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8477811813354492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8477811813354492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.847792625427246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8481245040893555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8481621742248535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8481621742248535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8481793403625488  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.84879732131958  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8488526344299316  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8488526344299316  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8488736152648926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.849775791168213  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([34, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.84999418258667  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.84999418258667  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8500590324401855  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8533015251159668  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([12, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8533616065979004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8533616065979004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8533844947814941  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.854689121246338  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8548078536987305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8548078536987305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8548364639282227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8566675186157227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([27, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8569130897521973  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8569130897521973  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8569645881652832  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8606209754943848  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.860933780670166  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.860933780670166  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.860994815826416  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.865755558013916  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8660597801208496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8660597801208496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8661150932312012  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.870816707611084  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([16, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8709893226623535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8709893226623535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8710198402404785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8738274574279785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8742027282714844  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8742027282714844  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.874258041381836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8797340393066406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.880124568939209  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.880124568939209  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8801798820495605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8860430717468262  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8864459991455078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8864459991455078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8864994049072266  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8925342559814453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8928508758544922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8928508758544922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8928909301757812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.8976974487304688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.898231029510498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.898231029510498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.898292064666748  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.906043529510498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9065427780151367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9065427780151367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9065980911254883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9140100479125977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9142518043518066  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9142518043518066  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.914278507232666  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.918043613433838  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9185147285461426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9185147285461426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.91856050491333  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.92533540725708  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9260950088500977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9260950088500977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9261655807495117  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9371042251586914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.937577724456787  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.937577724456787  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9376215934753418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9447283744812012  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9451680183410645  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9451680183410645  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 1.9452061653137207  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2752685546875 GB
    Memory Allocated: 1.951653003692627  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([2527, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2752685546875 GB
    Memory Allocated: 2.0123534202575684  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2752685546875 GB
    Memory Allocated: 2.0123534202575684  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2527, 256]), torch.Size([1, 2527, 256])
----------------------------------------3
 Nvidia-smi: 14.2752685546875 GB
    Memory Allocated: 2.018500804901123  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2752685546875 GB
    Memory Allocated: 2.875955104827881  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2527, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2752685546875 GB
    Memory Allocated: 2.809248447418213  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2752685546875 GB
    Memory Allocated: 2.8097753524780273  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3007, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2752685546875 GB
    Memory Allocated: 2.8097753524780273  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3007, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2772216796875 GB
    Memory Allocated: 2.810302257537842  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2772216796875 GB
    Memory Allocated: 2.8097753524780273  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3007, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.054459571838378906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.10272932052612305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1027522087097168  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 129573
first layer output nodes number: 29696
edges number: 292430
----------------------------------------before model layer 0
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.05816364288330078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([129573, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.05816364288330078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([38, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17018699645996094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17018699645996094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 38, 100]), torch.Size([1, 38, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17021560668945312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17044305801391602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 38, 100])
m.shape torch.Size([64, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17047643661499023  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17047643661499023  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17052412033081055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17123937606811523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([88, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17131423950195312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17131423950195312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 88, 100]), torch.Size([1, 88, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17138004302978516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17282342910766602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 88, 100])
m.shape torch.Size([106, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17294883728027344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17294883728027344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 106, 100]), torch.Size([1, 106, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17302799224853516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.175323486328125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 106, 100])
m.shape torch.Size([125, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17551708221435547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17551708221435547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 125, 100]), torch.Size([1, 125, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17561054229736328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17896795272827148  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 125, 100])
m.shape torch.Size([159, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1792769432067871  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1792769432067871  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 159, 100]), torch.Size([1, 159, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1793961524963379  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18449640274047852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 159, 100])
m.shape torch.Size([185, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1849193572998047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1849193572998047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 185, 100]), torch.Size([1, 185, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1850576400756836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.19196176528930664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 185, 100])
m.shape torch.Size([203, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.19249773025512695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.19249773025512695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 203, 100]), torch.Size([1, 203, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.19264936447143555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20128107070922852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 203, 100])
m.shape torch.Size([202, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20188283920288086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20188283920288086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 202, 100]), torch.Size([1, 202, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20203351974487305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.21167707443237305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 202, 100])
m.shape torch.Size([28526, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.3178696632385254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.3178696632385254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 28526, 100]), torch.Size([1, 28526, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.3391232490539551  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.848127841949463  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 28526, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7403769493103027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7686972618103027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([29696, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7686972618103027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29696, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7970175743103027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7686972618103027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29696, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7970175743103027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8040976524353027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 29696
----------------output nodes number: 3050
----------------edges number: 74874
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8043417930603027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8772907257080078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8772907257080078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8772964477539062  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8773422241210938  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8773436546325684  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8773436546325684  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.877347469329834  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8774046897888184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.877410888671875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.877410888671875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8774147033691406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8775253295898438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8775620460510254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8775620460510254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.877577304840088  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.878126621246338  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8781423568725586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8781423568725586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8781499862670898  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8784780502319336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.878481388092041  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.878481388092041  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8784832954406738  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8785786628723145  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8786163330078125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8786163330078125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8786258697509766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8791694641113281  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8792080879211426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8792080879211426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8792176246643066  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8798279762268066  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8798809051513672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8798809051513672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.879892349243164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8807048797607422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8807735443115234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8807735443115234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8807868957519531  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8818283081054688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8818912506103516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8818912506103516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8819026947021484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8828754425048828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8829450607299805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8829450607299805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8829565048217773  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8840093612670898  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8840980529785156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8840980529785156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8841114044189453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8854331970214844  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8855419158935547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8855419158935547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8855571746826172  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8871746063232422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8872442245483398  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8872442245483398  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.887253761291504  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.888331413269043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8884410858154297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8884410858154297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8884544372558594  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8900566101074219  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8902058601379395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8902058601379395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8902230262756348  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8924031257629395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8924860954284668  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8924860954284668  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8924956321716309  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8937735557556152  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8939228057861328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8939228057861328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8939380645751953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8960895538330078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.896223545074463  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.896223545074463  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8962368965148926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8982129096984863  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8983335494995117  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8983335494995117  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8983449935913086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9001188278198242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9002680778503418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9002680778503418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9002814292907715  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9024443626403809  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9026222229003906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9026222229003906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9026374816894531  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9052162170410156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2918, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.976064682006836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.976064682006836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2918, 256]), torch.Size([1, 2918, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9816303253173828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.9770450592041016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2918, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.904817581176758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.9053516387939453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3050, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.9053516387939453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3050, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.905885696411133  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.9053516387939453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3050, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.053914546966552734  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.11055517196655273  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.11057758331298828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 151129
first layer output nodes number: 35358
edges number: 350184
----------------------------------------before model layer 0
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.06683063507080078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([151129, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.06683063507080078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([45, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20153427124023438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20153427124023438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 45, 100]), torch.Size([1, 45, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.201568603515625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20183897018432617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 45, 100])
m.shape torch.Size([50, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2018594741821289  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2018594741821289  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 50, 100]), torch.Size([1, 50, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20189762115478516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20246124267578125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 50, 100])
m.shape torch.Size([77, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2025284767150879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2025284767150879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 77, 100]), torch.Size([1, 77, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20258665084838867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20385360717773438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 77, 100])
m.shape torch.Size([78, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20394086837768555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20394086837768555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 78, 100]), torch.Size([1, 78, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20399904251098633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20568609237670898  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 78, 100])
m.shape torch.Size([78, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20580244064331055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20580244064331055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 78, 100]), torch.Size([1, 78, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20586061477661133  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20795488357543945  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 78, 100])
m.shape torch.Size([98, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2081451416015625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2081451416015625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 98, 100]), torch.Size([1, 98, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20821857452392578  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.21136760711669922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 98, 100])
m.shape torch.Size([124, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2116546630859375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2116546630859375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 124, 100]), torch.Size([1, 124, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2117471694946289  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.21637248992919922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 124, 100])
m.shape torch.Size([139, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.21674060821533203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.21674060821533203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 139, 100]), torch.Size([1, 139, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2168445587158203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.22275829315185547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 139, 100])
m.shape torch.Size([152, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.22321605682373047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.22321605682373047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 152, 100]), torch.Size([1, 152, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2233295440673828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.23057985305786133  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 152, 100])
m.shape torch.Size([34517, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.35942935943603516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.35942935943603516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 34517, 100]), torch.Size([1, 34517, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.38677310943603516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2305898666381836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 34517, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.0982489585876465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.1319689750671387  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([35358, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.1319689750671387  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([35358, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.165688991546631  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.1319689750671387  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([35358, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.165688991546631  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.174118995666504  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 35358
----------------output nodes number: 2981
----------------edges number: 73264
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.174405097961426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.245391368865967  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.245391368865967  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2453970909118652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.245522975921631  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.245551109313965  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.245551109313965  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2455663681030273  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.24600887298584  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2460074424743652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2460074424743652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.246009349822998  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.246091365814209  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([8, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2461442947387695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2461442947387695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.246159553527832  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.246922492980957  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2469305992126465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2469305992126465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.246934413909912  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2471518516540527  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.247201919555664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.247201919555664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.247213363647461  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.247945785522461  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2480173110961914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2480173110961914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.248032569885254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2491159439086914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2491612434387207  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2491612434387207  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2491707801818848  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2499146461486816  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2499332427978516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2499332427978516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.249937057495117  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2502613067626953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.250359535217285  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.250359535217285  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2503747940063477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2517786026000977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2518386840820312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2518386840820312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2518482208251953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2527923583984375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2528600692749023  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2528600692749023  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2528696060180664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.253880500793457  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.253937244415283  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.253937244415283  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2539448738098145  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2548069953918457  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2550482749938965  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2550482749938965  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2550768852233887  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.258510112762451  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.258634567260742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.258634567260742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2586498260498047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.260587692260742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.260671615600586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.260671615600586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.26068115234375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2619590759277344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.262108325958252  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.262108325958252  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2621235847473145  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.264275074005127  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2643485069274902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2643485069274902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2643561363220215  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2654852867126465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2655029296875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2655029296875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.265504837036133  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2658004760742188  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.265932559967041  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.265932559967041  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.265944004058838  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2677979469299316  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2678847312927246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.2678847312927246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.267892360687256  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.269181728363037  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2865, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.3380188941955566  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.3380188941955566  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2865, 256]), torch.Size([1, 2865, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.34452486038208  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 3.354872703552246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2865, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 3.284475803375244  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 3.2849979400634766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 3.2849979400634766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 3.285520076751709  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 3.2849979400634766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.06227302551269531  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.09754276275634766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.09756660461425781  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 94676
first layer output nodes number: 29702
edges number: 288398
----------------------------------------before model layer 0
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.04455852508544922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([94676, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.04455852508544922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([39, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15602493286132812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15602493286132812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 39, 100]), torch.Size([1, 39, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15605449676513672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15628814697265625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 39, 100])
m.shape torch.Size([100, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15634822845458984  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15634822845458984  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 100, 100]), torch.Size([1, 100, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15642356872558594  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1575450897216797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 100, 100])
m.shape torch.Size([113, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15763378143310547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15763378143310547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15771865844726562  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1595773696899414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([238, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15988969802856445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15988969802856445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 238, 100]), torch.Size([1, 238, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.16006708145141602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.16521120071411133  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 238, 100])
m.shape torch.Size([276, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.16563701629638672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.16563701629638672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 276, 100]), torch.Size([1, 276, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.16584300994873047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17325162887573242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 276, 100])
m.shape torch.Size([310, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1738419532775879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1738419532775879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 310, 100]), torch.Size([1, 310, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1740736961364746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18401288986206055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 310, 100])
m.shape torch.Size([390, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18491411209106445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18491411209106445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 390, 100]), torch.Size([1, 390, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18520498275756836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1997385025024414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 390, 100])
m.shape torch.Size([491, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20105648040771484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20105648040771484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 491, 100]), torch.Size([1, 491, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.20142269134521484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.22228527069091797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 491, 100])
m.shape torch.Size([480, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.22371149063110352  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.22371149063110352  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 480, 100]), torch.Size([1, 480, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.22406911849975586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.24695730209350586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 480, 100])
m.shape torch.Size([27265, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.34834861755371094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.34834861755371094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 27265, 100]), torch.Size([1, 27265, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.36866283416748047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8109722137451172  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 27265, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.705188274383545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7335143089294434  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([29702, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7335143089294434  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29702, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7618403434753418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7335143089294434  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29702, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7618403434753418  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7689218521118164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 29702
----------------output nodes number: 3160
----------------edges number: 77476
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.769167423248291  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8440937995910645  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8440937995910645  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.844099521636963  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8441853523254395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8441858291625977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8441858291625977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8441877365112305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8442296981811523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8442330360412598  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8442330360412598  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8442349433898926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8442902565002441  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8443069458007812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8443069458007812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8443126678466797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8445587158203125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8445630073547363  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8445630073547363  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8445649147033691  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8446602821350098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8447208404541016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8447208404541016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.844736099243164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8456058502197266  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8456764221191406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8456764221191406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.845693588256836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.846792221069336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8468317985534668  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8468317985534668  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8468413352966309  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8475184440612793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.847609043121338  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.847609043121338  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8476262092590332  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8489651679992676  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8490490913391113  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8490490913391113  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8490643501281738  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8503613471984863  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8504915237426758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8504915237426758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8505125045776367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.852442741394043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.852567195892334  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.852567195892334  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.852586269378662  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8544745445251465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8545517921447754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8545517921447754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8545632362365723  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.855776309967041  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8559246063232422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8559246063232422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8559436798095703  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8580989837646484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8581876754760742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8581876754760742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.858199119567871  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.859572410583496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8596878051757812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8596878051757812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.859701156616211  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8613967895507812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.861682415008545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.861682415008545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.86171293258667  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.86580228805542  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8659601211547852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8659601211547852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8659772872924805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8683977127075195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.868631362915039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.868631362915039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8686542510986328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8720417022705078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8723053932189941  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8723053932189941  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8723301887512207  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.876173496246338  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.876448631286621  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.876448631286621  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8764734268188477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8804903030395508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.880685806274414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.880685806274414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8807029724121094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8836040496826172  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2990, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.955439567565918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.955439567565918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2990, 256]), torch.Size([1, 2990, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.961362361907959  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.9749293327331543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2990, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.900704860687256  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.9012584686279297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3160, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.9012584686279297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3160, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.9018120765686035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.9012584686279297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3160, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.04093503952026367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.07093667984008789  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.07096052169799805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 80535
first layer output nodes number: 25853
edges number: 255388
----------------------------------------before model layer 0
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.03894519805908203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([80535, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.03894519805908203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([18, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13677215576171875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13677215576171875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 18, 100]), torch.Size([1, 18, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13678646087646484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13689661026000977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 18, 100])
m.shape torch.Size([37, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1369171142578125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1369171142578125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 37, 100]), torch.Size([1, 37, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13694477081298828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.137359619140625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 37, 100])
m.shape torch.Size([57, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13740968704223633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13740968704223633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 57, 100]), torch.Size([1, 57, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1374526023864746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13839244842529297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 57, 100])
m.shape torch.Size([60, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13846063613891602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13846063613891602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 60, 100]), torch.Size([1, 60, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1385054588317871  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.13980531692504883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 60, 100])
m.shape torch.Size([92, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1399545669555664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1399545669555664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 92, 100]), torch.Size([1, 92, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.14002323150634766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.14249515533447266  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 92, 100])
m.shape torch.Size([106, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.14269781112670898  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.14269781112670898  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 106, 100]), torch.Size([1, 106, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1427769660949707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1461806297302246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 106, 100])
m.shape torch.Size([154, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.14654302597045898  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.14654302597045898  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 154, 100]), torch.Size([1, 154, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.14665842056274414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15240812301635742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 154, 100])
m.shape torch.Size([183, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15289592742919922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.15289592742919922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 183, 100]), torch.Size([1, 183, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1530323028564453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.16080570220947266  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 183, 100])
m.shape torch.Size([213, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1614518165588379  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1614518165588379  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 213, 100]), torch.Size([1, 213, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.16161108016967773  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17177820205688477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 213, 100])
m.shape torch.Size([24933, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.26458168029785156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.26458168029785156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 24933, 100]), torch.Size([1, 24933, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2831583023071289  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6020984649658203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 24933, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.506812572479248  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.5314679145812988  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([25853, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.5314679145812988  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([25853, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.5561232566833496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.5314679145812988  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([25853, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.5561232566833496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.5622873306274414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 25853
----------------output nodes number: 3143
----------------edges number: 77996
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.5625038146972656  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6375946998596191  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6375946998596191  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6375985145568848  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6376824378967285  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.637685775756836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.637685775756836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6376876831054688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.63775634765625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6377625465393066  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6377625465393066  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6377644538879395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.63785982131958  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6379051208496094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6379051208496094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6379165649414062  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6385688781738281  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6386017799377441  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6386017799377441  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6386094093322754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6391510963439941  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.639200210571289  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.639200210571289  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6392097473144531  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.63995361328125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6399950981140137  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6399950981140137  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.640002727508545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6406512260437012  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6406726837158203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6406726837158203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.640676498413086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6410274505615234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6411199569702148  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6411199569702148  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6411333084106445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6424551010131836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6424918174743652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6424918174743652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6424975395202637  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.643104076385498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6431341171264648  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6431341171264648  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6431379318237305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6435956954956055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6436285972595215  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6436285972595215  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.643632411956787  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6441168785095215  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6441516876220703  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6441516876220703  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.644155502319336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6446666717529297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6447224617004395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6447224617004395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.644728183746338  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6455349922180176  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6455726623535156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6455726623535156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6455764770507812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6461410522460938  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6462030410766602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6462030410766602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6462087631225586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6470956802368164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6471595764160156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6471595764160156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.647165298461914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.648092269897461  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6481356620788574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6481356620788574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.648139476776123  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.6487841606140137  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3089, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.723576545715332  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.723576545715332  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3089, 256]), torch.Size([1, 3089, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7299461364746094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.767754554748535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3089, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.6933388710021973  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.693889617919922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3143, 256])
----------------------------------------before rst
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.693889617919922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3143, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.6944403648376465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 2.693889617919922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3143, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.03566408157348633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.09035158157348633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.09037399291992188  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 144638
first layer output nodes number: 29988
edges number: 289213
----------------------------------------before model layer 0
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.06427335739135742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([144638, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.06427335739135742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([69, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1750955581665039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1750955581665039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 69, 100]), torch.Size([1, 69, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17514705657958984  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17555904388427734  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 69, 100])
m.shape torch.Size([145, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17564153671264648  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17564153671264648  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 145, 100]), torch.Size([1, 145, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1757502555847168  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17737531661987305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 145, 100])
m.shape torch.Size([227, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17757511138916016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17757511138916016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 227, 100]), torch.Size([1, 227, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.17774486541748047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1814708709716797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 227, 100])
m.shape torch.Size([302, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18183612823486328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18183612823486328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 302, 100]), torch.Size([1, 302, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18206119537353516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18858814239501953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 302, 100])
m.shape torch.Size([357, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18914079666137695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.18914079666137695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 357, 100]), torch.Size([1, 357, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.1894068717956543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.19898557662963867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 357, 100])
m.shape torch.Size([371, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.19968223571777344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.19968223571777344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 371, 100]), torch.Size([1, 371, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.19995880126953125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2118511199951172  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 371, 100])
m.shape torch.Size([368, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.21267271041870117  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.21267271041870117  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 368, 100]), torch.Size([1, 368, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.21294736862182617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.22666025161743164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 368, 100])
m.shape torch.Size([382, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2276616096496582  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.2276616096496582  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 382, 100]), torch.Size([1, 382, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.22794675827026367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.24417734146118164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 382, 100])
m.shape torch.Size([348, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.24520158767700195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.24520158767700195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 348, 100]), torch.Size([1, 348, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.24546098709106445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.26206254959106445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 348, 100])
m.shape torch.Size([27419, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.3640766143798828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.3640766143798828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 27419, 100]), torch.Size([1, 27419, 100])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 0.3845062255859375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.834965705871582  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 27419, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7287096977233887  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7573084831237793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([29988, 100])
----------------------------------------before rst
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7573084831237793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29988, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.78590726852417  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7573084831237793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29988, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.78590726852417  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7930569648742676  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 29988
----------------output nodes number: 2998
----------------edges number: 62808
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.7933030128479004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8537869453430176  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8537869453430176  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8537964820861816  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8538727760314941  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8538951873779297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8538951873779297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.853921890258789  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8543224334716797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([47, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.854444980621338  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.854444980621338  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.85453462600708  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8565068244934082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([58, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8566851615905762  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8566851615905762  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8567957878112793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.86000394821167  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([71, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8602900505065918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8602900505065918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8604254722595215  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8653006553649902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([73, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8656539916992188  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8656539916992188  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.865793228149414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8717803955078125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([70, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8721818923950195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8721818923950195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8723154067993164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8789911270141602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([37, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.879209041595459  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.879209041595459  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.879279613494873  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8833022117614746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8834576606750488  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8834576606750488  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8834996223449707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8861851692199707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8864622116088867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8864622116088867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.886521339416504  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8907194137573242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8912925720214844  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8912925720214844  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.8914012908935547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.899881362915039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([34, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.900219440460205  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.900219440460205  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9002842903137207  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9057965278625488  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9061393737792969  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9061393737792969  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9061965942382812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9114608764648438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.91294527053833  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.91294527053833  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9131035804748535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9287762641906738  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9291152954101562  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9291152954101562  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9291706085205078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9350337982177734  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9356212615966797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9356212615966797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9356975555419922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9443187713623047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9446401596069336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9446401596069336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9446821212768555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9497175216674805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9499564170837402  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9499564170837402  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9499850273132324  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9536185264587402  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9538416862487793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9538416862487793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9538664817810059  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9571890830993652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9577150344848633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.9577150344848633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 14.2791748046875 GB
    Memory Allocated: 1.957768440246582  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2869873046875 GB
    Memory Allocated: 1.9652986526489258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2869873046875 GB
    Memory Allocated: 1.96565580368042  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2869873046875 GB
    Memory Allocated: 1.96565580368042  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.2869873046875 GB
    Memory Allocated: 1.9656920433044434  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2928466796875 GB
    Memory Allocated: 1.971055507659912  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2928466796875 GB
    Memory Allocated: 1.9716720581054688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2928466796875 GB
    Memory Allocated: 1.9716720581054688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 14.2928466796875 GB
    Memory Allocated: 1.9717292785644531  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3026123046875 GB
    Memory Allocated: 1.9805984497070312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.3026123046875 GB
    Memory Allocated: 1.9813218116760254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3026123046875 GB
    Memory Allocated: 1.9813218116760254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 14.3026123046875 GB
    Memory Allocated: 1.981386661529541  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3143310546875 GB
    Memory Allocated: 1.9918923377990723  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.3143310546875 GB
    Memory Allocated: 1.9927597045898438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3143310546875 GB
    Memory Allocated: 1.9927597045898438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 14.3143310546875 GB
    Memory Allocated: 1.9928340911865234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3280029296875 GB
    Memory Allocated: 2.0054054260253906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([2097, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.3280029296875 GB
    Memory Allocated: 2.055755615234375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3280029296875 GB
    Memory Allocated: 2.055755615234375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2097, 256]), torch.Size([1, 2097, 256])
----------------------------------------3
 Nvidia-smi: 14.3280029296875 GB
    Memory Allocated: 2.061267375946045  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3280029296875 GB
    Memory Allocated: 2.7664880752563477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2097, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3280029296875 GB
    Memory Allocated: 2.7074460983276367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3280029296875 GB
    Memory Allocated: 2.7079710960388184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([2998, 256])
----------------------------------------before rst
 Nvidia-smi: 14.3280029296875 GB
    Memory Allocated: 2.7079710960388184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2998, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3299560546875 GB
    Memory Allocated: 2.70849609375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3299560546875 GB
    Memory Allocated: 2.7079710960388184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2998, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06032276153564453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.11789846420288086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.11792182922363281  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 154553
first layer output nodes number: 36557
edges number: 359982
----------------------------------------before model layer 0
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06789302825927734  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([154553, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06789302825927734  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([46, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2057933807373047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2057933807373047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 46, 100]), torch.Size([1, 46, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2058277130126953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2061023712158203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 46, 100])
m.shape torch.Size([80, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2061448097229004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2061448097229004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 80, 100]), torch.Size([1, 80, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20620489120483398  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20710039138793945  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 80, 100])
m.shape torch.Size([110, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20719337463378906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20719337463378906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 110, 100]), torch.Size([1, 110, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.207275390625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20907974243164062  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 110, 100])
m.shape torch.Size([148, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2092595100402832  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2092595100402832  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 148, 100]), torch.Size([1, 148, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20937013626098633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21257257461547852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 148, 100])
m.shape torch.Size([160, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2128152847290039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2128152847290039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 160, 100]), torch.Size([1, 160, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2129344940185547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2172260284423828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 160, 100])
m.shape torch.Size([200, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21761369705200195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21761369705200195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 200, 100]), torch.Size([1, 200, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21776342391967773  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22417593002319336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 200, 100])
m.shape torch.Size([199, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22462034225463867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22462034225463867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 199, 100]), torch.Size([1, 199, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22476911544799805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.23218774795532227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 199, 100])
m.shape torch.Size([247, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2328495979309082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2328495979309082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 247, 100]), torch.Size([1, 247, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2330336570739746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.24352502822875977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 247, 100])
m.shape torch.Size([185, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.24405336380004883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.24405336380004883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 185, 100]), torch.Size([1, 185, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.24419164657592773  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.25302886962890625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 185, 100])
m.shape torch.Size([35182, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.38402318954467773  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.38402318954467773  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 35182, 100]), torch.Size([1, 35182, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.41136693954467773  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.290780544281006  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 35182, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1554226875305176  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.190286159515381  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([36557, 100])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.190286159515381  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([36557, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.225149631500244  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.190286159515381  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([36557, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.225149631500244  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.233865737915039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 36557
----------------output nodes number: 3123
----------------edges number: 76973
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.234161853790283  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.309079647064209  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.309079647064209  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.309081554412842  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3090968132019043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3091020584106445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3091020584106445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.30910587310791  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.309189796447754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.309192180633545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.309192180633545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3091940879821777  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3092494010925293  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.309258460998535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.309258460998535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.309262275695801  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3093996047973633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3094210624694824  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3094210624694824  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3094286918640137  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3097567558288574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3097801208496094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3097801208496094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3097877502441406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.310169219970703  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([13, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.31026554107666  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.31026554107666  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3102903366088867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.311703681945801  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.311739444732666  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.311739444732666  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.31174898147583  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3124260902404785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3124637603759766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3124637603759766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.312471389770508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3130664825439453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3130974769592285  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3130974769592285  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.313103199005127  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.313589572906494  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3135995864868164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3135995864868164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.313601493835449  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.313776969909668  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3138437271118164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3138437271118164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3138532638549805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3147974014282227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.314807415008545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.314807415008545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3148093223571777  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.315011501312256  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([9, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3151493072509766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3151493072509766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.315166473388672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.317106246948242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3171796798706055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3171796798706055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3171892166137695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.318333625793457  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.318467617034912  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.318467617034912  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3184828758239746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.320420742034912  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.320486545562744  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.320486545562744  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3204941749572754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.321516513824463  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.321685791015625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.321685791015625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3217029571533203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3241233825683594  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.324215888977051  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.324215888977051  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.324225425720215  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.325636863708496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3260130882263184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3260130882263184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.326047420501709  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.331368923187256  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.331594944000244  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.331594944000244  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.331615924835205  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.335014820098877  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.335350513458252  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.335350513458252  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.335379123687744  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.340214252471924  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([2993, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.4130234718322754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.4130234718322754  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2993, 256]), torch.Size([1, 2993, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.4196810722351074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.4399900436401367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2993, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.3658013343811035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.3663482666015625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3123, 256])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.3663482666015625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3123, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.3668951988220215  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.3663482666015625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3123, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06323385238647461  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.12150955200195312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.12153339385986328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 156432
first layer output nodes number: 34440
edges number: 341674
----------------------------------------before model layer 0
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06847667694091797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([156432, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06847667694091797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([30, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19970226287841797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19970226287841797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 30, 100]), torch.Size([1, 30, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19972515106201172  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1999053955078125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 30, 100])
m.shape torch.Size([45, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19992780685424805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19992780685424805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 45, 100]), torch.Size([1, 45, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19996213912963867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2004685401916504  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 45, 100])
m.shape torch.Size([64, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20052289962768555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20052289962768555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20057058334350586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20161962509155273  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([60, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20168542861938477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20168542861938477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 60, 100]), torch.Size([1, 60, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20173025131225586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20303010940551758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 60, 100])
m.shape torch.Size([70, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2031383514404297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2031383514404297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 70, 100]), torch.Size([1, 70, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20319080352783203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20507192611694336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 70, 100])
m.shape torch.Size([83, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2052316665649414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2052316665649414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 83, 100]), torch.Size([1, 83, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2052936553955078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20795917510986328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 83, 100])
m.shape torch.Size([89, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.208160400390625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.208160400390625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 89, 100]), torch.Size([1, 89, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20822715759277344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21155500411987305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 89, 100])
m.shape torch.Size([104, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21183156967163086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21183156967163086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 104, 100]), torch.Size([1, 104, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21190977096557617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21633291244506836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 104, 100])
m.shape torch.Size([131, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21673345565795898  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21673345565795898  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 131, 100]), torch.Size([1, 131, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21683168411254883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22309255599975586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 131, 100])
m.shape torch.Size([33764, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.34882450103759766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.34882450103759766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 33764, 100]), torch.Size([1, 33764, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.3739814758300781  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1741456985473633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 33764, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.047304630279541  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0801491737365723  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([34440, 100])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0801491737365723  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([34440, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1129937171936035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0801491737365723  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([34440, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1129937171936035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1212048530578613  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 34440
----------------output nodes number: 3163
----------------edges number: 76851
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.121485710144043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.196408748626709  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.196408748626709  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1964144706726074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.196500301361084  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.196526527404785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.196526527404785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1965456008911133  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.196965217590332  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.196990489959717  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.196990489959717  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.197007656097412  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.197505474090576  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.197506904602051  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.197506904602051  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1975107192993164  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.197648048400879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.197658061981201  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.197658061981201  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.197661876678467  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1978259086608887  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.197864532470703  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.197864532470703  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1978759765625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1984481811523438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.198458194732666  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.198458194732666  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1984620094299316  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1986794471740723  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1986865997314453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1986865997314453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.198688507080078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.198810577392578  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([16, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1989636421203613  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1989636421203613  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1989941596984863  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2011609077453613  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.201230525970459  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.201230525970459  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2012457847595215  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2024359703063965  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2025208473205566  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2025208473205566  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.202536106109619  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2038331031799316  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([19, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2040629386901855  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2040629386901855  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.204099178314209  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2074332237243652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.207603931427002  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.207603931427002  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2076306343078613  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2102742195129395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.210361957550049  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.210361957550049  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2103753089904785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2117905616760254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.212045669555664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.212045669555664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.212078094482422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2157421112060547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.216102123260498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.216102123260498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2161459922790527  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2214102745056152  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2216134071350098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2216134071350098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2216382026672363  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2247872352600098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.224976062774658  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.224976062774658  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.224997043609619  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2278084754943848  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2278943061828613  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2278943061828613  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2279038429260254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.229248523712158  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2293853759765625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2293853759765625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.229398727416992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.231374740600586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.231537342071533  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.231537342071533  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2315526008605957  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.233917713165283  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2340431213378906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2340431213378906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2340545654296875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2359085083007812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2363414764404297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2363414764404297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.236377716064453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.242502212524414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([2947, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3133459091186523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3133459091186523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2947, 256]), torch.Size([1, 2947, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3199987411499023  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.3336057662963867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2947, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.2595038414001465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.2600579261779785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.2600579261779785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.2606120109558105  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.2600579261779785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3163, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06394147872924805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.11695051193237305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1169729232788086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 142294
first layer output nodes number: 37347
edges number: 370601
----------------------------------------before model layer 0
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06361246109008789  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([142294, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06361246109008789  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([32, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20617914199829102  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20617914199829102  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 32, 100]), torch.Size([1, 32, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20620298385620117  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20639371871948242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 32, 100])
m.shape torch.Size([33, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2064065933227539  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2064065933227539  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 33, 100]), torch.Size([1, 33, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20643138885498047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2068033218383789  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 33, 100])
m.shape torch.Size([47, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20684385299682617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20684385299682617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 47, 100]), torch.Size([1, 47, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2068791389465332  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20765113830566406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 47, 100])
m.shape torch.Size([74, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20774412155151367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20774412155151367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 74, 100]), torch.Size([1, 74, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20779943466186523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20940351486206055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 74, 100])
m.shape torch.Size([87, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20953798294067383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20953798294067383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 87, 100]), torch.Size([1, 87, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20960283279418945  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21193742752075195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 87, 100])
m.shape torch.Size([86, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2120976448059082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2120976448059082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 86, 100]), torch.Size([1, 86, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21216249465942383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21492528915405273  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 86, 100])
m.shape torch.Size([98, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2151484489440918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2151484489440918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 98, 100]), torch.Size([1, 98, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21522188186645508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21888351440429688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 98, 100])
m.shape torch.Size([168, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21934747695922852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21934747695922852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 168, 100]), torch.Size([1, 168, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21947336196899414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22661447525024414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 168, 100])
m.shape torch.Size([135, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2270045280456543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2270045280456543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 135, 100]), torch.Size([1, 135, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22710561752319336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2335495948791504  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 135, 100])
m.shape torch.Size([36587, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.37021780014038086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.37021780014038086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 36587, 100]), torch.Size([1, 36587, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.39756155014038086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.335601329803467  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 36587, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1964240074157715  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2320408821105957  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([37347, 100])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2320408821105957  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([37347, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.26765775680542  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2320408821105957  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([37347, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.26765775680542  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.276562213897705  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 37347
----------------output nodes number: 2981
----------------edges number: 72503
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2768630981445312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3466720581054688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3466720581054688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3466758728027344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3467330932617188  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3467373847961426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3467373847961426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.346741199493408  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.346825122833252  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.34683895111084  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.34683895111084  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.346846580505371  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3470678329467773  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.347107410430908  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.347107410430908  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3471245765686035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3477425575256348  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.347745895385742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.347745895385742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.347749710083008  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3479137420654297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.347959041595459  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.347959041595459  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3479723930358887  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.348639965057373  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3487257957458496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3487257957458496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3487486839294434  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.350053310394287  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3500938415527344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3500938415527344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3501052856445312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3508377075195312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.350918769836426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.350918769836426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.350935935974121  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3521547317504883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.352231025695801  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.352231025695801  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3522462844848633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3534364700317383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.353452205657959  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.353452205657959  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3534560203552246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3537802696228027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([14, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3539533615112305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3539533615112305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.35398006439209  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3564367294311523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3564772605895996  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3564772605895996  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.356484889984131  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3572402000427246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.357337474822998  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.357337474822998  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3573508262634277  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3587660789489746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3588671684265137  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3588671684265137  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3588805198669434  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.360389232635498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.360415458679199  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.360415458679199  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.360419273376465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.36087703704834  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3616366386413574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3616366386413574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.361720561981201  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3723788261413574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.372629165649414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.372629165649414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.372659683227539  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.376749038696289  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.377079963684082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.377079963684082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3771142959594727  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.381955146789551  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.382079601287842  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.382079601287842  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3820929527282715  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3840689659118652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3841047286987305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3841047286987305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.384108543395996  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.384699821472168  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.384897232055664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.384897232055664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3849143981933594  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3876953125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.388240337371826  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.388240337371826  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.3882861137390137  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.396022319793701  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([2764, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.4624133110046387  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.4624133110046387  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2764, 256]), torch.Size([1, 2764, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.4678635597229004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.3982315063476562  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2764, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.330080986022949  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.3306031227111816  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.3306031227111816  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.331125259399414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 3.3306031227111816  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.05864143371582031  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.10943746566772461  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.10945987701416016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 136354
first layer output nodes number: 29359
edges number: 290910
----------------------------------------before model layer 0
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06122732162475586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([136354, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.06122732162475586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([24, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17360782623291016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17360782623291016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 24, 100]), torch.Size([1, 24, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17362594604492188  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17376947402954102  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 24, 100])
m.shape torch.Size([32, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1737842559814453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1737842559814453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 32, 100]), torch.Size([1, 32, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17380809783935547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1741657257080078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 32, 100])
m.shape torch.Size([59, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17422008514404297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17422008514404297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17426490783691406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17523813247680664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([66, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17531442642211914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17531442642211914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 66, 100]), torch.Size([1, 66, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17536401748657227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17679643630981445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 66, 100])
m.shape torch.Size([78, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17691707611083984  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17691707611083984  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 78, 100]), torch.Size([1, 78, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17697525024414062  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17906951904296875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 78, 100])
m.shape torch.Size([93, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17924833297729492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17924833297729492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 93, 100]), torch.Size([1, 93, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17931795120239258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18230295181274414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 93, 100])
m.shape torch.Size([108, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18254995346069336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18254995346069336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1826310157775879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18666410446166992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([103, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18693065643310547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18693065643310547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 103, 100]), torch.Size([1, 103, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18700790405273438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19138813018798828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 103, 100])
m.shape torch.Size([107, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19170856475830078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19170856475830078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 107, 100]), torch.Size([1, 107, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1917886734008789  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19690275192260742  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 107, 100])
m.shape torch.Size([28689, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.3037376403808594  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.3037376403808594  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 28689, 100]), torch.Size([1, 28689, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.32511329650878906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8427562713623047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 28689, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7356395721435547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7636384963989258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([29359, 100])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7636384963989258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29359, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7916374206542969  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7636384963989258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([29359, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7916374206542969  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7986373901367188  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 29359
----------------output nodes number: 2985
----------------edges number: 72641
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7988786697387695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.868821144104004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.868821144104004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8688268661499023  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.868912696838379  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.868924617767334  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.868924617767334  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.868934154510498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8691439628601074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8691587448120117  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8691587448120117  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8691682815551758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8694448471069336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8694500923156738  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8694500923156738  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8694539070129395  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.869591236114502  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8696069717407227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8696069717407227  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.869612693786621  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.869858741760254  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.869896411895752  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.869896411895752  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8699078559875488  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8704800605773926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8705129623413086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8705129623413086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8705224990844727  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8710660934448242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.871121883392334  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.871121883392334  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8711352348327637  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8719897270202637  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([14, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8721179962158203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8721179962158203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8721446990966797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8740406036376953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8740696907043457  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8740696907043457  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.874077320098877  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8746724128723145  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.874680519104004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.874680519104004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8746824264526367  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8748445510864258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([8, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.874943733215332  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.874943733215332  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8749589920043945  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8763628005981445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8764362335205078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8764362335205078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8764476776123047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8775806427001953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([18, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8778347969055176  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8778347969055176  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8778691291809082  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8815083503723145  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([6, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8815836906433105  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8815836906433105  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8815951347351074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8828883171081543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8830137252807617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8830137252807617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8830289840698242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8848600387573242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8850946426391602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8850946426391602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8851213455200195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8885126113891602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8887004852294922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8887004852294922  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8887214660644531  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8915328979492188  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8922724723815918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8922724723815918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8923468589782715  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9028353691101074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9032626152038574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9032626152038574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.903306484222412  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9097990989685059  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9102425575256348  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9102425575256348  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9102845191955566  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9167885780334473  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9170775413513184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9170775413513184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9171042442321777  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9214301109313965  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9217400550842285  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9217400550842285  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.921766757965088  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9262795448303223  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([2747, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9931845664978027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9931845664978027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2747, 256]), torch.Size([1, 2747, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9984240531921387  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.9357028007507324  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2747, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.8663973808288574  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.8669204711914062  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([2985, 256])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.8669204711914062  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2985, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.867443561553955  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.8669204711914062  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2985, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.056429386138916016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1010293960571289  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.10105228424072266  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 119721
first layer output nodes number: 27329
edges number: 270254
----------------------------------------before model layer 0
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.053896427154541016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([119721, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.053896427154541016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([28, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15742111206054688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15742111206054688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 28, 100]), torch.Size([1, 28, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1574420928955078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1576099395751953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 28, 100])
m.shape torch.Size([41, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15763044357299805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15763044357299805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 41, 100]), torch.Size([1, 41, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15766191482543945  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1581254005432129  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 41, 100])
m.shape torch.Size([76, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15819501876831055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15819501876831055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15825223922729492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15950250625610352  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([62, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15956640243530273  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15956640243530273  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 62, 100]), torch.Size([1, 62, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.15961313247680664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16095685958862305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 62, 100])
m.shape torch.Size([78, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16107892990112305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16107892990112305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 78, 100]), torch.Size([1, 78, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16113710403442383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16323137283325195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 78, 100])
m.shape torch.Size([99, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16342401504516602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16342401504516602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 99, 100]), torch.Size([1, 99, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1634984016418457  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16667985916137695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 99, 100])
m.shape torch.Size([121, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16695833206176758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16695833206176758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 121, 100]), torch.Size([1, 121, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.16704893112182617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1715688705444336  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 121, 100])
m.shape torch.Size([129, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17190837860107422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17190837860107422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 129, 100]), torch.Size([1, 129, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17200469970703125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17749500274658203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 129, 100])
m.shape torch.Size([145, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1779332160949707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1779332160949707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 145, 100]), torch.Size([1, 145, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17804193496704102  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18497419357299805  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 145, 100])
m.shape torch.Size([26550, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2838263511657715  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2838263511657715  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 26550, 100]), torch.Size([1, 26550, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.30360841751098633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.708092212677002  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 26550, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.6071858406066895  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.6332793235778809  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([27329, 100])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.6332793235778809  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([27329, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.6599507331848145  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.633857250213623  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([27329, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.6599202156066895  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.6664667129516602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 27329
----------------output nodes number: 3063
----------------edges number: 74034
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.6666936874389648  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7379717826843262  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7379717826843262  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7379775047302246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.738023281097412  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([23, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7380871772766113  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7380871772766113  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.738131046295166  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7390961647033691  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7390937805175781  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7390937805175781  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7391014099121094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7393760681152344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7393956184387207  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7393956184387207  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.739403247833252  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7397313117980957  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7398018836975098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7398018836975098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7398228645324707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7408719062805176  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7408771514892578  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7408771514892578  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7408809661865234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.741098403930664  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7411918640136719  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7411918640136719  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7412128448486328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7425556182861328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7425742149353027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7425742149353027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7425799369812012  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7429862022399902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7430047988891602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7430047988891602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7430086135864258  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7433061599731445  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([19, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7435235977172852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7435235977172852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7435598373413086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7466402053833008  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7468347549438477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7468347549438477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7468671798706055  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7498502731323242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7499284744262695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7499284744262695  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7499418258666992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7512636184692383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7514300346374512  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7514300346374512  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.751452922821045  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7538790702819824  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.754129409790039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.754129409790039  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7541618347167969  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7578258514404297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7579078674316406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7579078674316406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7579193115234375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7592926025390625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7596330642700195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7596330642700195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7596712112426758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7645158767700195  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.76478910446167  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.76478910446167  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.764819622039795  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.768908977508545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7691054344177246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7691054344177246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7691264152526855  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7720847129821777  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7725791931152344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7725791931152344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7726268768310547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.779684066772461  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.779935359954834  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.779935359954834  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7799601554870605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7838034629821777  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.784034252166748  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.784034252166748  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.784055233001709  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7874541282653809  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7880206108093262  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7880206108093262  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7880682945251465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.7961268424987793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([2801, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8634061813354492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8634061813354492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2801, 256]), torch.Size([1, 2801, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8696088790893555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.8194007873535156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2801, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.748462677001953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.7489991188049316  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3063, 256])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.7489991188049316  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3063, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.74953556060791  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.7489991188049316  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3063, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.0502471923828125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.10164546966552734  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1016683578491211  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 137971
first layer output nodes number: 30842
edges number: 304190
----------------------------------------before model layer 0
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.061293601989746094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([137971, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.061293601989746094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([60, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17831850051879883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17831850051879883  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 60, 100]), torch.Size([1, 60, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17836332321166992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17872190475463867  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 60, 100])
m.shape torch.Size([69, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17875099182128906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17875099182128906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 69, 100]), torch.Size([1, 69, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.178802490234375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17957496643066406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 69, 100])
m.shape torch.Size([79, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17963790893554688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17963790893554688  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 79, 100]), torch.Size([1, 79, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.17969703674316406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18099355697631836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 79, 100])
m.shape torch.Size([112, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18113088607788086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18113088607788086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 112, 100]), torch.Size([1, 112, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1812148094177246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18363714218139648  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 112, 100])
m.shape torch.Size([109, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18379831314086914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18379831314086914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 109, 100]), torch.Size([1, 109, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18388032913208008  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1868114471435547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 109, 100])
m.shape torch.Size([124, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18704795837402344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18704795837402344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 124, 100]), torch.Size([1, 124, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.18714046478271484  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1911182403564453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 124, 100])
m.shape torch.Size([127, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19140338897705078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19140338897705078  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 127, 100]), torch.Size([1, 127, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.1914987564086914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19623708724975586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 127, 100])
m.shape torch.Size([155, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19665145874023438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19665145874023438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 155, 100]), torch.Size([1, 155, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.19676780700683594  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20336532592773438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 155, 100])
m.shape torch.Size([181, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20391416549682617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20391416549682617  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 181, 100]), torch.Size([1, 181, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20404958724975586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2126908302307129  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 181, 100])
m.shape torch.Size([29826, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.3237338066101074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.3237338066101074  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 29826, 100]), torch.Size([1, 29826, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.34713268280029297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9382820129394531  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 29826, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8240013122558594  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.853414535522461  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([30842, 100])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.853414535522461  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([30842, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8828277587890625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.853414535522461  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([30842, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8828277587890625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.890181064605713  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 30842
----------------output nodes number: 3016
----------------edges number: 69785
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.8904337882995605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9576349258422852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9576349258422852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.957657814025879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.957840919494629  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.95784330368042  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.95784330368042  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9578566551208496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.958056926727295  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9580793380737305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9580793380737305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9580984115600586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9585180282592773  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9585585594177246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9585585594177246  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9585833549499512  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9593024253845215  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9593143463134766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9593143463134766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9593238830566406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9596672058105469  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9597086906433105  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9597086906433105  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.959723949432373  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9603800773620605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([19, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.960500717163086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.960500717163086  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9605369567871094  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9623489379882812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9624385833740234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9624385833740234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9624652862548828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9639873504638672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([32, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9642510414123535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9642510414123535  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9643120765686035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9682183265686035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.968226432800293  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.968226432800293  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9682340621948242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.968775749206543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.968867301940918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.968867301940918  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9688844680786133  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9702234268188477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9706764221191406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9706764221191406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9707527160644531  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9772377014160156  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([22, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9774746894836426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9774746894836426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9775166511535645  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.981377124786377  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9815311431884766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9815311431884766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9815559387207031  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9840106964111328  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9852385520935059  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9852385520935059  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9854025840759277  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0027899742126465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.003169536590576  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.003169536590576  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0032267570495605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.009692668914795  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.009958267211914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.009958267211914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0099925994873047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0141124725341797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.014355182647705  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.014355182647705  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0143837928771973  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.018017292022705  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.019080638885498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.019080638885498  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.019193172454834  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0342726707458496  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.034639358520508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.034639358520508  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0346813201904297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.040597915649414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0414652824401855  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0414652824401855  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0415492057800293  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0539698600769043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0544991493225098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0544991493225098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0545506477355957  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.062532901763916  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0634360313415527  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0634360313415527  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.063516139984131  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.076493740081787  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0771918296813965  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0771918296813965  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0772528648376465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0875678062438965  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([2433, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.145998001098633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.145998001098633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2433, 256]), torch.Size([1, 2433, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1506385803222656  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.981205940246582  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2433, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.915127754211426  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.915656089782715  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([3016, 256])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.915656089782715  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3016, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.916184425354004  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.915656089782715  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([3016, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.057037353515625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.12520313262939453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.12522554397583008  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 182980
first layer output nodes number: 32722
edges number: 320885
----------------------------------------before model layer 0
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.07919597625732422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([182980, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.07919597625732422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([64, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2021336555480957  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2021336555480957  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20218133926391602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20256280899047852  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([80, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20259857177734375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20259857177734375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 80, 100]), torch.Size([1, 80, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20265865325927734  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2035541534423828  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 80, 100])
m.shape torch.Size([150, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20369195938110352  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20369195938110352  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 150, 100]), torch.Size([1, 150, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20380449295043945  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2062673568725586  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 150, 100])
m.shape torch.Size([152, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2064375877380371  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2064375877380371  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 152, 100]), torch.Size([1, 152, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20655107498168945  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20983648300170898  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 152, 100])
m.shape torch.Size([170, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2100968360900879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2100968360900879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 170, 100]), torch.Size([1, 170, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21022367477416992  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21478986740112305  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 170, 100])
m.shape torch.Size([214, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21520519256591797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21520519256591797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 214, 100]), torch.Size([1, 214, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21536540985107422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22222900390625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 214, 100])
m.shape torch.Size([273, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22286081314086914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22286081314086914  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 273, 100]), torch.Size([1, 273, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.22306489944458008  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.23324918746948242  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 273, 100])
m.shape torch.Size([193, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.23372268676757812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.23372268676757812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 193, 100]), torch.Size([1, 193, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.23386669158935547  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.24207496643066406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 193, 100])
m.shape torch.Size([246, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2428278923034668  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2428278923034668  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 246, 100]), torch.Size([1, 246, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2430119514465332  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.25475311279296875  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 246, 100])
m.shape torch.Size([31180, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.3708157539367676  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.3708157539367676  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 31180, 100]), torch.Size([1, 31180, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.3942532539367676  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0459275245666504  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 31180, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9261374473571777  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.957343578338623  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([32722, 100])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.957343578338623  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([32722, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9885497093200684  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.957343578338623  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([32722, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9885497093200684  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9963512420654297  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 32722
----------------output nodes number: 2990
----------------edges number: 59262
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 1.9966177940368652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0538172721862793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0538172721862793  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.053830623626709  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0539374351501465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.053938865661621  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.053938865661621  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0539464950561523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.054060935974121  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([46, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.054190158843994  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.054190158843994  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0542778968811035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0562081336975098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([49, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0563530921936035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0563530921936035  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0564465522766113  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.059156894683838  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.059302806854248  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.059302806854248  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0593791007995605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0621256828308105  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([73, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0625085830688477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0625085830688477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.062647819519043  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0686349868774414  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.06937313079834  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.06937313079834  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0696020126342773  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0810461044311523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([42, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0812549591064453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0812549591064453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0813350677490234  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0859012603759766  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0866141319274902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0866141319274902  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.086780071258545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.097400188446045  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([119, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0988078117370605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0988078117370605  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.0990347862243652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.115149974822998  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1158928871154785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1158928871154785  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1160473823547363  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1280980110168457  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.128632068634033  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.128632068634033  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1287331581115723  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1373257637023926  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1377625465393066  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1377625465393066  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1378369331359863  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1446805000305176  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([91, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.146134376525879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.146134376525879  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.146307945251465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1634912490844727  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([60, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1642699241638184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1642699241638184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.164384365081787  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1765151023864746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1770577430725098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1770577430725098  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1771321296691895  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.185537815093994  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1858115196228027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1858115196228027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.185847759246826  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1901965141296387  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1907496452331543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1907496452331543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.190812587738037  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1988062858581543  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1989212036132812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1989212036132812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.1989364624023438  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2009811401367188  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2013773918151855  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2013773918151855  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2014174461364746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2070651054382324  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.207347869873047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.207347869873047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.207376480102539  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.211610794067383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.21182918548584  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.21182918548584  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.211850166320801  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.215102195739746  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.215644359588623  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.215644359588623  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2156920433044434  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.223416805267334  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2240161895751953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2240161895751953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2240676879882812  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2327709197998047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([1881, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.277942180633545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.277942180633545  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1881, 256]), torch.Size([1, 1881, 256])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.2815299034118652  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.932889938354492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1881, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.8764991760253906  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.8770227432250977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([2990, 256])
----------------------------------------before rst
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.8770227432250977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2990, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.8775463104248047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 2.8770227432250977  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([2990, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.07379961013793945  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.12458086013793945  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.12460470199584961  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

first layer input nodes number: 134676
first layer output nodes number: 38621
edges number: 384284
----------------------------------------before model layer 0
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.061159610748291016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([134676, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.061159610748291016  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([26, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20834922790527344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20834922790527344  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 26, 100]), torch.Size([1, 26, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20836925506591797  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.208526611328125  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 26, 100])
m.shape torch.Size([40, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20854663848876953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20854663848876953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 40, 100]), torch.Size([1, 40, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20857715606689453  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20902633666992188  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 40, 100])
m.shape torch.Size([39, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20905494689941406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20905494689941406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 39, 100]), torch.Size([1, 39, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20908451080322266  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.20972633361816406  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 39, 100])
m.shape torch.Size([43, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2097759246826172  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2097759246826172  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 43, 100]), torch.Size([1, 43, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.209808349609375  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21074295043945312  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 43, 100])
m.shape torch.Size([41, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21080350875854492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21080350875854492  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 41, 100]), torch.Size([1, 41, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21083498001098633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2119464874267578  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 41, 100])
m.shape torch.Size([63, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21207189559936523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21207189559936523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21211957931518555  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21414422988891602  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([56, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21426677703857422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21426677703857422  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 56, 100]), torch.Size([1, 56, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2143087387084961  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21639680862426758  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 56, 100])
m.shape torch.Size([65, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2165699005126953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2165699005126953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 65, 100]), torch.Size([1, 65, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21661853790283203  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.219390869140625  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 65, 100])
m.shape torch.Size([86, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21965503692626953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21965503692626953  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 86, 100]), torch.Size([1, 86, 100])
----------------------------------------3
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.21971988677978516  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 0.2238316535949707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 86, 100])
m.shape torch.Size([38162, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 0.3663773536682129  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 0.3663773536682129  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 38162, 100]), torch.Size([1, 38162, 100])
----------------------------------------3
 Nvidia-smi: 14.4744873046875 GB
    Memory Allocated: 0.39481115341186523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.414525032043457  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 38162, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.2708091735839844  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.30764102935791  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

h_self size  torch.Size([38621, 100])
----------------------------------------before rst
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.30764102935791  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([38621, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.344472885131836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.30764102935791  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

torch.Size([38621, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.344472885131836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.354012966156006  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------input nodes number: 38621
----------------output nodes number: 3152
----------------edges number: 78737
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.3543248176574707  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4301271438598633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4301271438598633  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.430130958557129  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4304285049438477  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4304404258728027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4304404258728027  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4304423332214355  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.430631160736084  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.430644989013672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.430644989013672  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4306468963623047  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.430849075317383  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.43086576461792  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.43086576461792  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4308676719665527  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.43110990524292  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4311513900756836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4311513900756836  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.431155204772949  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.431746482849121  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4317679405212402  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4317679405212402  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.431769847869873  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.4320921897888184  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3144, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.507636070251465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.507636070251465  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

 h.shape torch.Size([1, 3144, 256]), torch.Size([1, 3144, 256])
----------------------------------------3
 Nvidia-smi: 14.6756591796875 GB
    Memory Allocated: 2.5139074325561523  GigaBytes
Max Memory Allocated: 3.5810256004333496  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.5719151496887207  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3144, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.49676513671875  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.497317314147949  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

h_self size  torch.Size([3152, 256])
----------------------------------------before rst
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.497317314147949  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([3152, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.4978694915771484  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.497317314147949  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([3152, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.05644512176513672  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.10527849197387695  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.10530233383178711  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

first layer input nodes number: 131085
first layer output nodes number: 34155
edges number: 339142
----------------------------------------before model layer 0
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.05952596664428711  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([131085, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.05952596664428711  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

m.shape torch.Size([43, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18947315216064453  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18947315216064453  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 43, 100]), torch.Size([1, 43, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18950557708740234  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18976354598999023  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 43, 100])
m.shape torch.Size([38, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18977594375610352  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18977594375610352  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 38, 100]), torch.Size([1, 38, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1898045539855957  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1902308464050293  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 38, 100])
m.shape torch.Size([48, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19027042388916016  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19027042388916016  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1903066635131836  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19109535217285156  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([52, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19115495681762695  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19115495681762695  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 52, 100]), torch.Size([1, 52, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1911940574645996  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1923222541809082  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 52, 100])
m.shape torch.Size([57, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19240903854370117  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19240903854370117  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 57, 100]), torch.Size([1, 57, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19245195388793945  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19398975372314453  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 57, 100])
m.shape torch.Size([73, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19413185119628906  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19413185119628906  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 73, 100]), torch.Size([1, 73, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19418716430664062  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19653987884521484  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 73, 100])
m.shape torch.Size([76, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19671058654785156  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19671058654785156  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19676780700683594  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19960880279541016  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([80, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19981861114501953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19981861114501953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 80, 100]), torch.Size([1, 80, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19987869262695312  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.20328044891357422  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 80, 100])
m.shape torch.Size([104, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.2035994529724121  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.2035994529724121  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 104, 100]), torch.Size([1, 104, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.20367765426635742  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.20864391326904297  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 104, 100])
m.shape torch.Size([33584, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.33371496200561523  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.33371496200561523  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 33584, 100]), torch.Size([1, 33584, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.3587374687194824  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1566853523254395  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 33584, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.030860424041748  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0634331703186035  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

h_self size  torch.Size([34155, 100])
----------------------------------------before rst
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0634331703186035  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([34155, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.096005916595459  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0634331703186035  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([34155, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.096005916595459  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.104149341583252  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------input nodes number: 34155
----------------output nodes number: 3156
----------------edges number: 78472
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1044278144836426  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1799726486206055  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1799726486206055  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1799745559692383  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1800031661987305  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1800074577331543  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1800074577331543  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.180009365081787  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1800780296325684  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1800832748413086  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1800832748413086  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1800851821899414  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1801671981811523  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1801743507385254  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1801743507385254  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.180176258087158  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1802849769592285  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.180318832397461  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.180318832397461  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.180326461791992  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.180814743041992  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.180830478668213  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.180830478668213  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1808342933654785  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.181105136871338  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1811141967773438  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1811141967773438  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1811161041259766  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.181264877319336  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1813101768493652  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1813101768493652  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1813178062438965  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1819663047790527  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1820030212402344  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1820030212402344  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.182008743286133  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.182575225830078  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1826157569885254  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1826157569885254  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.182621479034424  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.183228015899658  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1832714080810547  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1832714080810547  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.183277130126953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1839237213134766  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1840076446533203  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1840076446533203  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1840171813964844  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1852283477783203  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.18526029586792  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.18526029586792  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1852641105651855  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1857752799987793  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.185831069946289  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.185831069946289  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1858367919921875  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.186643600463867  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1867618560791016  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1867618560791016  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1867733001708984  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.188467025756836  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1885037422180176  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1885037422180176  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.188507556915283  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.189098834991455  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.189141273498535  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.189141273498535  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.189145088195801  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.189763069152832  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.189830780029297  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.189830780029297  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1898365020751953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.1908035278320312  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3109, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.265598773956299  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.265598773956299  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3109, 256]), torch.Size([1, 3109, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.271528720855713  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.3160767555236816  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3109, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.2412004470825195  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.241753101348877  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

h_self size  torch.Size([3156, 256])
----------------------------------------before rst
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.241753101348877  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([3156, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.2423057556152344  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.241753101348877  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([3156, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.054497718811035156  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.08537578582763672  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.08539915084838867  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

first layer input nodes number: 82887
first layer output nodes number: 26794
edges number: 264902
----------------------------------------before model layer 0
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.03990983963012695  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([82887, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.03990983963012695  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

m.shape torch.Size([35, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14224863052368164  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14224863052368164  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 35, 100]), torch.Size([1, 35, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14227533340454102  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1424860954284668  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 35, 100])
m.shape torch.Size([48, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14250850677490234  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14250850677490234  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14254474639892578  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1430826187133789  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([65, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14313745498657227  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14313745498657227  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 65, 100]), torch.Size([1, 65, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14318609237670898  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1442561149597168  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 65, 100])
m.shape torch.Size([79, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1443495750427246  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1443495750427246  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 79, 100]), torch.Size([1, 79, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1444087028503418  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1461176872253418  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 79, 100])
m.shape torch.Size([88, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14625215530395508  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14625215530395508  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 88, 100]), torch.Size([1, 88, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1463179588317871  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1486797332763672  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 88, 100])
m.shape torch.Size([93, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14885473251342773  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.14885473251342773  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 93, 100]), torch.Size([1, 93, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1489243507385254  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.15190935134887695  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 93, 100])
m.shape torch.Size([82, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.15208864212036133  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.15208864212036133  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 82, 100]), torch.Size([1, 82, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.15215063095092773  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.15522003173828125  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 82, 100])
m.shape torch.Size([116, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1555347442626953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1555347442626953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 116, 100]), torch.Size([1, 116, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.15562152862548828  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.16055679321289062  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 116, 100])
m.shape torch.Size([120, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.16091585159301758  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.16091585159301758  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 120, 100]), torch.Size([1, 120, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.16100549697875977  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.16672992706298828  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 120, 100])
m.shape torch.Size([26068, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.263796329498291  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.263796329498291  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 26068, 100]), torch.Size([1, 26068, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.2832188606262207  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6622042655944824  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 26068, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.5632824897766113  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.5888352394104004  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

h_self size  torch.Size([26794, 100])
----------------------------------------before rst
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.5888352394104004  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([26794, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6143879890441895  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.5888352394104004  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([26794, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6143879890441895  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6212973594665527  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------input nodes number: 26794
----------------output nodes number: 3105
----------------edges number: 77290
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6215205192565918  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6964325904846191  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6964325904846191  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.696434497833252  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6964497566223145  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6964530944824219  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6964530944824219  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6964569091796875  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6965141296386719  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6965155601501465  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6965155601501465  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6965174674987793  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6965594291687012  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6965627670288086  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6965627670288086  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6965646743774414  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.696619987487793  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6966538429260254  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6966538429260254  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6966614723205566  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6971497535705566  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6971673965454102  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6971673965454102  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6971712112426758  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6974687576293945  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6974787712097168  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6974787712097168  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6974806785583496  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6976428031921387  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6976547241210938  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6976547241210938  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6976566314697266  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6978321075439453  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6978888511657715  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6978888511657715  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6978964805603027  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6987051963806152  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6987476348876953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6987476348876953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6987533569335938  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6993999481201172  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6994519233703613  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6994519233703613  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.6994576454162598  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7002243995666504  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7002620697021484  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7002620697021484  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.700265884399414  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7008304595947266  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7008709907531738  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7008709907531738  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7008748054504395  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7014660835266113  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7015085220336914  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7015085220336914  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.701512336730957  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7021303176879883  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7021746635437012  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7021746635437012  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7021784782409668  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7028231620788574  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3074, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7776126861572266  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7776126861572266  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3074, 256]), torch.Size([1, 3074, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.7834758758544922  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.821495532989502  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3074, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.747225761413574  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.747769832611084  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

h_self size  torch.Size([3105, 256])
----------------------------------------before rst
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.747769832611084  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([3105, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.7483139038085938  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.747769832611084  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([3105, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.036533355712890625  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.08078384399414062  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.08080768585205078  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

first layer input nodes number: 118783
first layer output nodes number: 32502
edges number: 322645
----------------------------------------before model layer 0
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.05402231216430664  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([118783, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.05402231216430664  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

m.shape torch.Size([30, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17760705947875977  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17760705947875977  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 30, 100]), torch.Size([1, 30, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17762994766235352  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1778101921081543  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 30, 100])
m.shape torch.Size([46, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17783308029174805  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17783308029174805  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 46, 100]), torch.Size([1, 46, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17786741256713867  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17838239669799805  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 46, 100])
m.shape torch.Size([52, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17842340469360352  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17842340469360352  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 52, 100]), torch.Size([1, 52, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17846250534057617  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17931842803955078  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 52, 100])
m.shape torch.Size([44, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17936468124389648  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.17936468124389648  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 44, 100]), torch.Size([1, 44, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1793980598449707  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18035459518432617  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 44, 100])
m.shape torch.Size([54, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18043851852416992  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18043851852416992  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 54, 100]), torch.Size([1, 54, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1804795265197754  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18193435668945312  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 54, 100])
m.shape torch.Size([59, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18204593658447266  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18204593658447266  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18209075927734375  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1839923858642578  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([101, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1842336654663086  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1842336654663086  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 101, 100]), torch.Size([1, 101, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1843090057373047  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18807601928710938  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 101, 100])
m.shape torch.Size([102, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18834257125854492  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18834257125854492  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.18841886520385742  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19275617599487305  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([96, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1930398941040039  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1930398941040039  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 96, 100]), torch.Size([1, 96, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19311141967773438  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.19768905639648438  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 96, 100])
m.shape torch.Size([31918, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.3165574073791504  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.3165574073791504  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 31918, 100]), torch.Size([1, 31918, 100])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.34033823013305664  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0287766456604004  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 31918, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.9081873893737793  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.9391837120056152  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

h_self size  torch.Size([32502, 100])
----------------------------------------before rst
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.9391837120056152  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([32502, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.9701800346374512  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.9391837120056152  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([32502, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.9701800346374512  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.9779291152954102  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------input nodes number: 32502
----------------output nodes number: 3144
----------------edges number: 78342
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 1.9781951904296875  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.053609848022461  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.053609848022461  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0536117553710938  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0536670684814453  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.053673267364502  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.053673267364502  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0536751747131348  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0537705421447754  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0538506507873535  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0538506507873535  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.053864002227783  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0549988746643066  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.05502986907959  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.05502986907959  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0550355911254883  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0555620193481445  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.055572986602783  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.055572986602783  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.055574893951416  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0557637214660645  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0557775497436523  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0557775497436523  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.055779457092285  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0559816360473633  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.056013584136963  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.056013584136963  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0560173988342285  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0564751625061035  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.056528091430664  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.056528091430664  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0565338134765625  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.057300567626953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.057374954223633  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.057374954223633  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.057382583618164  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0584583282470703  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0584750175476074  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0584750175476074  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0584769248962402  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0587592124938965  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.05880069732666  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.05880069732666  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.058804512023926  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0593957901000977  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0594606399536133  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0594606399536133  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0594663619995117  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0603933334350586  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0604138374328613  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0604138374328613  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.060415744781494  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.0607380867004395  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3114, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.135560989379883  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.135560989379883  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3114, 256]), torch.Size([1, 3114, 256])
----------------------------------------3
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 2.142000198364258  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.1942520141601562  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3114, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.119490623474121  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.1200413703918457  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

h_self size  torch.Size([3144, 256])
----------------------------------------before rst
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.1200413703918457  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([3144, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.1205921173095703  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 3.1200413703918457  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([3144, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.04991292953491211  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.1242074966430664  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.12423038482666016  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

first layer input nodes number: 199432
first layer output nodes number: 46354
edges number: 460348
----------------------------------------before model layer 0
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.08594608306884766  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([199432, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.7518310546875 GB
    Memory Allocated: 0.08594608306884766  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

m.shape torch.Size([33, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2626533508300781  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2626533508300781  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 33, 100]), torch.Size([1, 33, 100])
----------------------------------------3
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2626781463623047  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2628765106201172  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 33, 100])
m.shape torch.Size([64, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2629117965698242  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2629117965698242  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.26295948028564453  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2636747360229492  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([43, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2636990547180176  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2636990547180176  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 43, 100]), torch.Size([1, 43, 100])
----------------------------------------3
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2637314796447754  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.26444053649902344  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 43, 100])
m.shape torch.Size([80, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2645435333251953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2645435333251953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 80, 100]), torch.Size([1, 80, 100])
----------------------------------------3
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2646036148071289  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.26633453369140625  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 80, 100])
m.shape torch.Size([83, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.26645946502685547  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.26645946502685547  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 83, 100]), torch.Size([1, 83, 100])
----------------------------------------3
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2665214538574219  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2687530517578125  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 83, 100])
m.shape torch.Size([101, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2689480781555176  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2689480781555176  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 101, 100]), torch.Size([1, 101, 100])
----------------------------------------3
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.26902341842651367  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2722630500793457  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 101, 100])
m.shape torch.Size([129, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.27256202697753906  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.27256202697753906  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 129, 100]), torch.Size([1, 129, 100])
----------------------------------------3
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2726583480834961  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.27747440338134766  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 129, 100])
m.shape torch.Size([121, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2777872085571289  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2777872085571289  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 121, 100]), torch.Size([1, 121, 100])
----------------------------------------3
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2778778076171875  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.28303050994873047  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 121, 100])
m.shape torch.Size([154, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.28350162506103516  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.28350162506103516  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 154, 100]), torch.Size([1, 154, 100])
----------------------------------------3
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.2836170196533203  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9237060546875 GB
    Memory Allocated: 0.29097652435302734  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 154, 100])
m.shape torch.Size([45546, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.0936279296875 GB
    Memory Allocated: 0.46084070205688477  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0936279296875 GB
    Memory Allocated: 0.46084070205688477  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 45546, 100]), torch.Size([1, 45546, 100])
----------------------------------------3
 Nvidia-smi: 15.0936279296875 GB
    Memory Allocated: 0.49477529525756836  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.905601978302002  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 45546, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.733156681060791  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.7773633003234863  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

h_self size  torch.Size([46354, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.7773633003234863  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([46354, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.8215699195861816  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.7773633003234863  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

torch.Size([46354, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.8215699195861816  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.8332886695861816  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------input nodes number: 46354
----------------output nodes number: 3048
----------------edges number: 75832
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.8336572647094727  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9066600799560547  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9066600799560547  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9066619873046875  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9067039489746094  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.906714916229248  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.906714916229248  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9067206382751465  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.906886577606201  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.906890869140625  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.906890869140625  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.906892776489258  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9069881439208984  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.907010555267334  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.907010555267334  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9070162773132324  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9073424339294434  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9073572158813477  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9073572158813477  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9073610305786133  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9076051712036133  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9076132774353027  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9076132774353027  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9076151847839355  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9077506065368652  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.907773017883301  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.907773017883301  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9077768325805664  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9081010818481445  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9081368446350098  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9081368446350098  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.908142566680908  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9086689949035645  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9086809158325195  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9086809158325195  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9086828231811523  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9088850021362305  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.908949851989746  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.908949851989746  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9089574813842773  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9098730087280273  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9098868370056152  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9098868370056152  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.909888744354248  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9101309776306152  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.910184860229492  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.910184860229492  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9101905822753906  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9109573364257812  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9109930992126465  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9109930992126465  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.910996913909912  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9115347862243652  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.911553382873535  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.911553382873535  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.911555290222168  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.911837577819824  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.911900520324707  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.911900520324707  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9119062423706055  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9127931594848633  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.912900924682617  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.912900924682617  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9129104614257812  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9144554138183594  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9145660400390625  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9145660400390625  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9145755767822266  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.916187286376953  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3007, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9884352684020996  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.9884352684020996  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

 h.shape torch.Size([1, 3007, 256]), torch.Size([1, 3007, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.994302272796631  GigaBytes
Max Memory Allocated: 3.646873950958252  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 4.019969463348389  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3007, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.9476089477539062  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.9481430053710938  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([3048, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.9481430053710938  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3048, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.9486770629882812  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.9481430053710938  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3048, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.07993936538696289  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1408400535583496  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.14086341857910156  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 163479
first layer output nodes number: 39949
edges number: 396503
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.0715947151184082  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([163479, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.0715947151184082  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([25, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2234663963317871  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2234663963317871  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 25, 100]), torch.Size([1, 25, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22348546981811523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22363662719726562  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 25, 100])
m.shape torch.Size([67, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2236771583557129  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2236771583557129  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 67, 100]), torch.Size([1, 67, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22372770309448242  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22448015213012695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 67, 100])
m.shape torch.Size([54, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22451543807983398  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22451543807983398  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 54, 100]), torch.Size([1, 54, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22455644607543945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22544574737548828  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 54, 100])
m.shape torch.Size([63, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22551918029785156  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22551918029785156  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22556686401367188  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22693252563476562  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([81, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22705984115600586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22705984115600586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 81, 100]), torch.Size([1, 81, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22712087631225586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22930383682250977  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 81, 100])
m.shape torch.Size([91, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2294769287109375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2294769287109375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 91, 100]), torch.Size([1, 91, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22954559326171875  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23247241973876953  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 91, 100])
m.shape torch.Size([102, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23270416259765625  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23270416259765625  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23278045654296875  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23658514022827148  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([123, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23691368103027344  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23691368103027344  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 123, 100]), torch.Size([1, 123, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23700618743896484  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24224472045898438  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 123, 100])
m.shape torch.Size([149, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24269819259643555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24269819259643555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 149, 100]), torch.Size([1, 149, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24280977249145508  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2499251365661621  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 149, 100])
m.shape torch.Size([39194, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.39587879180908203  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.39587879180908203  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 39194, 100]), torch.Size([1, 39194, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.4250812530517578  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.498617172241211  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 39194, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.350435256958008  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.388533592224121  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([39949, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.388533592224121  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([39949, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4266319274902344  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.388533592224121  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([39949, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4266319274902344  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.436587333679199  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 39949
----------------output nodes number: 3112
----------------edges number: 77483
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.436908721923828  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.511496067047119  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.511496067047119  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5114998817443848  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.511557102203369  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.511590003967285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.511590003967285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.511601448059082  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5120935440063477  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5121140480041504  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5121140480041504  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.512119770050049  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.512485980987549  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5124940872192383  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5124940872192383  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.512495994567871  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5126447677612305  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.512669086456299  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.512669086456299  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5126729011535645  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.513023853302002  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5130395889282227  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5130395889282227  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5130414962768555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5132837295532227  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.513301372528076  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.513301372528076  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.513303279876709  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.513558864593506  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.513577461242676  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.513577461242676  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5135793685913086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.513848304748535  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.513988971710205  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.513988971710205  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5140023231506348  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5159783363342285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.516056537628174  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.516056537628174  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.516064167022705  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.517246723175049  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.517375946044922  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.517375946044922  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5173873901367188  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5192413330078125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([1, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.519258975982666  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.519258975982666  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.519260883331299  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.519583225250244  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3077, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5935168266296387  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5935168266296387  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3077, 256]), torch.Size([1, 3077, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5998501777648926  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.645329475402832  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3077, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5713930130004883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5719380378723145  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([3112, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5719380378723145  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3112, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5724830627441406  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5719380378723145  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3112, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.06655693054199219  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.12319755554199219  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.12322092056274414  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 151687
first layer output nodes number: 38966
edges number: 386774
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.06718063354492188  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([151687, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.06718063354492188  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([31, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2157750129699707  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2157750129699707  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 31, 100]), torch.Size([1, 31, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21579885482788086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21598529815673828  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 31, 100])
m.shape torch.Size([48, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21600914001464844  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21600914001464844  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21604537963867188  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.216583251953125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([75, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21664905548095703  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21664905548095703  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.216705322265625  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21793889999389648  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([74, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21802139282226562  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21802139282226562  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 74, 100]), torch.Size([1, 74, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2180767059326172  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2196807861328125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 74, 100])
m.shape torch.Size([48, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2197427749633789  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2197427749633789  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21977901458740234  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2210693359375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([82, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22123479843139648  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22123479843139648  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 82, 100]), torch.Size([1, 82, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2212967872619629  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2239365577697754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 82, 100])
m.shape torch.Size([105, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22417974472045898  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22417974472045898  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 105, 100]), torch.Size([1, 105, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2242588996887207  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22818660736083984  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 105, 100])
m.shape torch.Size([118, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2284989356994629  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2284989356994629  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 118, 100]), torch.Size([1, 118, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22858762741088867  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23360872268676758  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 118, 100])
m.shape torch.Size([135, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23401737213134766  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23401737213134766  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 135, 100]), torch.Size([1, 135, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23411846160888672  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24056243896484375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 135, 100])
m.shape torch.Size([38250, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.3830900192260742  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.3830900192260742  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 38250, 100]), torch.Size([1, 38250, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.4115886688232422  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.435655117034912  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 38250, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2906551361083984  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.3278160095214844  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([38966, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.3278160095214844  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([38966, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.3649768829345703  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.3278160095214844  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([38966, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.3649768829345703  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.3743858337402344  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 38966
----------------output nodes number: 3129
----------------edges number: 77943
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.374699592590332  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.449737548828125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.449737548828125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4497432708740234  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.449869155883789  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4498724937438965  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4498724937438965  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4498744010925293  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4499564170837402  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.449962615966797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.449962615966797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4499645233154297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4500598907470703  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4500746726989746  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4500746726989746  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4500784873962402  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.450295925140381  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.450303077697754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.450303077697754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4503049850463867  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4504270553588867  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4504361152648926  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4504361152648926  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4504380226135254  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.450573444366455  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.45058536529541  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.45058536529541  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.450587272644043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4507627487182617  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4508156776428223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4508156776428223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4508233070373535  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4515786170959473  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4515905380249023  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4515905380249023  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.451592445373535  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.451807975769043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4518237113952637  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4518237113952637  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4518256187438965  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452054500579834  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452071189880371  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452071189880371  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452073097229004  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452315330505371  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4523329734802246  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4523329734802246  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4523348808288574  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4525904655456543  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4526281356811523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4526281356811523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452631950378418  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453169822692871  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4532084465026855  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4532084465026855  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453212261199951  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4537768363952637  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453885555267334  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453885555267334  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453895092010498  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.455440044403076  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3102, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.529970645904541  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.529970645904541  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3102, 256]), torch.Size([1, 3102, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.535914897918701  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5826854705810547  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3102, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.508298397064209  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5088462829589844  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([3129, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5088462829589844  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3129, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5093941688537598  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5088462829589844  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3129, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.06229972839355469  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.13315725326538086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1331796646118164  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 190206
first layer output nodes number: 40248
edges number: 399149
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.08175945281982422  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([190206, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.08175945281982422  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([37, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2346506118774414  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2346506118774414  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 37, 100]), torch.Size([1, 37, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2346782684326172  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23489952087402344  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 37, 100])
m.shape torch.Size([50, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2349233627319336  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2349233627319336  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 50, 100]), torch.Size([1, 50, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23496150970458984  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23552513122558594  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 50, 100])
m.shape torch.Size([60, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23557329177856445  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23557329177856445  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 60, 100]), torch.Size([1, 60, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23561811447143555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2366042137145996  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 60, 100])
m.shape torch.Size([85, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2367086410522461  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2367086410522461  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 85, 100]), torch.Size([1, 85, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2367725372314453  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23861408233642578  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 85, 100])
m.shape torch.Size([80, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23873138427734375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23873138427734375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 80, 100]), torch.Size([1, 80, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23879146575927734  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24094009399414062  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 80, 100])
m.shape torch.Size([96, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24112462997436523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24112462997436523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 96, 100]), torch.Size([1, 96, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2411961555480957  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24427175521850586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 96, 100])
m.shape torch.Size([148, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24462223052978516  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24462223052978516  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 148, 100]), torch.Size([1, 148, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24473285675048828  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25025415420532227  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 148, 100])
m.shape torch.Size([136, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25060415267944336  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25060415267944336  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 136, 100]), torch.Size([1, 136, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25070619583129883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2564883232116699  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 136, 100])
m.shape torch.Size([168, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2570009231567383  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2570009231567383  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 168, 100]), torch.Size([1, 168, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2571268081665039  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.26514482498168945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 168, 100])
m.shape torch.Size([39388, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.41181373596191406  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.41181373596191406  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 39388, 100]), torch.Size([1, 39388, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.4411602020263672  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5280704498291016  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 39388, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.378936290740967  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4173197746276855  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([40248, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4173197746276855  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([40248, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4557032585144043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4173197746276855  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([40248, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4557032585144043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.465369701385498  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 40248
----------------output nodes number: 2981
----------------edges number: 74019
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4656920433044434  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5369482040405273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5369482040405273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.53695011138916  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.536992073059082  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5369954109191895  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5369954109191895  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5369973182678223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.537052631378174  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5370616912841797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5370616912841797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5370655059814453  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.537202835083008  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.537208080291748  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.537208080291748  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.537209987640381  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5373053550720215  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5373144149780273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5373144149780273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.53731632232666  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.53745174407959  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([12, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5375895500183105  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5375895500183105  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5376124382019043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.539557933807373  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5397214889526367  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5397214889526367  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.539748191833496  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5422048568725586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.542206287384033  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.542206287384033  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.542208194732666  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.542410373687744  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5424251556396484  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5424251556396484  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5424270629882812  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.542642593383789  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.542659282684326  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.542659282684326  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.542661190032959  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.542903423309326  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5429210662841797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5429210662841797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5429229736328125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5431785583496094  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5432162284851074  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5432162284851074  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.543220043182373  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.543757915496826  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.543816566467285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.543816566467285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5438222885131836  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5446691513061523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.544754981994629  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.544754981994629  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.54476261138916  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5459985733032227  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5460872650146484  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5460872650146484  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5460948944091797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.547384262084961  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2932, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.617831230163574  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.617831230163574  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2932, 256]), torch.Size([1, 2932, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6234426498413086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.6363534927368164  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2932, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5657334327697754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.566255569458008  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.566255569458008  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5667777061462402  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.566255569458008  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.07648992538452148  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.11916780471801758  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.11919116973876953  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 114562
first layer output nodes number: 34814
edges number: 345530
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.052579402923583984  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([114562, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.052579402923583984  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([31, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18511581420898438  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18511581420898438  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 31, 100]), torch.Size([1, 31, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18513965606689453  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18532609939575195  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 31, 100])
m.shape torch.Size([43, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1853466033935547  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1853466033935547  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 43, 100]), torch.Size([1, 43, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1853790283203125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18586254119873047  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 43, 100])
m.shape torch.Size([55, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18590784072875977  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18590784072875977  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 55, 100]), torch.Size([1, 55, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18594884872436523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18685102462768555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 55, 100])
m.shape torch.Size([64, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18692588806152344  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18692588806152344  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18697357177734375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1883563995361328  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([75, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18847227096557617  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18847227096557617  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18852853775024414  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19054698944091797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([68, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19067096710205078  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19067096710205078  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 68, 100]), torch.Size([1, 68, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19072246551513672  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19291114807128906  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 68, 100])
m.shape torch.Size([89, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19311761856079102  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19311761856079102  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 89, 100]), torch.Size([1, 89, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19318437576293945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19651222229003906  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 89, 100])
m.shape torch.Size([91, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19675016403198242  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19675016403198242  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 91, 100]), torch.Size([1, 91, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19681882858276367  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2006983757019043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 91, 100])
m.shape torch.Size([122, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.20107316970825195  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.20107316970825195  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 122, 100]), torch.Size([1, 122, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.20116472244262695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.20699834823608398  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 122, 100])
m.shape torch.Size([34176, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.33426809310913086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.33426809310913086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 34176, 100]), torch.Size([1, 34176, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.36161184310913086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1901793479919434  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 34176, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0596766471862793  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0928778648376465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([34814, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0928778648376465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([34814, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1260790824890137  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0928778648376465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([34814, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1260790824890137  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1343793869018555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 34814
----------------output nodes number: 3118
----------------edges number: 77787
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.13466215133667  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2095842361450195  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2095842361450195  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.209589958190918  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2097959518432617  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.209801197052002  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.209801197052002  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2098031044006348  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.209911823272705  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.209928512573242  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.209928512573242  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.209932327270508  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.210176467895508  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2101855278015137  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2101855278015137  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2101874351501465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.210336208343506  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2103490829467773  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2103490829467773  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.21035099029541  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2105398178100586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2105536460876465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2105536460876465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2105555534362793  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2107577323913574  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2107744216918945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2107744216918945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2107763290405273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2110185623168945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.211036205291748  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.211036205291748  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.211038112640381  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2112936973571777  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2113122940063477  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2113122940063477  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2113142013549805  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.211583137512207  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2116055488586426  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2116055488586426  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2116074562072754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2119297981262207  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3105, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2867259979248047  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2867259979248047  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3105, 256]), torch.Size([1, 3105, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2936882972717285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.3516387939453125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3105, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.2773590087890625  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.277904987335205  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([3118, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.277904987335205  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3118, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.2784509658813477  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.277904987335205  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3118, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.04833507537841797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.10106945037841797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.10109233856201172  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 139982
first layer output nodes number: 39107
edges number: 388350
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.06317949295043945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([139982, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.06317949295043945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([29, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2119278907775879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2119278907775879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 29, 100]), torch.Size([1, 29, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21194982528686523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21212387084960938  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 29, 100])
m.shape torch.Size([45, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21214675903320312  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21214675903320312  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 45, 100]), torch.Size([1, 45, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21218109130859375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21268749237060547  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 45, 100])
m.shape torch.Size([55, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21273183822631836  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21273183822631836  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 55, 100]), torch.Size([1, 55, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21277284622192383  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21367502212524414  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 55, 100])
m.shape torch.Size([70, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2137589454650879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2137589454650879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 70, 100]), torch.Size([1, 70, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21381139755249023  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21532678604125977  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 70, 100])
m.shape torch.Size([59, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21541070938110352  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21541070938110352  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2154555320739746  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21704769134521484  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([87, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21721982955932617  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.21721982955932617  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 87, 100]), torch.Size([1, 87, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2172846794128418  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22007322311401367  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 87, 100])
m.shape torch.Size([113, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2203354835510254  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2203354835510254  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22042036056518555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22464418411254883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([93, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22487926483154297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22487926483154297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 93, 100]), torch.Size([1, 93, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22494888305664062  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22890567779541016  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 93, 100])
m.shape torch.Size([126, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2292933464050293  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2292933464050293  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 126, 100]), torch.Size([1, 126, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.22938776016235352  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23540449142456055  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 126, 100])
m.shape torch.Size([38430, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.37852048873901367  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.37852048873901367  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 38430, 100]), torch.Size([1, 38430, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.4071536064147949  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.440819263458252  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 38430, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.295663356781006  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.332958698272705  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([39107, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.332958698272705  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([39107, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.3702540397644043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.332958698272705  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([39107, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.3702540397644043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.379578113555908  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 39107
----------------output nodes number: 3011
----------------edges number: 75010
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.3798928260803223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452104091644287  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452104091644287  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4521079063415527  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452165126800537  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4521665573120117  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4521665573120117  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4521684646606445  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4522104263305664  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4522194862365723  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4522194862365723  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452223300933838  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4523606300354004  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4523658752441406  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4523658752441406  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4523677825927734  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452463150024414  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.45247220993042  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.45247220993042  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4524741172790527  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4526095390319824  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452620506286621  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452620506286621  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452622413635254  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452784538269043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452810764312744  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.452810764312744  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4528145790100098  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4531922340393066  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453205108642578  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453205108642578  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453207015991211  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453409194946289  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4534239768981934  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4534239768981934  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453425884246826  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.453641414642334  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4537100791931152  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4537100791931152  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4537177085876465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4546866416931152  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4547014236450195  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4547014236450195  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4547033309936523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.454958915710449  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4550156593322754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4550156593322754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.455021381378174  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4558281898498535  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.455885887145996  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.455885887145996  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4558916091918945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4567384719848633  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.456778049468994  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.456778049468994  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4567818641662598  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4573731422424316  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4574408531188965  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4574408531188965  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.457446575164795  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.458413600921631  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2983, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5300869941711426  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5300869941711426  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2983, 256]), torch.Size([1, 2983, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5357766151428223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.555677890777588  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2983, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.4840917587280273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.484619140625  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([3011, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.484619140625  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3011, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.4851465225219727  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.484619140625  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3011, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.05837249755859375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.12477874755859375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1248025894165039  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 175922
first layer output nodes number: 41355
edges number: 410289
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.077301025390625  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([175922, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.077301025390625  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([28, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23445463180541992  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23445463180541992  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 28, 100]), torch.Size([1, 28, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23447561264038086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23464345932006836  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 28, 100])
m.shape torch.Size([39, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23466205596923828  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23466205596923828  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 39, 100]), torch.Size([1, 39, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23469161987304688  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23512935638427734  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 39, 100])
m.shape torch.Size([64, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23518610000610352  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23518610000610352  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23523378372192383  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2362828254699707  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([95, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23640060424804688  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23640060424804688  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 95, 100]), torch.Size([1, 95, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23647212982177734  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23852920532226562  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 95, 100])
m.shape torch.Size([90, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2386612892150879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2386612892150879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 90, 100]), torch.Size([1, 90, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23872900009155273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24115228652954102  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 90, 100])
m.shape torch.Size([119, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24138450622558594  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24138450622558594  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 119, 100]), torch.Size([1, 119, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24147319793701172  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2452869415283203  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 119, 100])
m.shape torch.Size([137, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24560022354125977  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24560022354125977  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 137, 100]), torch.Size([1, 137, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24570322036743164  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2508230209350586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 137, 100])
m.shape torch.Size([106, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25108766555786133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25108766555786133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 106, 100]), torch.Size([1, 106, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25116682052612305  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.255678653717041  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 106, 100])
m.shape torch.Size([130, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.256075382232666  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.256075382232666  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 130, 100]), torch.Size([1, 130, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25617265701293945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.26238536834716797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 130, 100])
m.shape torch.Size([40547, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.41338634490966797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.41338634490966797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 40547, 100]), torch.Size([1, 40547, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.44359683990478516  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5920000076293945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 40547, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.438676357269287  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4781155586242676  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([41355, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4781155586242676  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([41355, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.517554759979248  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4781155586242676  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([41355, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.517554759979248  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.52744722366333  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 41355
----------------output nodes number: 3162
----------------edges number: 77650
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5277795791625977  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6025376319885254  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6025376319885254  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.602539539337158  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.60258150100708  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([19, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.602653980255127  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.602653980255127  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6026902198791504  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.60374116897583  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6037473678588867  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6037473678588867  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.603756904602051  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.604100227355957  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.604118824005127  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.604118824005127  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.604126453399658  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.604454517364502  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6044912338256836  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6044912338256836  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6045026779174805  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.605074882507324  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6051645278930664  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6051645278930664  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6051855087280273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6065282821655273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6065564155578613  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6065564155578613  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6065640449523926  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6071057319641113  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.607123374938965  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.607123374938965  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6071271896362305  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.607424736022949  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6074576377868652  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6074576377868652  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6074633598327637  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.607949733734131  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6079845428466797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6079845428466797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.607990264892578  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6085166931152344  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([16, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.608729362487793  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.608729362487793  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.608759880065918  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.611781120300293  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([4, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.611823558807373  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.611823558807373  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6118311882019043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.612639904022217  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.612682342529297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.612682342529297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6126880645751953  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6133346557617188  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6134300231933594  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6134300231933594  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6134414672851562  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6148147583007812  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6148786544799805  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6148786544799805  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6148862838745117  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6158552169799805  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6158699989318848  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6158699989318848  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6158719062805176  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6161274909973145  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6161651611328125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6161651611328125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.616168975830078  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6167068481445312  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.616725444793701  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.616725444793701  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.616727352142334  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6170096397399902  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.617093563079834  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.617093563079834  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6171011924743652  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.618283748626709  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.618302345275879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.618302345275879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6183042526245117  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6186132431030273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6186819076538086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6186819076538086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.618687629699707  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.619654655456543  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3059, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6931538581848145  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6931538581848145  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3059, 256]), torch.Size([1, 3059, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.699838161468506  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.729884624481201  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3059, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.6558427810668945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.6563968658447266  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.6563968658447266  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.6569509506225586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.6563968658447266  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3162, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.07207202911376953  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.14824390411376953  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.14826631546020508  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 201887
first layer output nodes number: 40025
edges number: 396250
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.08712387084960938  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([201887, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.08712387084960938  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([30, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23890399932861328  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23890399932861328  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 30, 100]), torch.Size([1, 30, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23892688751220703  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2391071319580078  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 30, 100])
m.shape torch.Size([71, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23914861679077148  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23914861679077148  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 71, 100]), torch.Size([1, 71, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23920202255249023  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.23999738693237305  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 71, 100])
m.shape torch.Size([102, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24008512496948242  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24008512496948242  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24016141891479492  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2418355941772461  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([92, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24193477630615234  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24193477630615234  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 92, 100]), torch.Size([1, 92, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2420034408569336  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24399471282958984  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 92, 100])
m.shape torch.Size([103, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24415254592895508  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24415254592895508  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 103, 100]), torch.Size([1, 103, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24422979354858398  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24699640274047852  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 103, 100])
m.shape torch.Size([147, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24728679656982422  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24728679656982422  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 147, 100]), torch.Size([1, 147, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.24739646911621094  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25211238861083984  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 147, 100])
m.shape torch.Size([137, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25241518020629883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25241518020629883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 137, 100]), torch.Size([1, 137, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2525181770324707  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25763797760009766  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 137, 100])
m.shape torch.Size([130, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25797414779663086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.25797414779663086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 130, 100]), torch.Size([1, 130, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2580714225769043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.26360464096069336  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 130, 100])
m.shape torch.Size([122, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2639651298522949  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2639651298522949  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 122, 100]), torch.Size([1, 122, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.2640566825866699  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.26989030838012695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 122, 100])
m.shape torch.Size([39091, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.4154701232910156  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.4154701232910156  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 39091, 100]), torch.Size([1, 39091, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.4445953369140625  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.512828826904297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 39091, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.364806652069092  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.402977466583252  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([40025, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.402977466583252  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([40025, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.441148281097412  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.402977466583252  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([40025, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.441148281097412  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.4512572288513184  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 40025
----------------output nodes number: 2981
----------------edges number: 71345
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.451578140258789  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5202736854553223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5202736854553223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.520277500152588  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.520308017730713  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.520331382751465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.520331382751465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5203561782836914  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.52072811126709  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.520773410797119  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.520773410797119  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5208115577697754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.521650791168213  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.521674156188965  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.521674156188965  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.521695137023926  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.522303581237793  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.522336483001709  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.522336483001709  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5223536491394043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5229716300964355  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([38, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5231823921203613  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5231823921203613  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.523254871368408  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.526371479034424  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([18, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.526456356048584  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.526456356048584  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5264906883239746  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.528207302093506  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5282516479492188  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5282516479492188  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5282669067382812  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5291366577148438  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.529172420501709  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.529172420501709  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.529181957244873  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.529792308807373  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5298070907592773  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5298070907592773  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.529810905456543  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5300817489624023  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.530154228210449  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.530154228210449  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.530167579650879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5312089920043945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5313525199890137  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5313525199890137  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5313773155212402  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.533484935760498  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5335354804992676  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5335354804992676  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5335450172424316  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5344223976135254  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.534485340118408  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.534485340118408  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5344948768615723  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5354390144348145  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.535491943359375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.535491943359375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5354995727539062  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5363082885742188  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.536412239074707  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.536412239074707  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5364255905151367  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5379343032836914  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5380096435546875  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5380096435546875  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5380191802978516  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.539163589477539  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5392627716064453  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5392627716064453  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.539274215698242  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5407276153564453  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5407586097717285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5407586097717285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.540762424468994  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.541273593902588  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.541464328765869  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.541464328765869  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5414834022521973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.544172763824463  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.544264316558838  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.544264316558838  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.544273853302002  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.545685291290283  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5457863807678223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5457863807678223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5457959175109863  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.547274112701416  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5475125312805176  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5475125312805176  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5475335121154785  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5509324073791504  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5510144233703613  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5510144233703613  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.5510220527648926  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.552311420440674  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2766, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.618769645690918  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.618769645690918  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2766, 256]), torch.Size([1, 2766, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.6254873275756836  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.5629405975341797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2766, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.4946084022521973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.4951305389404297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.4951305389404297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.495652675628662  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.4951305389404297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([2981, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.08180427551269531  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.12276840209960938  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.12279176712036133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 109961
first layer output nodes number: 33173
edges number: 328021
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.05068683624267578  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([109961, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.05068683624267578  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([46, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17638206481933594  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17638206481933594  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 46, 100]), torch.Size([1, 46, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17641639709472656  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17669105529785156  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 46, 100])
m.shape torch.Size([70, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1767263412475586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1767263412475586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 70, 100]), torch.Size([1, 70, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17677879333496094  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17756271362304688  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 70, 100])
m.shape torch.Size([66, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1776103973388672  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1776103973388672  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 66, 100]), torch.Size([1, 66, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1776599884033203  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17874670028686523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 66, 100])
m.shape torch.Size([84, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1788473129272461  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1788473129272461  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 84, 100]), torch.Size([1, 84, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1789102554321289  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18072986602783203  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 84, 100])
m.shape torch.Size([96, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1808772087097168  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1808772087097168  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 96, 100]), torch.Size([1, 96, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18094873428344727  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18352365493774414  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 96, 100])
m.shape torch.Size([111, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18373632431030273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18373632431030273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 111, 100]), torch.Size([1, 111, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18381929397583008  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1873784065246582  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 111, 100])
m.shape torch.Size([125, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18766307830810547  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18766307830810547  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 125, 100]), torch.Size([1, 125, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18775653839111328  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19241952896118164  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 125, 100])
m.shape torch.Size([143, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19279909133911133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19279909133911133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 143, 100]), torch.Size([1, 143, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19290590286254883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19898271560668945  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 143, 100])
m.shape torch.Size([184, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19954633712768555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19954633712768555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 184, 100]), torch.Size([1, 184, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19968366622924805  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.20845985412597656  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 184, 100])
m.shape torch.Size([32248, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.3285245895385742  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.3285245895385742  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 32248, 100]), torch.Size([1, 32248, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.3525514602661133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0584449768066406  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 32248, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9359664916992188  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9676027297973633  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([33173, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9676027297973633  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([33173, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9992389678955078  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9676027297973633  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([33173, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9992389678955078  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.007148265838623  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 33173
----------------output nodes number: 3133
----------------edges number: 77506
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0074191093444824  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0823488235473633  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0823488235473633  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0823583602905273  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0825014114379883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0824999809265137  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0824999809265137  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0825018882751465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0825438499450684  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.082547187805176  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.082547187805176  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0825490951538086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.08260440826416  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0826210975646973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0826210975646973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0826268196105957  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0828728675842285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0828771591186523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0828771591186523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.082879066467285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.082974433898926  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.082981586456299  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.082981586456299  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0829834938049316  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.083092212677002  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0831003189086914  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0831003189086914  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.083102226257324  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.083224296569824  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.083287239074707  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.083287239074707  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.083298683166504  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.08419132232666  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0842089653015137  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0842089653015137  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0842127799987793  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0845370292663574  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0845603942871094  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0845603942871094  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.084564208984375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0849151611328125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0849404335021973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0849404335021973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.084944248199463  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0853219032287598  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.085435390472412  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.085435390472412  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0854506492614746  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0870680809020996  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.087214469909668  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.087214469909668  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.087233543395996  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.089388847351074  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.089412212371826  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.089412212371826  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.089416027069092  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.089873790740967  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.089958667755127  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.089958667755127  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.089968204498291  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.091179370880127  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0913209915161133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0913209915161133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.091336250305176  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.093380928039551  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0934886932373047  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0934886932373047  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0935001373291016  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.095113754272461  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0953102111816406  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0953102111816406  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0953292846679688  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0981521606445312  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0982909202575684  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0982909202575684  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.098304271697998  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1003737449645996  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1006546020507812  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1006546020507812  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.100679397583008  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.104696273803711  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.10493803024292  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.10493803024292  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.104959011077881  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1085047721862793  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([3028, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.181324005126953  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.181324005126953  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3028, 256]), torch.Size([1, 3028, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.188021183013916  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.2153267860412598  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3028, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.141120433807373  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.141669273376465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([3133, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.141669273376465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3133, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1422181129455566  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.141669273376465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3133, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.046624183654785156  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.08376359939575195  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.0837869644165039  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 99695
first layer output nodes number: 33735
edges number: 334854
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.04687166213989258  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([99695, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.04687166213989258  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([23, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17538881301879883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17538881301879883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 23, 100]), torch.Size([1, 23, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17540597915649414  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17554330825805664  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 23, 100])
m.shape torch.Size([42, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1755661964416504  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1755661964416504  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 42, 100]), torch.Size([1, 42, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1755976676940918  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1760697364807129  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 42, 100])
m.shape torch.Size([50, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17611026763916016  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17611026763916016  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 50, 100]), torch.Size([1, 50, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1761484146118164  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17697477340698242  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 50, 100])
m.shape torch.Size([49, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17702913284301758  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17702913284301758  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 49, 100]), torch.Size([1, 49, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17706632614135742  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17813348770141602  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 49, 100])
m.shape torch.Size([72, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17824935913085938  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17824935913085938  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 72, 100]), torch.Size([1, 72, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17830371856689453  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18023920059204102  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 72, 100])
m.shape torch.Size([84, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18039989471435547  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18039989471435547  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 84, 100]), torch.Size([1, 84, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18046283721923828  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18316078186035156  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 84, 100])
m.shape torch.Size([92, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18336963653564453  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18336963653564453  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 92, 100]), torch.Size([1, 92, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18343830108642578  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18687152862548828  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 92, 100])
m.shape torch.Size([113, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18717432022094727  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18717432022094727  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18725919723510742  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19207429885864258  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([111, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19240427017211914  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19240427017211914  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 111, 100]), torch.Size([1, 111, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19248723983764648  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.197784423828125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 111, 100])
m.shape torch.Size([33099, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.3210463523864746  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.3210463523864746  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 33099, 100]), torch.Size([1, 33099, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.34570741653442383  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0966286659240723  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 33099, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9712285995483398  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0034008026123047  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([33735, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0034008026123047  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([33735, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0355730056762695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0034008026123047  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([33735, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0355730056762695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.04361629486084  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 33735
----------------output nodes number: 3134
----------------edges number: 78078
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.043891429901123  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.11905574798584  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.11905574798584  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1190576553344727  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.119112968444824  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.119123935699463  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.119123935699463  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1191277503967285  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1192917823791504  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.119297981262207  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.119297981262207  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.11929988861084  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.11940860748291  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1194252967834473  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1194252967834473  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.119429111480713  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.119673252105713  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1196908950805664  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1196908950805664  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.119694709777832  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1199655532836914  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1199746131896973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1199746131896973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.11997652053833  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1201252937316895  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.120136260986328  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.120136260986328  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.120138168334961  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.12030029296875  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1203246116638184  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1203246116638184  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.120328426361084  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1206793785095215  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1207046508789062  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1207046508789062  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.120708465576172  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1210861206054688  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1210999488830566  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1210999488830566  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1211018562316895  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1213173866271973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.121365547180176  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.121365547180176  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.121371269226074  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1220579147338867  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1220898628234863  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1220898628234863  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.122093677520752  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1225781440734863  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1225948333740234  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1225948333740234  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1225967407226562  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.122852325439453  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.122872829437256  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.122872829437256  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1228747367858887  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1231703758239746  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.123213768005371  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.123213768005371  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1232175827026367  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.123835563659668  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.123857021331787  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.123857021331787  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.12385892868042  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1241812705993652  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3109, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1989784240722656  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1989784240722656  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3109, 256]), torch.Size([1, 3109, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.206066608428955  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.2505345344543457  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3109, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1760153770446777  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1765642166137695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([3134, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1765642166137695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3134, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1771130561828613  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1765642166137695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3134, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.04279947280883789  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.08420753479003906  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.08423137664794922  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 111153
first layer output nodes number: 33752
edges number: 334718
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.05123090744018555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([111153, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.05123090744018555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([31, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1797499656677246  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1797499656677246  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 31, 100]), torch.Size([1, 31, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17977380752563477  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1799602508544922  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 31, 100])
m.shape torch.Size([42, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17997980117797852  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17997980117797852  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 42, 100]), torch.Size([1, 42, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18001127243041992  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18048334121704102  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 42, 100])
m.shape torch.Size([47, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18052053451538086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18052053451538086  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 47, 100]), torch.Size([1, 47, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1805558204650879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18132781982421875  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 47, 100])
m.shape torch.Size([59, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1813983917236328  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1813983917236328  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1814432144165039  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1827259063720703  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([82, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18285655975341797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18285655975341797  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 82, 100]), torch.Size([1, 82, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18291854858398438  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18512868881225586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 82, 100])
m.shape torch.Size([102, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18532609939575195  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18532609939575195  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18540239334106445  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1886744499206543  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([98, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18889188766479492  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18889188766479492  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 98, 100]), torch.Size([1, 98, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1889653205871582  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.192626953125  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 98, 100])
m.shape torch.Size([134, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19298982620239258  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19298982620239258  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 134, 100]), torch.Size([1, 134, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19308996200561523  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19878625869750977  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 134, 100])
m.shape torch.Size([124, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19915199279785156  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19915199279785156  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 124, 100]), torch.Size([1, 124, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19924449920654297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.20516490936279297  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 124, 100])
m.shape torch.Size([33033, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.32817649841308594  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.32817649841308594  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 33033, 100]), torch.Size([1, 33033, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.35278892517089844  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1002283096313477  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 33033, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9748578071594238  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0070462226867676  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([33752, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0070462226867676  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([33752, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0392346382141113  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0070462226867676  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([33752, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0392346382141113  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0472817420959473  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 33752
----------------output nodes number: 3163
----------------edges number: 78870
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0475573539733887  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1244449615478516  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1244449615478516  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.124448776245117  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.124666213989258  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.124673366546631  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.124673366546631  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1246752738952637  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1247973442077637  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1248064041137695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1248064041137695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1248083114624023  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.124943733215332  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.124992847442627  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.124992847442627  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.125000476837158  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.125702381134033  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.125739097595215  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.125739097595215  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1257448196411133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1263113021850586  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1263251304626465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1263251304626465  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1263270378112793  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.126555919647217  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.126572608947754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.126572608947754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1265745162963867  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.126816749572754  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.126870632171631  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.126870632171631  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1268763542175293  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.12764310836792  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.127678871154785  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.127678871154785  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.127682685852051  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.128220558166504  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.128239154815674  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.128239154815674  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1282410621643066  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.128523349761963  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1285648345947266  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1285648345947266  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.128568649291992  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.129159927368164  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1292967796325684  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1292967796325684  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.1293082237243652  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.131242275238037  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3136, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2065887451171875  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.2065887451171875  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3136, 256]), torch.Size([1, 3136, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.213771343231201  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.267481803894043  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3136, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1912598609924316  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1918139457702637  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1918139457702637  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1923680305480957  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1918139457702637  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3163, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.0470738410949707  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.08397626876831055  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.0840001106262207  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

first layer input nodes number: 99059
first layer output nodes number: 31989
edges number: 316495
----------------------------------------before model layer 0
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.046489715576171875  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([99059, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.046489715576171875  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([38, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.16774749755859375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.16774749755859375  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 38, 100]), torch.Size([1, 38, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.16777610778808594  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.16800355911254883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 38, 100])
m.shape torch.Size([55, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1680302619934082  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1680302619934082  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 55, 100]), torch.Size([1, 55, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.16807126998901367  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1686863899230957  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 55, 100])
m.shape torch.Size([57, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1687297821044922  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1687297821044922  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 57, 100]), torch.Size([1, 57, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.16877269744873047  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.16971254348754883  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 57, 100])
m.shape torch.Size([63, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1697850227355957  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1697850227355957  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.16983270645141602  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17119836807250977  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([113, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1713852882385254  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1713852882385254  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17147016525268555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17451143264770508  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([108, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17471075057983398  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17471075057983398  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17479181289672852  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17826032638549805  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([136, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1785745620727539  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1785745620727539  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 136, 100]), torch.Size([1, 136, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.17867660522460938  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18374872207641602  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 136, 100])
m.shape torch.Size([139, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1841120719909668  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1841120719909668  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 139, 100]), torch.Size([1, 139, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.18421602249145508  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19012975692749023  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 139, 100])
m.shape torch.Size([153, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19059085845947266  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19059085845947266  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 153, 100]), torch.Size([1, 153, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.1907052993774414  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.19801664352416992  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 153, 100])
m.shape torch.Size([31127, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.3139166831970215  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.3139166831970215  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 31127, 100]), torch.Size([1, 31127, 100])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.3373541831970215  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9866538047790527  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 31127, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.8682208061218262  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.8987278938293457  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([31989, 100])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.8987278938293457  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([31989, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9292349815368652  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.8987278938293457  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([31989, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9292349815368652  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.9368619918823242  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------input nodes number: 31989
----------------output nodes number: 3157
----------------edges number: 78648
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 1.937124252319336  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0128374099731445  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0128374099731445  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0128393173217773  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.012881278991699  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0128865242004395  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0128865242004395  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0128884315490723  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.012970447540283  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0129833221435547  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0129833221435547  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0129871368408203  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0131778717041016  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0131936073303223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0131936073303223  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.013197422027588  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.013441562652588  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0134496688842773  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0134496688842773  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.01345157623291  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.01358699798584  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0136075019836426  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0136075019836426  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.013611316680908  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.013908863067627  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.013918876647949  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.013918876647949  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.013920783996582  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.014082908630371  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.014094829559326  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.014094829559326  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.014096736907959  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0142722129821777  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.014285087585449  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.014285087585449  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.014286994934082  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0144758224487305  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0145058631896973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0145058631896973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.014509677886963  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0149407386779785  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0150084495544434  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0150084495544434  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0150160789489746  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0159850120544434  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.016036033630371  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.016036033630371  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0160417556762695  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.01680850982666  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0168251991271973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0168251991271973  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.01682710647583  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0170960426330566  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.017115592956543  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.017115592956543  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.017117500305176  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.017399787902832  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0174412727355957  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0174412727355957  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0174450874328613  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.018036365509033  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0180788040161133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0180788040161133  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.018082618713379  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.01870059967041  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0188374519348145  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0188374519348145  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.0188488960266113  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.020782947540283  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3124, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.095841407775879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.095841407775879  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

 h.shape torch.Size([1, 3124, 256]), torch.Size([1, 3124, 256])
----------------------------------------3
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 2.101799964904785  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.1508989334106445  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

rst.shape  torch.Size([1, 3124, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.07584285736084  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.0763959884643555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

h_self size  torch.Size([3157, 256])
----------------------------------------before rst
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.0763959884643555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3157, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.076949119567871  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 3.0763959884643555  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes

torch.Size([3157, 47])
-----------------------------------------after training 
 Nvidia-smi: 15.4686279296875 GB
    Memory Allocated: 0.05564069747924805  GigaBytes
Max Memory Allocated: 4.0916619300842285  GigaBytes


-----------------------------------------------------------------------------epoch done
