main start at this time 1661485641.2426653
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22022080421447754
global_2_local spend time (sec) 0.3683769702911377

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.975 seconds
Metis partitioning: 11.599 seconds
Split the graph: 3.299 seconds
Construct subgraphs: 0.051 seconds
48257
50574
47861
49879
REG metis partition end ----................................
the time spent:  27.33793067932129
REG construction  time spent:  9.392144680023193
pure dgl.metis_partition the time spent:  17.945785999298096
total k batches seeds list generation spend  28.001553535461426
after graph partition
graph partition algorithm spend time 28.708632230758667

partition_len_list
[387777, 385091, 319646, 319819]
REG selection method  spend 29.24187469482422
check_connections_block*********************************
time for parepare 1: 0.22389435768127441
local_output_nid generation: 0.00814056396484375
local_in_edges_tensor generation: 0.012979269027709961

&&&&&&&&&&&&&&& before remove duplicate length: 1154591
remove duplicated spend time : 0.27147364616394043

&&&&&&&&&&&&&&& after remove duplicate length: 381261

mini_batch_src_global generation: 0.0236814022064209
r_  generation: 0.22158265113830566

local_output_nid generation: 0.010016918182373047
local_in_edges_tensor generation: 0.02739691734313965

&&&&&&&&&&&&&&& before remove duplicate length: 1256826
remove duplicated spend time : 0.3407413959503174

&&&&&&&&&&&&&&& after remove duplicate length: 383259

mini_batch_src_global generation: 0.03610420227050781
r_  generation: 0.2674891948699951

local_output_nid generation: 0.011879205703735352
local_in_edges_tensor generation: 0.05582547187805176

&&&&&&&&&&&&&&& before remove duplicate length: 1146230
remove duplicated spend time : 0.271791934967041

&&&&&&&&&&&&&&& after remove duplicate length: 316625

mini_batch_src_global generation: 0.033168792724609375
r_  generation: 0.22240543365478516

local_output_nid generation: 0.010065078735351562
local_in_edges_tensor generation: 0.012725591659545898

&&&&&&&&&&&&&&& before remove duplicate length: 1206232
remove duplicated spend time : 0.27634286880493164

&&&&&&&&&&&&&&& after remove duplicate length: 317657

mini_batch_src_global generation: 0.03407478332519531
r_  generation: 0.21665096282958984


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7387962341308594
gen group dst list time:  0.05497384071350098
check_connections_block*********************************
time for parepare 1: 0.36994028091430664
local_output_nid generation: 0.08053874969482422
local_in_edges_tensor generation: 0.19019317626953125

&&&&&&&&&&&&&&& before remove duplicate length: 3815633
remove duplicated spend time : 1.0184032917022705

&&&&&&&&&&&&&&& after remove duplicate length: 861153

mini_batch_src_global generation: 0.08486270904541016
r_  generation: 0.7478501796722412

local_output_nid generation: 0.10581111907958984
local_in_edges_tensor generation: 0.15364956855773926

&&&&&&&&&&&&&&& before remove duplicate length: 3805856
remove duplicated spend time : 1.0289902687072754

&&&&&&&&&&&&&&& after remove duplicate length: 721257

mini_batch_src_global generation: 0.08291888236999512
r_  generation: 0.7972180843353271

local_output_nid generation: 0.07519769668579102
local_in_edges_tensor generation: 0.09506607055664062

&&&&&&&&&&&&&&& before remove duplicate length: 3089116
remove duplicated spend time : 0.7898566722869873

&&&&&&&&&&&&&&& after remove duplicate length: 661200

mini_batch_src_global generation: 0.07635712623596191
r_  generation: 0.6577849388122559

local_output_nid generation: 0.0900411605834961
local_in_edges_tensor generation: 0.13332891464233398

&&&&&&&&&&&&&&& before remove duplicate length: 3051700
remove duplicated spend time : 0.7842147350311279

&&&&&&&&&&&&&&& after remove duplicate length: 635868

mini_batch_src_global generation: 0.07777976989746094
r_  generation: 0.6332962512969971


connection checking time:  12.496273756027222
block generation total time  12.831703662872314
pseudo mini batch 0 input nodes size: 899014
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 0.33745241165161133  GigaBytes
Max Memory Allocated: 0.33745241165161133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 0.3378124237060547  GigaBytes
Max Memory Allocated: 0.3378124237060547  GigaBytes

first layer input nodes number: 899014
first layer output nodes number: 387777
edges number: 3815633
----------------------------------------before model layer 0
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 0.3844327926635742  GigaBytes
Max Memory Allocated: 0.3986473083496094  GigaBytes

torch.Size([899014, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 0.3844327926635742  GigaBytes
Max Memory Allocated: 0.3986473083496094  GigaBytes

m.shape torch.Size([619, 1, 100])
----------------------------------------1
 Nvidia-smi: 9.2166748046875 GB
    Memory Allocated: 1.8465485572814941  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2166748046875 GB
    Memory Allocated: 1.8465485572814941  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

 h.shape torch.Size([1, 619, 100]), torch.Size([1, 619, 100])
----------------------------------------3
 Nvidia-smi: 9.2166748046875 GB
    Memory Allocated: 1.8470101356506348  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2244873046875 GB
    Memory Allocated: 1.8507013320922852  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

rst.shape  torch.Size([1, 619, 100])
m.shape torch.Size([928, 2, 100])
----------------------------------------1
 Nvidia-smi: 9.2244873046875 GB
    Memory Allocated: 1.8511619567871094  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2244873046875 GB
    Memory Allocated: 1.8511619567871094  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

 h.shape torch.Size([1, 928, 100]), torch.Size([1, 928, 100])
----------------------------------------3
 Nvidia-smi: 9.2244873046875 GB
    Memory Allocated: 1.851853370666504  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2283935546875 GB
    Memory Allocated: 1.862335205078125  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

rst.shape  torch.Size([1, 928, 100])
m.shape torch.Size([1299, 3, 100])
----------------------------------------1
 Nvidia-smi: 9.2283935546875 GB
    Memory Allocated: 1.863558292388916  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2283935546875 GB
    Memory Allocated: 1.863558292388916  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

 h.shape torch.Size([1, 1299, 100]), torch.Size([1, 1299, 100])
----------------------------------------3
 Nvidia-smi: 9.2283935546875 GB
    Memory Allocated: 1.8645262718200684  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2322998046875 GB
    Memory Allocated: 1.8859591484069824  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

rst.shape  torch.Size([1, 1299, 100])
m.shape torch.Size([1504, 4, 100])
----------------------------------------1
 Nvidia-smi: 9.2322998046875 GB
    Memory Allocated: 1.887716293334961  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2322998046875 GB
    Memory Allocated: 1.887716293334961  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

 h.shape torch.Size([1, 1504, 100]), torch.Size([1, 1504, 100])
----------------------------------------3
 Nvidia-smi: 9.2342529296875 GB
    Memory Allocated: 1.8888368606567383  GigaBytes
Max Memory Allocated: 1.9089899063110352  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2401123046875 GB
    Memory Allocated: 1.9218006134033203  GigaBytes
Max Memory Allocated: 1.924041748046875  GigaBytes

rst.shape  torch.Size([1, 1504, 100])
m.shape torch.Size([1741, 5, 100])
----------------------------------------1
 Nvidia-smi: 9.2401123046875 GB
    Memory Allocated: 1.924483299255371  GigaBytes
Max Memory Allocated: 1.924581527709961  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2401123046875 GB
    Memory Allocated: 1.924483299255371  GigaBytes
Max Memory Allocated: 1.924581527709961  GigaBytes

 h.shape torch.Size([1, 1741, 100]), torch.Size([1, 1741, 100])
----------------------------------------3
 Nvidia-smi: 9.2420654296875 GB
    Memory Allocated: 1.92578125  GigaBytes
Max Memory Allocated: 1.92578125  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2694091796875 GB
    Memory Allocated: 1.9729485511779785  GigaBytes
Max Memory Allocated: 1.9769129753112793  GigaBytes

rst.shape  torch.Size([1, 1741, 100])
m.shape torch.Size([2070, 6, 100])
----------------------------------------1
 Nvidia-smi: 9.2889404296875 GB
    Memory Allocated: 1.9769268035888672  GigaBytes
Max Memory Allocated: 1.9770665168762207  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2889404296875 GB
    Memory Allocated: 1.9769268035888672  GigaBytes
Max Memory Allocated: 1.9770665168762207  GigaBytes

 h.shape torch.Size([1, 2070, 100]), torch.Size([1, 2070, 100])
----------------------------------------3
 Nvidia-smi: 9.2908935546875 GB
    Memory Allocated: 1.9784698486328125  GigaBytes
Max Memory Allocated: 1.9784698486328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3631591796875 GB
    Memory Allocated: 2.0456748008728027  GigaBytes
Max Memory Allocated: 2.050302028656006  GigaBytes

rst.shape  torch.Size([1, 2070, 100])
m.shape torch.Size([2284, 7, 100])
----------------------------------------1
 Nvidia-smi: 9.3631591796875 GB
    Memory Allocated: 2.0508594512939453  GigaBytes
Max Memory Allocated: 2.0510382652282715  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3631591796875 GB
    Memory Allocated: 2.0508594512939453  GigaBytes
Max Memory Allocated: 2.0510382652282715  GigaBytes

 h.shape torch.Size([1, 2284, 100]), torch.Size([1, 2284, 100])
----------------------------------------3
 Nvidia-smi: 9.3651123046875 GB
    Memory Allocated: 2.0525617599487305  GigaBytes
Max Memory Allocated: 2.0525617599487305  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4588623046875 GB
    Memory Allocated: 2.137936592102051  GigaBytes
Max Memory Allocated: 2.143892765045166  GigaBytes

rst.shape  torch.Size([1, 2284, 100])
m.shape torch.Size([2396, 8, 100])
----------------------------------------1
 Nvidia-smi: 9.4588623046875 GB
    Memory Allocated: 2.14422607421875  GigaBytes
Max Memory Allocated: 2.1444406509399414  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4588623046875 GB
    Memory Allocated: 2.14422607421875  GigaBytes
Max Memory Allocated: 2.1444406509399414  GigaBytes

 h.shape torch.Size([1, 2396, 100]), torch.Size([1, 2396, 100])
----------------------------------------3
 Nvidia-smi: 9.4608154296875 GB
    Memory Allocated: 2.1460113525390625  GigaBytes
Max Memory Allocated: 2.1460113525390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5955810546875 GB
    Memory Allocated: 2.247772216796875  GigaBytes
Max Memory Allocated: 2.254912853240967  GigaBytes

rst.shape  torch.Size([1, 2396, 100])
m.shape torch.Size([2396, 9, 100])
----------------------------------------1
 Nvidia-smi: 9.5955810546875 GB
    Memory Allocated: 2.254912853240967  GigaBytes
Max Memory Allocated: 2.2551541328430176  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5955810546875 GB
    Memory Allocated: 2.254912853240967  GigaBytes
Max Memory Allocated: 2.2551541328430176  GigaBytes

 h.shape torch.Size([1, 2396, 100]), torch.Size([1, 2396, 100])
----------------------------------------3
 Nvidia-smi: 9.5975341796875 GB
    Memory Allocated: 2.2566981315612793  GigaBytes
Max Memory Allocated: 2.2566981315612793  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7147216796875 GB
    Memory Allocated: 2.3717422485351562  GigaBytes
Max Memory Allocated: 2.3805618286132812  GigaBytes

rst.shape  torch.Size([1, 2396, 100])
m.shape torch.Size([372540, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.1951904296875 GB
    Memory Allocated: 3.759521484375  GigaBytes
Max Memory Allocated: 3.801156520843506  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1951904296875 GB
    Memory Allocated: 3.759521484375  GigaBytes
Max Memory Allocated: 3.801156520843506  GigaBytes

 h.shape torch.Size([1, 372540, 100]), torch.Size([1, 372540, 100])
----------------------------------------3
 Nvidia-smi: 11.4764404296875 GB
    Memory Allocated: 4.03708553314209  GigaBytes
Max Memory Allocated: 4.03708553314209  GigaBytes

