main start at this time 1661485560.495502
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.199326753616333
global_2_local spend time (sec) 0.3635251522064209

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.980 seconds
Metis partitioning: 11.058 seconds
Split the graph: 5.610 seconds
Construct subgraphs: 0.061 seconds
95530
101041
REG metis partition end ----................................
the time spent:  28.63776397705078
REG construction  time spent:  8.908655881881714
pure dgl.metis_partition the time spent:  19.729108095169067
total k batches seeds list generation spend  29.2782301902771
after graph partition
graph partition algorithm spend time 30.035906553268433

partition_len_list
[605014, 686090]
REG selection method  spend 30.56494140625
check_connections_block*********************************
time for parepare 1: 0.23649215698242188
local_output_nid generation: 0.012875556945800781
local_in_edges_tensor generation: 0.06453227996826172

&&&&&&&&&&&&&&& before remove duplicate length: 2311643
remove duplicated spend time : 0.54575514793396

&&&&&&&&&&&&&&& after remove duplicate length: 600728

mini_batch_src_global generation: 0.04185652732849121
r_  generation: 0.382540225982666

local_output_nid generation: 0.016059398651123047
local_in_edges_tensor generation: 0.04657125473022461

&&&&&&&&&&&&&&& before remove duplicate length: 2452236
remove duplicated spend time : 0.6112847328186035

&&&&&&&&&&&&&&& after remove duplicate length: 679200

mini_batch_src_global generation: 0.06423544883728027
r_  generation: 0.45941710472106934


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6712648868560791
gen group dst list time:  0.03424692153930664
check_connections_block*********************************
time for parepare 1: 0.3556947708129883
local_output_nid generation: 0.09766054153442383
local_in_edges_tensor generation: 0.23709917068481445

&&&&&&&&&&&&&&& before remove duplicate length: 5821216
remove duplicated spend time : 1.4799690246582031

&&&&&&&&&&&&&&& after remove duplicate length: 1061545

mini_batch_src_global generation: 0.07804465293884277
r_  generation: 0.9993596076965332

local_output_nid generation: 0.1235342025756836
local_in_edges_tensor generation: 0.18214631080627441

&&&&&&&&&&&&&&& before remove duplicate length: 6731831
remove duplicated spend time : 1.7949602603912354

&&&&&&&&&&&&&&& after remove duplicate length: 1130643

mini_batch_src_global generation: 0.12451410293579102
r_  generation: 1.2228333950042725


connection checking time:  10.663159847259521
block generation total time  11.976085186004639
pseudo mini batch 0 input nodes size: 1107226
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 0.41501760482788086  GigaBytes
Max Memory Allocated: 0.41501760482788086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 0.4157295227050781  GigaBytes
Max Memory Allocated: 0.4157295227050781  GigaBytes

first layer input nodes number: 1107226
first layer output nodes number: 605014
edges number: 5821216
----------------------------------------before model layer 0
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.48908281326293945  GigaBytes
Max Memory Allocated: 0.5107688903808594  GigaBytes

torch.Size([1107226, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.48908281326293945  GigaBytes
Max Memory Allocated: 0.5107688903808594  GigaBytes

m.shape torch.Size([2129, 1, 100])
----------------------------------------1
 Nvidia-smi: 10.1424560546875 GB
    Memory Allocated: 2.7201290130615234  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1424560546875 GB
    Memory Allocated: 2.7201290130615234  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

 h.shape torch.Size([1, 2129, 100]), torch.Size([1, 2129, 100])
----------------------------------------3
 Nvidia-smi: 10.1444091796875 GB
    Memory Allocated: 2.7217159271240234  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1522216796875 GB
    Memory Allocated: 2.734408378601074  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

rst.shape  torch.Size([1, 2129, 100])
m.shape torch.Size([3520, 2, 100])
----------------------------------------1
 Nvidia-smi: 10.1522216796875 GB
    Memory Allocated: 2.7362375259399414  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1522216796875 GB
    Memory Allocated: 2.7362375259399414  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

 h.shape torch.Size([1, 3520, 100]), torch.Size([1, 3520, 100])
----------------------------------------3
 Nvidia-smi: 10.1522216796875 GB
    Memory Allocated: 2.738922595977783  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1522216796875 GB
    Memory Allocated: 2.780758857727051  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

rst.shape  torch.Size([1, 3520, 100])
m.shape torch.Size([4462, 3, 100])
----------------------------------------1
 Nvidia-smi: 10.1522216796875 GB
    Memory Allocated: 2.783994197845459  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1522216796875 GB
    Memory Allocated: 2.783994197845459  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

 h.shape torch.Size([1, 4462, 100]), torch.Size([1, 4462, 100])
----------------------------------------3
 Nvidia-smi: 10.1522216796875 GB
    Memory Allocated: 2.787407875061035  GigaBytes
Max Memory Allocated: 2.8117642402648926  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 2.8607406616210938  GigaBytes
Max Memory Allocated: 2.865727424621582  GigaBytes

rst.shape  torch.Size([1, 4462, 100])
m.shape torch.Size([5928, 4, 100])
----------------------------------------1
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 2.867870807647705  GigaBytes
Max Memory Allocated: 2.868136405944824  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 2.867870807647705  GigaBytes
Max Memory Allocated: 2.868136405944824  GigaBytes

 h.shape torch.Size([1, 5928, 100]), torch.Size([1, 5928, 100])
----------------------------------------3
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 2.8724660873413086  GigaBytes
Max Memory Allocated: 2.8724660873413086  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3475341796875 GB
    Memory Allocated: 3.000554084777832  GigaBytes
Max Memory Allocated: 3.009387493133545  GigaBytes

rst.shape  torch.Size([1, 5928, 100])
m.shape torch.Size([7020, 5, 100])
----------------------------------------1
 Nvidia-smi: 10.3612060546875 GB
    Memory Allocated: 3.012017250061035  GigaBytes
Max Memory Allocated: 3.0124101638793945  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3612060546875 GB
    Memory Allocated: 3.012017250061035  GigaBytes
Max Memory Allocated: 3.0124101638793945  GigaBytes

 h.shape torch.Size([1, 7020, 100]), torch.Size([1, 7020, 100])
----------------------------------------3
 Nvidia-smi: 10.3612060546875 GB
    Memory Allocated: 3.0172481536865234  GigaBytes
Max Memory Allocated: 3.0172481536865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5838623046875 GB
    Memory Allocated: 3.2061891555786133  GigaBytes
Max Memory Allocated: 3.2192649841308594  GigaBytes

rst.shape  torch.Size([1, 7020, 100])
m.shape torch.Size([7594, 6, 100])
----------------------------------------1
 Nvidia-smi: 10.6014404296875 GB
    Memory Allocated: 3.221151828765869  GigaBytes
Max Memory Allocated: 3.22166109085083  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6014404296875 GB
    Memory Allocated: 3.221151828765869  GigaBytes
Max Memory Allocated: 3.22166109085083  GigaBytes

 h.shape torch.Size([1, 7594, 100]), torch.Size([1, 7594, 100])
----------------------------------------3
 Nvidia-smi: 10.6014404296875 GB
    Memory Allocated: 3.2268099784851074  GigaBytes
Max Memory Allocated: 3.2268099784851074  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8612060546875 GB
    Memory Allocated: 3.4760546684265137  GigaBytes
Max Memory Allocated: 3.4936327934265137  GigaBytes

rst.shape  torch.Size([1, 7594, 100])
m.shape torch.Size([8104, 7, 100])
----------------------------------------1
 Nvidia-smi: 10.8826904296875 GB
    Memory Allocated: 3.4947099685668945  GigaBytes
Max Memory Allocated: 3.495344638824463  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8826904296875 GB
    Memory Allocated: 3.4947099685668945  GigaBytes
Max Memory Allocated: 3.495344638824463  GigaBytes

 h.shape torch.Size([1, 8104, 100]), torch.Size([1, 8104, 100])
----------------------------------------3
 Nvidia-smi: 10.8826904296875 GB
    Memory Allocated: 3.500748634338379  GigaBytes
Max Memory Allocated: 3.500748634338379  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2322998046875 GB
    Memory Allocated: 3.802651882171631  GigaBytes
Max Memory Allocated: 3.824136257171631  GigaBytes

rst.shape  torch.Size([1, 8104, 100])
m.shape torch.Size([8347, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.2576904296875 GB
    Memory Allocated: 3.8250231742858887  GigaBytes
Max Memory Allocated: 3.8257699012756348  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2576904296875 GB
    Memory Allocated: 3.8250231742858887  GigaBytes
Max Memory Allocated: 3.8257699012756348  GigaBytes

 h.shape torch.Size([1, 8347, 100]), torch.Size([1, 8347, 100])
----------------------------------------3
 Nvidia-smi: 11.2576904296875 GB
    Memory Allocated: 3.8312430381774902  GigaBytes
Max Memory Allocated: 3.8312430381774902  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6522216796875 GB
    Memory Allocated: 4.190979480743408  GigaBytes
Max Memory Allocated: 4.216370105743408  GigaBytes

rst.shape  torch.Size([1, 8347, 100])
m.shape torch.Size([8319, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.6815185546875 GB
    Memory Allocated: 4.215761184692383  GigaBytes
Max Memory Allocated: 4.216598033905029  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6815185546875 GB
    Memory Allocated: 4.215761184692383  GigaBytes
Max Memory Allocated: 4.216598033905029  GigaBytes

 h.shape torch.Size([1, 8319, 100]), torch.Size([1, 8319, 100])
----------------------------------------3
 Nvidia-smi: 11.6815185546875 GB
    Memory Allocated: 4.221970558166504  GigaBytes
Max Memory Allocated: 4.221970558166504  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1131591796875 GB
    Memory Allocated: 4.626713752746582  GigaBytes
Max Memory Allocated: 4.654605388641357  GigaBytes

rst.shape  torch.Size([1, 8319, 100])
m.shape torch.Size([549591, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 6.6710004806518555  GigaBytes
Max Memory Allocated: 6.732490062713623  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2674560546875 GB
    Memory Allocated: 6.6710004806518555  GigaBytes
Max Memory Allocated: 6.732490062713623  GigaBytes

 h.shape torch.Size([1, 549591, 100]), torch.Size([1, 549591, 100])
----------------------------------------3
 Nvidia-smi: 14.6776123046875 GB
    Memory Allocated: 7.0811567306518555  GigaBytes
Max Memory Allocated: 7.0811567306518555  GigaBytes

