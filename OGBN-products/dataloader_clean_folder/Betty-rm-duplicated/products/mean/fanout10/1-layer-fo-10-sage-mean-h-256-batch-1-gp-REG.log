main start at this time 1660943207.875405
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

connection checking time:  0
block generation total time  0
pseudo mini batch 0 input nodes size: 849440
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3963623046875 GB
    Memory Allocated: 0.31647634506225586  GigaBytes
Max Memory Allocated: 0.31647634506225586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3963623046875 GB
    Memory Allocated: 0.31839466094970703  GigaBytes
Max Memory Allocated: 0.31839466094970703  GigaBytes

----------------input nodes number: 849440
----------------output nodes number: 196571
----------------edges number: 1949041
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4998779296875 GB
    Memory Allocated: 0.3407101631164551  GigaBytes
Max Memory Allocated: 0.34797096252441406  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4998779296875 GB
    Memory Allocated: 0.3407101631164551  GigaBytes
Max Memory Allocated: 0.34797096252441406  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9588623046875 GB
    Memory Allocated: 0.42919301986694336  GigaBytes
Max Memory Allocated: 0.5031542778015137  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9588623046875 GB
    Memory Allocated: 0.42919301986694336  GigaBytes
Max Memory Allocated: 0.5031542778015137  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9588623046875 GB
    Memory Allocated: 0.4636106491088867  GigaBytes
Max Memory Allocated: 0.5031542778015137  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 100])
----------------------------------------before rst
 Nvidia-smi: 7.9588623046875 GB
    Memory Allocated: 0.4636106491088867  GigaBytes
Max Memory Allocated: 0.5031542778015137  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9940185546875 GB
    Memory Allocated: 0.4987668991088867  GigaBytes
Max Memory Allocated: 0.5331845283508301  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9940185546875 GB
    Memory Allocated: 0.46434926986694336  GigaBytes
Max Memory Allocated: 0.5331845283508301  GigaBytes

torch.Size([196571, 47])
Number of nodes for computation during this epoch:  849440
Number of first layer input nodes during this epoch:  849440
Number of first layer output nodes during this epoch:  196571

-----------------------------------------------------------------------------epoch done
connection checking time:  0
block generation total time  0
pseudo mini batch 0 input nodes size: 847718
----------------------------------------before batch input features to device
 Nvidia-smi: 8.0643310546875 GB
    Memory Allocated: 0.3529181480407715  GigaBytes
Max Memory Allocated: 0.6034984588623047  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.6693243980407715  GigaBytes
Max Memory Allocated: 0.6693243980407715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.6707892417907715  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------input nodes number: 847718
----------------output nodes number: 196571
----------------edges number: 1949041
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.37531566619873047  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.37531566619873047  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.46379852294921875  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.46379852294921875  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.49895477294921875  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.49895477294921875  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.5341110229492188  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.49895477294921875  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

torch.Size([196571, 47])
Number of nodes for computation during this epoch:  847718
Number of first layer input nodes during this epoch:  847718
Number of first layer output nodes during this epoch:  196571

-----------------------------------------------------------------------------epoch done
read pickle file
0.06613612174987793

connection checking time:  0
block generation total time  0
block dataloader generation time/epoch 4.410743713378906e-05
pseudo mini batch 0 input nodes size: 848141
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.669126033782959  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.6715278625488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------input nodes number: 848141
----------------output nodes number: 196571
----------------edges number: 1949041
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.3759627342224121  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.3759627342224121  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.4650254249572754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.4650254249572754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.5001816749572754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.5001816749572754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.5345993041992188  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.49944305419921875  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

torch.Size([196571, 47])
Average training time/epoch 0.1670365333557129
Average Training time/epoch w/o nid counting 0.16697931289672852
Number of nodes for computation during this epoch:  848141
Number of first layer input nodes during this epoch:  848141
Number of first layer output nodes during this epoch:  196571

-----------------------------------------------------------------------------epoch done
read pickle file
0.20223331451416016

connection checking time:  0
block generation total time  0
block dataloader generation time/epoch 4.982948303222656e-05
pseudo mini batch 0 input nodes size: 848120
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.3536567687988281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.6700630187988281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.6715278625488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------input nodes number: 848120
----------------output nodes number: 196571
----------------edges number: 1949041
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.3760542869567871  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.3760542869567871  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.4645371437072754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.4645371437072754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.4996933937072754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.4996933937072754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.5341110229492188  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.49895477294921875  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

torch.Size([196571, 47])
Average training time/epoch 0.17460215091705322
Average Training time/epoch w/o nid counting 0.1821751594543457
Number of nodes for computation during this epoch:  848120
Number of first layer input nodes during this epoch:  848120
Number of first layer output nodes during this epoch:  196571

-----------------------------------------------------------------------------epoch done
read pickle file
0.2387397289276123

connection checking time:  0
block generation total time  0
block dataloader generation time/epoch 5.284945170084635e-05
pseudo mini batch 0 input nodes size: 848208
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.6691508293151855  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.6715278625488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------input nodes number: 848208
----------------output nodes number: 196571
----------------edges number: 1949041
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.3759632110595703  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.3759632110595703  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.4650254249572754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.4650254249572754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.5001816749572754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.5001816749572754  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.5345993041992188  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.49944305419921875  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

torch.Size([196571, 47])
Average training time/epoch 0.16348576545715332
Average Training time/epoch w/o nid counting 0.141157865524292
Number of nodes for computation during this epoch:  848208
Number of first layer input nodes during this epoch:  848208
Number of first layer output nodes during this epoch:  196571

-----------------------------------------------------------------------------epoch done
