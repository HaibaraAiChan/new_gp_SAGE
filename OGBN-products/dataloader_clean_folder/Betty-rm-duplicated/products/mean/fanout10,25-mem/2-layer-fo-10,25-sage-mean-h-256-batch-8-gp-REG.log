main start at this time 1661474789.608937
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2224266529083252
global_2_local spend time (sec) 0.36095094680786133

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.954 seconds
Metis partitioning: 11.572 seconds
Split the graph: 1.683 seconds
Construct subgraphs: 0.209 seconds
25172
25123
24129
25221
25309
23856
23896
23865
REG metis partition end ----................................
the time spent:  25.35186004638672
REG construction  time spent:  8.91008186340332
pure dgl.metis_partition the time spent:  16.4417781829834
total k batches seeds list generation spend  25.850651264190674
after graph partition
graph partition algorithm spend time 26.45413327217102

partition_len_list
[158480, 205040, 190318, 190503, 214947, 193422, 219469, 214439]
REG selection method  spend 26.984922647476196
check_connections_block*********************************
time for parepare 1: 0.23135709762573242
local_output_nid generation: 0.006079435348510742
local_in_edges_tensor generation: 0.007721424102783203

&&&&&&&&&&&&&&& before remove duplicate length: 601389
remove duplicated spend time : 0.10859847068786621

&&&&&&&&&&&&&&& after remove duplicate length: 156676

mini_batch_src_global generation: 0.009723901748657227
r_  generation: 0.07790708541870117

local_output_nid generation: 0.007175922393798828
local_in_edges_tensor generation: 0.012130022048950195

&&&&&&&&&&&&&&& before remove duplicate length: 621744
remove duplicated spend time : 0.13573741912841797

&&&&&&&&&&&&&&& after remove duplicate length: 203867

mini_batch_src_global generation: 0.01623058319091797
r_  generation: 0.11667060852050781

local_output_nid generation: 0.0068776607513427734
local_in_edges_tensor generation: 0.007339954376220703

&&&&&&&&&&&&&&& before remove duplicate length: 583893
remove duplicated spend time : 0.13060426712036133

&&&&&&&&&&&&&&& after remove duplicate length: 188346

mini_batch_src_global generation: 0.017223358154296875
r_  generation: 0.12173080444335938

local_output_nid generation: 0.007173299789428711
local_in_edges_tensor generation: 0.007698535919189453

&&&&&&&&&&&&&&& before remove duplicate length: 608268
remove duplicated spend time : 0.13800787925720215

&&&&&&&&&&&&&&& after remove duplicate length: 189025

mini_batch_src_global generation: 0.017749786376953125
r_  generation: 0.12334036827087402

local_output_nid generation: 0.007124185562133789
local_in_edges_tensor generation: 0.007724285125732422

&&&&&&&&&&&&&&& before remove duplicate length: 628832
remove duplicated spend time : 0.15069794654846191

&&&&&&&&&&&&&&& after remove duplicate length: 213357

mini_batch_src_global generation: 0.021436452865600586
r_  generation: 0.13769960403442383

local_output_nid generation: 0.006939411163330078
local_in_edges_tensor generation: 0.007405996322631836

&&&&&&&&&&&&&&& before remove duplicate length: 576223
remove duplicated spend time : 0.1336686611175537

&&&&&&&&&&&&&&& after remove duplicate length: 191300

mini_batch_src_global generation: 0.01977252960205078
r_  generation: 0.13088488578796387

local_output_nid generation: 0.007010221481323242
local_in_edges_tensor generation: 0.007248640060424805

&&&&&&&&&&&&&&& before remove duplicate length: 559519
remove duplicated spend time : 0.1329362392425537

&&&&&&&&&&&&&&& after remove duplicate length: 213870

mini_batch_src_global generation: 0.022507190704345703
r_  generation: 0.13874220848083496

local_output_nid generation: 0.008092641830444336
local_in_edges_tensor generation: 0.015286445617675781

&&&&&&&&&&&&&&& before remove duplicate length: 584011
remove duplicated spend time : 0.14354586601257324

&&&&&&&&&&&&&&& after remove duplicate length: 211821

mini_batch_src_global generation: 0.0250546932220459
r_  generation: 0.14069581031799316


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6742353439331055
gen group dst list time:  0.041988372802734375
check_connections_block*********************************
time for parepare 1: 0.3658149242401123
local_output_nid generation: 0.033597469329833984
local_in_edges_tensor generation: 0.10685396194458008

&&&&&&&&&&&&&&& before remove duplicate length: 1531827
remove duplicated spend time : 0.3018059730529785

&&&&&&&&&&&&&&& after remove duplicate length: 335355

mini_batch_src_global generation: 0.022695302963256836
r_  generation: 0.2526235580444336

local_output_nid generation: 0.05547380447387695
local_in_edges_tensor generation: 0.0716698169708252

&&&&&&&&&&&&&&& before remove duplicate length: 2022303
remove duplicated spend time : 0.48404383659362793

&&&&&&&&&&&&&&& after remove duplicate length: 457371

mini_batch_src_global generation: 0.042011260986328125
r_  generation: 0.3940613269805908

local_output_nid generation: 0.05416297912597656
local_in_edges_tensor generation: 0.05532550811767578

&&&&&&&&&&&&&&& before remove duplicate length: 1839272
remove duplicated spend time : 0.4575955867767334

&&&&&&&&&&&&&&& after remove duplicate length: 502627

mini_batch_src_global generation: 0.05276322364807129
r_  generation: 0.42705321311950684

local_output_nid generation: 0.052213430404663086
local_in_edges_tensor generation: 0.05025792121887207

&&&&&&&&&&&&&&& before remove duplicate length: 1819280
remove duplicated spend time : 0.4537644386291504

&&&&&&&&&&&&&&& after remove duplicate length: 432008

mini_batch_src_global generation: 0.051743507385253906
r_  generation: 0.40149736404418945

local_output_nid generation: 0.056470632553100586
local_in_edges_tensor generation: 0.06074810028076172

&&&&&&&&&&&&&&& before remove duplicate length: 2126050
remove duplicated spend time : 0.52400803565979

&&&&&&&&&&&&&&& after remove duplicate length: 484440

mini_batch_src_global generation: 0.057112693786621094
r_  generation: 0.4602928161621094

local_output_nid generation: 0.05156588554382324
local_in_edges_tensor generation: 0.04729580879211426

&&&&&&&&&&&&&&& before remove duplicate length: 1884661
remove duplicated spend time : 0.4724159240722656

&&&&&&&&&&&&&&& after remove duplicate length: 508515

mini_batch_src_global generation: 0.06497693061828613
r_  generation: 0.45619940757751465

local_output_nid generation: 0.060152530670166016
local_in_edges_tensor generation: 0.06412601470947266

&&&&&&&&&&&&&&& before remove duplicate length: 2160109
remove duplicated spend time : 0.5795795917510986

&&&&&&&&&&&&&&& after remove duplicate length: 625538

mini_batch_src_global generation: 0.07584762573242188
r_  generation: 0.5421631336212158

local_output_nid generation: 0.058629512786865234
local_in_edges_tensor generation: 0.057012319564819336

&&&&&&&&&&&&&&& before remove duplicate length: 2117184
remove duplicated spend time : 0.5619885921478271

&&&&&&&&&&&&&&& after remove duplicate length: 541244

mini_batch_src_global generation: 0.0686039924621582
r_  generation: 0.5084447860717773


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2088623046875 GB
    Memory Allocated: 0.13113975524902344  GigaBytes
Max Memory Allocated: 0.13113975524902344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2088623046875 GB
    Memory Allocated: 0.13132762908935547  GigaBytes
Max Memory Allocated: 0.13132762908935547  GigaBytes

first layer input nodes number: 349525
first layer output nodes number: 158480
edges number: 1531827
----------------------------------------before model layer 0
 Nvidia-smi: 7.3123779296875 GB
    Memory Allocated: 0.15100812911987305  GigaBytes
Max Memory Allocated: 0.15671491622924805  GigaBytes

torch.Size([349525, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.3123779296875 GB
    Memory Allocated: 0.15100812911987305  GigaBytes
Max Memory Allocated: 0.15671491622924805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.3123779296875 GB
    Memory Allocated: 0.15100812911987305  GigaBytes
Max Memory Allocated: 0.15671491622924805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6971435546875 GB
    Memory Allocated: 0.22205114364624023  GigaBytes
Max Memory Allocated: 0.2816805839538574  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6971435546875 GB
    Memory Allocated: 0.22205114364624023  GigaBytes
Max Memory Allocated: 0.2816805839538574  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8494873046875 GB
    Memory Allocated: 0.37318944931030273  GigaBytes
Max Memory Allocated: 0.37318944931030273  GigaBytes

h_neigh size torch.Size([158480, 256])
h_self size  torch.Size([158480, 100])
----------------------------------------before rst
 Nvidia-smi: 7.8494873046875 GB
    Memory Allocated: 0.37318944931030273  GigaBytes
Max Memory Allocated: 0.37318944931030273  GigaBytes

torch.Size([158480, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5243277549743652  GigaBytes
Max Memory Allocated: 0.6754660606384277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.37318944931030273  GigaBytes
Max Memory Allocated: 0.6754660606384277  GigaBytes

torch.Size([158480, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5243277549743652  GigaBytes
Max Memory Allocated: 0.6754660606384277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5621123313903809  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------input nodes number: 158480
----------------output nodes number: 25172
----------------edges number: 601389
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5635056495666504  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5635056495666504  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5921807289123535  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5921807289123535  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.596588134765625  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

h_neigh size torch.Size([25172, 47])
h_self size  torch.Size([25172, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.596588134765625  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

torch.Size([25172, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.6009955406188965  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.596588134765625  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

torch.Size([25172, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.4666748046875 GB
    Memory Allocated: 0.1360163688659668  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.6444091796875 GB
    Memory Allocated: 0.3137507438659668  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.6444091796875 GB
    Memory Allocated: 0.3139381408691406  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

first layer input nodes number: 475486
first layer output nodes number: 205040
edges number: 2022303
----------------------------------------before model layer 0
 Nvidia-smi: 8.6444091796875 GB
    Memory Allocated: 0.20945501327514648  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

torch.Size([475486, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.6444091796875 GB
    Memory Allocated: 0.20945501327514648  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.6444091796875 GB
    Memory Allocated: 0.20945501327514648  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.30167055130004883  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.30167055130004883  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8612060546875 GB
    Memory Allocated: 0.49721193313598633  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

h_neigh size torch.Size([205040, 256])
h_self size  torch.Size([205040, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8612060546875 GB
    Memory Allocated: 0.49721193313598633  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

torch.Size([205040, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.6927533149719238  GigaBytes
Max Memory Allocated: 0.8882946968078613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.49721193313598633  GigaBytes
Max Memory Allocated: 0.8882946968078613  GigaBytes

torch.Size([205040, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.6927533149719238  GigaBytes
Max Memory Allocated: 0.8882946968078613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7416386604309082  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------input nodes number: 205040
----------------output nodes number: 25123
----------------edges number: 621744
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7435503005981445  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7435503005981445  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7724099159240723  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7724099159240723  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7768087387084961  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

h_neigh size torch.Size([25123, 47])
h_self size  torch.Size([25123, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7768087387084961  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

torch.Size([25123, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7812075614929199  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7768087387084961  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

torch.Size([25123, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.18288230895996094  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.37865638732910156  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.37883663177490234  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

first layer input nodes number: 525526
first layer output nodes number: 190318
edges number: 1839272
----------------------------------------before model layer 0
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.2253279685974121  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([525526, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.2253279685974121  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.2253279685974121  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.3106403350830078  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.3106403350830078  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.4921417236328125  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([190318, 256])
h_self size  torch.Size([190318, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.4921417236328125  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([190318, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.6736431121826172  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.4921417236328125  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([190318, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.6736431121826172  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7190184593200684  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------input nodes number: 190318
----------------output nodes number: 24129
----------------edges number: 583893
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7206168174743652  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7206168174743652  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7488889694213867  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7488889694213867  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7531137466430664  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([24129, 47])
h_self size  torch.Size([24129, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7531137466430664  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([24129, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7573432922363281  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7531185150146484  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([24129, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.20074081420898438  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.36852455139160156  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.3687129020690918  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

first layer input nodes number: 450391
first layer output nodes number: 190503
edges number: 1819280
----------------------------------------before model layer 0
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.1959538459777832  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([450391, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.1959538459777832  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.1959538459777832  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.2811875343322754  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.2811875343322754  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.46286535263061523  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([190503, 256])
h_self size  torch.Size([190503, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.46286535263061523  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([190503, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.6445431709289551  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.46286535263061523  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([190503, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.6445431709289551  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.6899628639221191  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------input nodes number: 190503
----------------output nodes number: 25221
----------------edges number: 608268
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.6922130584716797  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.6922130584716797  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7213954925537109  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7213954925537109  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7263364791870117  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([25221, 47])
h_self size  torch.Size([25221, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7263364791870117  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([25221, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7307524681091309  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7258114814758301  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([25221, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.17294979095458984  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.3607826232910156  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.36097145080566406  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

first layer input nodes number: 504209
first layer output nodes number: 214947
edges number: 2126050
----------------------------------------before model layer 0
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.21898937225341797  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([504209, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.21898937225341797  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.21898937225341797  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6815185546875 GB
    Memory Allocated: 0.3157052993774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6815185546875 GB
    Memory Allocated: 0.3157052993774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.8865966796875 GB
    Memory Allocated: 0.5207834243774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([214947, 256])
h_self size  torch.Size([214947, 100])
----------------------------------------before rst
 Nvidia-smi: 9.8865966796875 GB
    Memory Allocated: 0.5207834243774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([214947, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7258615493774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.5207834243774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([214947, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7258615493774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7771091461181641  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------input nodes number: 214947
----------------output nodes number: 25309
----------------edges number: 628832
----------------------------------------before mean aggregator
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7789726257324219  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7789726257324219  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8079833984375  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8079833984375  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8124151229858398  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([25309, 47])
h_self size  torch.Size([25309, 256])
----------------------------------------before rst
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8124151229858398  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([25309, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8172826766967773  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8128509521484375  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([25309, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.19301509857177734  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.39278268814086914  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.3929605484008789  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

first layer input nodes number: 536246
first layer output nodes number: 193422
edges number: 1884661
----------------------------------------before model layer 0
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.22981786727905273  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([536246, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.22981786727905273  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.22981786727905273  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.3166360855102539  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.3166360855102539  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.5010976791381836  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

h_neigh size torch.Size([193422, 256])
h_self size  torch.Size([193422, 100])
----------------------------------------before rst
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.5010976791381836  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([193422, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.6855592727661133  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.5010976791381836  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([193422, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.6855592727661133  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7316746711730957  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------input nodes number: 193422
----------------output nodes number: 23856
----------------edges number: 576223
----------------------------------------before mean aggregator
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7332940101623535  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7332940101623535  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7613554000854492  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7613554000854492  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7655324935913086  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

h_neigh size torch.Size([23856, 47])
h_self size  torch.Size([23856, 256])
----------------------------------------before rst
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7655324935913086  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([23856, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.769709587097168  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7655324935913086  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([23856, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.20468425750732422  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.7537841796875 GB
    Memory Allocated: 0.4488248825073242  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.7537841796875 GB
    Memory Allocated: 0.4490032196044922  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

first layer input nodes number: 654835
first layer output nodes number: 219469
edges number: 2160109
----------------------------------------before model layer 0
 Nvidia-smi: 10.7537841796875 GB
    Memory Allocated: 0.2758359909057617  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([654835, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 10.7537841796875 GB
    Memory Allocated: 0.2758359909057617  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.7537841796875 GB
    Memory Allocated: 0.2758359909057617  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.7557373046875 GB
    Memory Allocated: 0.37450695037841797  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.7557373046875 GB
    Memory Allocated: 0.37450695037841797  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.9666748046875 GB
    Memory Allocated: 0.5838088989257812  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

h_neigh size torch.Size([219469, 256])
h_self size  torch.Size([219469, 100])
----------------------------------------before rst
 Nvidia-smi: 10.9666748046875 GB
    Memory Allocated: 0.5838088989257812  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([219469, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.7931108474731445  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.5838088989257812  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([219469, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.7931108474731445  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8454365730285645  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------input nodes number: 219469
----------------output nodes number: 23896
----------------edges number: 559519
----------------------------------------before mean aggregator
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8472504615783691  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8472504615783691  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8751873970031738  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8751873970031738  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8793716430664062  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

h_neigh size torch.Size([23896, 47])
h_self size  torch.Size([23896, 256])
----------------------------------------before rst
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8793716430664062  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([23896, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8835558891296387  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8793716430664062  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([23896, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.24906492233276367  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.46000242233276367  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.46018028259277344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 564819
first layer output nodes number: 214439
edges number: 2117184
----------------------------------------before model layer 0
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.24292707443237305  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([564819, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.24292707443237305  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.24292707443237305  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.339385986328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.339385986328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.544464111328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([214439, 256])
h_self size  torch.Size([214439, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.544464111328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([214439, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.749542236328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.544464111328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([214439, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.749542236328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8006687164306641  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 214439
----------------output nodes number: 23865
----------------edges number: 584011
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8024444580078125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8024444580078125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8297915458679199  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8297915458679199  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8339700698852539  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([23865, 47])
h_self size  torch.Size([23865, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8339700698852539  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23865, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8381485939025879  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8339700698852539  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23865, 47])
-----------------------------------------after training 
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.2714810371398926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes


-----------------------------------------------------------------------------epoch done
