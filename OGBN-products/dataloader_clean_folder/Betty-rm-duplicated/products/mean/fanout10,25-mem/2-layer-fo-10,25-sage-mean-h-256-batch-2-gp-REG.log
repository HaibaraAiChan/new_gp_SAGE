main start at this time 1661474625.020762
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22723889350891113
global_2_local spend time (sec) 0.37389254570007324

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.989 seconds
Metis partitioning: 11.149 seconds
Split the graph: 5.899 seconds
Construct subgraphs: 0.049 seconds
98906
97665
REG metis partition end ----................................
the time spent:  29.1358904838562
REG construction  time spent:  9.026887893676758
pure dgl.metis_partition the time spent:  20.109002590179443
total k batches seeds list generation spend  29.787355422973633
after graph partition
graph partition algorithm spend time 30.615456342697144

partition_len_list
[621980, 661492]
REG selection method  spend 31.1514790058136
check_connections_block*********************************
time for parepare 1: 0.22825884819030762
local_output_nid generation: 0.013050556182861328
local_in_edges_tensor generation: 0.02786421775817871

&&&&&&&&&&&&&&& before remove duplicate length: 2397569
remove duplicated spend time : 0.5743553638458252

&&&&&&&&&&&&&&& after remove duplicate length: 617827

mini_batch_src_global generation: 0.043985605239868164
r_  generation: 0.3733816146850586

local_output_nid generation: 0.014733076095581055
local_in_edges_tensor generation: 0.045781850814819336

&&&&&&&&&&&&&&& before remove duplicate length: 2366310
remove duplicated spend time : 0.6096091270446777

&&&&&&&&&&&&&&& after remove duplicate length: 654506

mini_batch_src_global generation: 0.06772446632385254
r_  generation: 0.4886505603790283


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6105165481567383
gen group dst list time:  0.04514956474304199
check_connections_block*********************************
time for parepare 1: 0.36678218841552734
local_output_nid generation: 0.0988161563873291
local_in_edges_tensor generation: 0.23211002349853516

&&&&&&&&&&&&&&& before remove duplicate length: 5996918
remove duplicated spend time : 1.6673755645751953

&&&&&&&&&&&&&&& after remove duplicate length: 1068036

mini_batch_src_global generation: 0.08255910873413086
r_  generation: 1.0301094055175781

local_output_nid generation: 0.140608549118042
local_in_edges_tensor generation: 0.21144962310791016

&&&&&&&&&&&&&&& before remove duplicate length: 6480009
remove duplicated spend time : 1.7917232513427734

&&&&&&&&&&&&&&& after remove duplicate length: 1114879

mini_batch_src_global generation: 0.12519049644470215
r_  generation: 1.2547869682312012


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 0.41473913192749023  GigaBytes
Max Memory Allocated: 0.41473913192749023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 0.41547632217407227  GigaBytes
Max Memory Allocated: 0.41547632217407227  GigaBytes

first layer input nodes number: 1112553
first layer output nodes number: 621980
edges number: 5996918
----------------------------------------before model layer 0
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.49094486236572266  GigaBytes
Max Memory Allocated: 0.5132851600646973  GigaBytes

torch.Size([1112553, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.49094486236572266  GigaBytes
Max Memory Allocated: 0.5132851600646973  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.49094486236572266  GigaBytes
Max Memory Allocated: 0.5132851600646973  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7303466796875 GB
    Memory Allocated: 0.7703647613525391  GigaBytes
Max Memory Allocated: 1.0051040649414062  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7303466796875 GB
    Memory Allocated: 0.7703647613525391  GigaBytes
Max Memory Allocated: 1.0051040649414062  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3240966796875 GB
    Memory Allocated: 1.364114761352539  GigaBytes
Max Memory Allocated: 1.364114761352539  GigaBytes

h_neigh size torch.Size([621980, 256])
h_self size  torch.Size([621980, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3240966796875 GB
    Memory Allocated: 1.364114761352539  GigaBytes
Max Memory Allocated: 1.364114761352539  GigaBytes

torch.Size([621980, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.5115966796875 GB
    Memory Allocated: 1.957864761352539  GigaBytes
Max Memory Allocated: 2.551614761352539  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5115966796875 GB
    Memory Allocated: 1.364114761352539  GigaBytes
Max Memory Allocated: 2.551614761352539  GigaBytes

torch.Size([621980, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5115966796875 GB
    Memory Allocated: 1.957864761352539  GigaBytes
Max Memory Allocated: 2.551614761352539  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5115966796875 GB
    Memory Allocated: 2.106156349182129  GigaBytes
Max Memory Allocated: 2.699906349182129  GigaBytes

----------------input nodes number: 621980
----------------output nodes number: 98906
----------------edges number: 2397569
----------------------------------------before mean aggregator
 Nvidia-smi: 10.5115966796875 GB
    Memory Allocated: 2.111527919769287  GigaBytes
Max Memory Allocated: 2.699906349182129  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.5115966796875 GB
    Memory Allocated: 2.111527919769287  GigaBytes
Max Memory Allocated: 2.699906349182129  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.2253923416137695  GigaBytes
Max Memory Allocated: 2.699906349182129  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.2253923416137695  GigaBytes
Max Memory Allocated: 2.699906349182129  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.2427101135253906  GigaBytes
Max Memory Allocated: 2.699906349182129  GigaBytes

h_neigh size torch.Size([98906, 47])
h_self size  torch.Size([98906, 256])
----------------------------------------before rst
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.2427101135253906  GigaBytes
Max Memory Allocated: 2.699906349182129  GigaBytes

torch.Size([98906, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.2600278854370117  GigaBytes
Max Memory Allocated: 2.699906349182129  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.2427101135253906  GigaBytes
Max Memory Allocated: 2.699906349182129  GigaBytes

torch.Size([98906, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 11.7283935546875 GB
    Memory Allocated: 0.4330754280090332  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.7283935546875 GB
    Memory Allocated: 0.868196964263916  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.7283935546875 GB
    Memory Allocated: 0.8689250946044922  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

first layer input nodes number: 1168020
first layer output nodes number: 661492
edges number: 6480009
----------------------------------------before model layer 0
 Nvidia-smi: 11.7283935546875 GB
    Memory Allocated: 0.5332717895507812  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

torch.Size([1168020, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.7283935546875 GB
    Memory Allocated: 0.5332717895507812  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.7283935546875 GB
    Memory Allocated: 0.5332717895507812  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.7440185546875 GB
    Memory Allocated: 0.830441951751709  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.7440185546875 GB
    Memory Allocated: 0.830441951751709  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.3748779296875 GB
    Memory Allocated: 1.461301326751709  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

h_neigh size torch.Size([661492, 256])
h_self size  torch.Size([661492, 100])
----------------------------------------before rst
 Nvidia-smi: 12.3748779296875 GB
    Memory Allocated: 1.461301326751709  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

torch.Size([661492, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.092160701751709  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 1.461301326751709  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

torch.Size([661492, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.092160701751709  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.2498726844787598  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------input nodes number: 661492
----------------output nodes number: 97665
----------------edges number: 2366310
----------------------------------------before mean aggregator
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.2555294036865234  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.2555294036865234  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.3670291900634766  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.3670291900634766  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.384129524230957  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

h_neigh size torch.Size([97665, 47])
h_self size  torch.Size([97665, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.384129524230957  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

torch.Size([97665, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.4012298583984375  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 2.384129524230957  GigaBytes
Max Memory Allocated: 3.355790138244629  GigaBytes

torch.Size([97665, 47])
-----------------------------------------after training 
 Nvidia-smi: 14.3045654296875 GB
    Memory Allocated: 0.6289033889770508  GigaBytes
Max Memory Allocated: 3.555917739868164  GigaBytes


-----------------------------------------------------------------------------epoch done
