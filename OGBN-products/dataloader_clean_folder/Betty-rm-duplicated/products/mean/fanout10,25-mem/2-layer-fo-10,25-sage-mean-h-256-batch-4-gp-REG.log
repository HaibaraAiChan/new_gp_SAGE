main start at this time 1661474708.6650302
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2234952449798584
global_2_local spend time (sec) 0.3713836669921875

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.901 seconds
Metis partitioning: 11.258 seconds
Split the graph: 2.883 seconds
Construct subgraphs: 0.059 seconds
50481
48893
47998
49199
REG metis partition end ----................................
the time spent:  25.933913707733154
REG construction  time spent:  8.81078815460205
pure dgl.metis_partition the time spent:  17.123125553131104
total k batches seeds list generation spend  26.539504528045654
after graph partition
graph partition algorithm spend time 27.20550036430359

partition_len_list
[343198, 318743, 379655, 358639]
REG selection method  spend 27.753132104873657
check_connections_block*********************************
time for parepare 1: 0.23523187637329102
local_output_nid generation: 0.01215362548828125
local_in_edges_tensor generation: 0.03130602836608887

&&&&&&&&&&&&&&& before remove duplicate length: 1228253
remove duplicated spend time : 0.26493024826049805

&&&&&&&&&&&&&&& after remove duplicate length: 340699

mini_batch_src_global generation: 0.03614997863769531
r_  generation: 0.192763090133667

local_output_nid generation: 0.009904146194458008
local_in_edges_tensor generation: 0.02605152130126953

&&&&&&&&&&&&&&& before remove duplicate length: 1181812
remove duplicated spend time : 0.2733919620513916

&&&&&&&&&&&&&&& after remove duplicate length: 316613

mini_batch_src_global generation: 0.033513784408569336
r_  generation: 0.20522379875183105

local_output_nid generation: 0.010972976684570312
local_in_edges_tensor generation: 0.05029177665710449

&&&&&&&&&&&&&&& before remove duplicate length: 1132345
remove duplicated spend time : 0.27504420280456543

&&&&&&&&&&&&&&& after remove duplicate length: 372568

mini_batch_src_global generation: 0.03659629821777344
r_  generation: 0.2632577419281006

local_output_nid generation: 0.011192560195922852
local_in_edges_tensor generation: 0.030294418334960938

&&&&&&&&&&&&&&& before remove duplicate length: 1221469
remove duplicated spend time : 0.3082163333892822

&&&&&&&&&&&&&&& after remove duplicate length: 356685

mini_batch_src_global generation: 0.03912496566772461
r_  generation: 0.26944828033447266


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7410750389099121
gen group dst list time:  0.041910648345947266
check_connections_block*********************************
time for parepare 1: 0.3734476566314697
local_output_nid generation: 0.0695197582244873
local_in_edges_tensor generation: 0.17890238761901855

&&&&&&&&&&&&&&& before remove duplicate length: 3348669
remove duplicated spend time : 0.7936375141143799

&&&&&&&&&&&&&&& after remove duplicate length: 676254

mini_batch_src_global generation: 0.04801607131958008
r_  generation: 0.5841865539550781

local_output_nid generation: 0.08290624618530273
local_in_edges_tensor generation: 0.09771347045898438

&&&&&&&&&&&&&&& before remove duplicate length: 3042377
remove duplicated spend time : 0.7640914916992188

&&&&&&&&&&&&&&& after remove duplicate length: 634850

mini_batch_src_global generation: 0.06937646865844727
r_  generation: 0.6070296764373779

local_output_nid generation: 0.1078193187713623
local_in_edges_tensor generation: 0.13486933708190918

&&&&&&&&&&&&&&& before remove duplicate length: 3710945
remove duplicated spend time : 0.9932279586791992

&&&&&&&&&&&&&&& after remove duplicate length: 856591

mini_batch_src_global generation: 0.09386682510375977
r_  generation: 0.8534407615661621

local_output_nid generation: 0.09328079223632812
local_in_edges_tensor generation: 0.0973966121673584

&&&&&&&&&&&&&&& before remove duplicate length: 3539527
remove duplicated spend time : 0.948265790939331

&&&&&&&&&&&&&&& after remove duplicate length: 676384

mini_batch_src_global generation: 0.0921483039855957
r_  generation: 0.7281148433685303


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3416748046875 GB
    Memory Allocated: 0.26267051696777344  GigaBytes
Max Memory Allocated: 0.26267051696777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3416748046875 GB
    Memory Allocated: 0.2630467414855957  GigaBytes
Max Memory Allocated: 0.2630467414855957  GigaBytes

first layer input nodes number: 704348
first layer output nodes number: 343198
edges number: 3348669
----------------------------------------before model layer 0
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.30495357513427734  GigaBytes
Max Memory Allocated: 0.3174285888671875  GigaBytes

torch.Size([704348, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.30495357513427734  GigaBytes
Max Memory Allocated: 0.3174285888671875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.30495357513427734  GigaBytes
Max Memory Allocated: 0.3174285888671875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1307373046875 GB
    Memory Allocated: 0.45903682708740234  GigaBytes
Max Memory Allocated: 0.5881671905517578  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1307373046875 GB
    Memory Allocated: 0.45903682708740234  GigaBytes
Max Memory Allocated: 0.5881671905517578  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.4588623046875 GB
    Memory Allocated: 0.7871618270874023  GigaBytes
Max Memory Allocated: 0.7871618270874023  GigaBytes

h_neigh size torch.Size([343198, 256])
h_self size  torch.Size([343198, 100])
----------------------------------------before rst
 Nvidia-smi: 8.4588623046875 GB
    Memory Allocated: 0.7871618270874023  GigaBytes
Max Memory Allocated: 0.7871618270874023  GigaBytes

torch.Size([343198, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.1152868270874023  GigaBytes
Max Memory Allocated: 1.4434118270874023  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 0.7871618270874023  GigaBytes
Max Memory Allocated: 1.4434118270874023  GigaBytes

torch.Size([343198, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.1152868270874023  GigaBytes
Max Memory Allocated: 1.4434118270874023  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.1971116065979004  GigaBytes
Max Memory Allocated: 1.5252366065979004  GigaBytes

----------------input nodes number: 343198
----------------output nodes number: 50481
----------------edges number: 1228253
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2000622749328613  GigaBytes
Max Memory Allocated: 1.5252366065979004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2000622749328613  GigaBytes
Max Memory Allocated: 1.5252366065979004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.25773286819458  GigaBytes
Max Memory Allocated: 1.5252366065979004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.25773286819458  GigaBytes
Max Memory Allocated: 1.5252366065979004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2665715217590332  GigaBytes
Max Memory Allocated: 1.5252366065979004  GigaBytes

h_neigh size torch.Size([50481, 47])
h_self size  torch.Size([50481, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2665715217590332  GigaBytes
Max Memory Allocated: 1.5252366065979004  GigaBytes

torch.Size([50481, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2754101753234863  GigaBytes
Max Memory Allocated: 1.5252366065979004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2665715217590332  GigaBytes
Max Memory Allocated: 1.5252366065979004  GigaBytes

torch.Size([50481, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.27216672897338867  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.5190672874450684  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.5194315910339355  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

first layer input nodes number: 662768
first layer output nodes number: 318743
edges number: 3042377
----------------------------------------before model layer 0
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.2963871955871582  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

torch.Size([662768, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.2963871955871582  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.2963871955871582  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.4389839172363281  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.4389839172363281  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.7429609298706055  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

h_neigh size torch.Size([318743, 256])
h_self size  torch.Size([318743, 100])
----------------------------------------before rst
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.7429609298706055  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

torch.Size([318743, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.0469379425048828  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.7429609298706055  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

torch.Size([318743, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.0469379425048828  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.1229324340820312  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------input nodes number: 318743
----------------output nodes number: 48893
----------------edges number: 1181812
----------------------------------------before mean aggregator
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.1256718635559082  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.1256718635559082  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1822967529296875  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1822967529296875  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.191030502319336  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

h_neigh size torch.Size([48893, 47])
h_self size  torch.Size([48893, 256])
----------------------------------------before rst
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.191030502319336  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

torch.Size([48893, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1995911598205566  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1908574104309082  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

torch.Size([48893, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 10.0936279296875 GB
    Memory Allocated: 0.2565603256225586  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.5924978256225586  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.5928554534912109  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

first layer input nodes number: 900302
first layer output nodes number: 379655
edges number: 3710945
----------------------------------------before model layer 0
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.3919334411621094  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

torch.Size([900302, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.3919334411621094  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 0.3919334411621094  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.5625033378601074  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 0.5625033378601074  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.8065185546875 GB
    Memory Allocated: 0.9245705604553223  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

h_neigh size torch.Size([379655, 256])
h_self size  torch.Size([379655, 100])
----------------------------------------before rst
 Nvidia-smi: 10.8065185546875 GB
    Memory Allocated: 0.9245705604553223  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

torch.Size([379655, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.286637783050537  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 0.9245705604553223  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

torch.Size([379655, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.286637783050537  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.37715482711792  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------input nodes number: 379655
----------------output nodes number: 47998
----------------edges number: 1132345
----------------------------------------before mean aggregator
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.3803415298461914  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.3803415298461914  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.4352107048034668  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.4352107048034668  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.4436149597167969  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

h_neigh size torch.Size([47998, 47])
h_self size  torch.Size([47998, 256])
----------------------------------------before rst
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.4436149597167969  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

torch.Size([47998, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.452019214630127  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.5330810546875 GB
    Memory Allocated: 1.4436149597167969  GigaBytes
Max Memory Allocated: 1.885012149810791  GigaBytes

torch.Size([47998, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.3452610969543457  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.6071391105651855  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.6075057983398438  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

first layer input nodes number: 702973
first layer output nodes number: 358639
edges number: 3539527
----------------------------------------before model layer 0
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.3162822723388672  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

torch.Size([702973, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.3162822723388672  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.3162822723388672  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.47853755950927734  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.47853755950927734  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.8205623626708984  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

h_neigh size torch.Size([358639, 256])
h_self size  torch.Size([358639, 100])
----------------------------------------before rst
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.8205623626708984  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

torch.Size([358639, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.1625871658325195  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.8205623626708984  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

torch.Size([358639, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.1625871658325195  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.248093605041504  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------input nodes number: 358639
----------------output nodes number: 49199
----------------edges number: 1221469
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.2511324882507324  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.2511324882507324  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.3075203895568848  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.3075203895568848  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.3161349296569824  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

h_neigh size torch.Size([49199, 47])
h_self size  torch.Size([49199, 256])
----------------------------------------before rst
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.3161349296569824  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

torch.Size([49199, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.32474946975708  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 1.3161349296569824  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes

torch.Size([49199, 47])
-----------------------------------------after training 
 Nvidia-smi: 11.9315185546875 GB
    Memory Allocated: 0.36895179748535156  GigaBytes
Max Memory Allocated: 2.1235289573669434  GigaBytes


-----------------------------------------------------------------------------epoch done
