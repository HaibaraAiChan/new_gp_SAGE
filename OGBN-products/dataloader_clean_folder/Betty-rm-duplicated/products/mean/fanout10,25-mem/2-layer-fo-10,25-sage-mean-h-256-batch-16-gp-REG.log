main start at this time 1661474871.3824306
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22276973724365234
global_2_local spend time (sec) 0.37152743339538574

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.020 seconds
Metis partitioning: 12.556 seconds
Split the graph: 1.373 seconds
Construct subgraphs: 0.328 seconds
12327
12555
12239
12654
12040
12644
12379
12361
12641
12099
12573
12069
11929
11939
12172
11950
REG metis partition end ----................................
the time spent:  26.21121907234192
REG construction  time spent:  8.912261962890625
pure dgl.metis_partition the time spent:  17.298957109451294
total k batches seeds list generation spend  26.816747903823853
after graph partition
graph partition algorithm spend time 27.394890069961548

partition_len_list
[116811, 107215, 89455, 80420, 104075, 116356, 95060, 97594, 115581, 116188, 115294, 123194, 109645, 115361, 110555, 106607]
REG selection method  spend 27.959458351135254
check_connections_block*********************************
time for parepare 1: 0.23009514808654785
local_output_nid generation: 0.003965854644775391
local_in_edges_tensor generation: 0.005936861038208008

&&&&&&&&&&&&&&& before remove duplicate length: 305229
remove duplicated spend time : 0.05686473846435547

&&&&&&&&&&&&&&& after remove duplicate length: 115888

mini_batch_src_global generation: 0.007882118225097656
r_  generation: 0.05391097068786621

local_output_nid generation: 0.004658222198486328
local_in_edges_tensor generation: 0.005595684051513672

&&&&&&&&&&&&&&& before remove duplicate length: 310335
remove duplicated spend time : 0.06045675277709961

&&&&&&&&&&&&&&& after remove duplicate length: 106452

mini_batch_src_global generation: 0.007847309112548828
r_  generation: 0.05580902099609375

local_output_nid generation: 0.004636287689208984
local_in_edges_tensor generation: 0.004704475402832031

&&&&&&&&&&&&&&& before remove duplicate length: 295523
remove duplicated spend time : 0.06474733352661133

&&&&&&&&&&&&&&& after remove duplicate length: 88500

mini_batch_src_global generation: 0.00699615478515625
r_  generation: 0.05127120018005371

local_output_nid generation: 0.004867076873779297
local_in_edges_tensor generation: 0.01740550994873047

&&&&&&&&&&&&&&& before remove duplicate length: 298994
remove duplicated spend time : 0.05043363571166992

&&&&&&&&&&&&&&& after remove duplicate length: 79303

mini_batch_src_global generation: 0.005824565887451172
r_  generation: 0.04171133041381836

local_output_nid generation: 0.005640745162963867
local_in_edges_tensor generation: 0.007585048675537109

&&&&&&&&&&&&&&& before remove duplicate length: 292435
remove duplicated spend time : 0.057389259338378906

&&&&&&&&&&&&&&& after remove duplicate length: 102800

mini_batch_src_global generation: 0.008114814758300781
r_  generation: 0.06323599815368652

local_output_nid generation: 0.00471949577331543
local_in_edges_tensor generation: 0.006350040435791016

&&&&&&&&&&&&&&& before remove duplicate length: 304877
remove duplicated spend time : 0.06433844566345215

&&&&&&&&&&&&&&& after remove duplicate length: 115200

mini_batch_src_global generation: 0.009427547454833984
r_  generation: 0.06298065185546875

local_output_nid generation: 0.004808664321899414
local_in_edges_tensor generation: 0.004845857620239258

&&&&&&&&&&&&&&& before remove duplicate length: 298535
remove duplicated spend time : 0.0663290023803711

&&&&&&&&&&&&&&& after remove duplicate length: 94332

mini_batch_src_global generation: 0.007792949676513672
r_  generation: 0.05538296699523926

local_output_nid generation: 0.004703998565673828
local_in_edges_tensor generation: 0.004736185073852539

&&&&&&&&&&&&&&& before remove duplicate length: 298985
remove duplicated spend time : 0.06518769264221191

&&&&&&&&&&&&&&& after remove duplicate length: 96826

mini_batch_src_global generation: 0.0075986385345458984
r_  generation: 0.05548977851867676

local_output_nid generation: 0.004813671112060547
local_in_edges_tensor generation: 0.004733562469482422

&&&&&&&&&&&&&&& before remove duplicate length: 313781
remove duplicated spend time : 0.06921744346618652

&&&&&&&&&&&&&&& after remove duplicate length: 114934

mini_batch_src_global generation: 0.009580135345458984
r_  generation: 0.0652303695678711

local_output_nid generation: 0.005813121795654297
local_in_edges_tensor generation: 0.004618644714355469

&&&&&&&&&&&&&&& before remove duplicate length: 299857
remove duplicated spend time : 0.06521725654602051

&&&&&&&&&&&&&&& after remove duplicate length: 114959

mini_batch_src_global generation: 0.009715795516967773
r_  generation: 0.06875205039978027

local_output_nid generation: 0.00483393669128418
local_in_edges_tensor generation: 0.0050275325775146484

&&&&&&&&&&&&&&& before remove duplicate length: 313151
remove duplicated spend time : 0.06754851341247559

&&&&&&&&&&&&&&& after remove duplicate length: 114572

mini_batch_src_global generation: 0.00941157341003418
r_  generation: 0.06519794464111328

local_output_nid generation: 0.004595279693603516
local_in_edges_tensor generation: 0.004660367965698242

&&&&&&&&&&&&&&& before remove duplicate length: 300161
remove duplicated spend time : 0.06747579574584961

&&&&&&&&&&&&&&& after remove duplicate length: 121946

mini_batch_src_global generation: 0.00993490219116211
r_  generation: 0.06840682029724121

local_output_nid generation: 0.004570484161376953
local_in_edges_tensor generation: 0.004546165466308594

&&&&&&&&&&&&&&& before remove duplicate length: 285338
remove duplicated spend time : 0.059943199157714844

&&&&&&&&&&&&&&& after remove duplicate length: 107139

mini_batch_src_global generation: 0.008637666702270508
r_  generation: 0.060263872146606445

local_output_nid generation: 0.004583597183227539
local_in_edges_tensor generation: 0.00453948974609375

&&&&&&&&&&&&&&& before remove duplicate length: 287712
remove duplicated spend time : 0.06266236305236816

&&&&&&&&&&&&&&& after remove duplicate length: 113793

mini_batch_src_global generation: 0.009103059768676758
r_  generation: 0.0632181167602539

local_output_nid generation: 0.004694223403930664
local_in_edges_tensor generation: 0.004761219024658203

&&&&&&&&&&&&&&& before remove duplicate length: 285297
remove duplicated spend time : 0.06759881973266602

&&&&&&&&&&&&&&& after remove duplicate length: 107843

mini_batch_src_global generation: 0.008921623229980469
r_  generation: 0.060793399810791016

local_output_nid generation: 0.004657268524169922
local_in_edges_tensor generation: 0.004648447036743164

&&&&&&&&&&&&&&& before remove duplicate length: 273669
remove duplicated spend time : 0.057161569595336914

&&&&&&&&&&&&&&& after remove duplicate length: 103148

mini_batch_src_global generation: 0.008455038070678711
r_  generation: 0.05870509147644043


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7634007930755615
gen group dst list time:  0.05109906196594238
check_connections_block*********************************
time for parepare 1: 0.38491249084472656
local_output_nid generation: 0.03161501884460449
local_in_edges_tensor generation: 0.0808403491973877

&&&&&&&&&&&&&&& before remove duplicate length: 1152785
remove duplicated spend time : 0.2360672950744629

&&&&&&&&&&&&&&& after remove duplicate length: 324097

mini_batch_src_global generation: 0.022006988525390625
r_  generation: 0.2143261432647705

local_output_nid generation: 0.033856868743896484
local_in_edges_tensor generation: 0.041724443435668945

&&&&&&&&&&&&&&& before remove duplicate length: 1056827
remove duplicated spend time : 0.2439897060394287

&&&&&&&&&&&&&&& after remove duplicate length: 282474

mini_batch_src_global generation: 0.02990269660949707
r_  generation: 0.2232675552368164

local_output_nid generation: 0.02679753303527832
local_in_edges_tensor generation: 0.03701472282409668

&&&&&&&&&&&&&&& before remove duplicate length: 869702
remove duplicated spend time : 0.19026422500610352

&&&&&&&&&&&&&&& after remove duplicate length: 239797

mini_batch_src_global generation: 0.027392148971557617
r_  generation: 0.18994712829589844

local_output_nid generation: 0.0297696590423584
local_in_edges_tensor generation: 0.02044200897216797

&&&&&&&&&&&&&&& before remove duplicate length: 775798
remove duplicated spend time : 0.15399622917175293

&&&&&&&&&&&&&&& after remove duplicate length: 164131

mini_batch_src_global generation: 0.01849961280822754
r_  generation: 0.131575345993042

local_output_nid generation: 0.03206324577331543
local_in_edges_tensor generation: 0.04606819152832031

&&&&&&&&&&&&&&& before remove duplicate length: 1013613
remove duplicated spend time : 0.23536181449890137

&&&&&&&&&&&&&&& after remove duplicate length: 325872

mini_batch_src_global generation: 0.03449702262878418
r_  generation: 0.24304628372192383

local_output_nid generation: 0.04149031639099121
local_in_edges_tensor generation: 0.043805599212646484

&&&&&&&&&&&&&&& before remove duplicate length: 1119032
remove duplicated spend time : 0.2584066390991211

&&&&&&&&&&&&&&& after remove duplicate length: 311398

mini_batch_src_global generation: 0.038407087326049805
r_  generation: 0.2571427822113037

local_output_nid generation: 0.035317420959472656
local_in_edges_tensor generation: 0.024165630340576172

&&&&&&&&&&&&&&& before remove duplicate length: 908957
remove duplicated spend time : 0.21178221702575684

&&&&&&&&&&&&&&& after remove duplicate length: 248008

mini_batch_src_global generation: 0.03321409225463867
r_  generation: 0.2041637897491455

local_output_nid generation: 0.029516935348510742
local_in_edges_tensor generation: 0.025325298309326172

&&&&&&&&&&&&&&& before remove duplicate length: 942199
remove duplicated spend time : 0.21781110763549805

&&&&&&&&&&&&&&& after remove duplicate length: 263807

mini_batch_src_global generation: 0.03406643867492676
r_  generation: 0.2079024314880371

local_output_nid generation: 0.03396344184875488
local_in_edges_tensor generation: 0.032921552658081055

&&&&&&&&&&&&&&& before remove duplicate length: 1140748
remove duplicated spend time : 0.2659728527069092

&&&&&&&&&&&&&&& after remove duplicate length: 303283

mini_batch_src_global generation: 0.03828072547912598
r_  generation: 0.2505607604980469

local_output_nid generation: 0.03381943702697754
local_in_edges_tensor generation: 0.03518867492675781

&&&&&&&&&&&&&&& before remove duplicate length: 1150107
remove duplicated spend time : 0.26261281967163086

&&&&&&&&&&&&&&& after remove duplicate length: 309992

mini_batch_src_global generation: 0.04008626937866211
r_  generation: 0.25897216796875

local_output_nid generation: 0.03296518325805664
local_in_edges_tensor generation: 0.030927419662475586

&&&&&&&&&&&&&&& before remove duplicate length: 1142771
remove duplicated spend time : 0.2683711051940918

&&&&&&&&&&&&&&& after remove duplicate length: 311984

mini_batch_src_global generation: 0.04077506065368652
r_  generation: 0.26406431198120117

local_output_nid generation: 0.03750133514404297
local_in_edges_tensor generation: 0.042948007583618164

&&&&&&&&&&&&&&& before remove duplicate length: 1220500
remove duplicated spend time : 0.3164045810699463

&&&&&&&&&&&&&&& after remove duplicate length: 359576

mini_batch_src_global generation: 0.04601240158081055
r_  generation: 0.3170654773712158

local_output_nid generation: 0.03332042694091797
local_in_edges_tensor generation: 0.031508684158325195

&&&&&&&&&&&&&&& before remove duplicate length: 1067181
remove duplicated spend time : 0.2817811965942383

&&&&&&&&&&&&&&& after remove duplicate length: 375093

mini_batch_src_global generation: 0.04929351806640625
r_  generation: 0.32122111320495605

local_output_nid generation: 0.03397846221923828
local_in_edges_tensor generation: 0.02853679656982422

&&&&&&&&&&&&&&& before remove duplicate length: 1130915
remove duplicated spend time : 0.2963385581970215

&&&&&&&&&&&&&&& after remove duplicate length: 361198

mini_batch_src_global generation: 0.046143293380737305
r_  generation: 0.3321816921234131

local_output_nid generation: 0.03295636177062988
local_in_edges_tensor generation: 0.03600049018859863

&&&&&&&&&&&&&&& before remove duplicate length: 1084802
remove duplicated spend time : 0.2696216106414795

&&&&&&&&&&&&&&& after remove duplicate length: 349023

mini_batch_src_global generation: 0.046201467514038086
r_  generation: 0.28627920150756836

local_output_nid generation: 0.03379034996032715
local_in_edges_tensor generation: 0.03247690200805664

&&&&&&&&&&&&&&& before remove duplicate length: 1048603
remove duplicated spend time : 0.2821009159088135

&&&&&&&&&&&&&&& after remove duplicate length: 371123

mini_batch_src_global generation: 0.04885601997375488
r_  generation: 0.32161927223205566


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2049560546875 GB
    Memory Allocated: 0.12723350524902344  GigaBytes
Max Memory Allocated: 0.12723350524902344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2049560546875 GB
    Memory Allocated: 0.12732553482055664  GigaBytes
Max Memory Allocated: 0.12732553482055664  GigaBytes

first layer input nodes number: 338658
first layer output nodes number: 116811
edges number: 1152785
----------------------------------------before model layer 0
 Nvidia-smi: 7.2889404296875 GB
    Memory Allocated: 0.14158391952514648  GigaBytes
Max Memory Allocated: 0.14587879180908203  GigaBytes

torch.Size([338658, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.2889404296875 GB
    Memory Allocated: 0.14158391952514648  GigaBytes
Max Memory Allocated: 0.14587879180908203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.2889404296875 GB
    Memory Allocated: 0.14158391952514648  GigaBytes
Max Memory Allocated: 0.14587879180908203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6385498046875 GB
    Memory Allocated: 0.19412469863891602  GigaBytes
Max Memory Allocated: 0.23807573318481445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6385498046875 GB
    Memory Allocated: 0.19412469863891602  GigaBytes
Max Memory Allocated: 0.23807573318481445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.3055243492126465  GigaBytes
Max Memory Allocated: 0.3055243492126465  GigaBytes

h_neigh size torch.Size([116811, 256])
h_self size  torch.Size([116811, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.3055243492126465  GigaBytes
Max Memory Allocated: 0.3055243492126465  GigaBytes

torch.Size([116811, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.41692399978637695  GigaBytes
Max Memory Allocated: 0.5283236503601074  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.3055243492126465  GigaBytes
Max Memory Allocated: 0.5283236503601074  GigaBytes

torch.Size([116811, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.41692399978637695  GigaBytes
Max Memory Allocated: 0.5283236503601074  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.44477415084838867  GigaBytes
Max Memory Allocated: 0.5561738014221191  GigaBytes

----------------input nodes number: 116811
----------------output nodes number: 12327
----------------edges number: 305229
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.4457368850708008  GigaBytes
Max Memory Allocated: 0.5561738014221191  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.4457368850708008  GigaBytes
Max Memory Allocated: 0.5561738014221191  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.46084022521972656  GigaBytes
Max Memory Allocated: 0.5561738014221191  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.46084022521972656  GigaBytes
Max Memory Allocated: 0.5561738014221191  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.4629988670349121  GigaBytes
Max Memory Allocated: 0.5561738014221191  GigaBytes

h_neigh size torch.Size([12327, 47])
h_self size  torch.Size([12327, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.4629988670349121  GigaBytes
Max Memory Allocated: 0.5561738014221191  GigaBytes

torch.Size([12327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.4653286933898926  GigaBytes
Max Memory Allocated: 0.5561738014221191  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 0.46317005157470703  GigaBytes
Max Memory Allocated: 0.5561738014221191  GigaBytes

torch.Size([12327, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.12976551055908203  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.23929738998413086  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.23939132690429688  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 294022
first layer output nodes number: 107215
edges number: 1056827
----------------------------------------before model layer 0
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.12607479095458984  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([294022, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.12607479095458984  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.12607479095458984  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.17428970336914062  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.17428970336914062  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.2765378952026367  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([107215, 256])
h_self size  torch.Size([107215, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.2765378952026367  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([107215, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3787860870361328  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.2765378952026367  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([107215, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3787860870361328  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.40434837341308594  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 107215
----------------output nodes number: 12555
----------------edges number: 310335
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.4052414894104004  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.4052414894104004  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.41990232467651367  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.41990232467651367  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.42272090911865234  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12555, 47])
h_self size  torch.Size([12555, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.42272090911865234  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12555, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.4255032539367676  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.4226846694946289  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12555, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.11238622665405273  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.2055654525756836  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.2056570053100586  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 250126
first layer output nodes number: 89455
edges number: 869702
----------------------------------------before model layer 0
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.10782432556152344  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([250126, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.10782432556152344  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.10782432556152344  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.14809846878051758  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.14809846878051758  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.23340940475463867  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([89455, 256])
h_self size  torch.Size([89455, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.23340940475463867  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([89455, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.31872034072875977  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.23340940475463867  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([89455, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.31872034072875977  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.34004831314086914  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 89455
----------------output nodes number: 12239
----------------edges number: 295523
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3408064842224121  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3408064842224121  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.35480833053588867  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.35480833053588867  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3569517135620117  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12239, 47])
h_self size  torch.Size([12239, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3569517135620117  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12239, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.35909509658813477  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3569517135620117  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12239, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.09597587585449219  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.15953588485717773  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.15963029861450195  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 170617
first layer output nodes number: 80420
edges number: 775798
----------------------------------------before model layer 0
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.07674598693847656  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([170617, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.07674598693847656  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.07674598693847656  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.11278533935546875  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.11278533935546875  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.18947982788085938  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([80420, 256])
h_self size  torch.Size([80420, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.18947982788085938  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([80420, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.26617431640625  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.18947982788085938  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([80420, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.26617431640625  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.28570556640625  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 80420
----------------output nodes number: 12654
----------------edges number: 298994
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.28639936447143555  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.28639936447143555  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3012218475341797  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3012218475341797  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3034377098083496  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12654, 47])
h_self size  torch.Size([12654, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3034377098083496  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12654, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.3064694404602051  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.30425357818603516  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12654, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2088623046875 GB
    Memory Allocated: 0.06643199920654297  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.19338655471801758  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.19347667694091797  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 340791
first layer output nodes number: 104075
edges number: 1013613
----------------------------------------before model layer 0
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.14411258697509766  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([340791, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.14411258697509766  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.14411258697509766  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.19082403182983398  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.19082403182983398  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.29007768630981445  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([104075, 256])
h_self size  torch.Size([104075, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.29007768630981445  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([104075, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3893313407897949  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.29007768630981445  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([104075, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3893313407897949  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.41414499282836914  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 104075
----------------output nodes number: 12040
----------------edges number: 292435
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.415010929107666  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.415010929107666  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.42964982986450195  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.42964982986450195  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.43219518661499023  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12040, 47])
h_self size  torch.Size([12040, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.43219518661499023  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12040, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.43430328369140625  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.43175792694091797  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12040, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.1297144889831543  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.25041866302490234  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.25051307678222656  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 324012
first layer output nodes number: 116356
edges number: 1119032
----------------------------------------before model layer 0
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13879632949829102  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([324012, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13879632949829102  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13879632949829102  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.19091463088989258  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.19091463088989258  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3018803596496582  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([116356, 256])
h_self size  torch.Size([116356, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3018803596496582  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([116356, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.41284608840942383  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3018803596496582  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([116356, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.41284608840942383  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.44058752059936523  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 116356
----------------output nodes number: 12644
----------------edges number: 304877
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.44154930114746094  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.44154930114746094  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45601749420166016  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45601749420166016  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45833301544189453  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12644, 47])
h_self size  torch.Size([12644, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45833301544189453  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12644, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.46054697036743164  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45823144912719727  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12644, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.12357425689697266  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.22002506256103516  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.22011756896972656  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 258908
first layer output nodes number: 95060
edges number: 908957
----------------------------------------before model layer 0
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.1112661361694336  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([258908, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.1112661361694336  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.1112661361694336  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.15380620956420898  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.15380620956420898  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.2444624900817871  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([95060, 256])
h_self size  torch.Size([95060, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.2444624900817871  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([95060, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.33511877059936523  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.2444624900817871  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([95060, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.33511877059936523  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.35778284072875977  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 95060
----------------output nodes number: 12379
----------------edges number: 298535
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.358583927154541  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.358583927154541  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.37317419052124023  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.37317419052124023  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.37534189224243164  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12379, 47])
h_self size  torch.Size([12379, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.37534189224243164  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12379, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.37750959396362305  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.37534189224243164  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12379, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.0992727279663086  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.20189428329467773  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.20198678970336914  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 275472
first layer output nodes number: 97594
edges number: 942199
----------------------------------------before model layer 0
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.11861753463745117  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([275472, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.11861753463745117  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.11861753463745117  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.16235828399658203  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.16235828399658203  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.2554311752319336  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([97594, 256])
h_self size  torch.Size([97594, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.2554311752319336  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([97594, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.34850406646728516  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.2554311752319336  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([97594, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.34850406646728516  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.37177228927612305  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 97594
----------------output nodes number: 12361
----------------edges number: 298985
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3725919723510742  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3725919723510742  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3877544403076172  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3877544403076172  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.39000606536865234  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12361, 47])
h_self size  torch.Size([12361, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.39000606536865234  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12361, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.39217042922973633  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.38991880416870117  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12361, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.10544013977050781  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.22332096099853516  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.22341537475585938  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 316433
first layer output nodes number: 115581
edges number: 1140748
----------------------------------------before model layer 0
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13475894927978516  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([316433, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13475894927978516  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13475894927978516  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.18674707412719727  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.18674707412719727  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.29697370529174805  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([115581, 256])
h_self size  torch.Size([115581, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.29697370529174805  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([115581, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.40720033645629883  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.29697370529174805  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([115581, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.40720033645629883  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4347572326660156  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 115581
----------------output nodes number: 12641
----------------edges number: 313781
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4357128143310547  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4357128143310547  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45032691955566406  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45032691955566406  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4533815383911133  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12641, 47])
h_self size  torch.Size([12641, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4533815383911133  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12641, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4555950164794922  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45254039764404297  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12641, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.12159156799316406  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.2419424057006836  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.2420330047607422  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 323064
first layer output nodes number: 116188
edges number: 1150107
----------------------------------------before model layer 0
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13813495635986328  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([323064, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13813495635986328  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13813495635986328  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.19042110443115234  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.19042110443115234  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3012266159057617  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([116188, 256])
h_self size  torch.Size([116188, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3012266159057617  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([116188, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4120321273803711  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3012266159057617  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([116188, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4120321273803711  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.43973350524902344  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 116188
----------------output nodes number: 12099
----------------edges number: 299857
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4406900405883789  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4406900405883789  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4552583694458008  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4552583694458008  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45765066146850586  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12099, 47])
h_self size  torch.Size([12099, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45765066146850586  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12099, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4601263999938965  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4577341079711914  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12099, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.12339544296264648  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.24445343017578125  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.24454736709594727  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 324962
first layer output nodes number: 115294
edges number: 1142771
----------------------------------------before model layer 0
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13870573043823242  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([324962, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13870573043823242  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.13870573043823242  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.19137954711914062  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.19137954711914062  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3013324737548828  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([115294, 256])
h_self size  torch.Size([115294, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3013324737548828  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([115294, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.411285400390625  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.3013324737548828  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([115294, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.411285400390625  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.43877363204956055  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 115294
----------------output nodes number: 12573
----------------edges number: 313151
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4397268295288086  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4397268295288086  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45494985580444336  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.45494985580444336  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4571514129638672  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12573, 47])
h_self size  torch.Size([12573, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4571514129638672  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12573, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.459352970123291  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.4571514129638672  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12573, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3377685546875 GB
    Memory Allocated: 0.12391519546508789  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4783935546875 GB
    Memory Allocated: 0.26342201232910156  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4783935546875 GB
    Memory Allocated: 0.26351213455200195  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

first layer input nodes number: 374485
first layer output nodes number: 123194
edges number: 1220500
----------------------------------------before model layer 0
 Nvidia-smi: 8.4783935546875 GB
    Memory Allocated: 0.15819215774536133  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([374485, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.4783935546875 GB
    Memory Allocated: 0.15819215774536133  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.4783935546875 GB
    Memory Allocated: 0.15819215774536133  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.4822998046875 GB
    Memory Allocated: 0.2136392593383789  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.4822998046875 GB
    Memory Allocated: 0.2136392593383789  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.4822998046875 GB
    Memory Allocated: 0.33112621307373047  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([123194, 256])
h_self size  torch.Size([123194, 100])
----------------------------------------before rst
 Nvidia-smi: 8.4822998046875 GB
    Memory Allocated: 0.33112621307373047  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([123194, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.44861316680908203  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.33112621307373047  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([123194, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.44861316680908203  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.4779849052429199  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------input nodes number: 123194
----------------output nodes number: 12069
----------------edges number: 300161
----------------------------------------before mean aggregator
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.47899293899536133  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.47899293899536133  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.4935903549194336  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.4935903549194336  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.4960060119628906  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

h_neigh size torch.Size([12069, 47])
h_self size  torch.Size([12069, 256])
----------------------------------------before rst
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.4960060119628906  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12069, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.4981193542480469  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6014404296875 GB
    Memory Allocated: 0.49570369720458984  GigaBytes
Max Memory Allocated: 0.6782855987548828  GigaBytes

torch.Size([12069, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.7264404296875 GB
    Memory Allocated: 0.14257431030273438  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.2910118103027344  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.29110097885131836  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

first layer input nodes number: 395946
first layer output nodes number: 109645
edges number: 1067181
----------------------------------------before model layer 0
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.16534996032714844  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([395946, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.16534996032714844  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.16534996032714844  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.21465635299682617  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.21465635299682617  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.31922197341918945  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

h_neigh size torch.Size([109645, 256])
h_self size  torch.Size([109645, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.31922197341918945  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([109645, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.42378759384155273  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.31922197341918945  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([109645, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.42378759384155273  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.44992923736572266  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------input nodes number: 109645
----------------output nodes number: 11929
----------------edges number: 285338
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.4508357048034668  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.4508357048034668  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.46568918228149414  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.46568918228149414  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.4678153991699219  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

h_neigh size torch.Size([11929, 47])
h_self size  torch.Size([11929, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.4678153991699219  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([11929, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.46990442276000977  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.46777820587158203  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([11929, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8748779296875 GB
    Memory Allocated: 0.151214599609375  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.293792724609375  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.293881893157959  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

first layer input nodes number: 380490
first layer output nodes number: 115361
edges number: 1130915
----------------------------------------before model layer 0
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.16049814224243164  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([380490, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.16049814224243164  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.16049814224243164  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.21233034133911133  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.21233034133911133  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.32234716415405273  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

h_neigh size torch.Size([115361, 256])
h_self size  torch.Size([115361, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.32234716415405273  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([115361, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.43236398696899414  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.32234716415405273  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([115361, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.43236398696899414  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4598684310913086  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------input nodes number: 115361
----------------output nodes number: 11939
----------------edges number: 287712
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4608173370361328  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4608173370361328  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4753694534301758  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4753694534301758  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.47751331329345703  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

h_neigh size torch.Size([11939, 47])
h_self size  torch.Size([11939, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.47751331329345703  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([11939, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.47960376739501953  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4774599075317383  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([11939, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.14537286758422852  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.2815999984741211  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.2816910743713379  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

first layer input nodes number: 365681
first layer output nodes number: 110555
edges number: 1084802
----------------------------------------before model layer 0
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.15319538116455078  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([365681, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.15319538116455078  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.15319538116455078  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.20287609100341797  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.20287609100341797  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.30830955505371094  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

h_neigh size torch.Size([110555, 256])
h_self size  torch.Size([110555, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.30830955505371094  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([110555, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4137430191040039  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.30830955505371094  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([110555, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4137430191040039  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.44010162353515625  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------input nodes number: 110555
----------------output nodes number: 12172
----------------edges number: 285297
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.44101667404174805  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.44101667404174805  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.45484209060668945  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.45484209060668945  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4569735527038574  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

h_neigh size torch.Size([12172, 47])
h_self size  torch.Size([12172, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4569735527038574  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([12172, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4591050148010254  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4569735527038574  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([12172, 47])
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.13901138305664062  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.28431272506713867  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.28440189361572266  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

first layer input nodes number: 390040
first layer output nodes number: 106607
edges number: 1048603
----------------------------------------before model layer 0
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.16255474090576172  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([390040, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.16255474090576172  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.16255474090576172  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.210479736328125  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.210479736328125  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.3121480941772461  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

h_neigh size torch.Size([106607, 256])
h_self size  torch.Size([106607, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.3121480941772461  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([106607, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4138164520263672  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.3121480941772461  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([106607, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4138164520263672  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.43923377990722656  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------input nodes number: 106607
----------------output nodes number: 11950
----------------edges number: 273669
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.44011735916137695  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.44011735916137695  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.45421695709228516  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.45421695709228516  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.45630931854248047  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

h_neigh size torch.Size([11950, 47])
h_self size  torch.Size([11950, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.45630931854248047  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([11950, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.4584016799926758  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.45630931854248047  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes

torch.Size([11950, 47])
-----------------------------------------after training 
 Nvidia-smi: 9.0174560546875 GB
    Memory Allocated: 0.1770496368408203  GigaBytes
Max Memory Allocated: 0.7199201583862305  GigaBytes


-----------------------------------------------------------------------------epoch done
