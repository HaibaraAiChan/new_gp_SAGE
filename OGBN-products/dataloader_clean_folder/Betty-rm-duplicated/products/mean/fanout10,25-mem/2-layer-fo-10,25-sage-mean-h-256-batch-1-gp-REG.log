main start at this time 1661474597.7657268
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 0.6819210052490234  GigaBytes
Max Memory Allocated: 0.6819210052490234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.6833858489990234  GigaBytes
Max Memory Allocated: 0.6833858489990234  GigaBytes

first layer input nodes number: 1829322
first layer output nodes number: 1205785
edges number: 11702596
----------------------------------------before model layer 0
 Nvidia-smi: 8.0311279296875 GB
    Memory Allocated: 0.8290467262268066  GigaBytes
Max Memory Allocated: 0.8726425170898438  GigaBytes

torch.Size([1829322, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0311279296875 GB
    Memory Allocated: 0.8290467262268066  GigaBytes
Max Memory Allocated: 0.8726425170898438  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0311279296875 GB
    Memory Allocated: 0.8290467262268066  GigaBytes
Max Memory Allocated: 0.8726425170898438  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.9373779296875 GB
    Memory Allocated: 1.3699493408203125  GigaBytes
Max Memory Allocated: 1.8236603736877441  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.9373779296875 GB
    Memory Allocated: 1.3699493408203125  GigaBytes
Max Memory Allocated: 1.8236603736877441  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 2.5203399658203125  GigaBytes
Max Memory Allocated: 2.5203399658203125  GigaBytes

h_neigh size torch.Size([1205785, 256])
h_self size  torch.Size([1205785, 100])
----------------------------------------before rst
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 2.5203399658203125  GigaBytes
Max Memory Allocated: 2.5203399658203125  GigaBytes

torch.Size([1205785, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 3.6707305908203125  GigaBytes
Max Memory Allocated: 4.8211212158203125  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 2.5203399658203125  GigaBytes
Max Memory Allocated: 4.8211212158203125  GigaBytes

torch.Size([1205785, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 3.6707305908203125  GigaBytes
Max Memory Allocated: 4.8211212158203125  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 3.958212375640869  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------input nodes number: 1205785
----------------output nodes number: 196571
----------------edges number: 4763879
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 3.9689807891845703  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 3.9689807891845703  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.193848133087158  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.193848133087158  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.228265762329102  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 256])
----------------------------------------before rst
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.228265762329102  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.262683391571045  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.228265762329102  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

torch.Size([196571, 47])
-----------------------------------------after training 
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 1.0434150695800781  GigaBytes
Max Memory Allocated: 6.380927085876465  GigaBytes


-----------------------------------------------------------------------------epoch done
