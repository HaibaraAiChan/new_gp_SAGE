main start at this time 1660936267.1878088
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2596931457519531
global_2_local spend time (sec) 0.37364888191223145

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.005 seconds
Metis partitioning: 12.668 seconds
Split the graph: 1.227 seconds
Construct subgraphs: 0.355 seconds
12635
12397
12654
12561
12479
12608
12038
11927
12017
12031
12628
12604
11949
12122
11928
11993
REG metis partition end ----................................
the time spent:  26.419745445251465
REG construction  time spent:  9.142730712890625
pure dgl.metis_partition the time spent:  17.27701473236084
total k batches seeds list generation spend  26.94913959503174
after graph partition
graph partition algorithm spend time 27.527026891708374

partition_len_list
[120206, 102501, 81708, 92586, 97732, 117471, 104661, 91797, 122727, 112307, 114854, 116486, 115959, 105227, 111880, 87241]
REG selection method  spend 28.087768077850342
check_connections_block*********************************
time for parepare 1: 0.22847509384155273
local_output_nid generation: 0.00466465950012207
local_in_edges_tensor generation: 0.0049321651458740234
mini_batch_src_global generation: 0.012158632278442383

&&&&&&&&&&&&&&& before remove duplicate length: 313501
&&&&&&&&&&&&&&& after remove duplicate length: 119279

r_  generation: 0.05100393295288086

local_output_nid generation: 0.004534482955932617
local_in_edges_tensor generation: 0.005387783050537109
mini_batch_src_global generation: 0.011886119842529297

&&&&&&&&&&&&&&& before remove duplicate length: 306184
&&&&&&&&&&&&&&& after remove duplicate length: 101890

r_  generation: 0.0482020378112793

local_output_nid generation: 0.0046656131744384766
local_in_edges_tensor generation: 0.004493236541748047
mini_batch_src_global generation: 0.008316278457641602

&&&&&&&&&&&&&&& before remove duplicate length: 298788
&&&&&&&&&&&&&&& after remove duplicate length: 80535

r_  generation: 0.03687858581542969

local_output_nid generation: 0.00469517707824707
local_in_edges_tensor generation: 0.0045773983001708984
mini_batch_src_global generation: 0.009058237075805664

&&&&&&&&&&&&&&& before remove duplicate length: 303852
&&&&&&&&&&&&&&& after remove duplicate length: 91603

r_  generation: 0.0467684268951416

local_output_nid generation: 0.00462794303894043
local_in_edges_tensor generation: 0.004536151885986328
mini_batch_src_global generation: 0.010193586349487305

&&&&&&&&&&&&&&& before remove duplicate length: 301056
&&&&&&&&&&&&&&& after remove duplicate length: 96926

r_  generation: 0.0501859188079834

local_output_nid generation: 0.004669904708862305
local_in_edges_tensor generation: 0.00453639030456543
mini_batch_src_global generation: 0.011504650115966797

&&&&&&&&&&&&&&& before remove duplicate length: 303801
&&&&&&&&&&&&&&& after remove duplicate length: 116278

r_  generation: 0.058603763580322266

local_output_nid generation: 0.0045070648193359375
local_in_edges_tensor generation: 0.0047266483306884766
mini_batch_src_global generation: 0.012300968170166016

&&&&&&&&&&&&&&& before remove duplicate length: 292289
&&&&&&&&&&&&&&& after remove duplicate length: 103401

r_  generation: 0.06611371040344238

local_output_nid generation: 0.004601716995239258
local_in_edges_tensor generation: 0.016957521438598633
mini_batch_src_global generation: 0.011564254760742188

&&&&&&&&&&&&&&& before remove duplicate length: 287256
&&&&&&&&&&&&&&& after remove duplicate length: 90943

r_  generation: 0.05058455467224121

local_output_nid generation: 0.004517316818237305
local_in_edges_tensor generation: 0.007684469223022461
mini_batch_src_global generation: 0.01114034652709961

&&&&&&&&&&&&&&& before remove duplicate length: 298835
&&&&&&&&&&&&&&& after remove duplicate length: 121442

r_  generation: 0.061479806900024414

local_output_nid generation: 0.004536628723144531
local_in_edges_tensor generation: 0.00517582893371582
mini_batch_src_global generation: 0.013811111450195312

&&&&&&&&&&&&&&& before remove duplicate length: 298426
&&&&&&&&&&&&&&& after remove duplicate length: 111125

r_  generation: 0.06001472473144531

local_output_nid generation: 0.0058095455169677734
local_in_edges_tensor generation: 0.004738807678222656
mini_batch_src_global generation: 0.0162200927734375

&&&&&&&&&&&&&&& before remove duplicate length: 313446
&&&&&&&&&&&&&&& after remove duplicate length: 114208

r_  generation: 0.06235218048095703

local_output_nid generation: 0.004770517349243164
local_in_edges_tensor generation: 0.004636526107788086
mini_batch_src_global generation: 0.012951374053955078

&&&&&&&&&&&&&&& before remove duplicate length: 313364
&&&&&&&&&&&&&&& after remove duplicate length: 115735

r_  generation: 0.06417131423950195

local_output_nid generation: 0.005709409713745117
local_in_edges_tensor generation: 0.004404306411743164
mini_batch_src_global generation: 0.012429237365722656

&&&&&&&&&&&&&&& before remove duplicate length: 287164
&&&&&&&&&&&&&&& after remove duplicate length: 114118

r_  generation: 0.06073188781738281

local_output_nid generation: 0.0045719146728515625
local_in_edges_tensor generation: 0.004658222198486328
mini_batch_src_global generation: 0.011772871017456055

&&&&&&&&&&&&&&& before remove duplicate length: 292883
&&&&&&&&&&&&&&& after remove duplicate length: 104193

r_  generation: 0.05722928047180176

local_output_nid generation: 0.004532814025878906
local_in_edges_tensor generation: 0.004439115524291992
mini_batch_src_global generation: 0.01128077507019043

&&&&&&&&&&&&&&& before remove duplicate length: 278668
&&&&&&&&&&&&&&& after remove duplicate length: 108827

r_  generation: 0.05606532096862793

local_output_nid generation: 0.00459742546081543
local_in_edges_tensor generation: 0.004355192184448242
mini_batch_src_global generation: 0.010782957077026367

&&&&&&&&&&&&&&& before remove duplicate length: 274366
&&&&&&&&&&&&&&& after remove duplicate length: 84078

r_  generation: 0.04250836372375488


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6742191314697266
gen group dst list time:  0.04801511764526367
check_connections_block*********************************
time for parepare 1: 0.361588716506958
local_output_nid generation: 0.02939581871032715
local_in_edges_tensor generation: 0.0816035270690918
mini_batch_src_global generation: 0.03508925437927246

&&&&&&&&&&&&&&& before remove duplicate length: 1191518
&&&&&&&&&&&&&&& after remove duplicate length: 321552

r_  generation: 0.21387887001037598

local_output_nid generation: 0.03133225440979004
local_in_edges_tensor generation: 0.03708338737487793
mini_batch_src_global generation: 0.028696775436401367

&&&&&&&&&&&&&&& before remove duplicate length: 1008150
&&&&&&&&&&&&&&& after remove duplicate length: 266222

r_  generation: 0.1936643123626709

local_output_nid generation: 0.023431777954101562
local_in_edges_tensor generation: 0.020811080932617188
mini_batch_src_global generation: 0.02226090431213379

&&&&&&&&&&&&&&& before remove duplicate length: 788762
&&&&&&&&&&&&&&& after remove duplicate length: 170782

r_  generation: 0.13474106788635254

local_output_nid generation: 0.02608513832092285
local_in_edges_tensor generation: 0.022289752960205078
mini_batch_src_global generation: 0.024190902709960938

&&&&&&&&&&&&&&& before remove duplicate length: 900567
&&&&&&&&&&&&&&& after remove duplicate length: 246083

r_  generation: 0.17792749404907227

local_output_nid generation: 0.028008699417114258
local_in_edges_tensor generation: 0.035096168518066406
mini_batch_src_global generation: 0.029115915298461914

&&&&&&&&&&&&&&& before remove duplicate length: 934913
&&&&&&&&&&&&&&& after remove duplicate length: 259659

r_  generation: 0.20174241065979004

local_output_nid generation: 0.0328519344329834
local_in_edges_tensor generation: 0.03145170211791992
mini_batch_src_global generation: 0.03959012031555176

&&&&&&&&&&&&&&& before remove duplicate length: 1130110
&&&&&&&&&&&&&&& after remove duplicate length: 315152

r_  generation: 0.24404168128967285

local_output_nid generation: 0.03161931037902832
local_in_edges_tensor generation: 0.027614593505859375
mini_batch_src_global generation: 0.035775184631347656

&&&&&&&&&&&&&&& before remove duplicate length: 1017919
&&&&&&&&&&&&&&& after remove duplicate length: 332634

r_  generation: 0.2564401626586914

local_output_nid generation: 0.027561664581298828
local_in_edges_tensor generation: 0.022843599319458008
mini_batch_src_global generation: 0.03149676322937012

&&&&&&&&&&&&&&& before remove duplicate length: 882497
&&&&&&&&&&&&&&& after remove duplicate length: 245058

r_  generation: 0.19725394248962402

local_output_nid generation: 0.03585624694824219
local_in_edges_tensor generation: 0.05464601516723633
mini_batch_src_global generation: 0.03979825973510742

&&&&&&&&&&&&&&& before remove duplicate length: 1215582
&&&&&&&&&&&&&&& after remove duplicate length: 359045

r_  generation: 0.3116598129272461

local_output_nid generation: 0.03218197822570801
local_in_edges_tensor generation: 0.03583812713623047
mini_batch_src_global generation: 0.04048323631286621

&&&&&&&&&&&&&&& before remove duplicate length: 1111603
&&&&&&&&&&&&&&& after remove duplicate length: 302473

r_  generation: 0.2468123435974121

local_output_nid generation: 0.0328218936920166
local_in_edges_tensor generation: 0.03149127960205078
mini_batch_src_global generation: 0.03954339027404785

&&&&&&&&&&&&&&& before remove duplicate length: 1133741
&&&&&&&&&&&&&&& after remove duplicate length: 302581

r_  generation: 0.24941778182983398

local_output_nid generation: 0.03224301338195801
local_in_edges_tensor generation: 0.030562162399291992
mini_batch_src_global generation: 0.03913402557373047

&&&&&&&&&&&&&&& before remove duplicate length: 1153066
&&&&&&&&&&&&&&& after remove duplicate length: 319167

r_  generation: 0.25776100158691406

local_output_nid generation: 0.03327202796936035
local_in_edges_tensor generation: 0.03278803825378418
mini_batch_src_global generation: 0.03942441940307617

&&&&&&&&&&&&&&& before remove duplicate length: 1136184
&&&&&&&&&&&&&&& after remove duplicate length: 383735

r_  generation: 0.31751346588134766

local_output_nid generation: 0.029315471649169922
local_in_edges_tensor generation: 0.027025222778320312
mini_batch_src_global generation: 0.038234710693359375

&&&&&&&&&&&&&&& before remove duplicate length: 1024334
&&&&&&&&&&&&&&& after remove duplicate length: 289495

r_  generation: 0.24097633361816406

local_output_nid generation: 0.03277397155761719
local_in_edges_tensor generation: 0.0285646915435791
mini_batch_src_global generation: 0.038786888122558594

&&&&&&&&&&&&&&& before remove duplicate length: 1099065
&&&&&&&&&&&&&&& after remove duplicate length: 369425

r_  generation: 0.30422401428222656

local_output_nid generation: 0.026638269424438477
local_in_edges_tensor generation: 0.023057222366333008
mini_batch_src_global generation: 0.03326296806335449

&&&&&&&&&&&&&&& before remove duplicate length: 856117
&&&&&&&&&&&&&&& after remove duplicate length: 281683

r_  generation: 0.22014117240905762


connection checking time:  14.205488204956055
block generation total time  12.983187913894653
pseudo mini batch 0 input nodes size: 334241
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2030029296875 GB
    Memory Allocated: 0.12528038024902344  GigaBytes
Max Memory Allocated: 0.12528038024902344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2030029296875 GB
    Memory Allocated: 0.12537479400634766  GigaBytes
Max Memory Allocated: 0.12537479400634766  GigaBytes

first layer input nodes number: 334241
first layer output nodes number: 120206
edges number: 1191518
----------------------------------------before model layer 0
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 0.13997554779052734  GigaBytes
Max Memory Allocated: 0.14441442489624023  GigaBytes

torch.Size([334241, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 0.13997554779052734  GigaBytes
Max Memory Allocated: 0.14441442489624023  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 0.13997554779052734  GigaBytes
Max Memory Allocated: 0.14441442489624023  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6365966796875 GB
    Memory Allocated: 0.19422340393066406  GigaBytes
Max Memory Allocated: 0.239593505859375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6365966796875 GB
    Memory Allocated: 0.19422340393066406  GigaBytes
Max Memory Allocated: 0.239593505859375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.30945777893066406  GigaBytes
Max Memory Allocated: 0.30945777893066406  GigaBytes

h_neigh size torch.Size([120206, 256])
h_self size  torch.Size([120206, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.30945777893066406  GigaBytes
Max Memory Allocated: 0.30945777893066406  GigaBytes

torch.Size([120206, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.42469215393066406  GigaBytes
Max Memory Allocated: 0.5399265289306641  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.30945777893066406  GigaBytes
Max Memory Allocated: 0.5399265289306641  GigaBytes

torch.Size([120206, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.42469215393066406  GigaBytes
Max Memory Allocated: 0.5399265289306641  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4533514976501465  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------input nodes number: 120206
----------------output nodes number: 12635
----------------edges number: 313501
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4543418884277344  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4543418884277344  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4690418243408203  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4690418243408203  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4712543487548828  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

h_neigh size torch.Size([12635, 47])
h_self size  torch.Size([12635, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4712543487548828  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

torch.Size([12635, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4734668731689453  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4712543487548828  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

torch.Size([12635, 47])
pseudo mini batch 1 input nodes size: 277455
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.12786865234375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.23122882843017578  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2313213348388672  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 277455
first layer output nodes number: 102501
edges number: 1008150
----------------------------------------before model layer 0
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11922454833984375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([277455, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11922454833984375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11922454833984375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.16530323028564453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.16530323028564453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.26305580139160156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([102501, 256])
h_self size  torch.Size([102501, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.26305580139160156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([102501, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3608083724975586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.26305580139160156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([102501, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3608083724975586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38524675369262695  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 102501
----------------output nodes number: 12397
----------------edges number: 306184
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38610315322875977  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38610315322875977  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4003129005432129  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4003129005432129  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4024839401245117  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12397, 47])
h_self size  torch.Size([12397, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4024839401245117  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12397, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.404879093170166  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4027080535888672  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12397, 47])
pseudo mini batch 2 input nodes size: 177678
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.1061854362487793  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.17237567901611328  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.1724700927734375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 177678
first layer output nodes number: 81708
edges number: 788762
----------------------------------------before model layer 0
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.07956886291503906  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([177678, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.07956886291503906  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.07956886291503906  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11618995666503906  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11618995666503906  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19411277770996094  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([81708, 256])
h_self size  torch.Size([81708, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19411277770996094  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([81708, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2720355987548828  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19411277770996094  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([81708, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2720355987548828  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2915668487548828  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 81708
----------------output nodes number: 12654
----------------edges number: 298788
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2922701835632324  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2922701835632324  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.30838775634765625  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.30838775634765625  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3108029365539551  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12654, 47])
h_self size  torch.Size([12654, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3108029365539551  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12654, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.313018798828125  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.31060361862182617  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12654, 47])
pseudo mini batch 3 input nodes size: 256513
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.0690622329711914  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.16462087631225586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.16471481323242188  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 256513
first layer output nodes number: 92586
edges number: 900567
----------------------------------------before model layer 0
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11089515686035156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([256513, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11089515686035156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11089515686035156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.15244150161743164  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.15244150161743164  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2407383918762207  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([92586, 256])
h_self size  torch.Size([92586, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2407383918762207  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([92586, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.32903528213500977  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2407383918762207  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([92586, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.32903528213500977  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.35110950469970703  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 92586
----------------output nodes number: 12561
----------------edges number: 303852
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.35189342498779297  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.35189342498779297  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36623096466064453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36623096466064453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36843061447143555  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12561, 47])
h_self size  torch.Size([12561, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36843061447143555  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12561, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.37063026428222656  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36843061447143555  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12561, 47])
pseudo mini batch 4 input nodes size: 271058
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.09841394424438477  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19939136505126953  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19948434829711914  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 271058
first layer output nodes number: 97732
edges number: 934913
----------------------------------------before model layer 0
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11621809005737305  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([271058, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11621809005737305  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11621809005737305  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.1599574089050293  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.1599574089050293  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2531619071960449  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([97732, 256])
h_self size  torch.Size([97732, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2531619071960449  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([97732, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.34636640548706055  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2531619071960449  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([97732, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.34636640548706055  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36966753005981445  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 97732
----------------output nodes number: 12479
----------------edges number: 301056
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.37048912048339844  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.37048912048339844  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38535547256469727  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38535547256469727  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3875460624694824  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12479, 47])
h_self size  torch.Size([12479, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3875460624694824  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12479, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38973140716552734  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3875408172607422  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12479, 47])
pseudo mini batch 5 input nodes size: 327912
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.10382270812988281  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.22597980499267578  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2260737419128418  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 327912
first layer output nodes number: 117471
edges number: 1130110
----------------------------------------before model layer 0
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.13977527618408203  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([327912, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.13977527618408203  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.13977527618408203  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19276094436645508  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19276094436645508  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.30479001998901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([117471, 256])
h_self size  torch.Size([117471, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.30479001998901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([117471, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.41681909561157227  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.30479001998901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([117471, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.41681909561157227  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.444826602935791  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 117471
----------------output nodes number: 12608
----------------edges number: 303801
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.44579601287841797  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.44579601287841797  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4607853889465332  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4607853889465332  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.46299314498901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12608, 47])
h_self size  torch.Size([12608, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.46299314498901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12608, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.46520090103149414  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.46299314498901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12608, 47])
pseudo mini batch 6 input nodes size: 349139
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.12502050399780273  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.25587987899780273  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.2559700012207031  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 349139
first layer output nodes number: 104661
edges number: 1017919
----------------------------------------before model layer 0
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.14686346054077148  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([349139, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.14686346054077148  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.14686346054077148  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.19382762908935547  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.19382762908935547  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.29364013671875  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([104661, 256])
h_self size  torch.Size([104661, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.29364013671875  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([104661, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.39345264434814453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.29364013671875  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([104661, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.39345264434814453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.41840600967407227  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 104661
----------------output nodes number: 12038
----------------edges number: 292289
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.41927623748779297  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.41927623748779297  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4330253601074219  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4330253601074219  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4351654052734375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12038, 47])
h_self size  torch.Size([12038, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4351654052734375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12038, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4372735023498535  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4351334571838379  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12038, 47])
pseudo mini batch 7 input nodes size: 256143
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.1336512565612793  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.22907209396362305  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.22916126251220703  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 256143
first layer output nodes number: 91797
edges number: 882497
----------------------------------------before model layer 0
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.10952138900756836  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([256143, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.10952138900756836  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.10952138900756836  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.1506366729736328  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.1506366729736328  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.23818111419677734  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([91797, 256])
h_self size  torch.Size([91797, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.23818111419677734  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([91797, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3257255554199219  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.23818111419677734  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([91797, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3257255554199219  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3476119041442871  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 91797
----------------output nodes number: 11927
----------------edges number: 287256
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3483853340148926  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3483853340148926  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.36338043212890625  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.36338043212890625  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.36546897888183594  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.36546897888183594  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3675575256347656  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.36546897888183594  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 8 input nodes size: 374249
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.0981602668762207  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4881591796875 GB
    Memory Allocated: 0.237579345703125  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4881591796875 GB
    Memory Allocated: 0.2376689910888672  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 374249
first layer output nodes number: 122727
edges number: 1215582
----------------------------------------before model layer 0
 Nvidia-smi: 8.4881591796875 GB
    Memory Allocated: 0.15723848342895508  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([374249, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.4881591796875 GB
    Memory Allocated: 0.15723848342895508  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.4881591796875 GB
    Memory Allocated: 0.15723848342895508  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.21247243881225586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.21247243881225586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.3295140266418457  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([122727, 256])
h_self size  torch.Size([122727, 100])
----------------------------------------before rst
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.3295140266418457  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([122727, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4467015266418457  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.32965993881225586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([122727, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4467015266418457  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.47596216201782227  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 122727
----------------output nodes number: 12017
----------------edges number: 298835
----------------------------------------before mean aggregator
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.47696638107299805  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.47696638107299805  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4910469055175781  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4910469055175781  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4936485290527344  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12017, 47])
h_self size  torch.Size([12017, 256])
----------------------------------------before rst
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4936485290527344  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12017, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.49575281143188477  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4931511878967285  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12017, 47])
pseudo mini batch 9 input nodes size: 315330
----------------------------------------before batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.14267206192016602  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.26014184951782227  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.26023149490356445  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 315330
first layer output nodes number: 112307
edges number: 1111603
----------------------------------------before model layer 0
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1344161033630371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([315330, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1344161033630371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1344161033630371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.18495512008666992  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.18495512008666992  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29205942153930664  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([112307, 256])
h_self size  torch.Size([112307, 100])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29205942153930664  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([112307, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.39916372299194336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29205942153930664  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([112307, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.39916372299194336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.42594003677368164  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 112307
----------------output nodes number: 12031
----------------edges number: 298426
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4268665313720703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4268665313720703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.440706729888916  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.440706729888916  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4428133964538574  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12031, 47])
h_self size  torch.Size([12031, 256])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4428133964538574  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12031, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.44492006301879883  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4428133964538574  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12031, 47])
pseudo mini batch 10 input nodes size: 315674
----------------------------------------before batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.12022781372070312  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.23782587051391602  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.23792028427124023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 315674
first layer output nodes number: 114854
edges number: 1133741
----------------------------------------before model layer 0
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.13466739654541016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([315674, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.13466739654541016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.13466739654541016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.18632984161376953  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.18632984161376953  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29586315155029297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([114854, 256])
h_self size  torch.Size([114854, 100])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29586315155029297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([114854, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4053964614868164  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29586315155029297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([114854, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4053964614868164  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.43277978897094727  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 114854
----------------output nodes number: 12628
----------------edges number: 313446
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4337301254272461  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4337301254272461  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4491705894470215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4491705894470215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4513816833496094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12628, 47])
h_self size  torch.Size([12628, 256])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4513816833496094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12628, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.45359277725219727  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4513816833496094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12628, 47])
pseudo mini batch 11 input nodes size: 332416
----------------------------------------before batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.12046527862548828  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.24429988861083984  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.24439382553100586  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 332416
first layer output nodes number: 116486
edges number: 1153066
----------------------------------------before model layer 0
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1410846710205078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([332416, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1410846710205078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1410846710205078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.19350528717041016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.19350528717041016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.3052496910095215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([116486, 256])
h_self size  torch.Size([116486, 100])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.3052496910095215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([116486, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4163393974304199  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.3045949935913086  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([116486, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4163393974304199  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.44345712661743164  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 116486
----------------output nodes number: 12604
----------------edges number: 313364
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.44441938400268555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.44441938400268555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4592289924621582  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4592289924621582  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.46143627166748047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12604, 47])
h_self size  torch.Size([12604, 256])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.46143627166748047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12604, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.46364355087280273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.46143627166748047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12604, 47])
pseudo mini batch 12 input nodes size: 403887
----------------------------------------before batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.12669754028320312  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2771573066711426  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27724647521972656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 403887
first layer output nodes number: 115959
edges number: 1136184
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1694784164428711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([403887, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1694784164428711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1694784164428711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2215743064880371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2215743064880371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.33266401290893555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([115959, 256])
h_self size  torch.Size([115959, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.33266401290893555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([115959, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4432511329650879  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.33216142654418945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([115959, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4432511329650879  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.470395565032959  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 115959
----------------output nodes number: 11949
----------------edges number: 287164
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47134876251220703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47134876251220703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4856276512145996  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4856276512145996  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4877200126647949  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11949, 47])
h_self size  torch.Size([11949, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4877200126647949  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11949, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.48981237411499023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4877200126647949  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11949, 47])
pseudo mini batch 13 input nodes size: 305133
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15366554260253906  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2673368453979492  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2674274444580078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 305133
first layer output nodes number: 105227
edges number: 1024334
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13022327423095703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([305133, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13022327423095703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13022327423095703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.17789888381958008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.17789888381958008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27825117111206055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([105227, 256])
h_self size  torch.Size([105227, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27825117111206055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([105227, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.378603458404541  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27825117111206055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([105227, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.378603458404541  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40369176864624023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 105227
----------------output nodes number: 12122
----------------edges number: 292883
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40456676483154297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40456676483154297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41840076446533203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41840076446533203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42052364349365234  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12122, 47])
h_self size  torch.Size([12122, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42052364349365234  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12122, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42311859130859375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42099571228027344  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12122, 47])
pseudo mini batch 14 input nodes size: 387183
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11644649505615234  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.260683536529541  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.260772705078125  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 387183
first layer output nodes number: 111880
edges number: 1099065
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1615138053894043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([387183, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1615138053894043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1615138053894043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21179914474487305  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21179914474487305  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3184962272644043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([111880, 256])
h_self size  torch.Size([111880, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3184962272644043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([111880, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42519330978393555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3184962272644043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([111880, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42519330978393555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45186758041381836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 111880
----------------output nodes number: 11928
----------------edges number: 278668
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4527907371520996  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4527907371520996  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46642160415649414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46642160415649414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4686260223388672  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11928, 47])
h_self size  torch.Size([11928, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4686260223388672  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11928, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4707145690917969  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46851015090942383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11928, 47])
pseudo mini batch 15 input nodes size: 296590
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14709234237670898  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2575807571411133  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.25767040252685547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 296590
first layer output nodes number: 87241
edges number: 856117
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12516260147094727  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([296590, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12516260147094727  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12516260147094727  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1643671989440918  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1643671989440918  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24756669998168945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([87241, 256])
h_self size  torch.Size([87241, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24756669998168945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([87241, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3307662010192871  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24756669998168945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([87241, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3307662010192871  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3515663146972656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 87241
----------------output nodes number: 11993
----------------edges number: 274366
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3523063659667969  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3523063659667969  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3658781051635742  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3658781051635742  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3679780960083008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11993, 47])
h_self size  torch.Size([11993, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3679780960083008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11993, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.37007808685302734  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3679780960083008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11993, 47])
Number of nodes for computation during this epoch:  6675944
Number of first layer input nodes during this epoch:  4980601
Number of first layer output nodes during this epoch:  1695343

-----------------------------------------------------------------------------epoch done
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2590060234069824
global_2_local spend time (sec) 0.39252352714538574

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.418 seconds
Metis partitioning: 12.867 seconds
Split the graph: 1.241 seconds
Construct subgraphs: 0.385 seconds
12563
12548
11927
12553
12001
12540
11934
12529
11950
12364
12165
12028
12060
12600
12247
12562
REG metis partition end ----................................
the time spent:  27.23469591140747
REG construction  time spent:  9.303303241729736
pure dgl.metis_partition the time spent:  17.931392669677734
total k batches seeds list generation spend  27.762532711029053
after graph partition
graph partition algorithm spend time 28.337105989456177

partition_len_list
[115090, 103742, 89191, 80853, 99799, 98935, 92574, 114324, 117312, 86450, 105855, 105688, 121757, 116583, 114520, 125176]
REG selection method  spend 28.909645795822144
check_connections_block*********************************
time for parepare 1: 0.21465635299682617
local_output_nid generation: 0.004027605056762695
local_in_edges_tensor generation: 0.00468754768371582
mini_batch_src_global generation: 0.010225296020507812

&&&&&&&&&&&&&&& before remove duplicate length: 312317
&&&&&&&&&&&&&&& after remove duplicate length: 114295

r_  generation: 0.04792666435241699

local_output_nid generation: 0.0047588348388671875
local_in_edges_tensor generation: 0.004395723342895508
mini_batch_src_global generation: 0.009859323501586914

&&&&&&&&&&&&&&& before remove duplicate length: 310241
&&&&&&&&&&&&&&& after remove duplicate length: 103084

r_  generation: 0.04915595054626465

local_output_nid generation: 0.004598855972290039
local_in_edges_tensor generation: 0.004170417785644531
mini_batch_src_global generation: 0.006440401077270508

&&&&&&&&&&&&&&& before remove duplicate length: 287288
&&&&&&&&&&&&&&& after remove duplicate length: 88167

r_  generation: 0.044310808181762695

local_output_nid generation: 0.0047969818115234375
local_in_edges_tensor generation: 0.004339933395385742
mini_batch_src_global generation: 0.007184267044067383

&&&&&&&&&&&&&&& before remove duplicate length: 296676
&&&&&&&&&&&&&&& after remove duplicate length: 79745

r_  generation: 0.0379483699798584

local_output_nid generation: 0.0046384334564208984
local_in_edges_tensor generation: 0.004297494888305664
mini_batch_src_global generation: 0.007975101470947266

&&&&&&&&&&&&&&& before remove duplicate length: 291963
&&&&&&&&&&&&&&& after remove duplicate length: 98877

r_  generation: 0.04983997344970703

local_output_nid generation: 0.004785060882568359
local_in_edges_tensor generation: 0.004331111907958984
mini_batch_src_global generation: 0.008868217468261719

&&&&&&&&&&&&&&& before remove duplicate length: 301258
&&&&&&&&&&&&&&& after remove duplicate length: 98185

r_  generation: 0.05421042442321777

local_output_nid generation: 0.004738807678222656
local_in_edges_tensor generation: 0.005117177963256836
mini_batch_src_global generation: 0.00967264175415039

&&&&&&&&&&&&&&& before remove duplicate length: 287401
&&&&&&&&&&&&&&& after remove duplicate length: 91683

r_  generation: 0.04899168014526367

local_output_nid generation: 0.0048253536224365234
local_in_edges_tensor generation: 0.004312753677368164
mini_batch_src_global generation: 0.009036540985107422

&&&&&&&&&&&&&&& before remove duplicate length: 302514
&&&&&&&&&&&&&&& after remove duplicate length: 113256

r_  generation: 0.05839657783508301

local_output_nid generation: 0.004661083221435547
local_in_edges_tensor generation: 0.01020669937133789
mini_batch_src_global generation: 0.009393453598022461

&&&&&&&&&&&&&&& before remove duplicate length: 291329
&&&&&&&&&&&&&&& after remove duplicate length: 115303

r_  generation: 0.06113839149475098

local_output_nid generation: 0.004828214645385742
local_in_edges_tensor generation: 0.006293058395385742
mini_batch_src_global generation: 0.009790182113647461

&&&&&&&&&&&&&&& before remove duplicate length: 292335
&&&&&&&&&&&&&&& after remove duplicate length: 85599

r_  generation: 0.04497051239013672

local_output_nid generation: 0.0047266483306884766
local_in_edges_tensor generation: 0.0045032501220703125
mini_batch_src_global generation: 0.008585453033447266

&&&&&&&&&&&&&&& before remove duplicate length: 273356
&&&&&&&&&&&&&&& after remove duplicate length: 102630

r_  generation: 0.05296444892883301

local_output_nid generation: 0.004714488983154297
local_in_edges_tensor generation: 0.004262208938598633
mini_batch_src_global generation: 0.00964045524597168

&&&&&&&&&&&&&&& before remove duplicate length: 286996
&&&&&&&&&&&&&&& after remove duplicate length: 102899

r_  generation: 0.054375410079956055

local_output_nid generation: 0.004669666290283203
local_in_edges_tensor generation: 0.0048067569732666016
mini_batch_src_global generation: 0.00978851318359375

&&&&&&&&&&&&&&& before remove duplicate length: 299858
&&&&&&&&&&&&&&& after remove duplicate length: 120489

r_  generation: 0.06232190132141113

local_output_nid generation: 0.0048694610595703125
local_in_edges_tensor generation: 0.004420280456542969
mini_batch_src_global generation: 0.010517597198486328

&&&&&&&&&&&&&&& before remove duplicate length: 313779
&&&&&&&&&&&&&&& after remove duplicate length: 115896

r_  generation: 0.0629892349243164

local_output_nid generation: 0.0047228336334228516
local_in_edges_tensor generation: 0.0042858123779296875
mini_batch_src_global generation: 0.010313749313354492

&&&&&&&&&&&&&&& before remove duplicate length: 304205
&&&&&&&&&&&&&&& after remove duplicate length: 113454

r_  generation: 0.06244087219238281

local_output_nid generation: 0.0048940181732177734
local_in_edges_tensor generation: 0.004457712173461914
mini_batch_src_global generation: 0.010322093963623047

&&&&&&&&&&&&&&& before remove duplicate length: 312363
&&&&&&&&&&&&&&& after remove duplicate length: 124358

r_  generation: 0.06912064552307129


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7157602310180664
gen group dst list time:  0.047324180603027344
check_connections_block*********************************
time for parepare 1: 0.3803071975708008
local_output_nid generation: 0.0286099910736084
local_in_edges_tensor generation: 0.07716560363769531
mini_batch_src_global generation: 0.03342270851135254

&&&&&&&&&&&&&&& before remove duplicate length: 1141248
&&&&&&&&&&&&&&& after remove duplicate length: 304954

r_  generation: 0.21878910064697266

local_output_nid generation: 0.032878875732421875
local_in_edges_tensor generation: 0.03477883338928223
mini_batch_src_global generation: 0.029310226440429688

&&&&&&&&&&&&&&& before remove duplicate length: 1020472
&&&&&&&&&&&&&&& after remove duplicate length: 269998

r_  generation: 0.19962239265441895

local_output_nid generation: 0.02696394920349121
local_in_edges_tensor generation: 0.02702808380126953
mini_batch_src_global generation: 0.023926258087158203

&&&&&&&&&&&&&&& before remove duplicate length: 867348
&&&&&&&&&&&&&&& after remove duplicate length: 240503

r_  generation: 0.18210816383361816

local_output_nid generation: 0.02277517318725586
local_in_edges_tensor generation: 0.01813483238220215
mini_batch_src_global generation: 0.022530078887939453

&&&&&&&&&&&&&&& before remove duplicate length: 779725
&&&&&&&&&&&&&&& after remove duplicate length: 172164

r_  generation: 0.135939359664917

local_output_nid generation: 0.029505014419555664
local_in_edges_tensor generation: 0.028229236602783203
mini_batch_src_global generation: 0.028652191162109375

&&&&&&&&&&&&&&& before remove duplicate length: 970098
&&&&&&&&&&&&&&& after remove duplicate length: 289223

r_  generation: 0.21350622177124023

local_output_nid generation: 0.029122591018676758
local_in_edges_tensor generation: 0.03206014633178711
mini_batch_src_global generation: 0.03250551223754883

&&&&&&&&&&&&&&& before remove duplicate length: 946393
&&&&&&&&&&&&&&& after remove duplicate length: 245842

r_  generation: 0.20550322532653809

local_output_nid generation: 0.028627395629882812
local_in_edges_tensor generation: 0.031017303466796875
mini_batch_src_global generation: 0.03196382522583008

&&&&&&&&&&&&&&& before remove duplicate length: 889740
&&&&&&&&&&&&&&& after remove duplicate length: 255697

r_  generation: 0.1984703540802002

local_output_nid generation: 0.03343319892883301
local_in_edges_tensor generation: 0.03452801704406738
mini_batch_src_global generation: 0.03941774368286133

&&&&&&&&&&&&&&& before remove duplicate length: 1101363
&&&&&&&&&&&&&&& after remove duplicate length: 342514

r_  generation: 0.2697176933288574

local_output_nid generation: 0.03489422798156738
local_in_edges_tensor generation: 0.036588191986083984
mini_batch_src_global generation: 0.04409599304199219

&&&&&&&&&&&&&&& before remove duplicate length: 1152987
&&&&&&&&&&&&&&& after remove duplicate length: 381008

r_  generation: 0.3151552677154541

local_output_nid generation: 0.024212121963500977
local_in_edges_tensor generation: 0.019400358200073242
mini_batch_src_global generation: 0.03134560585021973

&&&&&&&&&&&&&&& before remove duplicate length: 828476
&&&&&&&&&&&&&&& after remove duplicate length: 220675

r_  generation: 0.1867825984954834

local_output_nid generation: 0.030194759368896484
local_in_edges_tensor generation: 0.028111934661865234
mini_batch_src_global generation: 0.03373146057128906

&&&&&&&&&&&&&&& before remove duplicate length: 1036152
&&&&&&&&&&&&&&& after remove duplicate length: 334013

r_  generation: 0.25482892990112305

local_output_nid generation: 0.031891584396362305
local_in_edges_tensor generation: 0.04092597961425781
mini_batch_src_global generation: 0.03721928596496582

&&&&&&&&&&&&&&& before remove duplicate length: 1044222
&&&&&&&&&&&&&&& after remove duplicate length: 344559

r_  generation: 0.27478957176208496

local_output_nid generation: 0.03673362731933594
local_in_edges_tensor generation: 0.0665128231048584
mini_batch_src_global generation: 0.04311704635620117

&&&&&&&&&&&&&&& before remove duplicate length: 1205952
&&&&&&&&&&&&&&& after remove duplicate length: 356299

r_  generation: 0.31506991386413574

local_output_nid generation: 0.03372454643249512
local_in_edges_tensor generation: 0.03882241249084473
mini_batch_src_global generation: 0.044425010681152344

&&&&&&&&&&&&&&& before remove duplicate length: 1156244
&&&&&&&&&&&&&&& after remove duplicate length: 310458

r_  generation: 0.26804423332214355

local_output_nid generation: 0.0333707332611084
local_in_edges_tensor generation: 0.029928922653198242
mini_batch_src_global generation: 0.039775848388671875

&&&&&&&&&&&&&&& before remove duplicate length: 1133654
&&&&&&&&&&&&&&& after remove duplicate length: 302642

r_  generation: 0.2534162998199463

local_output_nid generation: 0.03653144836425781
local_in_edges_tensor generation: 0.05956435203552246
mini_batch_src_global generation: 0.04513812065124512

&&&&&&&&&&&&&&& before remove duplicate length: 1238595
&&&&&&&&&&&&&&& after remove duplicate length: 330540

r_  generation: 0.28627443313598633


connection checking time:  14.205642223358154
block generation total time  12.307901620864868
pseudo mini batch 0 input nodes size: 317018
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1137995719909668  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.23189830780029297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.23199224472045898  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 317018
first layer output nodes number: 115090
edges number: 1141248
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1357870101928711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([317018, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1357870101928711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1357870101928711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18759393692016602  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18759393692016602  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29735231399536133  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([115090, 256])
h_self size  torch.Size([115090, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29735231399536133  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([115090, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40711069107055664  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29735231399536133  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([115090, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40711069107055664  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.43455028533935547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 115090
----------------output nodes number: 12563
----------------edges number: 312317
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4355020523071289  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4355020523071289  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4507880210876465  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4507880210876465  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45331335067749023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12563, 47])
h_self size  torch.Size([12563, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45331335067749023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12563, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45551300048828125  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4529876708984375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12563, 47])
pseudo mini batch 1 input nodes size: 281316
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1218404769897461  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2266392707824707  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22673320770263672  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 281316
first layer output nodes number: 103742
edges number: 1020472
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12184524536132812  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([281316, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12184524536132812  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12184524536132812  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1690053939819336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1690053939819336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2679414749145508  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([103742, 256])
h_self size  torch.Size([103742, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2679414749145508  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([103742, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36687755584716797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2679414749145508  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([103742, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36687755584716797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.39161157608032227  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 103742
----------------output nodes number: 12548
----------------edges number: 310241
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.39247846603393555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.39247846603393555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4074826240539551  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4074826240539551  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4096798896789551  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12548, 47])
h_self size  torch.Size([12548, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4096798896789551  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12548, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4118771553039551  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4096798896789551  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12548, 47])
pseudo mini batch 2 input nodes size: 250727
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10821247100830078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2016158103942871  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2017049789428711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 250727
first layer output nodes number: 89191
edges number: 867348
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.108795166015625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([250727, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.108795166015625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.108795166015625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1488170623779297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1488170623779297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.23387622833251953  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([89191, 256])
h_self size  torch.Size([89191, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.23387622833251953  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([89191, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3189353942871094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.23387622833251953  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([89191, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3189353942871094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.34076642990112305  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 89191
----------------output nodes number: 11927
----------------edges number: 287288
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3415203094482422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3415203094482422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.35608959197998047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.35608959197998047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.35817813873291016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.35817813873291016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36060667037963867  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.358518123626709  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 3 input nodes size: 179084
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.09670352935791016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.16341781616210938  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1635117530822754  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 179084
first layer output nodes number: 80853
edges number: 779725
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.08048391342163086  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([179084, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.08048391342163086  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.08048391342163086  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1167154312133789  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1167154312133789  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.19382286071777344  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([80853, 256])
h_self size  torch.Size([80853, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.19382286071777344  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([80853, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27093029022216797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.19382286071777344  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([80853, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27093029022216797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29046154022216797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 80853
----------------output nodes number: 12553
----------------edges number: 296676
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29115819931030273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29115819931030273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30610036849975586  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30610036849975586  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30829858779907227  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12553, 47])
h_self size  torch.Size([12553, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30829858779907227  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12553, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3114619255065918  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3092637062072754  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12553, 47])
pseudo mini batch 4 input nodes size: 301351
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.0701289176940918  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18239116668701172  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1824808120727539  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 301351
first layer output nodes number: 99799
edges number: 970098
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1287250518798828  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([301351, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1287250518798828  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1287250518798828  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.17350292205810547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.17350292205810547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2686786651611328  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([99799, 256])
h_self size  torch.Size([99799, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2686786651611328  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([99799, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36385440826416016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2686786651611328  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([99799, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36385440826416016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3876485824584961  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 99799
----------------output nodes number: 12001
----------------edges number: 291963
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.38848209381103516  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.38848209381103516  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4033627510070801  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4033627510070801  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4063735008239746  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12001, 47])
h_self size  torch.Size([12001, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4063735008239746  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12001, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4084749221801758  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40546417236328125  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12001, 47])
pseudo mini batch 5 input nodes size: 255922
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1164851188659668  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2118239402770996  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21191740036010742  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 255922
first layer output nodes number: 98935
edges number: 946393
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11193323135375977  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([255922, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11193323135375977  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11193323135375977  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15620946884155273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15620946884155273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2505612373352051  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([98935, 256])
h_self size  torch.Size([98935, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2505612373352051  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([98935, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3449130058288574  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2505612373352051  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([98935, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3449130058288574  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3685011863708496  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 98935
----------------output nodes number: 12540
----------------edges number: 301258
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36933183670043945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36933183670043945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3838658332824707  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3838658332824707  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3860616683959961  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12540, 47])
h_self size  torch.Size([12540, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3860616683959961  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12540, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3882575035095215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3860616683959961  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12540, 47])
pseudo mini batch 6 input nodes size: 267716
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.09875059127807617  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.19848299026489258  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.19857215881347656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 267716
first layer output nodes number: 92574
edges number: 889740
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11459684371948242  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([267716, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11459684371948242  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11459684371948242  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15605878829956055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15605878829956055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24434423446655273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([92574, 256])
h_self size  torch.Size([92574, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24434423446655273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([92574, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3326296806335449  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24434423446655273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([92574, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3326296806335449  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.35470104217529297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 92574
----------------output nodes number: 11934
----------------edges number: 287401
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3554801940917969  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3554801940917969  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36919355392456055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36919355392456055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3714566230773926  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11934, 47])
h_self size  torch.Size([11934, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3714566230773926  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11934, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.37424421310424805  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.371981143951416  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11934, 47])
pseudo mini batch 7 input nodes size: 357619
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10303401947021484  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.23625755310058594  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.23635101318359375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 357619
first layer output nodes number: 114324
edges number: 1101363
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1516737937927246  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([357619, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1516737937927246  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1516737937927246  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2028956413269043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2028956413269043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3119235038757324  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([114324, 256])
h_self size  torch.Size([114324, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3119235038757324  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([114324, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42095136642456055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3119235038757324  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([114324, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42095136642456055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4482083320617676  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 114324
----------------output nodes number: 12529
----------------edges number: 302514
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4491539001464844  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4491539001464844  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4635286331176758  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4635286331176758  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46572256088256836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12529, 47])
h_self size  torch.Size([12529, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46572256088256836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12529, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46791648864746094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46572256088256836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12529, 47])
pseudo mini batch 8 input nodes size: 400905
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13663339614868164  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.285982608795166  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.28607177734375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 400905
first layer output nodes number: 117312
edges number: 1152987
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.16811132431030273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([400905, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.16811132431030273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.16811132431030273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2208414077758789  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2208414077758789  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3327188491821289  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([117312, 256])
h_self size  torch.Size([117312, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3327188491821289  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([117312, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4445962905883789  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3327188491821289  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([117312, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4445962905883789  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4725656509399414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 117312
----------------output nodes number: 11950
----------------edges number: 291329
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4735288619995117  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4735288619995117  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4881434440612793  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4881434440612793  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4904932975769043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11950, 47])
h_self size  torch.Size([11950, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4904932975769043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11950, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4925856590270996  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4902358055114746  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11950, 47])
pseudo mini batch 9 input nodes size: 234452
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15291070938110352  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2402510643005371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24034357070922852  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 234452
first layer output nodes number: 86450
edges number: 828476
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10164785385131836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([234452, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10164785385131836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10164785385131836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14071941375732422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14071941375732422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22316455841064453  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([86450, 256])
h_self size  torch.Size([86450, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22316455841064453  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([86450, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30560970306396484  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22316455841064453  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([86450, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30560970306396484  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3262209892272949  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 86450
----------------output nodes number: 12364
----------------edges number: 292335
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.32695770263671875  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.32695770263671875  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3410196304321289  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3410196304321289  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3431844711303711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12364, 47])
h_self size  torch.Size([12364, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3431844711303711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12364, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3453493118286133  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3431844711303711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12364, 47])
pseudo mini batch 10 input nodes size: 350097
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.09072017669677734  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22157955169677734  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22167062759399414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 350097
first layer output nodes number: 105855
edges number: 1036152
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14739227294921875  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([350097, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14739227294921875  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14739227294921875  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.19517230987548828  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.19517230987548828  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2961235046386719  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([105855, 256])
h_self size  torch.Size([105855, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2961235046386719  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([105855, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.39707469940185547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2961235046386719  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([105855, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.39707469940185547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42231273651123047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 105855
----------------output nodes number: 12165
----------------edges number: 273356
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42319250106811523  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42319250106811523  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4378838539123535  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4378838539123535  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4405655860900879  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12165, 47])
h_self size  torch.Size([12165, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4405655860900879  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12165, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44269561767578125  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4400138854980469  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12165, 47])
pseudo mini batch 11 input nodes size: 361447
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13475465774536133  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.26940441131591797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.26949405670166016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 361447
first layer output nodes number: 105688
edges number: 1044222
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15194368362426758  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([361447, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15194368362426758  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15194368362426758  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1995706558227539  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1995706558227539  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30036258697509766  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([105688, 256])
h_self size  torch.Size([105688, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30036258697509766  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([105688, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4011545181274414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30036258697509766  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([105688, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4011545181274414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42635250091552734  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 105688
----------------output nodes number: 12028
----------------edges number: 286996
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4272298812866211  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4272298812866211  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44133710861206055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44133710861206055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44344329833984375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12028, 47])
h_self size  torch.Size([12028, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44344329833984375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12028, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44554948806762695  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44344329833984375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12028, 47])
pseudo mini batch 12 input nodes size: 371112
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1379680633544922  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2762184143066406  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.276308536529541  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 371112
first layer output nodes number: 121757
edges number: 1205952
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1565699577331543  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([371112, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1565699577331543  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1565699577331543  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21136760711669922  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21136760711669922  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.327484130859375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([121757, 256])
h_self size  torch.Size([121757, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.327484130859375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([121757, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4436006546020508  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.327484130859375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([121757, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4436006546020508  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47263002395629883  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 121757
----------------output nodes number: 12060
----------------edges number: 299858
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47362756729125977  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47362756729125977  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4874539375305176  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4874539375305176  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4896106719970703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12060, 47])
h_self size  torch.Size([12060, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4896106719970703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12060, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.49172258377075195  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4895658493041992  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12060, 47])
pseudo mini batch 13 input nodes size: 322785
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14157485961914062  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2618217468261719  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2619156837463379  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 322785
first layer output nodes number: 116583
edges number: 1156244
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13868951797485352  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([322785, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13868951797485352  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13868951797485352  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.19117021560668945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.19117021560668945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3023524284362793  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([116583, 256])
h_self size  torch.Size([116583, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3023524284362793  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([116583, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41353464126586914  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3023524284362793  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([116583, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41353464126586914  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4413304328918457  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 116583
----------------output nodes number: 12600
----------------edges number: 313779
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4422931671142578  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4422931671142578  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4576091766357422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4576091766357422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45990991592407227  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12600, 47])
h_self size  torch.Size([12600, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45990991592407227  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12600, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4621162414550781  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45981550216674805  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12600, 47])
pseudo mini batch 14 input nodes size: 315258
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1237640380859375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24120712280273438  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24129867553710938  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 315258
first layer output nodes number: 114520
edges number: 1133654
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13522768020629883  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([315258, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13522768020629883  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13522768020629883  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18676328659057617  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18676328659057617  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2959780693054199  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([114520, 256])
h_self size  torch.Size([114520, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2959780693054199  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([114520, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40519285202026367  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2959780693054199  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([114520, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40519285202026367  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4324965476989746  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 114520
----------------output nodes number: 12247
----------------edges number: 304205
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4334416389465332  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4334416389465332  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4478321075439453  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4478321075439453  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4500918388366699  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12247, 47])
h_self size  torch.Size([12247, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4500918388366699  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12247, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4524812698364258  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45022153854370117  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12247, 47])
pseudo mini batch 15 input nodes size: 345128
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12080144882202148  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24937200546264648  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2494659423828125  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 345128
first layer output nodes number: 125176
edges number: 1238595
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1474900245666504  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([345128, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1474900245666504  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1474900245666504  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.20381689071655273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.20381689071655273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3231940269470215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([125176, 256])
h_self size  torch.Size([125176, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3231940269470215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([125176, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44257116317749023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3231940269470215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([125176, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44257116317749023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4724154472351074  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 125176
----------------output nodes number: 12562
----------------edges number: 312363
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47344207763671875  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47344207763671875  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.48868322372436523  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.48868322372436523  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4916200637817383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12562, 47])
h_self size  torch.Size([12562, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4916200637817383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12562, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4938197135925293  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.49088287353515625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12562, 47])
Number of nodes for computation during this epoch:  6599786
Number of first layer input nodes during this epoch:  4911937
Number of first layer output nodes during this epoch:  1687849

-----------------------------------------------------------------------------epoch done
read pickle file
0.7993628978729248

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.3240237236022949
global_2_local spend time (sec) 0.47710490226745605

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.070 seconds
Metis partitioning: 13.021 seconds
Split the graph: 1.322 seconds
Construct subgraphs: 0.038 seconds
11928
12364
11994
12620
12645
12609
12172
11927
12576
12414
11971
11942
12333
12608
12014
12454
REG metis partition end ----................................
the time spent:  26.781717538833618
REG construction  time spent:  9.309699535369873
pure dgl.metis_partition the time spent:  17.472018003463745
total k batches seeds list generation spend  27.655988216400146
after graph partition
graph partition algorithm spend time 28.221496105194092

partition_len_list
[91121, 109973, 108095, 106079, 110725, 92032, 80276, 113860, 92633, 127303, 108576, 103524, 116968, 121991, 112600, 117035]
REG selection method  spend 28.91236162185669
check_connections_block*********************************
time for parepare 1: 0.2403421401977539
local_output_nid generation: 0.003909587860107422
local_in_edges_tensor generation: 0.010240554809570312
mini_batch_src_global generation: 0.00986933708190918

&&&&&&&&&&&&&&& before remove duplicate length: 287303
&&&&&&&&&&&&&&& after remove duplicate length: 90338

r_  generation: 0.04071927070617676

local_output_nid generation: 0.004751443862915039
local_in_edges_tensor generation: 0.00601649284362793
mini_batch_src_global generation: 0.009145975112915039

&&&&&&&&&&&&&&& before remove duplicate length: 296283
&&&&&&&&&&&&&&& after remove duplicate length: 108787

r_  generation: 0.05660748481750488

local_output_nid generation: 0.004740476608276367
local_in_edges_tensor generation: 0.0048410892486572266
mini_batch_src_global generation: 0.007435798645019531

&&&&&&&&&&&&&&& before remove duplicate length: 293204
&&&&&&&&&&&&&&& after remove duplicate length: 107126

r_  generation: 0.053817033767700195

local_output_nid generation: 0.004905223846435547
local_in_edges_tensor generation: 0.005467891693115234
mini_batch_src_global generation: 0.009100675582885742

&&&&&&&&&&&&&&& before remove duplicate length: 305296
&&&&&&&&&&&&&&& after remove duplicate length: 105233

r_  generation: 0.055876731872558594

local_output_nid generation: 0.0049610137939453125
local_in_edges_tensor generation: 0.004605293273925781
mini_batch_src_global generation: 0.008820533752441406

&&&&&&&&&&&&&&& before remove duplicate length: 312498
&&&&&&&&&&&&&&& after remove duplicate length: 109911

r_  generation: 0.0594327449798584

local_output_nid generation: 0.007540702819824219
local_in_edges_tensor generation: 0.005491018295288086
mini_batch_src_global generation: 0.009215831756591797

&&&&&&&&&&&&&&& before remove duplicate length: 311232
&&&&&&&&&&&&&&& after remove duplicate length: 91516

r_  generation: 0.05280041694641113

local_output_nid generation: 0.0047376155853271484
local_in_edges_tensor generation: 0.004420280456542969
mini_batch_src_global generation: 0.008741378784179688

&&&&&&&&&&&&&&& before remove duplicate length: 288550
&&&&&&&&&&&&&&& after remove duplicate length: 79143

r_  generation: 0.03976321220397949

local_output_nid generation: 0.0046727657318115234
local_in_edges_tensor generation: 0.008376359939575195
mini_batch_src_global generation: 0.008436203002929688

&&&&&&&&&&&&&&& before remove duplicate length: 287257
&&&&&&&&&&&&&&& after remove duplicate length: 112194

r_  generation: 0.05698442459106445

local_output_nid generation: 0.004866123199462891
local_in_edges_tensor generation: 0.004557609558105469
mini_batch_src_global generation: 0.009477853775024414

&&&&&&&&&&&&&&& before remove duplicate length: 297409
&&&&&&&&&&&&&&& after remove duplicate length: 91574

r_  generation: 0.05170130729675293

local_output_nid generation: 0.0048677921295166016
local_in_edges_tensor generation: 0.005250453948974609
mini_batch_src_global generation: 0.0091094970703125

&&&&&&&&&&&&&&& before remove duplicate length: 305274
&&&&&&&&&&&&&&& after remove duplicate length: 125549

r_  generation: 0.06459951400756836

local_output_nid generation: 0.0047283172607421875
local_in_edges_tensor generation: 0.004203081130981445
mini_batch_src_global generation: 0.009000778198242188

&&&&&&&&&&&&&&& before remove duplicate length: 268057
&&&&&&&&&&&&&&& after remove duplicate length: 105121

r_  generation: 0.057068586349487305

local_output_nid generation: 0.004693031311035156
local_in_edges_tensor generation: 0.0059185028076171875
mini_batch_src_global generation: 0.010241508483886719

&&&&&&&&&&&&&&& before remove duplicate length: 283666
&&&&&&&&&&&&&&& after remove duplicate length: 100570

r_  generation: 0.05475950241088867

local_output_nid generation: 0.004816532135009766
local_in_edges_tensor generation: 0.004630088806152344
mini_batch_src_global generation: 0.009760379791259766

&&&&&&&&&&&&&&& before remove duplicate length: 306035
&&&&&&&&&&&&&&& after remove duplicate length: 116229

r_  generation: 0.06179690361022949

local_output_nid generation: 0.004973888397216797
local_in_edges_tensor generation: 0.004760026931762695
mini_batch_src_global generation: 0.010406970977783203

&&&&&&&&&&&&&&& before remove duplicate length: 312981
&&&&&&&&&&&&&&& after remove duplicate length: 120843

r_  generation: 0.06699180603027344

local_output_nid generation: 0.004741668701171875
local_in_edges_tensor generation: 0.004570484161376953
mini_batch_src_global generation: 0.010008096694946289

&&&&&&&&&&&&&&& before remove duplicate length: 298546
&&&&&&&&&&&&&&& after remove duplicate length: 111613

r_  generation: 0.06171131134033203

local_output_nid generation: 0.004878044128417969
local_in_edges_tensor generation: 0.005997419357299805
mini_batch_src_global generation: 0.01031637191772461

&&&&&&&&&&&&&&& before remove duplicate length: 310288
&&&&&&&&&&&&&&& after remove duplicate length: 116264

r_  generation: 0.06549310684204102


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7752037048339844
gen group dst list time:  0.05037283897399902
check_connections_block*********************************
time for parepare 1: 0.40123581886291504
local_output_nid generation: 0.02536153793334961
local_in_edges_tensor generation: 0.10244488716125488
mini_batch_src_global generation: 0.02985978126525879

&&&&&&&&&&&&&&& before remove duplicate length: 875169
&&&&&&&&&&&&&&& after remove duplicate length: 241925

r_  generation: 0.16047072410583496

local_output_nid generation: 0.0355222225189209
local_in_edges_tensor generation: 0.04388117790222168
mini_batch_src_global generation: 0.05358076095581055

&&&&&&&&&&&&&&& before remove duplicate length: 1055010
&&&&&&&&&&&&&&& after remove duplicate length: 302433

r_  generation: 0.21952080726623535

local_output_nid generation: 0.033472537994384766
local_in_edges_tensor generation: 0.03499341011047363
mini_batch_src_global generation: 0.029635906219482422

&&&&&&&&&&&&&&& before remove duplicate length: 1054488
&&&&&&&&&&&&&&& after remove duplicate length: 339018

r_  generation: 0.2523233890533447

local_output_nid generation: 0.03170180320739746
local_in_edges_tensor generation: 0.028382539749145508
mini_batch_src_global generation: 0.0311582088470459

&&&&&&&&&&&&&&& before remove duplicate length: 1021051
&&&&&&&&&&&&&&& after remove duplicate length: 273421

r_  generation: 0.22728562355041504

local_output_nid generation: 0.03327059745788574
local_in_edges_tensor generation: 0.03200888633728027
mini_batch_src_global generation: 0.03397989273071289

&&&&&&&&&&&&&&& before remove duplicate length: 1089784
&&&&&&&&&&&&&&& after remove duplicate length: 295439

r_  generation: 0.2432537078857422

local_output_nid generation: 0.026268720626831055
local_in_edges_tensor generation: 0.02583026885986328
mini_batch_src_global generation: 0.03371572494506836

&&&&&&&&&&&&&&& before remove duplicate length: 903132
&&&&&&&&&&&&&&& after remove duplicate length: 233614

r_  generation: 0.19318532943725586

local_output_nid generation: 0.02300405502319336
local_in_edges_tensor generation: 0.021639585494995117
mini_batch_src_global generation: 0.026409626007080078

&&&&&&&&&&&&&&& before remove duplicate length: 775487
&&&&&&&&&&&&&&& after remove duplicate length: 179666

r_  generation: 0.15667009353637695

local_output_nid generation: 0.03295540809631348
local_in_edges_tensor generation: 0.02960824966430664
mini_batch_src_global generation: 0.03518056869506836

&&&&&&&&&&&&&&& before remove duplicate length: 1114323
&&&&&&&&&&&&&&& after remove duplicate length: 332419

r_  generation: 0.25611424446105957

local_output_nid generation: 0.02575206756591797
local_in_edges_tensor generation: 0.022168397903442383
mini_batch_src_global generation: 0.03444981575012207

&&&&&&&&&&&&&&& before remove duplicate length: 889563
&&&&&&&&&&&&&&& after remove duplicate length: 240872

r_  generation: 0.20469331741333008

local_output_nid generation: 0.036264896392822266
local_in_edges_tensor generation: 0.04376864433288574
mini_batch_src_global generation: 0.052352190017700195

&&&&&&&&&&&&&&& before remove duplicate length: 1258812
&&&&&&&&&&&&&&& after remove duplicate length: 392517

r_  generation: 0.3292248249053955

local_output_nid generation: 0.0322268009185791
local_in_edges_tensor generation: 0.03091144561767578
mini_batch_src_global generation: 0.03941774368286133

&&&&&&&&&&&&&&& before remove duplicate length: 1062098
&&&&&&&&&&&&&&& after remove duplicate length: 358345

r_  generation: 0.31125712394714355

local_output_nid generation: 0.03225994110107422
local_in_edges_tensor generation: 0.06891775131225586
mini_batch_src_global generation: 0.03886294364929199

&&&&&&&&&&&&&&& before remove duplicate length: 1020057
&&&&&&&&&&&&&&& after remove duplicate length: 355097

r_  generation: 0.30144238471984863

local_output_nid generation: 0.034742116928100586
local_in_edges_tensor generation: 0.037600040435791016
mini_batch_src_global generation: 0.0463414192199707

&&&&&&&&&&&&&&& before remove duplicate length: 1156645
&&&&&&&&&&&&&&& after remove duplicate length: 336453

r_  generation: 0.2876718044281006

local_output_nid generation: 0.0363771915435791
local_in_edges_tensor generation: 0.03539276123046875
mini_batch_src_global generation: 0.042885541915893555

&&&&&&&&&&&&&&& before remove duplicate length: 1208503
&&&&&&&&&&&&&&& after remove duplicate length: 340171

r_  generation: 0.2909994125366211

local_output_nid generation: 0.034345149993896484
local_in_edges_tensor generation: 0.030577421188354492
mini_batch_src_global generation: 0.04022574424743652

&&&&&&&&&&&&&&& before remove duplicate length: 1115740
&&&&&&&&&&&&&&& after remove duplicate length: 319812

r_  generation: 0.2638401985168457

local_output_nid generation: 0.03305220603942871
local_in_edges_tensor generation: 0.03654050827026367
mini_batch_src_global generation: 0.04043698310852051

&&&&&&&&&&&&&&& before remove duplicate length: 1159296
&&&&&&&&&&&&&&& after remove duplicate length: 269643

r_  generation: 0.23986244201660156


connection checking time:  14.83821153640747
block generation total time  12.407655000686646
block dataloader generation time/epoch 57.409690618515015
pseudo mini batch 0 input nodes size: 253131
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.1327228546142578  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2270216941833496  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2271108627319336  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

first layer input nodes number: 253131
first layer output nodes number: 91121
edges number: 875169
----------------------------------------before model layer 0
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.10967397689819336  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([253131, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.10967397689819336  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.10967397689819336  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.1504802703857422  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.1504802703857422  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2373800277709961  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([91121, 256])
h_self size  torch.Size([91121, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2373800277709961  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([91121, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.32427978515625  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2373800277709961  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([91121, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.32427978515625  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3460049629211426  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------input nodes number: 91121
----------------output nodes number: 11928
----------------edges number: 287303
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3467731475830078  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3467731475830078  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.360445499420166  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.360445499420166  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.36323070526123047  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([11928, 47])
h_self size  torch.Size([11928, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.36323070526123047  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([11928, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.36542415618896484  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3626389503479004  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([11928, 47])
pseudo mini batch 1 input nodes size: 315766
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.09759902954101562  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.21523141860961914  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.21532392501831055  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

first layer input nodes number: 315766
first layer output nodes number: 109973
edges number: 1055010
----------------------------------------before model layer 0
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.13417720794677734  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([315766, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.13417720794677734  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.13417720794677734  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.1834397315979004  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.1834397315979004  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2883181571960449  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([109973, 256])
h_self size  torch.Size([109973, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2883181571960449  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([109973, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.39319658279418945  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2883181571960449  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([109973, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.39319658279418945  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4194164276123047  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------input nodes number: 109973
----------------output nodes number: 12364
----------------edges number: 296283
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.42032861709594727  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.42032861709594727  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.43444347381591797  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.43444347381591797  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4367642402648926  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([12364, 47])
h_self size  torch.Size([12364, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4367642402648926  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12364, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.43892908096313477  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.43660831451416016  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12364, 47])
pseudo mini batch 2 input nodes size: 353501
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.12116813659667969  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.25285768508911133  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2529473304748535  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

first layer input nodes number: 353501
first layer output nodes number: 108095
edges number: 1054488
----------------------------------------before model layer 0
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.14910173416137695  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([353501, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.14910173416137695  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.14910173416137695  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.19835519790649414  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.19835519790649414  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.30144262313842773  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([108095, 256])
h_self size  torch.Size([108095, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.30144262313842773  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([108095, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.40453004837036133  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.30144262313842773  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([108095, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.40453004837036133  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.43030214309692383  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------input nodes number: 108095
----------------output nodes number: 11994
----------------edges number: 293204
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4311971664428711  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4311971664428711  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.44573450088500977  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.44573450088500977  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.44783496856689453  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([11994, 47])
h_self size  torch.Size([11994, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.44783496856689453  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([11994, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4499354362487793  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.44783496856689453  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([11994, 47])
pseudo mini batch 3 input nodes size: 284352
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.13500213623046875  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.24093151092529297  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2410259246826172  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

first layer input nodes number: 284352
first layer output nodes number: 106079
edges number: 1021051
----------------------------------------before model layer 0
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.12259864807128906  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([284352, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.12259864807128906  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.12259864807128906  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.17063188552856445  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.17063188552856445  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.27179670333862305  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([106079, 256])
h_self size  torch.Size([106079, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.27179670333862305  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([106079, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.37296152114868164  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.27179670333862305  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([106079, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.37296152114868164  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3982529640197754  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------input nodes number: 106079
----------------output nodes number: 12620
----------------edges number: 305296
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3991379737854004  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3991379737854004  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4146738052368164  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4146738052368164  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4168834686279297  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([12620, 47])
h_self size  torch.Size([12620, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4168834686279297  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12620, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.41909313201904297  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4168834686279297  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12620, 47])
pseudo mini batch 4 input nodes size: 307369
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.10935592651367188  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.22459030151367188  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2246847152709961  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

first layer input nodes number: 307369
first layer output nodes number: 110725
edges number: 1089784
----------------------------------------before model layer 0
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.13222503662109375  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([307369, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.13222503662109375  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.13222503662109375  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.18252897262573242  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.18252897262573242  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.28812456130981445  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([110725, 256])
h_self size  torch.Size([110725, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.28812456130981445  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([110725, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3937201499938965  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.28812456130981445  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([110725, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3937201499938965  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4201192855834961  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------input nodes number: 110725
----------------output nodes number: 12645
----------------edges number: 312498
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4210391044616699  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4210391044616699  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.43552160263061523  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.43552160263061523  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.43773603439331055  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([12645, 47])
h_self size  torch.Size([12645, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.43773603439331055  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12645, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4406590461730957  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4384446144104004  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12645, 47])
pseudo mini batch 5 input nodes size: 243849
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.11866569519042969  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.20950698852539062  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.20960140228271484  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

first layer input nodes number: 243849
first layer output nodes number: 92032
edges number: 903132
----------------------------------------before model layer 0
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.10643720626831055  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([243849, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.10643720626831055  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.10643720626831055  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.14779424667358398  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.14779424667358398  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.23556280136108398  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([92032, 256])
h_self size  torch.Size([92032, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.23556280136108398  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([92032, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.323331356048584  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.23556280136108398  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([92032, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.323331356048584  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.345273494720459  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------input nodes number: 92032
----------------output nodes number: 12609
----------------edges number: 311232
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3460536003112793  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3460536003112793  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.360623836517334  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.360623836517334  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3630971908569336  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([12609, 47])
h_self size  torch.Size([12609, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3630971908569336  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12609, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.36530494689941406  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.36283159255981445  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12609, 47])
pseudo mini batch 6 input nodes size: 187020
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.09426593780517578  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.16393661499023438  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.16402769088745117  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

first layer input nodes number: 187020
first layer output nodes number: 80276
edges number: 775487
----------------------------------------before model layer 0
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.08398914337158203  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([187020, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.08398914337158203  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.08398914337158203  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.11997222900390625  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.11997222900390625  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.19652938842773438  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([80276, 256])
h_self size  torch.Size([80276, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.19652938842773438  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([80276, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2730865478515625  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.19652938842773438  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([80276, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2730865478515625  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2926177978515625  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------input nodes number: 80276
----------------output nodes number: 12172
----------------edges number: 288550
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2933073043823242  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.2933073043823242  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3073287010192871  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3073287010192871  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.309661865234375  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([12172, 47])
h_self size  torch.Size([12172, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.309661865234375  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12172, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.31179332733154297  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3094601631164551  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12172, 47])
pseudo mini batch 7 input nodes size: 348419
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.07301568984985352  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.20281219482421875  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.20290136337280273  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

first layer input nodes number: 348419
first layer output nodes number: 113860
edges number: 1114323
----------------------------------------before model layer 0
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.1475982666015625  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([348419, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.1475982666015625  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.1475982666015625  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.19874191284179688  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.19874191284179688  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3073272705078125  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([113860, 256])
h_self size  torch.Size([113860, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3073272705078125  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([113860, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4159126281738281  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3073272705078125  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([113860, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4159126281738281  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.44305896759033203  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------input nodes number: 113860
----------------output nodes number: 11927
----------------edges number: 287257
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4439969062805176  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4439969062805176  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.457611083984375  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.457611083984375  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4605369567871094  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4605369567871094  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.46262550354003906  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.4596996307373047  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 8 input nodes size: 255964
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.13393402099609375  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.22928810119628906  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.22938203811645508  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

first layer input nodes number: 255964
first layer output nodes number: 92633
edges number: 889563
----------------------------------------before model layer 0
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.11093854904174805  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([255964, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.11093854904174805  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.11093854904174805  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.1524205207824707  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.1524205207824707  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.24076223373413086  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([92633, 256])
h_self size  torch.Size([92633, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.24076223373413086  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([92633, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.329103946685791  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.24076223373413086  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([92633, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.329103946685791  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.35118961334228516  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------input nodes number: 92633
----------------output nodes number: 12576
----------------edges number: 297409
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3519740104675293  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3519740104675293  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.36660146713256836  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.36660146713256836  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3688035011291504  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([12576, 47])
h_self size  torch.Size([12576, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3688035011291504  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12576, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3710055351257324  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.3688035011291504  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12576, 47])
pseudo mini batch 9 input nodes size: 410152
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0057373046875 GB
    Memory Allocated: 0.09877252578735352  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1600341796875 GB
    Memory Allocated: 0.25156641006469727  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1600341796875 GB
    Memory Allocated: 0.25165891647338867  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

first layer input nodes number: 410152
first layer output nodes number: 127303
edges number: 1258812
----------------------------------------before model layer 0
 Nvidia-smi: 9.1600341796875 GB
    Memory Allocated: 0.17296934127807617  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([410152, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1600341796875 GB
    Memory Allocated: 0.17296934127807617  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1600341796875 GB
    Memory Allocated: 0.17296934127807617  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.23102045059204102  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.23102045059204102  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.35242605209350586  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([127303, 256])
h_self size  torch.Size([127303, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.35242605209350586  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([127303, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.4738316535949707  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.35242605209350586  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([127303, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.4738316535949707  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.504183292388916  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------input nodes number: 127303
----------------output nodes number: 12414
----------------edges number: 305274
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.5052247047424316  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.5052247047424316  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.5194306373596191  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.5194306373596191  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.5221619606018066  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

h_neigh size torch.Size([12414, 47])
h_self size  torch.Size([12414, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.5221619606018066  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12414, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.5243358612060547  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1619873046875 GB
    Memory Allocated: 0.5216045379638672  GigaBytes
Max Memory Allocated: 0.7197918891906738  GigaBytes

torch.Size([12414, 47])
pseudo mini batch 10 input nodes size: 376151
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.15618276596069336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.29680776596069336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.29689741134643555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 376151
first layer output nodes number: 108576
edges number: 1062098
----------------------------------------before model layer 0
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.15753459930419922  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([376151, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.15753459930419922  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.15753459930419922  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2068181037902832  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2068181037902832  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3103642463684082  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([108576, 256])
h_self size  torch.Size([108576, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3103642463684082  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([108576, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4139103889465332  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3103642463684082  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([108576, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4139103889465332  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.43979692459106445  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 108576
----------------output nodes number: 11971
----------------edges number: 268057
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.44069576263427734  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.44069576263427734  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4552764892578125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4552764892578125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.45827293395996094  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11971, 47])
h_self size  torch.Size([11971, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.45827293395996094  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11971, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4603691101074219  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.45737266540527344  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11971, 47])
pseudo mini batch 11 input nodes size: 373151
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14483356475830078  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2838435173034668  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2839326858520508  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 373151
first layer output nodes number: 103524
edges number: 1020057
----------------------------------------before model layer 0
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.1569056510925293  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([373151, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.1569056510925293  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.1569056510925293  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.20345830917358398  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.20345830917358398  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3021864891052246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([103524, 256])
h_self size  torch.Size([103524, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3021864891052246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([103524, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.40091466903686523  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3021864891052246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([103524, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.40091466903686523  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4255967140197754  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 103524
----------------output nodes number: 11942
----------------edges number: 283666
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.42645740509033203  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.42645740509033203  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4408884048461914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4408884048461914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4429793357849121  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11942, 47])
h_self size  torch.Size([11942, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4429793357849121  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11942, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4450702667236328  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4429793357849121  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11942, 47])
pseudo mini batch 12 input nodes size: 349771
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14231252670288086  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.27317190170288086  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.27326393127441406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 349771
first layer output nodes number: 116968
edges number: 1156645
----------------------------------------before model layer 0
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14854145050048828  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([349771, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14854145050048828  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14854145050048828  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2011699676513672  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2011699676513672  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.31271934509277344  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([116968, 256])
h_self size  torch.Size([116968, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.31271934509277344  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([116968, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4242687225341797  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.31271934509277344  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([116968, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4242687225341797  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.45215606689453125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 116968
----------------output nodes number: 12333
----------------edges number: 306035
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.45311975479125977  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.45311975479125977  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4680957794189453  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4680957794189453  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.47037601470947266  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12333, 47])
h_self size  torch.Size([12333, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.47037601470947266  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12333, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4725356101989746  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.47025537490844727  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12333, 47])
pseudo mini batch 13 input nodes size: 354064
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.1343541145324707  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2662534713745117  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.26634740829467773  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 354064
first layer output nodes number: 121991
edges number: 1208503
----------------------------------------before model layer 0
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.1509380340576172  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([354064, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.1509380340576172  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.1509380340576172  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2058429718017578  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2058429718017578  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3230304718017578  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([121991, 256])
h_self size  torch.Size([121991, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3230304718017578  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([121991, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.43937015533447266  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.32218265533447266  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([121991, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.43937015533447266  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.46845531463623047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 121991
----------------output nodes number: 12608
----------------edges number: 312981
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.46945858001708984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.46945858001708984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.48390960693359375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.48390960693359375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4861173629760742  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12608, 47])
h_self size  torch.Size([12608, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4861173629760742  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12608, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4883251190185547  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4861173629760742  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12608, 47])
pseudo mini batch 14 input nodes size: 333755
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.13532352447509766  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.26032352447509766  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.26041316986083984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 333755
first layer output nodes number: 112600
edges number: 1115740
----------------------------------------before model layer 0
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14278030395507812  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([333755, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14278030395507812  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14278030395507812  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.19345998764038086  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.19345998764038086  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3008437156677246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([112600, 256])
h_self size  torch.Size([112600, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3008437156677246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([112600, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.40822744369506836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3008437156677246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([112600, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.40822744369506836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4350733757019043  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 112600
----------------output nodes number: 12014
----------------edges number: 298546
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.436002254486084  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.436002254486084  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4504542350769043  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4504542350769043  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4534292221069336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12014, 47])
h_self size  torch.Size([12014, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4534292221069336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12014, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4555330276489258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4525580406188965  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12014, 47])
pseudo mini batch 15 input nodes size: 280712
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.12918710708618164  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.23376083374023438  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.23385381698608398  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 280712
first layer output nodes number: 117035
edges number: 1159296
----------------------------------------before model layer 0
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.12354516983032227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([280712, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.12354516983032227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.12354516983032227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.17621803283691406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.17621803283691406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.28783130645751953  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([117035, 256])
h_self size  torch.Size([117035, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.28783130645751953  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([117035, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.399444580078125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.28783130645751953  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([117035, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.399444580078125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.42734813690185547  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 117035
----------------output nodes number: 12454
----------------edges number: 310288
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4283132553100586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4283132553100586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4435458183288574  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4435458183288574  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4457263946533203  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12454, 47])
h_self size  torch.Size([12454, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4457263946533203  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12454, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4479069709777832  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4457263946533203  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12454, 47])
Average training time/epoch 1.27923583984375
Average Training time/epoch w/o nid counting 1.2770185470581055
Number of nodes for computation during this epoch:  6739918
Number of first layer input nodes during this epoch:  5027127
Number of first layer output nodes during this epoch:  1712791

-----------------------------------------------------------------------------epoch done
read pickle file
0.751373291015625

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2823328971862793
global_2_local spend time (sec) 0.4432365894317627

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.107 seconds
Metis partitioning: 13.253 seconds
Split the graph: 1.203 seconds
Construct subgraphs: 0.071 seconds
11927
12479
12084
12183
11994
12648
11983
11928
12411
12654
12649
12571
11927
12426
12098
12609
REG metis partition end ----................................
the time spent:  26.85529637336731
REG construction  time spent:  9.199763059616089
pure dgl.metis_partition the time spent:  17.65553331375122
total k batches seeds list generation spend  27.71935486793518
after graph partition
graph partition algorithm spend time 28.340128183364868

partition_len_list
[108487, 89155, 116860, 117170, 113343, 117697, 113825, 123187, 90432, 82208, 104997, 123106, 111502, 96683, 89607, 114974]
REG selection method  spend 28.99309515953064
check_connections_block*********************************
time for parepare 1: 0.2150874137878418
local_output_nid generation: 0.003949403762817383
local_in_edges_tensor generation: 0.004663705825805664
mini_batch_src_global generation: 0.011831045150756836

&&&&&&&&&&&&&&& before remove duplicate length: 292636
&&&&&&&&&&&&&&& after remove duplicate length: 106739

r_  generation: 0.04457712173461914

local_output_nid generation: 0.004775524139404297
local_in_edges_tensor generation: 0.0061986446380615234
mini_batch_src_global generation: 0.012560606002807617

&&&&&&&&&&&&&&& before remove duplicate length: 295728
&&&&&&&&&&&&&&& after remove duplicate length: 88201

r_  generation: 0.04397463798522949

local_output_nid generation: 0.004713535308837891
local_in_edges_tensor generation: 0.004320621490478516
mini_batch_src_global generation: 0.008092880249023438

&&&&&&&&&&&&&&& before remove duplicate length: 298892
&&&&&&&&&&&&&&& after remove duplicate length: 115575

r_  generation: 0.054727792739868164

local_output_nid generation: 0.0047495365142822266
local_in_edges_tensor generation: 0.004940986633300781
mini_batch_src_global generation: 0.013428449630737305

&&&&&&&&&&&&&&& before remove duplicate length: 302784
&&&&&&&&&&&&&&& after remove duplicate length: 116202

r_  generation: 0.05865979194641113

local_output_nid generation: 0.004677772521972656
local_in_edges_tensor generation: 0.004288673400878906
mini_batch_src_global generation: 0.009474992752075195

&&&&&&&&&&&&&&& before remove duplicate length: 276331
&&&&&&&&&&&&&&& after remove duplicate length: 109998

r_  generation: 0.05683469772338867

local_output_nid generation: 0.004960060119628906
local_in_edges_tensor generation: 0.0044918060302734375
mini_batch_src_global generation: 0.011155366897583008

&&&&&&&&&&&&&&& before remove duplicate length: 313776
&&&&&&&&&&&&&&& after remove duplicate length: 117003

r_  generation: 0.0645761489868164

local_output_nid generation: 0.004676342010498047
local_in_edges_tensor generation: 0.009927749633789062
mini_batch_src_global generation: 0.01119542121887207

&&&&&&&&&&&&&&& before remove duplicate length: 295942
&&&&&&&&&&&&&&& after remove duplicate length: 112313

r_  generation: 0.060455322265625

local_output_nid generation: 0.005504131317138672
local_in_edges_tensor generation: 0.006120920181274414
mini_batch_src_global generation: 0.011681318283081055

&&&&&&&&&&&&&&& before remove duplicate length: 277447
&&&&&&&&&&&&&&& after remove duplicate length: 120003

r_  generation: 0.06227993965148926

local_output_nid generation: 0.004811525344848633
local_in_edges_tensor generation: 0.004978656768798828
mini_batch_src_global generation: 0.01170802116394043

&&&&&&&&&&&&&&& before remove duplicate length: 300034
&&&&&&&&&&&&&&& after remove duplicate length: 89429

r_  generation: 0.052702903747558594

local_output_nid generation: 0.004897594451904297
local_in_edges_tensor generation: 0.005333662033081055
mini_batch_src_global generation: 0.011261463165283203

&&&&&&&&&&&&&&& before remove duplicate length: 298793
&&&&&&&&&&&&&&& after remove duplicate length: 81064

r_  generation: 0.0411381721496582

local_output_nid generation: 0.004878044128417969
local_in_edges_tensor generation: 0.004416942596435547
mini_batch_src_global generation: 0.011629343032836914

&&&&&&&&&&&&&&& before remove duplicate length: 312481
&&&&&&&&&&&&&&& after remove duplicate length: 104245

r_  generation: 0.05510878562927246

local_output_nid generation: 0.004848480224609375
local_in_edges_tensor generation: 0.004473686218261719
mini_batch_src_global generation: 0.01274871826171875

&&&&&&&&&&&&&&& before remove duplicate length: 312523
&&&&&&&&&&&&&&& after remove duplicate length: 122219

r_  generation: 0.06330490112304688

local_output_nid generation: 0.0047149658203125
local_in_edges_tensor generation: 0.004413604736328125
mini_batch_src_global generation: 0.009485006332397461

&&&&&&&&&&&&&&& before remove duplicate length: 289189
&&&&&&&&&&&&&&& after remove duplicate length: 110309

r_  generation: 0.06039619445800781

local_output_nid generation: 0.004829883575439453
local_in_edges_tensor generation: 0.004555702209472656
mini_batch_src_global generation: 0.009685277938842773

&&&&&&&&&&&&&&& before remove duplicate length: 299690
&&&&&&&&&&&&&&& after remove duplicate length: 95858

r_  generation: 0.05468130111694336

local_output_nid generation: 0.004789590835571289
local_in_edges_tensor generation: 0.0043239593505859375
mini_batch_src_global generation: 0.009215116500854492

&&&&&&&&&&&&&&& before remove duplicate length: 292941
&&&&&&&&&&&&&&& after remove duplicate length: 88836

r_  generation: 0.0500028133392334

local_output_nid generation: 0.00486302375793457
local_in_edges_tensor generation: 0.004537343978881836
mini_batch_src_global generation: 0.009360790252685547

&&&&&&&&&&&&&&& before remove duplicate length: 304692
&&&&&&&&&&&&&&& after remove duplicate length: 113899

r_  generation: 0.059331655502319336


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7631781101226807
gen group dst list time:  0.05025935173034668
check_connections_block*********************************
time for parepare 1: 0.3622269630432129
local_output_nid generation: 0.027727127075195312
local_in_edges_tensor generation: 0.09302997589111328
mini_batch_src_global generation: 0.03438591957092285

&&&&&&&&&&&&&&& before remove duplicate length: 1071921
&&&&&&&&&&&&&&& after remove duplicate length: 326909

r_  generation: 0.22241735458374023

local_output_nid generation: 0.026099205017089844
local_in_edges_tensor generation: 0.02136683464050293
mini_batch_src_global generation: 0.026177406311035156

&&&&&&&&&&&&&&& before remove duplicate length: 855972
&&&&&&&&&&&&&&& after remove duplicate length: 227107

r_  generation: 0.17048192024230957

local_output_nid generation: 0.035613059997558594
local_in_edges_tensor generation: 0.03654217720031738
mini_batch_src_global generation: 0.033800363540649414

&&&&&&&&&&&&&&& before remove duplicate length: 1156516
&&&&&&&&&&&&&&& after remove duplicate length: 341976

r_  generation: 0.26217079162597656

local_output_nid generation: 0.03464245796203613
local_in_edges_tensor generation: 0.03378629684448242
mini_batch_src_global generation: 0.03976106643676758

&&&&&&&&&&&&&&& before remove duplicate length: 1159856
&&&&&&&&&&&&&&& after remove duplicate length: 322024

r_  generation: 0.2728266716003418

local_output_nid generation: 0.03607058525085449
local_in_edges_tensor generation: 0.034627676010131836
mini_batch_src_global generation: 0.0359799861907959

&&&&&&&&&&&&&&& before remove duplicate length: 1116624
&&&&&&&&&&&&&&& after remove duplicate length: 401721

r_  generation: 0.33652257919311523

local_output_nid generation: 0.034653663635253906
local_in_edges_tensor generation: 0.031653642654418945
mini_batch_src_global generation: 0.039721012115478516

&&&&&&&&&&&&&&& before remove duplicate length: 1160944
&&&&&&&&&&&&&&& after remove duplicate length: 308374

r_  generation: 0.2639017105102539

local_output_nid generation: 0.0339815616607666
local_in_edges_tensor generation: 0.02903151512145996
mini_batch_src_global generation: 0.03818678855895996

&&&&&&&&&&&&&&& before remove duplicate length: 1128177
&&&&&&&&&&&&&&& after remove duplicate length: 342791

r_  generation: 0.2752680778503418

local_output_nid generation: 0.0372157096862793
local_in_edges_tensor generation: 0.05102849006652832
mini_batch_src_global generation: 0.04770326614379883

&&&&&&&&&&&&&&& before remove duplicate length: 1208191
&&&&&&&&&&&&&&& after remove duplicate length: 420688

r_  generation: 0.371518611907959

local_output_nid generation: 0.02701115608215332
local_in_edges_tensor generation: 0.029559612274169922
mini_batch_src_global generation: 0.033950090408325195

&&&&&&&&&&&&&&& before remove duplicate length: 879610
&&&&&&&&&&&&&&& after remove duplicate length: 241275

r_  generation: 0.21667909622192383

local_output_nid generation: 0.023500680923461914
local_in_edges_tensor generation: 0.019723176956176758
mini_batch_src_global generation: 0.027860164642333984

&&&&&&&&&&&&&&& before remove duplicate length: 792791
&&&&&&&&&&&&&&& after remove duplicate length: 175182

r_  generation: 0.16119790077209473

local_output_nid generation: 0.0313570499420166
local_in_edges_tensor generation: 0.028502702713012695
mini_batch_src_global generation: 0.03346872329711914

&&&&&&&&&&&&&&& before remove duplicate length: 1032336
&&&&&&&&&&&&&&& after remove duplicate length: 282506

r_  generation: 0.2319633960723877

local_output_nid generation: 0.04037284851074219
local_in_edges_tensor generation: 0.032297372817993164
mini_batch_src_global generation: 0.04208087921142578

&&&&&&&&&&&&&&& before remove duplicate length: 1220582
&&&&&&&&&&&&&&& after remove duplicate length: 335234

r_  generation: 0.2861654758453369

local_output_nid generation: 0.038167715072631836
local_in_edges_tensor generation: 0.04644131660461426
mini_batch_src_global generation: 0.04011344909667969

&&&&&&&&&&&&&&& before remove duplicate length: 1081105
&&&&&&&&&&&&&&& after remove duplicate length: 341819

r_  generation: 0.28696656227111816

local_output_nid generation: 0.030805110931396484
local_in_edges_tensor generation: 0.02734994888305664
mini_batch_src_global generation: 0.03516721725463867

&&&&&&&&&&&&&&& before remove duplicate length: 925125
&&&&&&&&&&&&&&& after remove duplicate length: 255092

r_  generation: 0.21796441078186035

local_output_nid generation: 0.027840852737426758
local_in_edges_tensor generation: 0.02554941177368164
mini_batch_src_global generation: 0.031496524810791016

&&&&&&&&&&&&&&& before remove duplicate length: 868906
&&&&&&&&&&&&&&& after remove duplicate length: 255573

r_  generation: 0.20302915573120117

local_output_nid generation: 0.03317594528198242
local_in_edges_tensor generation: 0.02973341941833496
mini_batch_src_global generation: 0.038727521896362305

&&&&&&&&&&&&&&& before remove duplicate length: 1106270
&&&&&&&&&&&&&&& after remove duplicate length: 301951

r_  generation: 0.25402402877807617


connection checking time:  14.803511142730713
block generation total time  12.724631071090698
block dataloader generation time/epoch 57.553807735443115
pseudo mini batch 0 input nodes size: 342585
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.10796880722045898  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.23559188842773438  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.23568105697631836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 342585
first layer output nodes number: 108487
edges number: 1071921
----------------------------------------before model layer 0
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.1453847885131836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([342585, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.1453847885131836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.1453847885131836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.19470453262329102  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.19470453262329102  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.29816579818725586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([108487, 256])
h_self size  torch.Size([108487, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.29816579818725586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([108487, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4016270637512207  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.29816579818725586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([108487, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4016270637512207  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.427492618560791  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 108487
----------------output nodes number: 11927
----------------edges number: 292636
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4283905029296875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4283905029296875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.44243431091308594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.44243431091308594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4447603225708008  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4447603225708008  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.44684886932373047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4445228576660156  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 1 input nodes size: 241164
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.13092327117919922  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.22076416015625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2208571434020996  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 241164
first layer output nodes number: 89155
edges number: 855972
----------------------------------------before model layer 0
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.10425806045532227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([241164, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.10425806045532227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.10425806045532227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14479780197143555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14479780197143555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.22982263565063477  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([89155, 256])
h_self size  torch.Size([89155, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.22982263565063477  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([89155, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.314847469329834  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.22982263565063477  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([89155, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.314847469329834  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3361039161682129  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 89155
----------------output nodes number: 12479
----------------edges number: 295728
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.33686161041259766  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.33686161041259766  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3510599136352539  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3510599136352539  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.35324525833129883  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12479, 47])
h_self size  torch.Size([12479, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.35324525833129883  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12479, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.35543060302734375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.35324525833129883  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12479, 47])
pseudo mini batch 2 input nodes size: 356503
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.09324169158935547  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.22604942321777344  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.22613954544067383  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 356503
first layer output nodes number: 116860
edges number: 1156516
----------------------------------------before model layer 0
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.15060043334960938  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([356503, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.15060043334960938  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.15060043334960938  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.20381402969360352  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.20381402969360352  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3152604103088379  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([116860, 256])
h_self size  torch.Size([116860, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3152604103088379  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([116860, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.42670679092407227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.3152604103088379  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([116860, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.42670679092407227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.45456838607788086  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 116860
----------------output nodes number: 12084
----------------edges number: 298892
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.45552921295166016  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.45552921295166016  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.46964597702026367  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.46964597702026367  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.47176218032836914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12084, 47])
h_self size  torch.Size([12084, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.47176218032836914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12084, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4738783836364746  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.47176218032836914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12084, 47])
pseudo mini batch 3 input nodes size: 334371
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.13613653182983398  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.261136531829834  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.2612276077270508  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 334371
first layer output nodes number: 117170
edges number: 1159856
----------------------------------------before model layer 0
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14313650131225586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([334371, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14313650131225586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.14313650131225586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.19586515426635742  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.19586515426635742  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.30760717391967773  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([117170, 256])
h_self size  torch.Size([117170, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.30760717391967773  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([117170, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.41934919357299805  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.30760717391967773  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([117170, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.41934919357299805  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4472846984863281  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 117170
----------------output nodes number: 12183
----------------edges number: 302784
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.44824886322021484  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.44824886322021484  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.46246767044067383  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.46246767044067383  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.46471500396728516  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12183, 47])
h_self size  torch.Size([12183, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.46471500396728516  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12183, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.46684837341308594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.4646010398864746  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12183, 47])
pseudo mini batch 4 input nodes size: 421758
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1639404296875 GB
    Memory Allocated: 0.12846088409423828  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.28557825088500977  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.28566789627075195  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 421758
first layer output nodes number: 113343
edges number: 1116624
----------------------------------------before model layer 0
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.17499876022338867  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([421758, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.17499876022338867  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.17499876022338867  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.22659730911254883  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.22659730911254883  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.3346896171569824  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([113343, 256])
h_self size  torch.Size([113343, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.3346896171569824  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([113343, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.442781925201416  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.3346896171569824  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([113343, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.442781925201416  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4698052406311035  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 113343
----------------output nodes number: 11994
----------------edges number: 276331
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.47073936462402344  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.47073936462402344  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.48460960388183594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.48460960388183594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4873075485229492  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11994, 47])
h_self size  torch.Size([11994, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4873075485229492  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11994, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.489408016204834  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4867100715637207  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11994, 47])
pseudo mini batch 5 input nodes size: 322722
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.1610274314880371  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.2821211814880371  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.28221559524536133  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 322722
first layer output nodes number: 117697
edges number: 1160944
----------------------------------------before model layer 0
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.13927888870239258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([322722, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.13927888870239258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.13927888870239258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.1922130584716797  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.1922130584716797  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.3044576644897461  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([117697, 256])
h_self size  torch.Size([117697, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.3044576644897461  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([117697, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4167022705078125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.3044576644897461  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([117697, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4167022705078125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4447636604309082  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 117697
----------------output nodes number: 12648
----------------edges number: 313776
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.44573545455932617  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.44573545455932617  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.46152591705322266  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.46152591705322266  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.46451568603515625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12648, 47])
h_self size  torch.Size([12648, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.46451568603515625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12648, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.46673059463500977  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.46374082565307617  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12648, 47])
pseudo mini batch 6 input nodes size: 358636
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.12452554702758789  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.25812816619873047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.25821781158447266  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 358636
first layer output nodes number: 113825
edges number: 1128177
----------------------------------------before model layer 0
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.15191411972045898  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([358636, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.15191411972045898  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.15191411972045898  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.20314741134643555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.20314741134643555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.31169939041137695  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([113825, 256])
h_self size  torch.Size([113825, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.31169939041137695  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([113825, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.42025136947631836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.31169939041137695  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([113825, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.42025136947631836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4473896026611328  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 113825
----------------output nodes number: 11983
----------------edges number: 295942
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.44832754135131836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.44832754135131836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4628448486328125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4628448486328125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.46494340896606445  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11983, 47])
h_self size  torch.Size([11983, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.46494340896606445  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11983, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.46742868423461914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.4653301239013672  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11983, 47])
pseudo mini batch 7 input nodes size: 440784
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 0.13691329956054688  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3011183738708496  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3012075424194336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 440784
first layer output nodes number: 123187
edges number: 1208191
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18364667892456055  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([440784, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18364667892456055  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18364667892456055  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2389984130859375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2389984130859375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3564786911010742  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([123187, 256])
h_self size  torch.Size([123187, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3564786911010742  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([123187, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.47395896911621094  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3564786911010742  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([123187, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.47395896911621094  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5033292770385742  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 123187
----------------output nodes number: 11928
----------------edges number: 277447
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5043363571166992  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5043363571166992  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5193328857421875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5193328857421875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5214214324951172  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11928, 47])
h_self size  torch.Size([11928, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5214214324951172  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11928, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5235099792480469  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5214214324951172  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11928, 47])
pseudo mini batch 8 input nodes size: 251527
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.16750526428222656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.26120662689208984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.26129913330078125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 251527
first layer output nodes number: 90432
edges number: 879610
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.10834312438964844  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([251527, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.10834312438964844  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.10834312438964844  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.14892244338989258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.14892244338989258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.23516511917114258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([90432, 256])
h_self size  torch.Size([90432, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.23516511917114258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([90432, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3214077949523926  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.23516511917114258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([90432, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3214077949523926  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3429684638977051  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 90432
----------------output nodes number: 12411
----------------edges number: 300034
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3437347412109375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3437347412109375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.35820722579956055  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.35820722579956055  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3603806495666504  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12411, 47])
h_self size  torch.Size([12411, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3603806495666504  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12411, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36255407333374023  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3603806495666504  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12411, 47])
pseudo mini batch 9 input nodes size: 182185
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.09708976745605469  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.16495943069458008  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1650538444519043  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 182185
first layer output nodes number: 82208
edges number: 792791
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.08144140243530273  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([182185, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.08144140243530273  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.08144140243530273  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11827993392944336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11827993392944336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.19667959213256836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([82208, 256])
h_self size  torch.Size([82208, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.19667959213256836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([82208, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.27507925033569336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.19667959213256836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([82208, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.27507925033569336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2946791648864746  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 82208
----------------output nodes number: 12654
----------------edges number: 298793
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.29538631439208984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.29538631439208984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.30977773666381836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.30977773666381836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3129301071166992  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12654, 47])
h_self size  torch.Size([12654, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3129301071166992  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12654, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.31514596939086914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3119935989379883  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12654, 47])
pseudo mini batch 10 input nodes size: 294951
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.07223892211914062  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18211698532104492  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18221139907836914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 294951
first layer output nodes number: 104997
edges number: 1032336
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1275944709777832  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([294951, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1275944709777832  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1275944709777832  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1750941276550293  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1750941276550293  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.27522706985473633  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([104997, 256])
h_self size  torch.Size([104997, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.27522706985473633  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([104997, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.37536001205444336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.27522706985473633  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([104997, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.37536001205444336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4003934860229492  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 104997
----------------output nodes number: 12649
----------------edges number: 312481
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.40127038955688477  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.40127038955688477  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4164237976074219  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4164237976074219  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41875219345092773  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12649, 47])
h_self size  torch.Size([12649, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41875219345092773  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12649, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.42096710205078125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4186387062072754  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12649, 47])
pseudo mini batch 11 input nodes size: 348287
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11342334747314453  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.24317073822021484  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.24326467514038086  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 348287
first layer output nodes number: 123106
edges number: 1220582
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1486644744873047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([348287, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1486644744873047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1486644744873047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.20407819747924805  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.20407819747924805  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.32148122787475586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([123106, 256])
h_self size  torch.Size([123106, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.32148122787475586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([123106, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43888425827026367  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.32148122787475586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([123106, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43888425827026367  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4682350158691406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 123106
----------------output nodes number: 12571
----------------edges number: 312523
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.46924638748168945  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.46924638748168945  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.48432493209838867  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.48432493209838867  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4870729446411133  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12571, 47])
h_self size  torch.Size([12571, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4870729446411133  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4892740249633789  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4865260124206543  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12571, 47])
pseudo mini batch 12 input nodes size: 357249
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1337118148803711  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2667975425720215  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.26688671112060547  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 357249
first layer output nodes number: 111502
edges number: 1081105
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15159893035888672  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([357249, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15159893035888672  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15159893035888672  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.20160818099975586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.20160818099975586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.30794477462768555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([111502, 256])
h_self size  torch.Size([111502, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.30794477462768555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([111502, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41428136825561523  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.30794477462768555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([111502, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41428136825561523  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.44086551666259766  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 111502
----------------output nodes number: 11927
----------------edges number: 289189
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4417858123779297  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4417858123779297  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4557943344116211  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4557943344116211  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4578828811645508  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4578828811645508  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.45997142791748047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4578828811645508  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 13 input nodes size: 266258
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13638591766357422  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.23557519912719727  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.23566818237304688  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 266258
first layer output nodes number: 96683
edges number: 925125
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11471271514892578  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([266258, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11471271514892578  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11471271514892578  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15798377990722656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15798377990722656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.25018787384033203  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([96683, 256])
h_self size  torch.Size([96683, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.25018787384033203  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([96683, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3423919677734375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.25018787384033203  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([96683, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3423919677734375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36544322967529297  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 96683
----------------output nodes number: 12426
----------------edges number: 299690
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3662567138671875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3662567138671875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.38069772720336914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.38069772720336914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.38287353515625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12426, 47])
h_self size  torch.Size([12426, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.38287353515625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12426, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.38504934310913086  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.38287353515625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12426, 47])
pseudo mini batch 14 input nodes size: 266538
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.10258054733276367  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.201873779296875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2019643783569336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 266538
first layer output nodes number: 89607
edges number: 868906
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11403846740722656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([266538, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11403846740722656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11403846740722656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15422868728637695  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15422868728637695  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2396845817565918  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([89607, 256])
h_self size  torch.Size([89607, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2396845817565918  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([89607, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.32514047622680664  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2396845817565918  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([89607, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.32514047622680664  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.34650468826293945  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 89607
----------------output nodes number: 12098
----------------edges number: 292941
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3472633361816406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3472633361816406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3617367744445801  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3617367744445801  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36385536193847656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12098, 47])
h_self size  torch.Size([12098, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36385536193847656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12098, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36597394943237305  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36385536193847656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12098, 47])
pseudo mini batch 15 input nodes size: 314074
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.10262489318847656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21981239318847656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21990680694580078  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 314074
first layer output nodes number: 114974
edges number: 1106270
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13514184951782227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([314074, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13514184951782227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13514184951782227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18735027313232422  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18735027313232422  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2972869873046875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([114974, 256])
h_self size  torch.Size([114974, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2972869873046875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([114974, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4069347381591797  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2969980239868164  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([114974, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4069347381591797  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43405771255493164  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 114974
----------------output nodes number: 12609
----------------edges number: 304692
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4350090026855469  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4350090026855469  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.45035409927368164  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.45035409927368164  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4526243209838867  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12609, 47])
h_self size  torch.Size([12609, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4526243209838867  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12609, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4548320770263672  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4525618553161621  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12609, 47])
Average training time/epoch 1.2514052391052246
Average Training time/epoch w/o nid counting 1.2217962741851807
Number of nodes for computation during this epoch:  6812825
Number of first layer input nodes during this epoch:  5099592
Number of first layer output nodes during this epoch:  1713233

-----------------------------------------------------------------------------epoch done
read pickle file
0.8474609851837158

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.25285816192626953
global_2_local spend time (sec) 0.45139074325561523

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.416 seconds
Metis partitioning: 13.304 seconds
Split the graph: 1.207 seconds
Construct subgraphs: 0.064 seconds
11992
12326
11940
12170
12575
11990
12578
12351
12654
11976
12366
12583
12366
12080
11970
12654
REG metis partition end ----................................
the time spent:  27.483071088790894
REG construction  time spent:  9.469886541366577
pure dgl.metis_partition the time spent:  18.013184547424316
total k batches seeds list generation spend  28.355190992355347
after graph partition
graph partition algorithm spend time 28.94913935661316

partition_len_list
[121326, 88536, 101600, 112240, 119702, 118299, 115056, 123852, 80372, 106484, 90416, 104028, 108492, 98519, 100968, 111709]
REG selection method  spend 29.6000657081604
check_connections_block*********************************
time for parepare 1: 0.2289736270904541
local_output_nid generation: 0.0041217803955078125
local_in_edges_tensor generation: 0.004198551177978516
mini_batch_src_global generation: 0.009988069534301758

&&&&&&&&&&&&&&& before remove duplicate length: 291651
&&&&&&&&&&&&&&& after remove duplicate length: 119367

r_  generation: 0.04960227012634277

local_output_nid generation: 0.004779815673828125
local_in_edges_tensor generation: 0.0041615962982177734
mini_batch_src_global generation: 0.009682178497314453

&&&&&&&&&&&&&&& before remove duplicate length: 291078
&&&&&&&&&&&&&&& after remove duplicate length: 87562

r_  generation: 0.055371761322021484

local_output_nid generation: 0.004694461822509766
local_in_edges_tensor generation: 0.0042188167572021484
mini_batch_src_global generation: 0.0065042972564697266

&&&&&&&&&&&&&&& before remove duplicate length: 283578
&&&&&&&&&&&&&&& after remove duplicate length: 98716

r_  generation: 0.047009944915771484

local_output_nid generation: 0.00482487678527832
local_in_edges_tensor generation: 0.004171609878540039
mini_batch_src_global generation: 0.0069239139556884766

&&&&&&&&&&&&&&& before remove duplicate length: 274906
&&&&&&&&&&&&&&& after remove duplicate length: 108769

r_  generation: 0.05370783805847168

local_output_nid generation: 0.004854440689086914
local_in_edges_tensor generation: 0.004353761672973633
mini_batch_src_global generation: 0.00899505615234375

&&&&&&&&&&&&&&& before remove duplicate length: 311875
&&&&&&&&&&&&&&& after remove duplicate length: 118906

r_  generation: 0.0632777214050293

local_output_nid generation: 0.004735469818115234
local_in_edges_tensor generation: 0.004231691360473633
mini_batch_src_global generation: 0.008806705474853516

&&&&&&&&&&&&&&& before remove duplicate length: 297151
&&&&&&&&&&&&&&& after remove duplicate length: 117029

r_  generation: 0.06312036514282227

local_output_nid generation: 0.004909515380859375
local_in_edges_tensor generation: 0.005326986312866211
mini_batch_src_global generation: 0.01097416877746582

&&&&&&&&&&&&&&& before remove duplicate length: 313781
&&&&&&&&&&&&&&& after remove duplicate length: 114307

r_  generation: 0.06626701354980469

local_output_nid generation: 0.0074310302734375
local_in_edges_tensor generation: 0.004400968551635742
mini_batch_src_global generation: 0.009841442108154297

&&&&&&&&&&&&&&& before remove duplicate length: 307328
&&&&&&&&&&&&&&& after remove duplicate length: 122613

r_  generation: 0.06542515754699707

local_output_nid generation: 0.004876375198364258
local_in_edges_tensor generation: 0.004446983337402344
mini_batch_src_global generation: 0.009607076644897461

&&&&&&&&&&&&&&& before remove duplicate length: 298827
&&&&&&&&&&&&&&& after remove duplicate length: 79231

r_  generation: 0.0437922477722168

local_output_nid generation: 0.004663228988647461
local_in_edges_tensor generation: 0.0050449371337890625
mini_batch_src_global generation: 0.00866389274597168

&&&&&&&&&&&&&&& before remove duplicate length: 292393
&&&&&&&&&&&&&&& after remove duplicate length: 105448

r_  generation: 0.05507969856262207

local_output_nid generation: 0.004798173904418945
local_in_edges_tensor generation: 0.004370450973510742
mini_batch_src_global generation: 0.009317398071289062

&&&&&&&&&&&&&&& before remove duplicate length: 304595
&&&&&&&&&&&&&&& after remove duplicate length: 89852

r_  generation: 0.050296783447265625

local_output_nid generation: 0.0048389434814453125
local_in_edges_tensor generation: 0.00531458854675293
mini_batch_src_global generation: 0.009496450424194336

&&&&&&&&&&&&&&& before remove duplicate length: 309783
&&&&&&&&&&&&&&& after remove duplicate length: 103283

r_  generation: 0.05707836151123047

local_output_nid generation: 0.0047910213470458984
local_in_edges_tensor generation: 0.005129575729370117
mini_batch_src_global generation: 0.009412765502929688

&&&&&&&&&&&&&&& before remove duplicate length: 301065
&&&&&&&&&&&&&&& after remove duplicate length: 107703

r_  generation: 0.057717084884643555

local_output_nid generation: 0.004724264144897461
local_in_edges_tensor generation: 0.0050623416900634766
mini_batch_src_global generation: 0.009505510330200195

&&&&&&&&&&&&&&& before remove duplicate length: 291937
&&&&&&&&&&&&&&& after remove duplicate length: 97835

r_  generation: 0.05470395088195801

local_output_nid generation: 0.00468897819519043
local_in_edges_tensor generation: 0.004187345504760742
mini_batch_src_global generation: 0.008959293365478516

&&&&&&&&&&&&&&& before remove duplicate length: 287766
&&&&&&&&&&&&&&& after remove duplicate length: 99813

r_  generation: 0.05349922180175781

local_output_nid generation: 0.004857063293457031
local_in_edges_tensor generation: 0.005387067794799805
mini_batch_src_global generation: 0.010875463485717773

&&&&&&&&&&&&&&& before remove duplicate length: 306165
&&&&&&&&&&&&&&& after remove duplicate length: 110647

r_  generation: 0.05946922302246094


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7590229511260986
gen group dst list time:  0.050881385803222656
check_connections_block*********************************
time for parepare 1: 0.3644905090332031
local_output_nid generation: 0.031555891036987305
local_in_edges_tensor generation: 0.10689926147460938
mini_batch_src_global generation: 0.03951549530029297

&&&&&&&&&&&&&&& before remove duplicate length: 1193285
&&&&&&&&&&&&&&& after remove duplicate length: 387057

r_  generation: 0.27393198013305664

local_output_nid generation: 0.025937795639038086
local_in_edges_tensor generation: 0.028817415237426758
mini_batch_src_global generation: 0.02939772605895996

&&&&&&&&&&&&&&& before remove duplicate length: 849908
&&&&&&&&&&&&&&& after remove duplicate length: 227006

r_  generation: 0.1750352382659912

local_output_nid generation: 0.0323338508605957
local_in_edges_tensor generation: 0.03872966766357422
mini_batch_src_global generation: 0.04734611511230469

&&&&&&&&&&&&&&& before remove duplicate length: 1001495
&&&&&&&&&&&&&&& after remove duplicate length: 342846

r_  generation: 0.24187779426574707

local_output_nid generation: 0.03363537788391113
local_in_edges_tensor generation: 0.03523063659667969
mini_batch_src_global generation: 0.03521108627319336

&&&&&&&&&&&&&&& before remove duplicate length: 1099788
&&&&&&&&&&&&&&& after remove duplicate length: 370962

r_  generation: 0.3017089366912842

local_output_nid generation: 0.03461956977844238
local_in_edges_tensor generation: 0.031192302703857422
mini_batch_src_global generation: 0.04040050506591797

&&&&&&&&&&&&&&& before remove duplicate length: 1183357
&&&&&&&&&&&&&&& after remove duplicate length: 335048

r_  generation: 0.28113389015197754

local_output_nid generation: 0.03568601608276367
local_in_edges_tensor generation: 0.04123091697692871
mini_batch_src_global generation: 0.03779792785644531

&&&&&&&&&&&&&&& before remove duplicate length: 1171882
&&&&&&&&&&&&&&& after remove duplicate length: 350991

r_  generation: 0.30887603759765625

local_output_nid generation: 0.03358769416809082
local_in_edges_tensor generation: 0.03015613555908203
mini_batch_src_global generation: 0.03910636901855469

&&&&&&&&&&&&&&& before remove duplicate length: 1139136
&&&&&&&&&&&&&&& after remove duplicate length: 264953

r_  generation: 0.2342243194580078

local_output_nid generation: 0.03718733787536621
local_in_edges_tensor generation: 0.03516864776611328
mini_batch_src_global generation: 0.0421907901763916

&&&&&&&&&&&&&&& before remove duplicate length: 1227469
&&&&&&&&&&&&&&& after remove duplicate length: 349920

r_  generation: 0.31084656715393066

local_output_nid generation: 0.0229799747467041
local_in_edges_tensor generation: 0.022841215133666992
mini_batch_src_global generation: 0.029766082763671875

&&&&&&&&&&&&&&& before remove duplicate length: 774558
&&&&&&&&&&&&&&& after remove duplicate length: 167212

r_  generation: 0.14931106567382812

local_output_nid generation: 0.031213760375976562
local_in_edges_tensor generation: 0.030144453048706055
mini_batch_src_global generation: 0.034147024154663086

&&&&&&&&&&&&&&& before remove duplicate length: 1048897
&&&&&&&&&&&&&&& after remove duplicate length: 298500

r_  generation: 0.2302548885345459

local_output_nid generation: 0.026061296463012695
local_in_edges_tensor generation: 0.026772499084472656
mini_batch_src_global generation: 0.03548121452331543

&&&&&&&&&&&&&&& before remove duplicate length: 886533
&&&&&&&&&&&&&&& after remove duplicate length: 246718

r_  generation: 0.20624279975891113

local_output_nid generation: 0.031084537506103516
local_in_edges_tensor generation: 0.027755022048950195
mini_batch_src_global generation: 0.03555464744567871

&&&&&&&&&&&&&&& before remove duplicate length: 1019849
&&&&&&&&&&&&&&& after remove duplicate length: 272831

r_  generation: 0.22852063179016113

local_output_nid generation: 0.03125286102294922
local_in_edges_tensor generation: 0.028783559799194336
mini_batch_src_global generation: 0.03720259666442871

&&&&&&&&&&&&&&& before remove duplicate length: 1055862
&&&&&&&&&&&&&&& after remove duplicate length: 299002

r_  generation: 0.24950838088989258

local_output_nid generation: 0.02942371368408203
local_in_edges_tensor generation: 0.08479428291320801
mini_batch_src_global generation: 0.03509640693664551

&&&&&&&&&&&&&&& before remove duplicate length: 943073
&&&&&&&&&&&&&&& after remove duplicate length: 251173

r_  generation: 0.2140669822692871

local_output_nid generation: 0.03417563438415527
local_in_edges_tensor generation: 0.044557809829711914
mini_batch_src_global generation: 0.03365015983581543

&&&&&&&&&&&&&&& before remove duplicate length: 972952
&&&&&&&&&&&&&&& after remove duplicate length: 298279

r_  generation: 0.23567867279052734

local_output_nid generation: 0.03324460983276367
local_in_edges_tensor generation: 0.03319406509399414
mini_batch_src_global generation: 0.03792977333068848

&&&&&&&&&&&&&&& before remove duplicate length: 1079867
&&&&&&&&&&&&&&& after remove duplicate length: 318624

r_  generation: 0.26320338249206543


connection checking time:  14.627554178237915
block generation total time  12.196777582168579
block dataloader generation time/epoch 57.557904163996376
pseudo mini batch 0 input nodes size: 405822
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.12061119079589844  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.271791934967041  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2718815803527832  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 405822
first layer output nodes number: 121326
edges number: 1193285
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.16966819763183594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([405822, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.16966819763183594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.16966819763183594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.22420883178710938  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.22420883178710938  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.33991432189941406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([121326, 256])
h_self size  torch.Size([121326, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.33991432189941406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([121326, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.45561981201171875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.33991432189941406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([121326, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.45561981201171875  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4845461845397949  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 121326
----------------output nodes number: 11992
----------------edges number: 291651
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.48553991317749023  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.48553991317749023  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4998469352722168  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4998469352722168  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5021390914916992  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11992, 47])
h_self size  torch.Size([11992, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5021390914916992  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11992, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5042390823364258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.5019469261169434  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11992, 47])
pseudo mini batch 1 input nodes size: 241279
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15449285507202148  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.24437665939331055  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.24446868896484375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 241279
first layer output nodes number: 88536
edges number: 849908
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.10427999496459961  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([241279, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.10427999496459961  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.10427999496459961  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.14392471313476562  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.14392471313476562  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.22835922241210938  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([88536, 256])
h_self size  torch.Size([88536, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.22835922241210938  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([88536, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3127937316894531  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.22835922241210938  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([88536, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3127937316894531  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.33390235900878906  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 88536
----------------output nodes number: 12326
----------------edges number: 291078
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3346543312072754  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3346543312072754  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.34931421279907227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.34931421279907227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3514723777770996  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12326, 47])
h_self size  torch.Size([12326, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3514723777770996  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12326, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.35363054275512695  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3514723777770996  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12326, 47])
pseudo mini batch 2 input nodes size: 360411
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.09325647354125977  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.22752046585083008  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.22760963439941406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 360411
first layer output nodes number: 101600
edges number: 1001495
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1519322395324707  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([360411, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1519322395324707  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1519322395324707  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.19849777221679688  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.19849777221679688  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2953910827636719  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([101600, 256])
h_self size  torch.Size([101600, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2953910827636719  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([101600, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3922843933105469  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2953910827636719  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([101600, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3922843933105469  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4165077209472656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 101600
----------------output nodes number: 11940
----------------edges number: 283578
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41735410690307617  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41735410690307617  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43094396591186523  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43094396591186523  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43303489685058594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11940, 47])
h_self size  torch.Size([11940, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43303489685058594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11940, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43512582778930664  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43303489685058594  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11940, 47])
pseudo mini batch 3 input nodes size: 388866
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13756656646728516  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.28243064880371094  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.28252172470092773  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 388866
first layer output nodes number: 112240
edges number: 1099788
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1629042625427246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([388866, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1629042625427246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1629042625427246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21333026885986328  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21333026885986328  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3203706741333008  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([112240, 256])
h_self size  torch.Size([112240, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3203706741333008  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([112240, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4274110794067383  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3203706741333008  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([112240, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4274110794067383  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.45417118072509766  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 112240
----------------output nodes number: 12170
----------------edges number: 274906
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.45509862899780273  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.45509862899780273  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4696221351623535  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4696221351623535  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4717531204223633  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12170, 47])
h_self size  torch.Size([12170, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4717531204223633  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12170, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.47388410568237305  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4717531204223633  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12170, 47])
pseudo mini batch 4 input nodes size: 348659
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1482086181640625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2790679931640625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2791619300842285  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 348659
first layer output nodes number: 119702
edges number: 1183357
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1490612030029297  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([348659, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1490612030029297  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1490612030029297  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2032461166381836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2032461166381836  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.31740283966064453  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([119702, 256])
h_self size  torch.Size([119702, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.31740283966064453  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([119702, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43155956268310547  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.31740283966064453  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([119702, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43155956268310547  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4600987434387207  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 119702
----------------output nodes number: 12575
----------------edges number: 311875
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.46108484268188477  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.46108484268188477  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4763021469116211  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4763021469116211  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4794325828552246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12575, 47])
h_self size  torch.Size([12575, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4794325828552246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12575, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.48163461685180664  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4785041809082031  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12575, 47])
pseudo mini batch 5 input nodes size: 366635
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1352062225341797  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2717885971069336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2718782424926758  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 366635
first layer output nodes number: 118299
edges number: 1171882
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15548467636108398  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([366635, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15548467636108398  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15548467636108398  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21015071868896484  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21015071868896484  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3229694366455078  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([118299, 256])
h_self size  torch.Size([118299, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3229694366455078  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([118299, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4357881546020508  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3229694366455078  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([118299, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4357881546020508  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4639930725097656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 118299
----------------output nodes number: 11990
----------------edges number: 297151
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4649643898010254  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4649643898010254  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.47942399978637695  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.47942399978637695  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.481839656829834  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11990, 47])
h_self size  torch.Size([11990, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.481839656829834  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11990, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.48393917083740234  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4815235137939453  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11990, 47])
pseudo mini batch 6 input nodes size: 275981
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1398940086364746  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2427053451538086  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2427992820739746  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 275981
first layer output nodes number: 115056
edges number: 1139136
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11995792388916016  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([275981, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11995792388916016  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11995792388916016  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1717362403869629  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1717362403869629  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2814621925354004  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([115056, 256])
h_self size  torch.Size([115056, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2814621925354004  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([115056, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3911881446838379  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2814621925354004  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([115056, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3911881446838379  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41861963272094727  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 115056
----------------output nodes number: 12578
----------------edges number: 313781
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4195709228515625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4195709228515625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4348897933959961  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4348897933959961  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43750476837158203  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12578, 47])
h_self size  torch.Size([12578, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43750476837158203  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12578, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4399118423461914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43729686737060547  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12578, 47])
pseudo mini batch 7 input nodes size: 364457
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.10623025894165039  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.24200153350830078  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.24209356307983398  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 364457
first layer output nodes number: 123852
edges number: 1227469
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15454339981079102  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([364457, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15454339981079102  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15454339981079102  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21028947830200195  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21028947830200195  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.32840394973754883  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([123852, 256])
h_self size  torch.Size([123852, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.32840394973754883  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([123852, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4465184211730957  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.32840394973754883  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([123852, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4465184211730957  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4760470390319824  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 123852
----------------output nodes number: 12351
----------------edges number: 307328
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4770622253417969  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4770622253417969  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.49179840087890625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.49179840087890625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4939613342285156  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12351, 47])
h_self size  torch.Size([12351, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4939613342285156  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12351, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.496124267578125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4939613342285156  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12351, 47])
pseudo mini batch 8 input nodes size: 173831
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13914871215820312  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.20390605926513672  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.20400047302246094  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 173831
first layer output nodes number: 80372
edges number: 774558
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.07803010940551758  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([173831, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.07803010940551758  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.07803010940551758  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11404228210449219  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11404228210449219  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1906909942626953  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([80372, 256])
h_self size  torch.Size([80372, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1906909942626953  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([80372, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.26733970642089844  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1906909942626953  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([80372, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.26733970642089844  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.28687095642089844  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 80372
----------------output nodes number: 12654
----------------edges number: 298827
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2875642776489258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2875642776489258  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3020658493041992  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3020658493041992  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.30428171157836914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12654, 47])
h_self size  torch.Size([12654, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.30428171157836914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12654, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3073134422302246  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3050975799560547  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12654, 47])
pseudo mini batch 9 input nodes size: 310999
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.06819009780883789  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18404626846313477  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18413591384887695  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 310999
first layer output nodes number: 106484
edges number: 1048897
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13288164138793945  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([310999, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13288164138793945  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13288164138793945  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18076229095458984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18076229095458984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.28231334686279297  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([106484, 256])
h_self size  torch.Size([106484, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.28231334686279297  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([106484, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3838644027709961  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.28231334686279297  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([106484, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3838644027709961  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4092521667480469  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 106484
----------------output nodes number: 11976
----------------edges number: 292393
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41013526916503906  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41013526916503906  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4249267578125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4249267578125  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4271888732910156  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11976, 47])
h_self size  torch.Size([11976, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4271888732910156  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11976, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.42928600311279297  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.42702388763427734  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11976, 47])
pseudo mini batch 10 input nodes size: 257343
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11916542053222656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21503353118896484  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21512603759765625  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 257343
first layer output nodes number: 90416
edges number: 886533
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11153364181518555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([257343, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11153364181518555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11153364181518555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1521596908569336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1521596908569336  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2383871078491211  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([90416, 256])
h_self size  torch.Size([90416, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2383871078491211  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([90416, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3246145248413086  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2383871078491211  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([90416, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3246145248413086  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.34617137908935547  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 90416
----------------output nodes number: 12366
----------------edges number: 304595
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3469376564025879  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3469376564025879  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36150598526000977  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36150598526000977  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36367130279541016  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12366, 47])
h_self size  torch.Size([12366, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36367130279541016  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12366, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36583662033081055  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.36367130279541016  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12366, 47])
pseudo mini batch 11 input nodes size: 284218
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.09924840927124023  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.20512819290161133  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.20522212982177734  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 284218
first layer output nodes number: 104028
edges number: 1019849
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.12314319610595703  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([284218, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.12314319610595703  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.12314319610595703  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.17041730880737305  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.17041730880737305  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2696261405944824  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([104028, 256])
h_self size  torch.Size([104028, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2696261405944824  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([104028, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3688349723815918  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2696261405944824  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([104028, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3688349723815918  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.39363718032836914  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 104028
----------------output nodes number: 12583
----------------edges number: 309783
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.39450645446777344  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.39450645446777344  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.40976619720458984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.40976619720458984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4119696617126465  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12583, 47])
h_self size  torch.Size([12583, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4119696617126465  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12583, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4143834114074707  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41217994689941406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12583, 47])
pseudo mini batch 12 input nodes size: 312759
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1092996597290039  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2264871597290039  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2265796661376953  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 312759
first layer output nodes number: 108492
edges number: 1055862
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13388729095458984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([312759, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13388729095458984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.13388729095458984  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18314695358276367  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.18314695358276367  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.28661298751831055  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([108492, 256])
h_self size  torch.Size([108492, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.28661298751831055  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([108492, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3900790214538574  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.28661298751831055  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([108492, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3900790214538574  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41594552993774414  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 108492
----------------output nodes number: 12366
----------------edges number: 301065
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41684675216674805  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41684675216674805  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4313349723815918  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4313349723815918  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4335002899169922  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12366, 47])
h_self size  torch.Size([12366, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4335002899169922  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12366, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4356656074523926  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4335002899169922  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12366, 47])
pseudo mini batch 13 input nodes size: 261543
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.12056779861450195  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2180004119873047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21809053421020508  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 261543
first layer output nodes number: 98519
edges number: 943073
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11298513412475586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([261543, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11298513412475586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.11298513412475586  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15731525421142578  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.15731525421142578  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2512702941894531  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([98519, 256])
h_self size  torch.Size([98519, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2512702941894531  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([98519, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.34522533416748047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2512702941894531  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([98519, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.34522533416748047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3687143325805664  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 98519
----------------output nodes number: 12080
----------------edges number: 291937
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3695387840270996  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3695387840270996  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3839292526245117  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3839292526245117  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3864622116088867  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12080, 47])
h_self size  torch.Size([12080, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3864622116088867  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12080, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3885774612426758  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.3860445022583008  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12080, 47])
pseudo mini batch 14 input nodes size: 312210
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.10117816925048828  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21836566925048828  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.21845531463623047  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 312210
first layer output nodes number: 100968
edges number: 972952
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1335296630859375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([312210, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1335296630859375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.1335296630859375  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.17882776260375977  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.17882776260375977  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.275118350982666  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([100968, 256])
h_self size  torch.Size([100968, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.275118350982666  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([100968, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.37140893936157227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.275118350982666  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([100968, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.37140893936157227  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.39548158645629883  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 100968
----------------output nodes number: 11970
----------------edges number: 287766
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.39632368087768555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.39632368087768555  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41084766387939453  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41084766387939453  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41297340393066406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([11970, 47])
h_self size  torch.Size([11970, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41297340393066406  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11970, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.41516637802124023  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4130406379699707  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([11970, 47])
pseudo mini batch 15 input nodes size: 331712
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.12049579620361328  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.24406814575195312  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.24416255950927734  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

first layer input nodes number: 331712
first layer output nodes number: 111709
edges number: 1079867
----------------------------------------before model layer 0
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.14092016220092773  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([331712, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.14092016220092773  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.14092016220092773  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.19099760055541992  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.19099760055541992  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2975316047668457  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([111709, 256])
h_self size  torch.Size([111709, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2975316047668457  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([111709, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4040656089782715  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.2975316047668457  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([111709, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4040656089782715  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.43069934844970703  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------input nodes number: 111709
----------------output nodes number: 12654
----------------edges number: 306165
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4316263198852539  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4316263198852539  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.44606971740722656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.44606971740722656  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4482855796813965  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

h_neigh size torch.Size([12654, 47])
h_self size  torch.Size([12654, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4482855796813965  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12654, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4505014419555664  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4881591796875 GB
    Memory Allocated: 0.4482855796813965  GigaBytes
Max Memory Allocated: 0.7535347938537598  GigaBytes

torch.Size([12654, 47])
Average training time/epoch 1.2422808806101482
Average Training time/epoch w/o nid counting 1.2219538688659668
Number of nodes for computation during this epoch:  6698324
Number of first layer input nodes during this epoch:  4996725
Number of first layer output nodes during this epoch:  1701599

-----------------------------------------------------------------------------epoch done
