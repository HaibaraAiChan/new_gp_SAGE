main start at this time 1661478154.4958065
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
pseudo mini batch 0 input nodes size: 1829322
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 0.6819210052490234  GigaBytes
Max Memory Allocated: 0.6819210052490234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.6833858489990234  GigaBytes
Max Memory Allocated: 0.6833858489990234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7791748046875 GB
    Memory Allocated: 0.6833858489990234  GigaBytes
Max Memory Allocated: 0.6833858489990234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9530029296875 GB
    Memory Allocated: 0.8063907623291016  GigaBytes
Max Memory Allocated: 0.8063907623291016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9530029296875 GB
    Memory Allocated: 0.8063907623291016  GigaBytes
Max Memory Allocated: 0.8063907623291016  GigaBytes

first layer input nodes number: 1829322
first layer output nodes number: 1205785
edges number: 11702596
----------------------------------------before model layer 0
 Nvidia-smi: 8.0311279296875 GB
    Memory Allocated: 0.8290467262268066  GigaBytes
Max Memory Allocated: 0.8726425170898438  GigaBytes

torch.Size([1829322, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0311279296875 GB
    Memory Allocated: 0.8290467262268066  GigaBytes
Max Memory Allocated: 0.8726425170898438  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0311279296875 GB
    Memory Allocated: 0.8290467262268066  GigaBytes
Max Memory Allocated: 0.8726425170898438  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.9373779296875 GB
    Memory Allocated: 1.3699493408203125  GigaBytes
Max Memory Allocated: 1.8236603736877441  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.9373779296875 GB
    Memory Allocated: 1.3699493408203125  GigaBytes
Max Memory Allocated: 1.8236603736877441  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 2.5203399658203125  GigaBytes
Max Memory Allocated: 2.5203399658203125  GigaBytes

h_neigh size torch.Size([1205785, 256])
h_self size  torch.Size([1205785, 100])
----------------------------------------before rst
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 2.5203399658203125  GigaBytes
Max Memory Allocated: 2.5203399658203125  GigaBytes

torch.Size([1205785, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 3.6707305908203125  GigaBytes
Max Memory Allocated: 4.8211212158203125  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 2.5203399658203125  GigaBytes
Max Memory Allocated: 4.8211212158203125  GigaBytes

torch.Size([1205785, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 3.6707305908203125  GigaBytes
Max Memory Allocated: 4.8211212158203125  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 3.958212375640869  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------input nodes number: 1205785
----------------output nodes number: 196571
----------------edges number: 4763879
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 3.9689807891845703  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3885498046875 GB
    Memory Allocated: 3.9689807891845703  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.193848133087158  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.193848133087158  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.228265762329102  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 256])
----------------------------------------before rst
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.228265762329102  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.262683391571045  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.228265762329102  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

torch.Size([196571, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.262683391571045  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3905029296875 GB
    Memory Allocated: 4.297101974487305  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 1.0428543090820312  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 1.0434150695800781  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 1.0434150695800781  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.31728100776672363 |0.4427783489227295 |0.8278067111968994 |0.0002865791320800781 |0.04755282402038574 |0.003141641616821289 |
----------------------------------------------------------pseudo_mini_loss sum 6.257230758666992
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3035107
Number of first layer input nodes during this epoch:  1829322
Number of first layer output nodes during this epoch:  1205785
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 1.04341459274292  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 1.04341459274292  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
pseudo mini batch 0 input nodes size: 1828621
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 1.3998594284057617  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 1.4013242721557617  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 0.7182188034057617  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 0.8408641815185547  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 0.8408641815185547  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

first layer input nodes number: 1828621
first layer output nodes number: 1205023
edges number: 11697236
----------------------------------------before model layer 0
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 0.8634672164916992  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1828621, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 0.8634672164916992  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 0.8634672164916992  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 1.4043269157409668  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 1.4043269157409668  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 2.5535264015197754  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

h_neigh size torch.Size([1205023, 256])
h_self size  torch.Size([1205023, 100])
----------------------------------------before rst
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 2.5535264015197754  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1205023, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 3.702725887298584  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 2.5535264015197754  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1205023, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 3.702725887298584  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 3.9900259971618652  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------input nodes number: 1205023
----------------output nodes number: 196571
----------------edges number: 4763879
----------------------------------------before mean aggregator
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 4.000788688659668  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 4.000788688659668  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 4.225212097167969  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 4.225212097167969  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 4.259629726409912  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 256])
----------------------------------------before rst
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 4.259629726409912  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 4.2940473556518555  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 4.259629726409912  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([196571, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 4.259629726409912  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 4.294048309326172  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.042081356048584  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.042081356048584  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.042081356048584  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2852342128753662 |0.12657666206359863 |0.06623029708862305 |0.0001399517059326172 |0.005504131317138672 |0.0010571479797363281 |
----------------------------------------------------------pseudo_mini_loss sum 3.4147837162017822
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3033644
Number of first layer input nodes during this epoch:  1828621
Number of first layer output nodes during this epoch:  1205023
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.0420808792114258  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.0420808792114258  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.7617795467376709
pseudo mini batch 0 input nodes size: 1828630
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.7182188034057617  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.7182188034057617  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.3998594284057617  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.4013242721557617  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8413071632385254  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8413071632385254  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

first layer input nodes number: 1828630
first layer output nodes number: 1205451
edges number: 11699574
----------------------------------------before model layer 0
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8639135360717773  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1828630, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8639135360717773  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8639135360717773  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.4047918319702148  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.4047918319702148  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 2.555182456970215  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

h_neigh size torch.Size([1205451, 256])
h_self size  torch.Size([1205451, 100])
----------------------------------------before rst
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 2.555182456970215  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1205451, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 3.705573081970215  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 2.555182456970215  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1205451, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 3.705573081970215  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 3.9929752349853516  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------input nodes number: 1205451
----------------output nodes number: 196571
----------------edges number: 4763879
----------------------------------------before mean aggregator
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.003421783447266  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.003421783447266  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.227845191955566  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.227845191955566  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.26226282119751  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 256])
----------------------------------------before rst
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.26226282119751  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.296680450439453  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.26226282119751  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([196571, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.26226282119751  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.2966814041137695  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.042231559753418  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.042231559753418  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.042231559753418  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.26453638076782227 |0.07996034622192383 |0.06466102600097656 |0.0001697540283203125 |0.0031931400299072266 |0.0012431144714355469 |
----------------------------------------------------------pseudo_mini_loss sum 2.0486459732055664
Total (block generation + training)time/epoch 1.27003812789917
Training time/epoch 0.5078847408294678
Training time without block to device /epoch 0.42792439460754395
Training time without total dataloading part /epoch 0.06926703453063965
load block tensor time/epoch 0.26453638076782227
block to device time/epoch 0.07996034622192383
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3034081
Number of first layer input nodes during this epoch:  1828630
Number of first layer output nodes during this epoch:  1205451
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.0422310829162598  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.0422310829162598  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.7636359930038452
pseudo mini batch 0 input nodes size: 1828797
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.3999247550964355  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.4013895988464355  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.7182841300964355  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8409266471862793  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8409266471862793  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

first layer input nodes number: 1828797
first layer output nodes number: 1205102
edges number: 11696870
----------------------------------------before model layer 0
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8635311126708984  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1828797, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8635311126708984  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8635311126708984  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.4043879508972168  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.4043879508972168  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 2.5536627769470215  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

h_neigh size torch.Size([1205102, 256])
h_self size  torch.Size([1205102, 100])
----------------------------------------before rst
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 2.5536627769470215  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1205102, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 3.702937602996826  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 2.5536627769470215  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1205102, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 3.702937602996826  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 3.9902563095092773  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------input nodes number: 1205102
----------------output nodes number: 196571
----------------edges number: 4763879
----------------------------------------before mean aggregator
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.001019477844238  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.001019477844238  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.225442886352539  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.225442886352539  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.259860515594482  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 256])
----------------------------------------before rst
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.259860515594482  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.294278144836426  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.259860515594482  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([196571, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.259860515594482  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.294279098510742  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.0421428680419922  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.0421428680419922  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.0421428680419922  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2460486888885498 |0.09739065170288086 |0.06501984596252441 |0.0005886554718017578 |0.003575563430786133 |0.0020461082458496094 |
----------------------------------------------------------pseudo_mini_loss sum 1.6036854982376099
Total (block generation + training)time/epoch 1.2711337804794312
Training time/epoch 0.5065667629241943
Training time without block to device /epoch 0.4091761112213135
Training time without total dataloading part /epoch 0.07123017311096191
load block tensor time/epoch 0.2460486888885498
block to device time/epoch 0.09739065170288086
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3033899
Number of first layer input nodes during this epoch:  1828797
Number of first layer output nodes during this epoch:  1205102
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.042142391204834  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.042142391204834  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.7642266750335693
pseudo mini batch 0 input nodes size: 1829214
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.7182841300964355  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.7182841300964355  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.3999247550964355  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.4013895988464355  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8413071632385254  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8413071632385254  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

first layer input nodes number: 1829214
first layer output nodes number: 1205475
edges number: 11699466
----------------------------------------before model layer 0
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8639178276062012  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1829214, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8639178276062012  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 0.8639178276062012  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.4047961235046387  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.4047961235046387  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 2.5551867485046387  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

h_neigh size torch.Size([1205475, 256])
h_self size  torch.Size([1205475, 100])
----------------------------------------before rst
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 2.5551867485046387  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1205475, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 3.7055773735046387  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 2.5551867485046387  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([1205475, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 3.7055773735046387  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 3.992985248565674  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------input nodes number: 1205475
----------------output nodes number: 196571
----------------edges number: 4763879
----------------------------------------before mean aggregator
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.003431797027588  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.003431797027588  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.227855205535889  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.227855205535889  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.262272834777832  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

h_neigh size torch.Size([196571, 47])
h_self size  torch.Size([196571, 256])
----------------------------------------before rst
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.262272834777832  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.296690464019775  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.262272834777832  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

torch.Size([196571, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.262272834777832  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 4.296691417694092  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.0422358512878418  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.0422358512878418  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 1.0422358512878418  GigaBytes
Max Memory Allocated: 6.380926609039307  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.25006604194641113 |0.09754276275634766 |0.06442809104919434 |0.000148773193359375 |0.0036585330963134766 |0.0009462833404541016 |
----------------------------------------------------------pseudo_mini_loss sum 1.4578744173049927
Total (block generation + training)time/epoch 1.27279265721639
Training time/epoch 0.5105350017547607
Training time without block to device /epoch 0.4129922389984131
Training time without total dataloading part /epoch 0.06918168067932129
load block tensor time/epoch 0.25006604194641113
block to device time/epoch 0.09754276275634766
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3034689
Number of first layer input nodes during this epoch:  1829214
Number of first layer output nodes during this epoch:  1205475
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  75264
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
