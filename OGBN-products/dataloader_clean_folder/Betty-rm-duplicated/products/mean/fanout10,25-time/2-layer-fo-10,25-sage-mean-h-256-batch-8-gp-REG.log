main start at this time 1660935952.5438044
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.20284605026245117
global_2_local spend time (sec) 0.3663640022277832

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.081 seconds
Metis partitioning: 11.944 seconds
Split the graph: 1.761 seconds
Construct subgraphs: 0.363 seconds
25172
25123
24129
25221
25309
23856
23896
23865
REG metis partition end ----................................
the time spent:  26.113555908203125
REG construction  time spent:  8.942987203598022
pure dgl.metis_partition the time spent:  17.170568704605103
total k batches seeds list generation spend  26.638426303863525
after graph partition
graph partition algorithm spend time 27.28817653656006

partition_len_list
[158480, 205040, 190318, 190503, 214947, 193422, 219469, 214439]
REG selection method  spend 27.82905602455139
check_connections_block*********************************
time for parepare 1: 0.22578144073486328
local_output_nid generation: 0.005898475646972656
local_in_edges_tensor generation: 0.007720232009887695
mini_batch_src_global generation: 0.020761966705322266

&&&&&&&&&&&&&&& before remove duplicate length: 601389
&&&&&&&&&&&&&&& after remove duplicate length: 156676

r_  generation: 0.07651948928833008

local_output_nid generation: 0.00709986686706543
local_in_edges_tensor generation: 0.012259721755981445
mini_batch_src_global generation: 0.019852876663208008

&&&&&&&&&&&&&&& before remove duplicate length: 621744
&&&&&&&&&&&&&&& after remove duplicate length: 203867

r_  generation: 0.11461210250854492

local_output_nid generation: 0.007049560546875
local_in_edges_tensor generation: 0.007344245910644531
mini_batch_src_global generation: 0.017928123474121094

&&&&&&&&&&&&&&& before remove duplicate length: 583893
&&&&&&&&&&&&&&& after remove duplicate length: 188346

r_  generation: 0.11468052864074707

local_output_nid generation: 0.007164955139160156
local_in_edges_tensor generation: 0.009013175964355469
mini_batch_src_global generation: 0.020339250564575195

&&&&&&&&&&&&&&& before remove duplicate length: 608268
&&&&&&&&&&&&&&& after remove duplicate length: 189025

r_  generation: 0.11951398849487305

local_output_nid generation: 0.007128477096557617
local_in_edges_tensor generation: 0.00788569450378418
mini_batch_src_global generation: 0.021469831466674805

&&&&&&&&&&&&&&& before remove duplicate length: 628832
&&&&&&&&&&&&&&& after remove duplicate length: 213357

r_  generation: 0.1509075164794922

local_output_nid generation: 0.006967306137084961
local_in_edges_tensor generation: 0.009439229965209961
mini_batch_src_global generation: 0.023406505584716797

&&&&&&&&&&&&&&& before remove duplicate length: 576223
&&&&&&&&&&&&&&& after remove duplicate length: 191300

r_  generation: 0.13711261749267578

local_output_nid generation: 0.008194923400878906
local_in_edges_tensor generation: 0.030099153518676758
mini_batch_src_global generation: 0.021725177764892578

&&&&&&&&&&&&&&& before remove duplicate length: 559519
&&&&&&&&&&&&&&& after remove duplicate length: 213870

r_  generation: 0.14464473724365234

local_output_nid generation: 0.008410215377807617
local_in_edges_tensor generation: 0.009862661361694336
mini_batch_src_global generation: 0.02295970916748047

&&&&&&&&&&&&&&& before remove duplicate length: 584011
&&&&&&&&&&&&&&& after remove duplicate length: 211821

r_  generation: 0.14311861991882324


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7412776947021484
gen group dst list time:  0.04488110542297363
check_connections_block*********************************
time for parepare 1: 0.37885594367980957
local_output_nid generation: 0.03378582000732422
local_in_edges_tensor generation: 0.09850192070007324
mini_batch_src_global generation: 0.048818349838256836

&&&&&&&&&&&&&&& before remove duplicate length: 1531827
&&&&&&&&&&&&&&& after remove duplicate length: 335355

r_  generation: 0.25539445877075195

local_output_nid generation: 0.05242347717285156
local_in_edges_tensor generation: 0.06974291801452637
mini_batch_src_global generation: 0.054509878158569336

&&&&&&&&&&&&&&& before remove duplicate length: 2022303
&&&&&&&&&&&&&&& after remove duplicate length: 457371

r_  generation: 0.3892240524291992

local_output_nid generation: 0.07789921760559082
local_in_edges_tensor generation: 0.07431602478027344
mini_batch_src_global generation: 0.04886770248413086

&&&&&&&&&&&&&&& before remove duplicate length: 1839272
&&&&&&&&&&&&&&& after remove duplicate length: 502627

r_  generation: 0.41637563705444336

local_output_nid generation: 0.05003499984741211
local_in_edges_tensor generation: 0.04528522491455078
mini_batch_src_global generation: 0.05350804328918457

&&&&&&&&&&&&&&& before remove duplicate length: 1819280
&&&&&&&&&&&&&&& after remove duplicate length: 432008

r_  generation: 0.4167516231536865

local_output_nid generation: 0.05883526802062988
local_in_edges_tensor generation: 0.06767845153808594
mini_batch_src_global generation: 0.07255983352661133

&&&&&&&&&&&&&&& before remove duplicate length: 2126050
&&&&&&&&&&&&&&& after remove duplicate length: 484440

r_  generation: 0.46469950675964355

local_output_nid generation: 0.051589012145996094
local_in_edges_tensor generation: 0.0879831314086914
mini_batch_src_global generation: 0.07837533950805664

&&&&&&&&&&&&&&& before remove duplicate length: 1884661
&&&&&&&&&&&&&&& after remove duplicate length: 508515

r_  generation: 0.44153285026550293

local_output_nid generation: 0.07529401779174805
local_in_edges_tensor generation: 0.06022906303405762
mini_batch_src_global generation: 0.07511305809020996

&&&&&&&&&&&&&&& before remove duplicate length: 2160109
&&&&&&&&&&&&&&& after remove duplicate length: 625538

r_  generation: 0.5485785007476807

local_output_nid generation: 0.06091451644897461
local_in_edges_tensor generation: 0.0603175163269043
mini_batch_src_global generation: 0.07306647300720215

&&&&&&&&&&&&&&& before remove duplicate length: 2117184
&&&&&&&&&&&&&&& after remove duplicate length: 541244

r_  generation: 0.4988291263580322


connection checking time:  14.038769006729126
block generation total time  13.443698644638062
pseudo mini batch 0 input nodes size: 349525
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2088623046875 GB
    Memory Allocated: 0.13113975524902344  GigaBytes
Max Memory Allocated: 0.13113975524902344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2088623046875 GB
    Memory Allocated: 0.13132762908935547  GigaBytes
Max Memory Allocated: 0.13132762908935547  GigaBytes

first layer input nodes number: 349525
first layer output nodes number: 158480
edges number: 1531827
----------------------------------------before model layer 0
 Nvidia-smi: 7.3123779296875 GB
    Memory Allocated: 0.15100812911987305  GigaBytes
Max Memory Allocated: 0.15671491622924805  GigaBytes

torch.Size([349525, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.3123779296875 GB
    Memory Allocated: 0.15100812911987305  GigaBytes
Max Memory Allocated: 0.15671491622924805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.3123779296875 GB
    Memory Allocated: 0.15100812911987305  GigaBytes
Max Memory Allocated: 0.15671491622924805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6971435546875 GB
    Memory Allocated: 0.22205114364624023  GigaBytes
Max Memory Allocated: 0.2816805839538574  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6971435546875 GB
    Memory Allocated: 0.22205114364624023  GigaBytes
Max Memory Allocated: 0.2816805839538574  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8494873046875 GB
    Memory Allocated: 0.37318944931030273  GigaBytes
Max Memory Allocated: 0.37318944931030273  GigaBytes

h_neigh size torch.Size([158480, 256])
h_self size  torch.Size([158480, 100])
----------------------------------------before rst
 Nvidia-smi: 7.8494873046875 GB
    Memory Allocated: 0.37318944931030273  GigaBytes
Max Memory Allocated: 0.37318944931030273  GigaBytes

torch.Size([158480, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5243277549743652  GigaBytes
Max Memory Allocated: 0.6754660606384277  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.37318944931030273  GigaBytes
Max Memory Allocated: 0.6754660606384277  GigaBytes

torch.Size([158480, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5243277549743652  GigaBytes
Max Memory Allocated: 0.6754660606384277  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5621123313903809  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------input nodes number: 158480
----------------output nodes number: 25172
----------------edges number: 601389
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5635056495666504  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5635056495666504  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5921807289123535  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.5921807289123535  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.596588134765625  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

h_neigh size torch.Size([25172, 47])
h_self size  torch.Size([25172, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.596588134765625  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

torch.Size([25172, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.6009955406188965  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.596588134765625  GigaBytes
Max Memory Allocated: 0.7132506370544434  GigaBytes

torch.Size([25172, 47])
pseudo mini batch 1 input nodes size: 475486
----------------------------------------before batch input features to device
 Nvidia-smi: 8.4666748046875 GB
    Memory Allocated: 0.1360163688659668  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.6444091796875 GB
    Memory Allocated: 0.3137507438659668  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.6444091796875 GB
    Memory Allocated: 0.3139381408691406  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

first layer input nodes number: 475486
first layer output nodes number: 205040
edges number: 2022303
----------------------------------------before model layer 0
 Nvidia-smi: 8.6444091796875 GB
    Memory Allocated: 0.20945501327514648  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

torch.Size([475486, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.6444091796875 GB
    Memory Allocated: 0.20945501327514648  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.6444091796875 GB
    Memory Allocated: 0.20945501327514648  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.30167055130004883  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.6639404296875 GB
    Memory Allocated: 0.30167055130004883  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8612060546875 GB
    Memory Allocated: 0.49721193313598633  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

h_neigh size torch.Size([205040, 256])
h_self size  torch.Size([205040, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8612060546875 GB
    Memory Allocated: 0.49721193313598633  GigaBytes
Max Memory Allocated: 0.8806591033935547  GigaBytes

torch.Size([205040, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.6927533149719238  GigaBytes
Max Memory Allocated: 0.8882946968078613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.49721193313598633  GigaBytes
Max Memory Allocated: 0.8882946968078613  GigaBytes

torch.Size([205040, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.6927533149719238  GigaBytes
Max Memory Allocated: 0.8882946968078613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7416386604309082  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------input nodes number: 205040
----------------output nodes number: 25123
----------------edges number: 621744
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7435503005981445  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7435503005981445  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7724099159240723  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7724099159240723  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7768087387084961  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

h_neigh size torch.Size([25123, 47])
h_self size  torch.Size([25123, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7768087387084961  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

torch.Size([25123, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7812075614929199  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2557373046875 GB
    Memory Allocated: 0.7768087387084961  GigaBytes
Max Memory Allocated: 0.9371800422668457  GigaBytes

torch.Size([25123, 47])
pseudo mini batch 2 input nodes size: 525526
----------------------------------------before batch input features to device
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.18288230895996094  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.37865638732910156  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.37883663177490234  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

first layer input nodes number: 525526
first layer output nodes number: 190318
edges number: 1839272
----------------------------------------before model layer 0
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.2253279685974121  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([525526, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.2253279685974121  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.2253279685974121  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.3106403350830078  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.3106403350830078  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.4921417236328125  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([190318, 256])
h_self size  torch.Size([190318, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.4921417236328125  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([190318, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.6736431121826172  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.4921417236328125  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([190318, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.6736431121826172  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7190184593200684  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------input nodes number: 190318
----------------output nodes number: 24129
----------------edges number: 583893
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7206168174743652  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7206168174743652  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7488889694213867  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7488889694213867  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7531137466430664  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([24129, 47])
h_self size  torch.Size([24129, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7531137466430664  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([24129, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7573432922363281  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4979248046875 GB
    Memory Allocated: 0.7531185150146484  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([24129, 47])
pseudo mini batch 3 input nodes size: 450391
----------------------------------------before batch input features to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.20074081420898438  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.36852455139160156  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.3687129020690918  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

first layer input nodes number: 450391
first layer output nodes number: 190503
edges number: 1819280
----------------------------------------before model layer 0
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.1959538459777832  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([450391, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.1959538459777832  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.1959538459777832  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.2811875343322754  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.2811875343322754  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.46286535263061523  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([190503, 256])
h_self size  torch.Size([190503, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.46286535263061523  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([190503, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.6445431709289551  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.46286535263061523  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([190503, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.6445431709289551  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.6899628639221191  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------input nodes number: 190503
----------------output nodes number: 25221
----------------edges number: 608268
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.6922130584716797  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.6922130584716797  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7213954925537109  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7213954925537109  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7263364791870117  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([25221, 47])
h_self size  torch.Size([25221, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7263364791870117  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([25221, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7307524681091309  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.7258114814758301  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([25221, 47])
pseudo mini batch 4 input nodes size: 504209
----------------------------------------before batch input features to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.17294979095458984  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.3607826232910156  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.36097145080566406  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

first layer input nodes number: 504209
first layer output nodes number: 214947
edges number: 2126050
----------------------------------------before model layer 0
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.21898937225341797  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([504209, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.21898937225341797  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6795654296875 GB
    Memory Allocated: 0.21898937225341797  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6815185546875 GB
    Memory Allocated: 0.3157052993774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6815185546875 GB
    Memory Allocated: 0.3157052993774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.8865966796875 GB
    Memory Allocated: 0.5207834243774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([214947, 256])
h_self size  torch.Size([214947, 100])
----------------------------------------before rst
 Nvidia-smi: 9.8865966796875 GB
    Memory Allocated: 0.5207834243774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([214947, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7258615493774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.5207834243774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([214947, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7258615493774414  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7771091461181641  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------input nodes number: 214947
----------------output nodes number: 25309
----------------edges number: 628832
----------------------------------------before mean aggregator
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7789726257324219  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.7789726257324219  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8079833984375  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8079833984375  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8124151229858398  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

h_neigh size torch.Size([25309, 47])
h_self size  torch.Size([25309, 256])
----------------------------------------before rst
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8124151229858398  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([25309, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8172826766967773  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.2967529296875 GB
    Memory Allocated: 0.8128509521484375  GigaBytes
Max Memory Allocated: 1.1457114219665527  GigaBytes

torch.Size([25309, 47])
pseudo mini batch 5 input nodes size: 536246
----------------------------------------before batch input features to device
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.19301509857177734  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.39278268814086914  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.3929605484008789  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

first layer input nodes number: 536246
first layer output nodes number: 193422
edges number: 1884661
----------------------------------------before model layer 0
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.22981786727905273  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([536246, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.22981786727905273  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.22981786727905273  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.3166360855102539  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.3166360855102539  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.5010976791381836  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

h_neigh size torch.Size([193422, 256])
h_self size  torch.Size([193422, 100])
----------------------------------------before rst
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.5010976791381836  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([193422, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.6855592727661133  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.5010976791381836  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([193422, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.6855592727661133  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7316746711730957  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------input nodes number: 193422
----------------output nodes number: 23856
----------------edges number: 576223
----------------------------------------before mean aggregator
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7332940101623535  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7332940101623535  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7613554000854492  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7613554000854492  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7655324935913086  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

h_neigh size torch.Size([23856, 47])
h_self size  torch.Size([23856, 256])
----------------------------------------before rst
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7655324935913086  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([23856, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.769709587097168  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.7655324935913086  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([23856, 47])
pseudo mini batch 6 input nodes size: 654835
----------------------------------------before batch input features to device
 Nvidia-smi: 10.5096435546875 GB
    Memory Allocated: 0.20468425750732422  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.7537841796875 GB
    Memory Allocated: 0.4488248825073242  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.7537841796875 GB
    Memory Allocated: 0.4490032196044922  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

first layer input nodes number: 654835
first layer output nodes number: 219469
edges number: 2160109
----------------------------------------before model layer 0
 Nvidia-smi: 10.7537841796875 GB
    Memory Allocated: 0.2758359909057617  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([654835, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 10.7537841796875 GB
    Memory Allocated: 0.2758359909057617  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.7537841796875 GB
    Memory Allocated: 0.2758359909057617  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.7557373046875 GB
    Memory Allocated: 0.37450695037841797  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.7557373046875 GB
    Memory Allocated: 0.37450695037841797  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.9666748046875 GB
    Memory Allocated: 0.5838088989257812  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

h_neigh size torch.Size([219469, 256])
h_self size  torch.Size([219469, 100])
----------------------------------------before rst
 Nvidia-smi: 10.9666748046875 GB
    Memory Allocated: 0.5838088989257812  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([219469, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.7931108474731445  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.5838088989257812  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([219469, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.7931108474731445  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8454365730285645  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------input nodes number: 219469
----------------output nodes number: 23896
----------------edges number: 559519
----------------------------------------before mean aggregator
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8472504615783691  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8472504615783691  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8751873970031738  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8751873970031738  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8793716430664062  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

h_neigh size torch.Size([23896, 47])
h_self size  torch.Size([23896, 256])
----------------------------------------before rst
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8793716430664062  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([23896, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8835558891296387  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.3885498046875 GB
    Memory Allocated: 0.8793716430664062  GigaBytes
Max Memory Allocated: 1.1995935440063477  GigaBytes

torch.Size([23896, 47])
pseudo mini batch 7 input nodes size: 564819
----------------------------------------before batch input features to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.24906492233276367  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.46000242233276367  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.46018028259277344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 564819
first layer output nodes number: 214439
edges number: 2117184
----------------------------------------before model layer 0
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.24292707443237305  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([564819, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.24292707443237305  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.24292707443237305  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.339385986328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.339385986328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.544464111328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([214439, 256])
h_self size  torch.Size([214439, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.544464111328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([214439, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.749542236328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.544464111328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([214439, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.749542236328125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8006687164306641  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 214439
----------------output nodes number: 23865
----------------edges number: 584011
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8024444580078125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8024444580078125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8297915458679199  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8297915458679199  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8339700698852539  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([23865, 47])
h_self size  torch.Size([23865, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8339700698852539  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23865, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8381485939025879  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.8339700698852539  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23865, 47])
Number of nodes for computation during this epoch:  5647655
Number of first layer input nodes during this epoch:  4061037
Number of first layer output nodes during this epoch:  1586618

-----------------------------------------------------------------------------epoch done
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.3235018253326416
global_2_local spend time (sec) 0.4086952209472656

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.466 seconds
Metis partitioning: 12.441 seconds
Split the graph: 1.880 seconds
Construct subgraphs: 0.103 seconds
23959
25194
24981
24126
25004
25297
23894
24116
REG metis partition end ----................................
the time spent:  26.93142294883728
REG construction  time spent:  9.019140481948853
pure dgl.metis_partition the time spent:  17.912282466888428
total k batches seeds list generation spend  27.620633125305176
after graph partition
graph partition algorithm spend time 28.26181387901306

partition_len_list
[167315, 188376, 223123, 204767, 206844, 158145, 201917, 199665]
REG selection method  spend 28.88052749633789
check_connections_block*********************************
time for parepare 1: 0.22608709335327148
local_output_nid generation: 0.006161928176879883
local_in_edges_tensor generation: 0.00733494758605957
mini_batch_src_global generation: 0.020753860473632812

&&&&&&&&&&&&&&& before remove duplicate length: 582205
&&&&&&&&&&&&&&& after remove duplicate length: 166058

r_  generation: 0.07692480087280273

local_output_nid generation: 0.007470130920410156
local_in_edges_tensor generation: 0.007259845733642578
mini_batch_src_global generation: 0.021090269088745117

&&&&&&&&&&&&&&& before remove duplicate length: 605852
&&&&&&&&&&&&&&& after remove duplicate length: 186717

r_  generation: 0.11023783683776855

local_output_nid generation: 0.007485389709472656
local_in_edges_tensor generation: 0.007455110549926758
mini_batch_src_global generation: 0.019623279571533203

&&&&&&&&&&&&&&& before remove duplicate length: 617194
&&&&&&&&&&&&&&& after remove duplicate length: 221834

r_  generation: 0.13440346717834473

local_output_nid generation: 0.007365226745605469
local_in_edges_tensor generation: 0.007307767868041992
mini_batch_src_global generation: 0.020429611206054688

&&&&&&&&&&&&&&& before remove duplicate length: 599927
&&&&&&&&&&&&&&& after remove duplicate length: 203253

r_  generation: 0.1267077922821045

local_output_nid generation: 0.010074853897094727
local_in_edges_tensor generation: 0.009519338607788086
mini_batch_src_global generation: 0.021864652633666992

&&&&&&&&&&&&&&& before remove duplicate length: 620841
&&&&&&&&&&&&&&& after remove duplicate length: 205743

r_  generation: 0.13533830642700195

local_output_nid generation: 0.007475614547729492
local_in_edges_tensor generation: 0.007199287414550781
mini_batch_src_global generation: 0.02393031120300293

&&&&&&&&&&&&&&& before remove duplicate length: 604012
&&&&&&&&&&&&&&& after remove duplicate length: 156326

r_  generation: 0.10216259956359863

local_output_nid generation: 0.007132053375244141
local_in_edges_tensor generation: 0.007031917572021484
mini_batch_src_global generation: 0.0213623046875

&&&&&&&&&&&&&&& before remove duplicate length: 572904
&&&&&&&&&&&&&&& after remove duplicate length: 198946

r_  generation: 0.14449381828308105

local_output_nid generation: 0.00759124755859375
local_in_edges_tensor generation: 0.00955510139465332
mini_batch_src_global generation: 0.021272659301757812

&&&&&&&&&&&&&&& before remove duplicate length: 560944
&&&&&&&&&&&&&&& after remove duplicate length: 194330

r_  generation: 0.12778425216674805


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7632830142974854
gen group dst list time:  0.05051565170288086
check_connections_block*********************************
time for parepare 1: 0.38272643089294434
local_output_nid generation: 0.04433178901672363
local_in_edges_tensor generation: 0.11701202392578125
mini_batch_src_global generation: 0.05097031593322754

&&&&&&&&&&&&&&& before remove duplicate length: 1613710
&&&&&&&&&&&&&&& after remove duplicate length: 407336

r_  generation: 0.3241696357727051

local_output_nid generation: 0.048629045486450195
local_in_edges_tensor generation: 0.09530496597290039
mini_batch_src_global generation: 0.057485342025756836

&&&&&&&&&&&&&&& before remove duplicate length: 1798474
&&&&&&&&&&&&&&& after remove duplicate length: 428812

r_  generation: 0.3951990604400635

local_output_nid generation: 0.08409738540649414
local_in_edges_tensor generation: 0.06918025016784668
mini_batch_src_global generation: 0.06294584274291992

&&&&&&&&&&&&&&& before remove duplicate length: 2198134
&&&&&&&&&&&&&&& after remove duplicate length: 527216

r_  generation: 0.46178245544433594

local_output_nid generation: 0.056329965591430664
local_in_edges_tensor generation: 0.05892348289489746
mini_batch_src_global generation: 0.06069755554199219

&&&&&&&&&&&&&&& before remove duplicate length: 2025629
&&&&&&&&&&&&&&& after remove duplicate length: 474042

r_  generation: 0.4428896903991699

local_output_nid generation: 0.05504035949707031
local_in_edges_tensor generation: 0.05256342887878418
mini_batch_src_global generation: 0.06368589401245117

&&&&&&&&&&&&&&& before remove duplicate length: 2047071
&&&&&&&&&&&&&&& after remove duplicate length: 465314

r_  generation: 0.4567122459411621

local_output_nid generation: 0.04935932159423828
local_in_edges_tensor generation: 0.11788010597229004
mini_batch_src_global generation: 0.07434940338134766

&&&&&&&&&&&&&&& before remove duplicate length: 1527713
&&&&&&&&&&&&&&& after remove duplicate length: 332688

r_  generation: 0.30965399742126465

local_output_nid generation: 0.06339859962463379
local_in_edges_tensor generation: 0.06648516654968262
mini_batch_src_global generation: 0.06457257270812988

&&&&&&&&&&&&&&& before remove duplicate length: 1964312
&&&&&&&&&&&&&&& after remove duplicate length: 561928

r_  generation: 0.4788978099822998

local_output_nid generation: 0.0555877685546875
local_in_edges_tensor generation: 0.052622318267822266
mini_batch_src_global generation: 0.06979560852050781

&&&&&&&&&&&&&&& before remove duplicate length: 1964363
&&&&&&&&&&&&&&& after remove duplicate length: 547289

r_  generation: 0.4949493408203125


connection checking time:  13.867146730422974
block generation total time  12.19593095779419
pseudo mini batch 0 input nodes size: 425568
----------------------------------------before batch input features to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.2164154052734375  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.3749518394470215  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.37513065338134766  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 425568
first layer output nodes number: 167315
edges number: 1613710
----------------------------------------before model layer 0
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.18500185012817383  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([425568, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.18500185012817383  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.18500185012817383  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.259979248046875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.259979248046875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.4195432662963867  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([167315, 256])
h_self size  torch.Size([167315, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.4195432662963867  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([167315, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.5791072845458984  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.4195432662963867  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([167315, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.5791072845458984  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6189985275268555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 167315
----------------output nodes number: 23959
----------------edges number: 582205
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6210527420043945  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6210527420043945  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6484193801879883  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6484193801879883  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6526145935058594  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([23959, 47])
h_self size  torch.Size([23959, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6526145935058594  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23959, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6568098068237305  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6526145935058594  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23959, 47])
pseudo mini batch 1 input nodes size: 447214
----------------------------------------before batch input features to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.1640329360961914  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.33063316345214844  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.33082103729248047  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 447214
first layer output nodes number: 188376
edges number: 1798474
----------------------------------------before model layer 0
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.19478988647460938  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([447214, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.19478988647460938  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.19478988647460938  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.2790675163269043  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.2790675163269043  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.45871686935424805  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([188376, 256])
h_self size  torch.Size([188376, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.45871686935424805  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([188376, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6383662223815918  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.45871686935424805  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([188376, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6383662223815918  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6832785606384277  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 188376
----------------output nodes number: 25194
----------------edges number: 605852
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6851530075073242  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.6851530075073242  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.7138824462890625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.7138824462890625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.7182936668395996  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25194, 47])
h_self size  torch.Size([25194, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.7182936668395996  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25194, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.7227048873901367  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.7182936668395996  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25194, 47])
pseudo mini batch 2 input nodes size: 548394
----------------------------------------before batch input features to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.17232179641723633  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.37739992141723633  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.37758636474609375  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 548394
first layer output nodes number: 223123
edges number: 2198134
----------------------------------------before model layer 0
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.23752307891845703  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([548394, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.23752307891845703  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6053466796875 GB
    Memory Allocated: 0.23752307891845703  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6092529296875 GB
    Memory Allocated: 0.33785200119018555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6092529296875 GB
    Memory Allocated: 0.33785200119018555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6092529296875 GB
    Memory Allocated: 0.5506386756896973  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([223123, 256])
h_self size  torch.Size([223123, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6092529296875 GB
    Memory Allocated: 0.5506386756896973  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([223123, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.7635293006896973  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.5507426261901855  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([223123, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.7636332511901855  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.8167262077331543  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 223123
----------------output nodes number: 24981
----------------edges number: 617194
----------------------------------------before mean aggregator
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.818575382232666  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.818575382232666  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.8471846580505371  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.8471846580505371  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.8515586853027344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24981, 47])
h_self size  torch.Size([24981, 256])
----------------------------------------before rst
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.8515586853027344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.8559327125549316  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.0350341796875 GB
    Memory Allocated: 0.8515586853027344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24981, 47])
pseudo mini batch 3 input nodes size: 493164
----------------------------------------before batch input features to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.21076107025146484  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.39447927474975586  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.39465904235839844  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 493164
first layer output nodes number: 204767
edges number: 2025629
----------------------------------------before model layer 0
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.214569091796875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([493164, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.214569091796875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.214569091796875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.30670690536499023  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.30670690536499023  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5019879341125488  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([204767, 256])
h_self size  torch.Size([204767, 100])
----------------------------------------before rst
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5019879341125488  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([204767, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.6972689628601074  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5019879341125488  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([204767, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.6972689628601074  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7460894584655762  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 204767
----------------output nodes number: 24126
----------------edges number: 599927
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7481703758239746  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7481703758239746  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7758288383483887  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7758288383483887  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7800531387329102  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24126, 47])
h_self size  torch.Size([24126, 256])
----------------------------------------before rst
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7800531387329102  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24126, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7842774391174316  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7800531387329102  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24126, 47])
pseudo mini batch 4 input nodes size: 483541
----------------------------------------before batch input features to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.18924474716186523  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.36937808990478516  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.3695645332336426  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 483541
first layer output nodes number: 206844
edges number: 2047071
----------------------------------------before model layer 0
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.21092748641967773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([483541, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.21092748641967773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.21092748641967773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.30400562286376953  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.30400562286376953  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5012712478637695  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([206844, 256])
h_self size  torch.Size([206844, 100])
----------------------------------------before rst
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5012712478637695  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([206844, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.6985368728637695  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5012712478637695  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([206844, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.6985368728637695  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7487778663635254  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 206844
----------------output nodes number: 25004
----------------edges number: 620841
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7507438659667969  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7507438659667969  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7795681953430176  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7795681953430176  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7839465141296387  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25004, 47])
h_self size  torch.Size([25004, 256])
----------------------------------------before rst
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7839465141296387  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25004, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7883248329162598  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7839465141296387  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25004, 47])
pseudo mini batch 5 input nodes size: 346405
----------------------------------------before batch input features to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.1858205795288086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.3148665428161621  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.31505537033081055  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 346405
first layer output nodes number: 158145
edges number: 1527713
----------------------------------------before model layer 0
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.15493154525756836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([346405, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.15493154525756836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.15493154525756836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.22615337371826172  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.22615337371826172  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.3769721984863281  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([158145, 256])
h_self size  torch.Size([158145, 100])
----------------------------------------before rst
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.3769721984863281  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([158145, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5277910232543945  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.3769721984863281  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([158145, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5277910232543945  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5654959678649902  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 158145
----------------output nodes number: 25297
----------------edges number: 604012
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5672097206115723  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5672097206115723  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5960240364074707  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5960240364074707  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.6004533767700195  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25297, 47])
h_self size  torch.Size([25297, 256])
----------------------------------------before rst
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.6004533767700195  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25297, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.6048827171325684  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.6004533767700195  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25297, 47])
pseudo mini batch 6 input nodes size: 593665
----------------------------------------before batch input features to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.13478660583496094  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.3559441566467285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.3561224937438965  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 593665
first layer output nodes number: 201917
edges number: 1964312
----------------------------------------before model layer 0
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.25240182876586914  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([593665, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.25240182876586914  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.25240182876586914  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.34301042556762695  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.34301042556762695  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5355734825134277  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([201917, 256])
h_self size  torch.Size([201917, 100])
----------------------------------------before rst
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5355734825134277  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([201917, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7281365394592285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.5355734825134277  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([201917, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7281365394592285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7763867378234863  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 201917
----------------output nodes number: 23894
----------------edges number: 572904
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7780694961547852  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.7780694961547852  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.8053035736083984  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.8053035736083984  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.8101987838745117  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([23894, 47])
h_self size  torch.Size([23894, 256])
----------------------------------------before rst
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.8101987838745117  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23894, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.8143825531005859  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.8094873428344727  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23894, 47])
pseudo mini batch 7 input nodes size: 573414
----------------------------------------before batch input features to device
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.22735357284545898  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.4409670829772949  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.4411468505859375  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 573414
first layer output nodes number: 199665
edges number: 1964363
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2447361946105957  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([573414, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2447361946105957  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2447361946105957  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.33449745178222656  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.33449745178222656  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5249128341674805  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([199665, 256])
h_self size  torch.Size([199665, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5249128341674805  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([199665, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7153282165527344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5249128341674805  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([199665, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7153282165527344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.762932300567627  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 199665
----------------output nodes number: 24116
----------------edges number: 560944
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7645998001098633  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7645998001098633  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.792121410369873  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.792121410369873  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7963442802429199  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24116, 47])
h_self size  torch.Size([24116, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7963442802429199  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24116, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8005671501159668  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7963442802429199  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24116, 47])
Number of nodes for computation during this epoch:  5461517
Number of first layer input nodes during this epoch:  3911365
Number of first layer output nodes during this epoch:  1550152

-----------------------------------------------------------------------------epoch done
read pickle file
0.7072386741638184

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2944796085357666
global_2_local spend time (sec) 0.4416825771331787

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.154 seconds
Metis partitioning: 12.514 seconds
Split the graph: 1.778 seconds
Construct subgraphs: 0.053 seconds
23856
23861
25237
24468
23878
25171
24931
25169
REG metis partition end ----................................
the time spent:  26.439775228500366
REG construction  time spent:  8.919217824935913
pure dgl.metis_partition the time spent:  17.520557403564453
total k batches seeds list generation spend  27.096315145492554
after graph partition
graph partition algorithm spend time 27.75722599029541

partition_len_list
[151848, 208049, 188440, 173611, 208709, 220937, 206785, 202901]
REG selection method  spend 28.398447275161743
check_connections_block*********************************
time for parepare 1: 0.22785305976867676
local_output_nid generation: 0.006292819976806641
local_in_edges_tensor generation: 0.007443904876708984
mini_batch_src_global generation: 0.018634796142578125

&&&&&&&&&&&&&&& before remove duplicate length: 568398
&&&&&&&&&&&&&&& after remove duplicate length: 149982

r_  generation: 0.07298731803894043

local_output_nid generation: 0.007466793060302734
local_in_edges_tensor generation: 0.007076740264892578
mini_batch_src_global generation: 0.02582097053527832

&&&&&&&&&&&&&&& before remove duplicate length: 588914
&&&&&&&&&&&&&&& after remove duplicate length: 206541

r_  generation: 0.11536979675292969

local_output_nid generation: 0.007716655731201172
local_in_edges_tensor generation: 0.009050846099853516
mini_batch_src_global generation: 0.017020463943481445

&&&&&&&&&&&&&&& before remove duplicate length: 609253
&&&&&&&&&&&&&&& after remove duplicate length: 187040

r_  generation: 0.11826324462890625

local_output_nid generation: 0.007530927658081055
local_in_edges_tensor generation: 0.008051633834838867
mini_batch_src_global generation: 0.017910003662109375

&&&&&&&&&&&&&&& before remove duplicate length: 594455
&&&&&&&&&&&&&&& after remove duplicate length: 172209

r_  generation: 0.10421395301818848

local_output_nid generation: 0.007537364959716797
local_in_edges_tensor generation: 0.015600204467773438
mini_batch_src_global generation: 0.016632556915283203

&&&&&&&&&&&&&&& before remove duplicate length: 554601
&&&&&&&&&&&&&&& after remove duplicate length: 203096

r_  generation: 0.12596654891967773

local_output_nid generation: 0.007798433303833008
local_in_edges_tensor generation: 0.008713483810424805
mini_batch_src_global generation: 0.020229339599609375

&&&&&&&&&&&&&&& before remove duplicate length: 619025
&&&&&&&&&&&&&&& after remove duplicate length: 218584

r_  generation: 0.1439051628112793

local_output_nid generation: 0.0077059268951416016
local_in_edges_tensor generation: 0.008170604705810547
mini_batch_src_global generation: 0.0208282470703125

&&&&&&&&&&&&&&& before remove duplicate length: 602832
&&&&&&&&&&&&&&& after remove duplicate length: 205099

r_  generation: 0.14204835891723633

local_output_nid generation: 0.007767677307128906
local_in_edges_tensor generation: 0.0076751708984375
mini_batch_src_global generation: 0.021779537200927734

&&&&&&&&&&&&&&& before remove duplicate length: 626401
&&&&&&&&&&&&&&& after remove duplicate length: 201697

r_  generation: 0.15076136589050293


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7695715427398682
gen group dst list time:  0.046025753021240234
check_connections_block*********************************
time for parepare 1: 0.3878774642944336
local_output_nid generation: 0.03366684913635254
local_in_edges_tensor generation: 0.10949039459228516
mini_batch_src_global generation: 0.045983076095581055

&&&&&&&&&&&&&&& before remove duplicate length: 1465336
&&&&&&&&&&&&&&& after remove duplicate length: 324066

r_  generation: 0.2491915225982666

local_output_nid generation: 0.054027557373046875
local_in_edges_tensor generation: 0.05696988105773926
mini_batch_src_global generation: 0.06090545654296875

&&&&&&&&&&&&&&& before remove duplicate length: 2052141
&&&&&&&&&&&&&&& after remove duplicate length: 514112

r_  generation: 0.4254324436187744

local_output_nid generation: 0.05005598068237305
local_in_edges_tensor generation: 0.046829938888549805
mini_batch_src_global generation: 0.05005645751953125

&&&&&&&&&&&&&&& before remove duplicate length: 1801687
&&&&&&&&&&&&&&& after remove duplicate length: 416090

r_  generation: 0.3894317150115967

local_output_nid generation: 0.04850029945373535
local_in_edges_tensor generation: 0.045732975006103516
mini_batch_src_global generation: 0.04707741737365723

&&&&&&&&&&&&&&& before remove duplicate length: 1673606
&&&&&&&&&&&&&&& after remove duplicate length: 426766

r_  generation: 0.3838021755218506

local_output_nid generation: 0.06075906753540039
local_in_edges_tensor generation: 0.06207466125488281
mini_batch_src_global generation: 0.06772541999816895

&&&&&&&&&&&&&&& before remove duplicate length: 2049482
&&&&&&&&&&&&&&& after remove duplicate length: 594982

r_  generation: 0.541226863861084

local_output_nid generation: 0.05956554412841797
local_in_edges_tensor generation: 0.09013485908508301
mini_batch_src_global generation: 0.07257437705993652

&&&&&&&&&&&&&&& before remove duplicate length: 2186615
&&&&&&&&&&&&&&& after remove duplicate length: 539935

r_  generation: 0.4971191883087158

local_output_nid generation: 0.054242849349975586
local_in_edges_tensor generation: 0.051683664321899414
mini_batch_src_global generation: 0.06722879409790039

&&&&&&&&&&&&&&& before remove duplicate length: 2013732
&&&&&&&&&&&&&&& after remove duplicate length: 521141

r_  generation: 0.49628257751464844

local_output_nid generation: 0.054776668548583984
local_in_edges_tensor generation: 0.04773354530334473
mini_batch_src_global generation: 0.07535457611083984

&&&&&&&&&&&&&&& before remove duplicate length: 2005732
&&&&&&&&&&&&&&& after remove duplicate length: 439514

r_  generation: 0.4575159549713135


connection checking time:  13.752708435058594
block generation total time  11.909695863723755
block dataloader generation time/epoch 55.23288083076477
pseudo mini batch 0 input nodes size: 337627
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.21913766860961914  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.34491395950317383  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3450918197631836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 337627
first layer output nodes number: 151848
edges number: 1465336
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.15185928344726562  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([337627, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.15185928344726562  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.15185928344726562  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2199110984802246  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2199110984802246  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.36472463607788086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([151848, 256])
h_self size  torch.Size([151848, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.36472463607788086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([151848, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5095381736755371  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.36472463607788086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([151848, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5095381736755371  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5457415580749512  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 151848
----------------output nodes number: 23856
----------------edges number: 568398
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.547050952911377  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.547050952911377  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5749449729919434  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5749449729919434  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5791220664978027  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([23856, 47])
h_self size  torch.Size([23856, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5791220664978027  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23856, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5832991600036621  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5791220664978027  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23856, 47])
pseudo mini batch 1 input nodes size: 535626
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.13125371932983398  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.33079004287719727  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.33096790313720703  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 535626
first layer output nodes number: 208049
edges number: 2052141
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.23064517974853516  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([535626, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.23064517974853516  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.23064517974853516  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3242154121398926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3242154121398926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5226263999938965  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([208049, 256])
h_self size  torch.Size([208049, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5226263999938965  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([208049, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7210373878479004  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5226263999938965  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([208049, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7210373878479004  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7706403732299805  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 208049
----------------output nodes number: 23861
----------------edges number: 588914
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7723684310913086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7723684310913086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8002724647521973  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8002724647521973  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8046603202819824  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([23861, 47])
h_self size  torch.Size([23861, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8046603202819824  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23861, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8088383674621582  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.804450511932373  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23861, 47])
pseudo mini batch 2 input nodes size: 433535
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.20522451400756836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3667292594909668  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.36691761016845703  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 433535
first layer output nodes number: 188440
edges number: 1801687
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.19018316268920898  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([433535, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.19018316268920898  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.19018316268920898  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2745089530944824  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2745089530944824  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.45421934127807617  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([188440, 256])
h_self size  torch.Size([188440, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.45421934127807617  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([188440, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6339297294616699  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.45421934127807617  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([188440, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6339297294616699  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6788573265075684  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 188440
----------------output nodes number: 25237
----------------edges number: 609253
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6804499626159668  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6804499626159668  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7097821235656738  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7097821235656738  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7142009735107422  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25237, 47])
h_self size  torch.Size([25237, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7142009735107422  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25237, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7186198234558105  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7142009735107422  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25237, 47])
pseudo mini batch 3 input nodes size: 446017
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.1672344207763672  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3333888053894043  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3335714340209961  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 446017
first layer output nodes number: 173611
edges number: 1673606
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.19434404373168945  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([446017, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.19434404373168945  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.19434404373168945  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2729630470275879  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2729630470275879  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.43853139877319336  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([173611, 256])
h_self size  torch.Size([173611, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.43853139877319336  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([173611, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6040997505187988  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.43853139877319336  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([173611, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6040997505187988  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6454920768737793  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 173611
----------------output nodes number: 24468
----------------edges number: 594455
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6471834182739258  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6471834182739258  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6751308441162109  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6751308441162109  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.679415225982666  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24468, 47])
h_self size  torch.Size([24468, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.679415225982666  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24468, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6836996078491211  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.679415225982666  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24468, 47])
pseudo mini batch 4 input nodes size: 623686
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.17174386978149414  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.4040851593017578  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.4042634963989258  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 623686
first layer output nodes number: 208709
edges number: 2049482
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2639937400817871  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([623686, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2639937400817871  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2639937400817871  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3577919006347656  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3577919006347656  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5568323135375977  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([208709, 256])
h_self size  torch.Size([208709, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5568323135375977  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([208709, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7558727264404297  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5568323135375977  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([208709, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7558727264404297  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8056330680847168  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 208709
----------------output nodes number: 23878
----------------edges number: 554601
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8078289031982422  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8078289031982422  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8349113464355469  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8349113464355469  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8390922546386719  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([23878, 47])
h_self size  torch.Size([23878, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8390922546386719  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23878, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8432731628417969  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8390922546386719  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23878, 47])
pseudo mini batch 5 input nodes size: 561963
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2378230094909668  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.4471707344055176  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.4473586082458496  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 561963
first layer output nodes number: 220937
edges number: 2186615
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.24178743362426758  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([561963, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.24178743362426758  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.24178743362426758  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.34120845794677734  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.34120845794677734  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5521459579467773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([220937, 256])
h_self size  torch.Size([220937, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5521459579467773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([220937, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7630834579467773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5521459579467773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([220937, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7630834579467773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8157591819763184  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 220937
----------------output nodes number: 25171
----------------edges number: 619025
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8175935745239258  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8175935745239258  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8473381996154785  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8473381996154785  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.85174560546875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25171, 47])
h_self size  torch.Size([25171, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.85174560546875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25171, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8561530113220215  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.85174560546875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25171, 47])
pseudo mini batch 6 input nodes size: 546861
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.21506547927856445  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.41878747940063477  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.418973445892334  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 546861
first layer output nodes number: 206785
edges number: 2013732
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2362804412841797  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([546861, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2362804412841797  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2362804412841797  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3290886878967285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3290886878967285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5263543128967285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([206785, 256])
h_self size  torch.Size([206785, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5263543128967285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([206785, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7236199378967285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5263543128967285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([206785, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7236199378967285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7729215621948242  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 206785
----------------output nodes number: 24931
----------------edges number: 602832
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7746486663818359  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7746486663818359  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8035478591918945  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8035478591918945  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8079133033752441  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24931, 47])
h_self size  torch.Size([24931, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8079133033752441  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24931, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8122787475585938  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8079133033752441  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24931, 47])
pseudo mini batch 7 input nodes size: 456963
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2093958854675293  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.37962818145751953  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.37981605529785156  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 456963
first layer output nodes number: 202901
edges number: 2005732
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.20183229446411133  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([456963, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.20183229446411133  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.20183229446411133  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2939610481262207  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2939610481262207  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.48746252059936523  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([202901, 256])
h_self size  torch.Size([202901, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.48746252059936523  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([202901, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6809639930725098  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.48746252059936523  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([202901, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6809639930725098  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.729339599609375  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 202901
----------------output nodes number: 25169
----------------edges number: 626401
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7310395240783691  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7310395240783691  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7598977088928223  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7598977088928223  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7643046379089355  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25169, 47])
h_self size  torch.Size([25169, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7643046379089355  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25169, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7687115669250488  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7643046379089355  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25169, 47])
Average training time/epoch 0.8537297248840332
Average Training time/epoch w/o nid counting 0.8526632785797119
Number of nodes for computation during this epoch:  5503558
Number of first layer input nodes during this epoch:  3942278
Number of first layer output nodes during this epoch:  1561280

-----------------------------------------------------------------------------epoch done
read pickle file
0.736793041229248

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2557187080383301
global_2_local spend time (sec) 0.4215428829193115

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.164 seconds
Metis partitioning: 12.436 seconds
Split the graph: 1.884 seconds
Construct subgraphs: 0.076 seconds
24644
24723
25273
25134
23865
24194
24308
24430
REG metis partition end ----................................
the time spent:  26.80694055557251
REG construction  time spent:  9.225478887557983
pure dgl.metis_partition the time spent:  17.581461668014526
total k batches seeds list generation spend  27.46192765235901
after graph partition
graph partition algorithm spend time 28.10323667526245

partition_len_list
[199398, 170731, 201361, 157017, 200797, 202643, 200975, 217210]
REG selection method  spend 28.719329357147217
check_connections_block*********************************
time for parepare 1: 0.22085094451904297
local_output_nid generation: 0.0063097476959228516
local_in_edges_tensor generation: 0.006932497024536133
mini_batch_src_global generation: 0.024885177612304688

&&&&&&&&&&&&&&& before remove duplicate length: 598593
&&&&&&&&&&&&&&& after remove duplicate length: 197705

r_  generation: 0.11231493949890137

local_output_nid generation: 0.0076711177825927734
local_in_edges_tensor generation: 0.008519411087036133
mini_batch_src_global generation: 0.023527860641479492

&&&&&&&&&&&&&&& before remove duplicate length: 595866
&&&&&&&&&&&&&&& after remove duplicate length: 169467

r_  generation: 0.09326386451721191

local_output_nid generation: 0.010820627212524414
local_in_edges_tensor generation: 0.00711369514465332
mini_batch_src_global generation: 0.02228546142578125

&&&&&&&&&&&&&&& before remove duplicate length: 625335
&&&&&&&&&&&&&&& after remove duplicate length: 200096

r_  generation: 0.12281012535095215

local_output_nid generation: 0.007565498352050781
local_in_edges_tensor generation: 0.0068264007568359375
mini_batch_src_global generation: 0.020016193389892578

&&&&&&&&&&&&&&& before remove duplicate length: 600381
&&&&&&&&&&&&&&& after remove duplicate length: 155239

r_  generation: 0.09610724449157715

local_output_nid generation: 0.007303953170776367
local_in_edges_tensor generation: 0.006776571273803711
mini_batch_src_global generation: 0.019243478775024414

&&&&&&&&&&&&&&& before remove duplicate length: 571255
&&&&&&&&&&&&&&& after remove duplicate length: 197233

r_  generation: 0.12198758125305176

local_output_nid generation: 0.008679628372192383
local_in_edges_tensor generation: 0.006882667541503906
mini_batch_src_global generation: 0.021283864974975586

&&&&&&&&&&&&&&& before remove duplicate length: 561392
&&&&&&&&&&&&&&& after remove duplicate length: 197585

r_  generation: 0.12854623794555664

local_output_nid generation: 0.0074923038482666016
local_in_edges_tensor generation: 0.007050275802612305
mini_batch_src_global generation: 0.02307868003845215

&&&&&&&&&&&&&&& before remove duplicate length: 604784
&&&&&&&&&&&&&&& after remove duplicate length: 199649

r_  generation: 0.16222167015075684

local_output_nid generation: 0.007676362991333008
local_in_edges_tensor generation: 0.007178544998168945
mini_batch_src_global generation: 0.02354288101196289

&&&&&&&&&&&&&&& before remove duplicate length: 606273
&&&&&&&&&&&&&&& after remove duplicate length: 215962

r_  generation: 0.1411268711090088


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7811465263366699
gen group dst list time:  0.04360556602478027
check_connections_block*********************************
time for parepare 1: 0.35096025466918945
local_output_nid generation: 0.04777359962463379
local_in_edges_tensor generation: 0.12177133560180664
mini_batch_src_global generation: 0.05854034423828125

&&&&&&&&&&&&&&& before remove duplicate length: 1925045
&&&&&&&&&&&&&&& after remove duplicate length: 492919

r_  generation: 0.38573145866394043

local_output_nid generation: 0.04583120346069336
local_in_edges_tensor generation: 0.048407793045043945
mini_batch_src_global generation: 0.048453569412231445

&&&&&&&&&&&&&&& before remove duplicate length: 1629706
&&&&&&&&&&&&&&& after remove duplicate length: 380206

r_  generation: 0.33605122566223145

local_output_nid generation: 0.05353522300720215
local_in_edges_tensor generation: 0.06184577941894531
mini_batch_src_global generation: 0.05182528495788574

&&&&&&&&&&&&&&& before remove duplicate length: 1985756
&&&&&&&&&&&&&&& after remove duplicate length: 447312

r_  generation: 0.40318775177001953

local_output_nid generation: 0.040941715240478516
local_in_edges_tensor generation: 0.03625607490539551
mini_batch_src_global generation: 0.045670270919799805

&&&&&&&&&&&&&&& before remove duplicate length: 1516762
&&&&&&&&&&&&&&& after remove duplicate length: 331035

r_  generation: 0.3036799430847168

local_output_nid generation: 0.055060386657714844
local_in_edges_tensor generation: 0.05463361740112305
mini_batch_src_global generation: 0.05658888816833496

&&&&&&&&&&&&&&& before remove duplicate length: 1957167
&&&&&&&&&&&&&&& after remove duplicate length: 559657

r_  generation: 0.47979187965393066

local_output_nid generation: 0.05650901794433594
local_in_edges_tensor generation: 0.056871891021728516
mini_batch_src_global generation: 0.0690455436706543

&&&&&&&&&&&&&&& before remove duplicate length: 1990763
&&&&&&&&&&&&&&& after remove duplicate length: 554987

r_  generation: 0.48069167137145996

local_output_nid generation: 0.05437946319580078
local_in_edges_tensor generation: 0.05215811729431152
mini_batch_src_global generation: 0.06543087959289551

&&&&&&&&&&&&&&& before remove duplicate length: 1986985
&&&&&&&&&&&&&&& after remove duplicate length: 453637

r_  generation: 0.44730305671691895

local_output_nid generation: 0.058939456939697266
local_in_edges_tensor generation: 0.05238819122314453
mini_batch_src_global generation: 0.06876277923583984

&&&&&&&&&&&&&&& before remove duplicate length: 2145866
&&&&&&&&&&&&&&& after remove duplicate length: 517078

r_  generation: 0.4823322296142578


connection checking time:  13.429126024246216
block generation total time  11.423158407211304
block dataloader generation time/epoch 54.97150266170502
pseudo mini batch 0 input nodes size: 514294
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.1759486198425293  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3675384521484375  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3677225112915039  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 514294
first layer output nodes number: 199398
edges number: 1925045
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.22214984893798828  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([514294, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.22214984893798828  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.22214984893798828  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.31151771545410156  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.31151771545410156  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.501678466796875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([199398, 256])
h_self size  torch.Size([199398, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.501678466796875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([199398, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6918392181396484  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.501678466796875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([199398, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6918392181396484  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7393794059753418  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 199398
----------------output nodes number: 24644
----------------edges number: 598593
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7418804168701172  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7418804168701172  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.770439624786377  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.770439624786377  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.775627613067627  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24644, 47])
h_self size  torch.Size([24644, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.775627613067627  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24644, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.779942512512207  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.774754524230957  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24644, 47])
pseudo mini batch 1 input nodes size: 397304
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.19808435440063477  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.34609174728393555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.34627628326416016  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 397304
first layer output nodes number: 170731
edges number: 1629706
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.17662906646728516  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([397304, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.17662906646728516  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.17662906646728516  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.25301074981689453  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.25301074981689453  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.41583251953125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([170731, 256])
h_self size  torch.Size([170731, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.41583251953125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([170731, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5786542892456055  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.41583251953125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([170731, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5786542892456055  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6193599700927734  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 170731
----------------output nodes number: 24723
----------------edges number: 595866
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6217446327209473  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6217446327209473  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6499476432800293  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6499476432800293  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6542763710021973  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24723, 47])
h_self size  torch.Size([24723, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6542763710021973  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24723, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6586050987243652  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6542763710021973  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24723, 47])
pseudo mini batch 2 input nodes size: 465064
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.15364313125610352  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.32689332962036133  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.32708168029785156  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 465064
first layer output nodes number: 201361
edges number: 1985756
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.20439767837524414  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([465064, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.20439767837524414  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.20439767837524414  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.29495668411254883  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.29495668411254883  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.48698949813842773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([201361, 256])
h_self size  torch.Size([201361, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.48698949813842773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([201361, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6790223121643066  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.48698949813842773  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([201361, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6790223121643066  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7270307540893555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 201361
----------------output nodes number: 25273
----------------edges number: 625335
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.729210376739502  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.729210376739502  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.758237361907959  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.758237361907959  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7634701728820801  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25273, 47])
h_self size  torch.Size([25273, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7634701728820801  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25273, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7678952217102051  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.762662410736084  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25273, 47])
pseudo mini batch 3 input nodes size: 344856
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.1797938346862793  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.30826282501220703  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.30845022201538086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 344856
first layer output nodes number: 157017
edges number: 1516762
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.15509748458862305  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([344856, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.15509748458862305  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.15509748458862305  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2255687713623047  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2255687713623047  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.37531185150146484  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([157017, 256])
h_self size  torch.Size([157017, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.37531185150146484  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([157017, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.525054931640625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.37531185150146484  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([157017, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.525054931640625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5624909400939941  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 157017
----------------output nodes number: 25134
----------------edges number: 600381
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5647315979003906  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5647315979003906  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.594090461730957  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.594090461730957  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5984911918640137  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25134, 47])
h_self size  torch.Size([25134, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5984911918640137  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25134, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.6035704612731934  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5991697311401367  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25134, 47])
pseudo mini batch 4 input nodes size: 590820
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.13417959213256836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3542776107788086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.35445547103881836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 590820
first layer output nodes number: 200797
edges number: 1957167
----------------------------------------before model layer 0
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2513999938964844  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([590820, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2513999938964844  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.2513999938964844  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3415336608886719  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.3415336608886719  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5330286026000977  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([200797, 256])
h_self size  torch.Size([200797, 100])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5330286026000977  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([200797, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7245235443115234  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.5330286026000977  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([200797, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7245235443115234  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.772397518157959  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 200797
----------------output nodes number: 23865
----------------edges number: 571255
----------------------------------------before mean aggregator
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7740716934204102  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.7740716934204102  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8020687103271484  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8020687103271484  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8062472343444824  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([23865, 47])
h_self size  torch.Size([23865, 256])
----------------------------------------before rst
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8062472343444824  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23865, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8104257583618164  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.8062472343444824  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23865, 47])
pseudo mini batch 5 input nodes size: 580698
----------------------------------------before batch input features to device
 Nvidia-smi: 12.4647216796875 GB
    Memory Allocated: 0.22557687759399414  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.44237375259399414  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4425544738769531  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 580698
first layer output nodes number: 202643
edges number: 1990763
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.24725055694580078  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([580698, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.24725055694580078  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.24725055694580078  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.33832883834838867  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.33832883834838867  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5315842628479004  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([202643, 256])
h_self size  torch.Size([202643, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5315842628479004  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([202643, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7248396873474121  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5315842628479004  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([202643, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7248396873474121  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7731537818908691  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 202643
----------------output nodes number: 24194
----------------edges number: 561392
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7748446464538574  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7748446464538574  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8026905059814453  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8026905059814453  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8073892593383789  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24194, 47])
h_self size  torch.Size([24194, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8073892593383789  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24194, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8116254806518555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8069267272949219  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24194, 47])
pseudo mini batch 6 input nodes size: 471909
----------------------------------------before batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.2223362922668457  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3981361389160156  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3983173370361328  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 471909
first layer output nodes number: 200975
edges number: 1986985
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.206695556640625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([471909, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.206695556640625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.206695556640625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.2971186637878418  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.2971186637878418  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4887833595275879  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([200975, 256])
h_self size  torch.Size([200975, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4887833595275879  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([200975, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.680448055267334  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4887833595275879  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([200975, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.680448055267334  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.728762149810791  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 200975
----------------output nodes number: 24308
----------------edges number: 604784
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7310066223144531  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7310066223144531  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7590961456298828  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7590961456298828  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7633523941040039  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24308, 47])
h_self size  torch.Size([24308, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7633523941040039  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24308, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.767608642578125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7633523941040039  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24308, 47])
pseudo mini batch 7 input nodes size: 538272
----------------------------------------before batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.18135976791381836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3818817138671875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3820638656616211  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 538272
first layer output nodes number: 217210
edges number: 2145866
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.23276329040527344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([538272, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.23276329040527344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.23276329040527344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3304781913757324  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3304781913757324  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.537625789642334  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([217210, 256])
h_self size  torch.Size([217210, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.537625789642334  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([217210, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7447733879089355  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.537625789642334  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([217210, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7447733879089355  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7965602874755859  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 217210
----------------output nodes number: 24430
----------------edges number: 606273
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7986669540405273  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7986669540405273  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.826664924621582  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.826664924621582  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8309426307678223  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24430, 47])
h_self size  torch.Size([24430, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8309426307678223  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24430, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8352203369140625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8309426307678223  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24430, 47])
Average training time/epoch 0.8865514993667603
Average Training time/epoch w/o nid counting 0.9184858798980713
Number of nodes for computation during this epoch:  5453349
Number of first layer input nodes during this epoch:  3903217
Number of first layer output nodes during this epoch:  1550132

-----------------------------------------------------------------------------epoch done
read pickle file
0.7621135711669922

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.29380106925964355
global_2_local spend time (sec) 0.3989524841308594

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.200 seconds
Metis partitioning: 12.501 seconds
Split the graph: 1.993 seconds
Construct subgraphs: 0.058 seconds
24047
24301
24961
24159
25195
25012
23861
25035
REG metis partition end ----................................
the time spent:  26.83088254928589
REG construction  time spent:  9.056884288787842
pure dgl.metis_partition the time spent:  17.773998260498047
total k batches seeds list generation spend  27.517842769622803
after graph partition
graph partition algorithm spend time 28.179790496826172

partition_len_list
[188447, 184248, 185096, 221828, 206722, 205543, 191626, 155488]
REG selection method  spend 28.78585696220398
check_connections_block*********************************
time for parepare 1: 0.22908616065979004
local_output_nid generation: 0.006619930267333984
local_in_edges_tensor generation: 0.0071887969970703125
mini_batch_src_global generation: 0.021881580352783203

&&&&&&&&&&&&&&& before remove duplicate length: 583510
&&&&&&&&&&&&&&& after remove duplicate length: 186767

r_  generation: 0.09757065773010254

local_output_nid generation: 0.007921695709228516
local_in_edges_tensor generation: 0.00703120231628418
mini_batch_src_global generation: 0.02124619483947754

&&&&&&&&&&&&&&& before remove duplicate length: 585751
&&&&&&&&&&&&&&& after remove duplicate length: 182842

r_  generation: 0.11556816101074219

local_output_nid generation: 0.008133172988891602
local_in_edges_tensor generation: 0.007505893707275391
mini_batch_src_global generation: 0.018074989318847656

&&&&&&&&&&&&&&& before remove duplicate length: 616103
&&&&&&&&&&&&&&& after remove duplicate length: 183899

r_  generation: 0.11407709121704102

local_output_nid generation: 0.007933616638183594
local_in_edges_tensor generation: 0.007189273834228516
mini_batch_src_global generation: 0.018827438354492188

&&&&&&&&&&&&&&& before remove duplicate length: 571274
&&&&&&&&&&&&&&& after remove duplicate length: 217864

r_  generation: 0.1423039436340332

local_output_nid generation: 0.008092403411865234
local_in_edges_tensor generation: 0.00764775276184082
mini_batch_src_global generation: 0.02222609519958496

&&&&&&&&&&&&&&& before remove duplicate length: 611904
&&&&&&&&&&&&&&& after remove duplicate length: 203275

r_  generation: 0.13518762588500977

local_output_nid generation: 0.010391473770141602
local_in_edges_tensor generation: 0.009251832962036133
mini_batch_src_global generation: 0.022474050521850586

&&&&&&&&&&&&&&& before remove duplicate length: 622855
&&&&&&&&&&&&&&& after remove duplicate length: 204353

r_  generation: 0.1396784782409668

local_output_nid generation: 0.00804448127746582
local_in_edges_tensor generation: 0.009276628494262695
mini_batch_src_global generation: 0.02470088005065918

&&&&&&&&&&&&&&& before remove duplicate length: 574365
&&&&&&&&&&&&&&& after remove duplicate length: 189502

r_  generation: 0.13391399383544922

local_output_nid generation: 0.008144378662109375
local_in_edges_tensor generation: 0.008135557174682617
mini_batch_src_global generation: 0.023369312286376953

&&&&&&&&&&&&&&& before remove duplicate length: 598117
&&&&&&&&&&&&&&& after remove duplicate length: 153727

r_  generation: 0.09983325004577637


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.780738353729248
gen group dst list time:  0.05265641212463379
check_connections_block*********************************
time for parepare 1: 0.3834972381591797
local_output_nid generation: 0.04637742042541504
local_in_edges_tensor generation: 0.12590408325195312
mini_batch_src_global generation: 0.07636284828186035

&&&&&&&&&&&&&&& before remove duplicate length: 1820843
&&&&&&&&&&&&&&& after remove duplicate length: 498096

r_  generation: 0.3843371868133545

local_output_nid generation: 0.0495305061340332
local_in_edges_tensor generation: 0.08739328384399414
mini_batch_src_global generation: 0.05617070198059082

&&&&&&&&&&&&&&& before remove duplicate length: 1762410
&&&&&&&&&&&&&&& after remove duplicate length: 414065

r_  generation: 0.3866231441497803

local_output_nid generation: 0.0586700439453125
local_in_edges_tensor generation: 0.07214879989624023
mini_batch_src_global generation: 0.04921841621398926

&&&&&&&&&&&&&&& before remove duplicate length: 1817032
&&&&&&&&&&&&&&& after remove duplicate length: 447345

r_  generation: 0.42322492599487305

local_output_nid generation: 0.07530808448791504
local_in_edges_tensor generation: 0.060884714126586914
mini_batch_src_global generation: 0.07081246376037598

&&&&&&&&&&&&&&& before remove duplicate length: 2183489
&&&&&&&&&&&&&&& after remove duplicate length: 588514

r_  generation: 0.5006124973297119

local_output_nid generation: 0.05741071701049805
local_in_edges_tensor generation: 0.05215191841125488
mini_batch_src_global generation: 0.06770491600036621

&&&&&&&&&&&&&&& before remove duplicate length: 2044254
&&&&&&&&&&&&&&& after remove duplicate length: 519660

r_  generation: 0.49796485900878906

local_output_nid generation: 0.05579710006713867
local_in_edges_tensor generation: 0.04917454719543457
mini_batch_src_global generation: 0.06414675712585449

&&&&&&&&&&&&&&& before remove duplicate length: 2032802
&&&&&&&&&&&&&&& after remove duplicate length: 439575

r_  generation: 0.4382140636444092

local_output_nid generation: 0.051509857177734375
local_in_edges_tensor generation: 0.04756021499633789
mini_batch_src_global generation: 0.060755014419555664

&&&&&&&&&&&&&&& before remove duplicate length: 1862597
&&&&&&&&&&&&&&& after remove duplicate length: 484594

r_  generation: 0.450167179107666

local_output_nid generation: 0.048600196838378906
local_in_edges_tensor generation: 0.09849834442138672
mini_batch_src_global generation: 0.05815458297729492

&&&&&&&&&&&&&&& before remove duplicate length: 1502131
&&&&&&&&&&&&&&& after remove duplicate length: 327534

r_  generation: 0.3097507953643799


connection checking time:  13.950109243392944
block generation total time  12.251678466796875
block dataloader generation time/epoch 55.372902631759644
pseudo mini batch 0 input nodes size: 521599
----------------------------------------before batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.20610332489013672  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.40041446685791016  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.40059375762939453  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 521599
first layer output nodes number: 188447
edges number: 1820843
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.22477960586547852  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([521599, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.22477960586547852  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.22477960586547852  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3092513084411621  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3092513084411621  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4889683723449707  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([188447, 256])
h_self size  torch.Size([188447, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4889683723449707  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([188447, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6686854362487793  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4889683723449707  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([188447, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6686854362487793  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7136149406433105  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 188447
----------------output nodes number: 24047
----------------edges number: 583510
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7151985168457031  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7151985168457031  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7426586151123047  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7426586151123047  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7468690872192383  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24047, 47])
h_self size  torch.Size([24047, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7468690872192383  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24047, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7510795593261719  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7468690872192383  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24047, 47])
pseudo mini batch 1 input nodes size: 430852
----------------------------------------before batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.19982337951660156  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.36032867431640625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.36050987243652344  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 430852
first layer output nodes number: 184248
edges number: 1762410
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.18844842910766602  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([430852, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.18844842910766602  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.18844842910766602  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.2709040641784668  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.2709040641784668  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.44661664962768555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([184248, 256])
h_self size  torch.Size([184248, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.44661664962768555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([184248, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6223292350769043  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.44661664962768555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([184248, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6223292350769043  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.666257381439209  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 184248
----------------output nodes number: 24301
----------------edges number: 585751
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6683764457702637  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6683764457702637  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6968860626220703  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6968860626220703  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.701141357421875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24301, 47])
h_self size  torch.Size([24301, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.701141357421875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24301, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7053966522216797  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.701141357421875  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24301, 47])
pseudo mini batch 2 input nodes size: 466178
----------------------------------------before batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.16606426239013672  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.33972930908203125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.33991575241088867  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 466178
first layer output nodes number: 185096
edges number: 1817032
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.20308828353881836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([466178, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.20308828353881836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.20308828353881836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.2862706184387207  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.2862706184387207  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.46279191970825195  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([185096, 256])
h_self size  torch.Size([185096, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.46279191970825195  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([185096, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6393132209777832  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.46279191970825195  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([185096, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6393132209777832  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.683443546295166  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 185096
----------------output nodes number: 24961
----------------edges number: 616103
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6858501434326172  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6858501434326172  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7144327163696289  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7144327163696289  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7190027236938477  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24961, 47])
h_self size  torch.Size([24961, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7190027236938477  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24961, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7238130569458008  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.719243049621582  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24961, 47])
pseudo mini batch 3 input nodes size: 614668
----------------------------------------before batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.17934465408325195  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4083266258239746  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4085068702697754  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 614668
first layer output nodes number: 221828
edges number: 2183489
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.2617321014404297  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([614668, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.2617321014404297  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.2617321014404297  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3614654541015625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3614654541015625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5730171203613281  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([221828, 256])
h_self size  torch.Size([221828, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5730171203613281  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([221828, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7845687866210938  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5730171203613281  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([221828, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7845687866210938  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8374567031860352  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 221828
----------------output nodes number: 24159
----------------edges number: 571274
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8395681381225586  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8395681381225586  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8670454025268555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8670454025268555  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8712754249572754  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([24159, 47])
h_self size  torch.Size([24159, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8712754249572754  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24159, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8755054473876953  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8712754249572754  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([24159, 47])
pseudo mini batch 4 input nodes size: 541482
----------------------------------------before batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.23451471328735352  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4362325668334961  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4364204406738281  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 541482
first layer output nodes number: 206722
edges number: 2044254
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.23303461074829102  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([541482, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.23303461074829102  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.23303461074829102  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3260464668273926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3260464668273926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5233120918273926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([206722, 256])
h_self size  torch.Size([206722, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5233120918273926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([206722, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7205777168273926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5233120918273926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([206722, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7205777168273926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7698640823364258  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 206722
----------------output nodes number: 25195
----------------edges number: 611904
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7715926170349121  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7715926170349121  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8008852005004883  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8008852005004883  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8052968978881836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25195, 47])
h_self size  torch.Size([25195, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8052968978881836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25195, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8097085952758789  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.8052968978881836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25195, 47])
pseudo mini batch 5 input nodes size: 457397
----------------------------------------before batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.20743989944458008  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.37783384323120117  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3780202865600586  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 457397
first layer output nodes number: 205543
edges number: 2032802
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.20113515853881836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([457397, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.20113515853881836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.20113515853881836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.29361820220947266  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.29361820220947266  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4896392822265625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([205543, 256])
h_self size  torch.Size([205543, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4896392822265625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([205543, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6856603622436523  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4896392822265625  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([205543, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6856603622436523  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7349467277526855  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 205543
----------------output nodes number: 25012
----------------edges number: 622855
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7369580268859863  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7369580268859863  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7656397819519043  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7656397819519043  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.77001953125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25012, 47])
h_self size  torch.Size([25012, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.77001953125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25012, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7743992805480957  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.77001953125  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25012, 47])
pseudo mini batch 6 input nodes size: 511964
----------------------------------------before batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.17608261108398438  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3668041229248047  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.36698198318481445  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 511964
first layer output nodes number: 191626
edges number: 1862597
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.22039556503295898  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([511964, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.22039556503295898  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.22039556503295898  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.30637407302856445  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.30637407302856445  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4891228675842285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([191626, 256])
h_self size  torch.Size([191626, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4891228675842285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([191626, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6718716621398926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.4891228675842285  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([191626, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.6718716621398926  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7175588607788086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 191626
----------------output nodes number: 23861
----------------edges number: 574365
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7197561264038086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7197561264038086  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7475595474243164  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7475595474243164  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7517375946044922  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([23861, 47])
h_self size  torch.Size([23861, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7517375946044922  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23861, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.7559738159179688  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.751795768737793  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([23861, 47])
pseudo mini batch 7 input nodes size: 341252
----------------------------------------before batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.19619989395141602  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.32332658767700195  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.3235135078430176  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

first layer input nodes number: 341252
first layer output nodes number: 155488
edges number: 1502131
----------------------------------------before model layer 0
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.1527385711669922  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([341252, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.1527385711669922  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.1527385711669922  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.22243404388427734  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.22243404388427734  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.37071895599365234  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([155488, 256])
h_self size  torch.Size([155488, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.37071895599365234  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([155488, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5190038681030273  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.37071895599365234  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([155488, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5190038681030273  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5560750961303711  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------input nodes number: 155488
----------------output nodes number: 25035
----------------edges number: 598117
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5577664375305176  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5577664375305176  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5866799354553223  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5866799354553223  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5910634994506836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

h_neigh size torch.Size([25035, 47])
h_self size  torch.Size([25035, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5910634994506836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25035, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5954470634460449  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6815185546875 GB
    Memory Allocated: 0.5910634994506836  GigaBytes
Max Memory Allocated: 1.2759079933166504  GigaBytes

torch.Size([25035, 47])
Average training time/epoch 0.8758582274119059
Average Training time/epoch w/o nid counting 0.8535115718841553
Number of nodes for computation during this epoch:  5424390
Number of first layer input nodes during this epoch:  3885392
Number of first layer output nodes during this epoch:  1538998

-----------------------------------------------------------------------------epoch done
