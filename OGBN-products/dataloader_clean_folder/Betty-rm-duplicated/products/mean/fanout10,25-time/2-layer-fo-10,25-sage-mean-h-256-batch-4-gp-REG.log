main start at this time 1660935643.1916876
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22394609451293945
global_2_local spend time (sec) 0.3640146255493164

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.883 seconds
Metis partitioning: 11.174 seconds
Split the graph: 2.805 seconds
Construct subgraphs: 0.075 seconds
50510
48924
48041
49096
REG metis partition end ----................................
the time spent:  25.798995971679688
REG construction  time spent:  8.840359449386597
pure dgl.metis_partition the time spent:  16.95863652229309
total k batches seeds list generation spend  26.373109102249146
after graph partition
graph partition algorithm spend time 27.10717797279358

partition_len_list
[343245, 319005, 378227, 358497]
REG selection method  spend 27.637426376342773
check_connections_block*********************************
time for parepare 1: 0.22708821296691895
local_output_nid generation: 0.008148908615112305
local_in_edges_tensor generation: 0.014795303344726562
mini_batch_src_global generation: 0.03992319107055664

&&&&&&&&&&&&&&& before remove duplicate length: 1228913
&&&&&&&&&&&&&&& after remove duplicate length: 340744

r_  generation: 0.21137404441833496

local_output_nid generation: 0.010016441345214844
local_in_edges_tensor generation: 0.02284383773803711
mini_batch_src_global generation: 0.03694486618041992

&&&&&&&&&&&&&&& before remove duplicate length: 1182605
&&&&&&&&&&&&&&& after remove duplicate length: 316871

r_  generation: 0.2046821117401123

local_output_nid generation: 0.013060808181762695
local_in_edges_tensor generation: 0.030791282653808594
mini_batch_src_global generation: 0.02735304832458496

&&&&&&&&&&&&&&& before remove duplicate length: 1133817
&&&&&&&&&&&&&&& after remove duplicate length: 371264

r_  generation: 0.2503623962402344

local_output_nid generation: 0.009990453720092773
local_in_edges_tensor generation: 0.018332242965698242
mini_batch_src_global generation: 0.03469705581665039

&&&&&&&&&&&&&&& before remove duplicate length: 1218544
&&&&&&&&&&&&&&& after remove duplicate length: 356490

r_  generation: 0.2680966854095459


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.751117467880249
gen group dst list time:  0.040799617767333984
check_connections_block*********************************
time for parepare 1: 0.37967848777770996
local_output_nid generation: 0.06328964233398438
local_in_edges_tensor generation: 0.14783191680908203
mini_batch_src_global generation: 0.10476040840148926

&&&&&&&&&&&&&&& before remove duplicate length: 3349051
&&&&&&&&&&&&&&& after remove duplicate length: 676446

r_  generation: 0.6119017601013184

local_output_nid generation: 0.0909583568572998
local_in_edges_tensor generation: 0.09463071823120117
mini_batch_src_global generation: 0.08047866821289062

&&&&&&&&&&&&&&& before remove duplicate length: 3045026
&&&&&&&&&&&&&&& after remove duplicate length: 635507

r_  generation: 0.5951197147369385

local_output_nid generation: 0.08965659141540527
local_in_edges_tensor generation: 0.10897660255432129
mini_batch_src_global generation: 0.09818410873413086

&&&&&&&&&&&&&&& before remove duplicate length: 3697654
&&&&&&&&&&&&&&& after remove duplicate length: 849461

r_  generation: 0.8247706890106201

local_output_nid generation: 0.10826373100280762
local_in_edges_tensor generation: 0.1220552921295166
mini_batch_src_global generation: 0.10678291320800781

&&&&&&&&&&&&&&& before remove duplicate length: 3537077
&&&&&&&&&&&&&&& after remove duplicate length: 677269

r_  generation: 0.7090854644775391


connection checking time:  12.31047797203064
block generation total time  12.588130474090576
pseudo mini batch 0 input nodes size: 704565
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3416748046875 GB
    Memory Allocated: 0.26275157928466797  GigaBytes
Max Memory Allocated: 0.26275157928466797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3416748046875 GB
    Memory Allocated: 0.26312828063964844  GigaBytes
Max Memory Allocated: 0.26312828063964844  GigaBytes

first layer input nodes number: 704565
first layer output nodes number: 343245
edges number: 3349051
----------------------------------------before model layer 0
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.30504465103149414  GigaBytes
Max Memory Allocated: 0.3175210952758789  GigaBytes

torch.Size([704565, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.30504465103149414  GigaBytes
Max Memory Allocated: 0.3175210952758789  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.30504465103149414  GigaBytes
Max Memory Allocated: 0.3175210952758789  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1307373046875 GB
    Memory Allocated: 0.45914554595947266  GigaBytes
Max Memory Allocated: 0.5882935523986816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1307373046875 GB
    Memory Allocated: 0.45914554595947266  GigaBytes
Max Memory Allocated: 0.5882935523986816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.4588623046875 GB
    Memory Allocated: 0.7872705459594727  GigaBytes
Max Memory Allocated: 0.7872705459594727  GigaBytes

h_neigh size torch.Size([343245, 256])
h_self size  torch.Size([343245, 100])
----------------------------------------before rst
 Nvidia-smi: 8.4588623046875 GB
    Memory Allocated: 0.7872705459594727  GigaBytes
Max Memory Allocated: 0.7872705459594727  GigaBytes

torch.Size([343245, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.1153955459594727  GigaBytes
Max Memory Allocated: 1.4435205459594727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 0.7872705459594727  GigaBytes
Max Memory Allocated: 1.4435205459594727  GigaBytes

torch.Size([343245, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.1153955459594727  GigaBytes
Max Memory Allocated: 1.4435205459594727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.1972317695617676  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------input nodes number: 343245
----------------output nodes number: 50510
----------------edges number: 1228913
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2001662254333496  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2001662254333496  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2578692436218262  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2578692436218262  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2667131423950195  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

h_neigh size torch.Size([50510, 47])
h_self size  torch.Size([50510, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2667131423950195  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

torch.Size([50510, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.275557041168213  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2667131423950195  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

torch.Size([50510, 47])
pseudo mini batch 1 input nodes size: 663441
----------------------------------------before batch input features to device
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.27225351333618164  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.5194048881530762  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.5197696685791016  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

first layer input nodes number: 663441
first layer output nodes number: 319005
edges number: 3045026
----------------------------------------before model layer 0
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.2966618537902832  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([663441, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.2966618537902832  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.2966618537902832  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.4393773078918457  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.4393773078918457  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.7436041831970215  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

h_neigh size torch.Size([319005, 256])
h_self size  torch.Size([319005, 100])
----------------------------------------before rst
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.7436041831970215  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([319005, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.0478310585021973  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.7436041831970215  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([319005, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.0478310585021973  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.1238880157470703  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------input nodes number: 319005
----------------output nodes number: 48924
----------------edges number: 1182605
----------------------------------------before mean aggregator
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.1266298294067383  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.1266298294067383  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1829752922058105  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1829752922058105  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1917037963867188  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

h_neigh size torch.Size([48924, 47])
h_self size  torch.Size([48924, 256])
----------------------------------------before rst
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1917037963867188  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([48924, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.200270175933838  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1915416717529297  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([48924, 47])
pseudo mini batch 2 input nodes size: 892931
----------------------------------------before batch input features to device
 Nvidia-smi: 10.0936279296875 GB
    Memory Allocated: 0.2568063735961914  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4276123046875 GB
    Memory Allocated: 0.589449405670166  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4276123046875 GB
    Memory Allocated: 0.5898075103759766  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

first layer input nodes number: 892931
first layer output nodes number: 378227
edges number: 3697654
----------------------------------------before model layer 0
 Nvidia-smi: 10.4276123046875 GB
    Memory Allocated: 0.38847970962524414  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([892931, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 10.4276123046875 GB
    Memory Allocated: 0.38847970962524414  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.4276123046875 GB
    Memory Allocated: 0.38847970962524414  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 0.5584626197814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 0.5584626197814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.8026123046875 GB
    Memory Allocated: 0.9197907447814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

h_neigh size torch.Size([378227, 256])
h_self size  torch.Size([378227, 100])
----------------------------------------before rst
 Nvidia-smi: 10.8026123046875 GB
    Memory Allocated: 0.9197907447814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([378227, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.2811188697814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 0.9197907447814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([378227, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.2811188697814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.37129545211792  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------input nodes number: 378227
----------------output nodes number: 48041
----------------edges number: 1133817
----------------------------------------before mean aggregator
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.374471664428711  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.374471664428711  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.429443359375  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.429443359375  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.4378552436828613  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

h_neigh size torch.Size([48041, 47])
h_self size  torch.Size([48041, 256])
----------------------------------------before rst
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.4378552436828613  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([48041, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.4462671279907227  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.4378552436828613  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([48041, 47])
pseudo mini batch 3 input nodes size: 703937
----------------------------------------before batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.34197473526000977  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.6042118072509766  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.6045780181884766  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

first layer input nodes number: 703937
first layer output nodes number: 358497
edges number: 3537077
----------------------------------------before model layer 0
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3166365623474121  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([703937, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3166365623474121  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3166365623474121  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4784708023071289  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4784708023071289  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.8203601837158203  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([358497, 256])
h_self size  torch.Size([358497, 100])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.8203601837158203  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([358497, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1622495651245117  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.8203601837158203  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([358497, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1622495651245117  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2477221488952637  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------input nodes number: 358497
----------------output nodes number: 49096
----------------edges number: 1218544
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2507596015930176  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2507596015930176  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3070263862609863  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3070263862609863  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3156228065490723  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([49096, 47])
h_self size  torch.Size([49096, 256])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3156228065490723  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49096, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3242192268371582  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3156228065490723  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49096, 47])
Number of nodes for computation during this epoch:  4363848
Number of first layer input nodes during this epoch:  2964874
Number of first layer output nodes during this epoch:  1398974

-----------------------------------------------------------------------------epoch done
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.29610657691955566
global_2_local spend time (sec) 0.40776801109313965

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.993 seconds
Metis partitioning: 11.831 seconds
Split the graph: 3.359 seconds
Construct subgraphs: 0.054 seconds
49801
49776
47743
49251
REG metis partition end ----................................
the time spent:  27.42062520980835
REG construction  time spent:  9.160774946212769
pure dgl.metis_partition the time spent:  18.25985026359558
total k batches seeds list generation spend  28.0702486038208
after graph partition
graph partition algorithm spend time 28.825191259384155

partition_len_list
[337197, 330761, 375952, 374630]
REG selection method  spend 29.41695547103882
check_connections_block*********************************
time for parepare 1: 0.2243785858154297
local_output_nid generation: 0.008812189102172852
local_in_edges_tensor generation: 0.013700246810913086
mini_batch_src_global generation: 0.03703761100769043

&&&&&&&&&&&&&&& before remove duplicate length: 1211032
&&&&&&&&&&&&&&& after remove duplicate length: 334743

r_  generation: 0.1937851905822754

local_output_nid generation: 0.009835481643676758
local_in_edges_tensor generation: 0.024552106857299805
mini_batch_src_global generation: 0.033768415451049805

&&&&&&&&&&&&&&& before remove duplicate length: 1203968
&&&&&&&&&&&&&&& after remove duplicate length: 328540

r_  generation: 0.20816397666931152

local_output_nid generation: 0.009860515594482422
local_in_edges_tensor generation: 0.01847362518310547
mini_batch_src_global generation: 0.027174949645996094

&&&&&&&&&&&&&&& before remove duplicate length: 1124878
&&&&&&&&&&&&&&& after remove duplicate length: 368306

r_  generation: 0.24832749366760254

local_output_nid generation: 0.009981155395507812
local_in_edges_tensor generation: 0.015828847885131836
mini_batch_src_global generation: 0.034995079040527344

&&&&&&&&&&&&&&& before remove duplicate length: 1224001
&&&&&&&&&&&&&&& after remove duplicate length: 372784

r_  generation: 0.2786576747894287


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8506405353546143
gen group dst list time:  0.04256296157836914
check_connections_block*********************************
time for parepare 1: 0.3691995143890381
local_output_nid generation: 0.06526851654052734
local_in_edges_tensor generation: 0.14931440353393555
mini_batch_src_global generation: 0.10161471366882324

&&&&&&&&&&&&&&& before remove duplicate length: 3292647
&&&&&&&&&&&&&&& after remove duplicate length: 658445

r_  generation: 0.6012656688690186

local_output_nid generation: 0.08274340629577637
local_in_edges_tensor generation: 0.0994114875793457
mini_batch_src_global generation: 0.07868671417236328

&&&&&&&&&&&&&&& before remove duplicate length: 3163595
&&&&&&&&&&&&&&& after remove duplicate length: 652466

r_  generation: 0.6087746620178223

local_output_nid generation: 0.10145306587219238
local_in_edges_tensor generation: 0.24164605140686035
mini_batch_src_global generation: 0.09699535369873047

&&&&&&&&&&&&&&& before remove duplicate length: 3670516
&&&&&&&&&&&&&&& after remove duplicate length: 882648

r_  generation: 0.8129098415374756

local_output_nid generation: 0.08569931983947754
local_in_edges_tensor generation: 0.1050722599029541
mini_batch_src_global generation: 0.11070680618286133

&&&&&&&&&&&&&&& before remove duplicate length: 3700041
&&&&&&&&&&&&&&& after remove duplicate length: 702975

r_  generation: 0.7667794227600098


connection checking time:  12.429437160491943
block generation total time  11.389785289764404
pseudo mini batch 0 input nodes size: 684201
----------------------------------------before batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.2723212242126465  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5272064208984375  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5275778770446777  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

first layer input nodes number: 684201
first layer output nodes number: 337197
edges number: 3292647
----------------------------------------before model layer 0
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3061408996582031  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([684201, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3061408996582031  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3061408996582031  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.45769500732421875  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.45769500732421875  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.779271125793457  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([337197, 256])
h_self size  torch.Size([337197, 100])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.779271125793457  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([337197, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1008472442626953  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.779271125793457  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([337197, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1008472442626953  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.181241512298584  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------input nodes number: 337197
----------------output nodes number: 49801
----------------edges number: 1211032
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1849031448364258  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1849031448364258  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2417926788330078  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2417926788330078  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2505125999450684  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([49801, 47])
h_self size  torch.Size([49801, 256])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2505125999450684  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49801, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.259232521057129  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2505125999450684  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49801, 47])
pseudo mini batch 1 input nodes size: 681202
----------------------------------------before batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.26509904861450195  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.518867015838623  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5192379951477051  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

first layer input nodes number: 681202
first layer output nodes number: 330761
edges number: 3163595
----------------------------------------before model layer 0
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3040628433227539  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([681202, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3040628433227539  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3040628433227539  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.45273876190185547  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.45273876190185547  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.7681770324707031  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([330761, 256])
h_self size  torch.Size([330761, 100])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.7681770324707031  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([330761, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.0836153030395508  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.7681770324707031  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([330761, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.0836153030395508  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1624751091003418  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------input nodes number: 330761
----------------output nodes number: 49776
----------------edges number: 1203968
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1653108596801758  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1653108596801758  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.222681999206543  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.222681999206543  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2316522598266602  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([49776, 47])
h_self size  torch.Size([49776, 256])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2316522598266602  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49776, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2403678894042969  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2313976287841797  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49776, 47])
pseudo mini batch 2 input nodes size: 928927
----------------------------------------before batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.26423168182373047  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.6102843284606934  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.6106400489807129  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

first layer input nodes number: 928927
first layer output nodes number: 375952
edges number: 3670516
----------------------------------------before model layer 0
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4024639129638672  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([928927, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4024639129638672  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4024639129638672  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5714664459228516  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5714664459228516  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.9300022125244141  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([375952, 256])
h_self size  torch.Size([375952, 100])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.9300022125244141  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([375952, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2885379791259766  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.9300022125244141  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([375952, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2885379791259766  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3781719207763672  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------input nodes number: 375952
----------------output nodes number: 47743
----------------edges number: 1124878
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.38132905960083  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.38132905960083  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.4355978965759277  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.4355978965759277  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.4439573287963867  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([47743, 47])
h_self size  torch.Size([47743, 256])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.4439573287963867  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([47743, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.4523167610168457  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.4439573287963867  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([47743, 47])
pseudo mini batch 3 input nodes size: 730159
----------------------------------------before batch input features to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.35589027404785156  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.6278958320617676  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.628262996673584  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

first layer input nodes number: 730159
first layer output nodes number: 374630
edges number: 3700041
----------------------------------------before model layer 0
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.32734012603759766  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([730159, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.32734012603759766  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.32734012603759766  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.4960751533508301  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.4960751533508301  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.8533501625061035  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

h_neigh size torch.Size([374630, 256])
h_self size  torch.Size([374630, 100])
----------------------------------------before rst
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.8533501625061035  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([374630, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.210625171661377  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.8533501625061035  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([374630, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.210625171661377  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.2999439239501953  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------input nodes number: 374630
----------------output nodes number: 49251
----------------edges number: 1224001
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.3031024932861328  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.3031024932861328  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.3601131439208984  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.3601131439208984  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.369225025177002  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

h_neigh size torch.Size([49251, 47])
h_self size  torch.Size([49251, 256])
----------------------------------------before rst
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.369225025177002  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([49251, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.3778486251831055  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.368736743927002  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([49251, 47])
Number of nodes for computation during this epoch:  4443029
Number of first layer input nodes during this epoch:  3024489
Number of first layer output nodes during this epoch:  1418540

-----------------------------------------------------------------------------epoch done
read pickle file
0.6486976146697998

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.24419617652893066
global_2_local spend time (sec) 0.4089219570159912

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.221 seconds
Metis partitioning: 11.986 seconds
Split the graph: 3.088 seconds
Construct subgraphs: 0.025 seconds
50488
47720
47754
50609
REG metis partition end ----................................
the time spent:  27.236268758773804
REG construction  time spent:  8.895085334777832
pure dgl.metis_partition the time spent:  18.34118342399597
total k batches seeds list generation spend  27.92819380760193
after graph partition
graph partition algorithm spend time 28.677326440811157

partition_len_list
[348534, 310805, 383855, 387797]
REG selection method  spend 29.274742603302002
check_connections_block*********************************
time for parepare 1: 0.23046565055847168
local_output_nid generation: 0.009371757507324219
local_in_edges_tensor generation: 0.01321101188659668
mini_batch_src_global generation: 0.05063819885253906

&&&&&&&&&&&&&&& before remove duplicate length: 1229090
&&&&&&&&&&&&&&& after remove duplicate length: 345972

r_  generation: 0.20267677307128906

local_output_nid generation: 0.010194778442382812
local_in_edges_tensor generation: 0.02702188491821289
mini_batch_src_global generation: 0.03412461280822754

&&&&&&&&&&&&&&& before remove duplicate length: 1152245
&&&&&&&&&&&&&&& after remove duplicate length: 308698

r_  generation: 0.20013046264648438

local_output_nid generation: 0.01053929328918457
local_in_edges_tensor generation: 0.012347936630249023
mini_batch_src_global generation: 0.02675914764404297

&&&&&&&&&&&&&&& before remove duplicate length: 1124976
&&&&&&&&&&&&&&& after remove duplicate length: 375954

r_  generation: 0.25583624839782715

local_output_nid generation: 0.01123952865600586
local_in_edges_tensor generation: 0.02675008773803711
mini_batch_src_global generation: 0.036803245544433594

&&&&&&&&&&&&&&& before remove duplicate length: 1257568
&&&&&&&&&&&&&&& after remove duplicate length: 385849

r_  generation: 0.2852213382720947


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8265857696533203
gen group dst list time:  0.04043388366699219
check_connections_block*********************************
time for parepare 1: 0.3778390884399414
local_output_nid generation: 0.06830954551696777
local_in_edges_tensor generation: 0.1543102264404297
mini_batch_src_global generation: 0.10436606407165527

&&&&&&&&&&&&&&& before remove duplicate length: 3404543
&&&&&&&&&&&&&&& after remove duplicate length: 680132

r_  generation: 0.6103706359863281

local_output_nid generation: 0.07208538055419922
local_in_edges_tensor generation: 0.07723212242126465
mini_batch_src_global generation: 0.0727396011352539

&&&&&&&&&&&&&&& before remove duplicate length: 2964445
&&&&&&&&&&&&&&& after remove duplicate length: 617985

r_  generation: 0.5806772708892822

local_output_nid generation: 0.0941915512084961
local_in_edges_tensor generation: 0.11569881439208984
mini_batch_src_global generation: 0.10794591903686523

&&&&&&&&&&&&&&& before remove duplicate length: 3751089
&&&&&&&&&&&&&&& after remove duplicate length: 908614

r_  generation: 0.8578436374664307

local_output_nid generation: 0.08896231651306152
local_in_edges_tensor generation: 0.14224863052368164
mini_batch_src_global generation: 0.12445974349975586

&&&&&&&&&&&&&&& before remove duplicate length: 3829118
&&&&&&&&&&&&&&& after remove duplicate length: 719471

r_  generation: 0.8061554431915283


connection checking time:  12.615154266357422
block generation total time  12.039916515350342
block dataloader generation time/epoch 55.122313261032104
pseudo mini batch 0 input nodes size: 707339
----------------------------------------before batch input features to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.2826061248779297  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.5462779998779297  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.546654224395752  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

first layer input nodes number: 707339
first layer output nodes number: 348534
edges number: 3404543
----------------------------------------before model layer 0
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.31667280197143555  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([707339, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.31667280197143555  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.31667280197143555  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.47379493713378906  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.47379493713378906  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.806182861328125  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

h_neigh size torch.Size([348534, 256])
h_self size  torch.Size([348534, 100])
----------------------------------------before rst
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.806182861328125  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([348534, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.138570785522461  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.806182861328125  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([348534, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.138570785522461  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.221667766571045  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------input nodes number: 348534
----------------output nodes number: 50488
----------------edges number: 1229090
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.2246408462524414  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.2246408462524414  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.2823247909545898  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.2823247909545898  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.2911648750305176  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

h_neigh size torch.Size([50488, 47])
h_self size  torch.Size([50488, 256])
----------------------------------------before rst
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.2911648750305176  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([50488, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.3000049591064453  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.2911648750305176  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([50488, 47])
pseudo mini batch 1 input nodes size: 645282
----------------------------------------before batch input features to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.27401065826416016  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.514397144317627  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.5147528648376465  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

first layer input nodes number: 645282
first layer output nodes number: 310805
edges number: 2964445
----------------------------------------before model layer 0
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.2890920639038086  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([645282, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.2890920639038086  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.2890920639038086  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.42904186248779297  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.42904186248779297  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.7254486083984375  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

h_neigh size torch.Size([310805, 256])
h_self size  torch.Size([310805, 100])
----------------------------------------before rst
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.7254486083984375  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([310805, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.021855354309082  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.7254486083984375  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([310805, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.021855354309082  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.0959572792053223  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------input nodes number: 310805
----------------output nodes number: 47720
----------------edges number: 1152245
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.0989413261413574  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.0989413261413574  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.1533913612365723  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.1533913612365723  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.1617469787597656  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

h_neigh size torch.Size([47720, 47])
h_self size  torch.Size([47720, 256])
----------------------------------------before rst
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.1617469787597656  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([47720, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.170102596282959  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 1.1617469787597656  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([47720, 47])
pseudo mini batch 2 input nodes size: 955621
----------------------------------------before batch input features to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.25022029876708984  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.6062169075012207  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.6065731048583984  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

first layer input nodes number: 955621
first layer output nodes number: 383855
edges number: 3751089
----------------------------------------before model layer 0
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.4127650260925293  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([955621, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.4127650260925293  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 0.4127650260925293  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2811279296875 GB
    Memory Allocated: 0.5851407051086426  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2811279296875 GB
    Memory Allocated: 0.5851407051086426  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6483154296875 GB
    Memory Allocated: 0.9512133598327637  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

h_neigh size torch.Size([383855, 256])
h_self size  torch.Size([383855, 100])
----------------------------------------before rst
 Nvidia-smi: 12.6483154296875 GB
    Memory Allocated: 0.9512133598327637  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([383855, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.3172860145568848  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.9512133598327637  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([383855, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.3172860145568848  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.4088044166564941  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------input nodes number: 383855
----------------output nodes number: 47754
----------------edges number: 1124976
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.4120206832885742  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.4120206832885742  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.4668011665344238  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.4668011665344238  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.4751625061035156  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

h_neigh size torch.Size([47754, 47])
h_self size  torch.Size([47754, 256])
----------------------------------------before rst
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.4751625061035156  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([47754, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.4835238456726074  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.4751625061035156  GigaBytes
Max Memory Allocated: 2.117825984954834  GigaBytes

torch.Size([47754, 47])
pseudo mini batch 3 input nodes size: 746693
----------------------------------------before batch input features to device
 Nvidia-smi: 13.7557373046875 GB
    Memory Allocated: 0.36583662033081055  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7557373046875 GB
    Memory Allocated: 0.6440014839172363  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7557373046875 GB
    Memory Allocated: 0.644378662109375  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

first layer input nodes number: 746693
first layer output nodes number: 387797
edges number: 3829118
----------------------------------------before model layer 0
 Nvidia-smi: 13.7557373046875 GB
    Memory Allocated: 0.33600282669067383  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([746693, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 13.7557373046875 GB
    Memory Allocated: 0.33600282669067383  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.7557373046875 GB
    Memory Allocated: 0.33600282669067383  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.7557373046875 GB
    Memory Allocated: 0.5104427337646484  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.7557373046875 GB
    Memory Allocated: 0.5104427337646484  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.1268310546875 GB
    Memory Allocated: 0.880274772644043  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([387797, 256])
h_self size  torch.Size([387797, 100])
----------------------------------------before rst
 Nvidia-smi: 14.1268310546875 GB
    Memory Allocated: 0.880274772644043  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([387797, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.2501068115234375  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 0.880274772644043  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([387797, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.2501068115234375  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.3425650596618652  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------input nodes number: 387797
----------------output nodes number: 50609
----------------edges number: 1257568
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.3465867042541504  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.3465867042541504  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.4045987129211426  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.4045987129211426  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.4134597778320312  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([50609, 47])
h_self size  torch.Size([50609, 256])
----------------------------------------before rst
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.4134597778320312  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([50609, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.42232084274292  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.4134597778320312  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([50609, 47])
Average training time/epoch 0.7839763164520264
Average Training time/epoch w/o nid counting 0.7835736274719238
Number of nodes for computation during this epoch:  4485926
Number of first layer input nodes during this epoch:  3054935
Number of first layer output nodes during this epoch:  1430991

-----------------------------------------------------------------------------epoch done
read pickle file
0.7026684284210205

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.3033902645111084
global_2_local spend time (sec) 0.4729020595550537

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.288 seconds
Metis partitioning: 12.427 seconds
Split the graph: 3.348 seconds
Construct subgraphs: 0.049 seconds
47783
50591
48012
50185
REG metis partition end ----................................
the time spent:  28.380248069763184
REG construction  time spent:  9.247063159942627
pure dgl.metis_partition the time spent:  19.133184909820557
total k batches seeds list generation spend  29.077077388763428
after graph partition
graph partition algorithm spend time 29.818950653076172

partition_len_list
[375645, 386656, 349792, 340625]
REG selection method  spend 30.49830985069275
check_connections_block*********************************
time for parepare 1: 0.2137908935546875
local_output_nid generation: 0.009120941162109375
local_in_edges_tensor generation: 0.013542413711547852
mini_batch_src_global generation: 0.03752279281616211

&&&&&&&&&&&&&&& before remove duplicate length: 1127793
&&&&&&&&&&&&&&& after remove duplicate length: 368193

r_  generation: 0.2292466163635254

local_output_nid generation: 0.010962486267089844
local_in_edges_tensor generation: 0.0167388916015625
mini_batch_src_global generation: 0.04019737243652344

&&&&&&&&&&&&&&& before remove duplicate length: 1255859
&&&&&&&&&&&&&&& after remove duplicate length: 384515

r_  generation: 0.26125144958496094

local_output_nid generation: 0.010454654693603516
local_in_edges_tensor generation: 0.03860068321228027
mini_batch_src_global generation: 0.02880239486694336

&&&&&&&&&&&&&&& before remove duplicate length: 1161226
&&&&&&&&&&&&&&& after remove duplicate length: 346463

r_  generation: 0.23988032341003418

local_output_nid generation: 0.011991024017333984
local_in_edges_tensor generation: 0.02256608009338379
mini_batch_src_global generation: 0.04054093360900879

&&&&&&&&&&&&&&& before remove duplicate length: 1219001
&&&&&&&&&&&&&&& after remove duplicate length: 338372

r_  generation: 0.24364447593688965


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8084728717803955
gen group dst list time:  0.04906868934631348
check_connections_block*********************************
time for parepare 1: 0.4137725830078125
local_output_nid generation: 0.08626890182495117
local_in_edges_tensor generation: 0.16855239868164062
mini_batch_src_global generation: 0.11673235893249512

&&&&&&&&&&&&&&& before remove duplicate length: 3670077
&&&&&&&&&&&&&&& after remove duplicate length: 878247

r_  generation: 0.873408317565918

local_output_nid generation: 0.11320281028747559
local_in_edges_tensor generation: 0.14263629913330078
mini_batch_src_global generation: 0.10184311866760254

&&&&&&&&&&&&&&& before remove duplicate length: 3816686
&&&&&&&&&&&&&&& after remove duplicate length: 723969

r_  generation: 0.779055118560791

local_output_nid generation: 0.09446883201599121
local_in_edges_tensor generation: 0.11094450950622559
mini_batch_src_global generation: 0.09400200843811035

&&&&&&&&&&&&&&& before remove duplicate length: 3413126
&&&&&&&&&&&&&&& after remove duplicate length: 746194

r_  generation: 0.7597134113311768

local_output_nid generation: 0.10154271125793457
local_in_edges_tensor generation: 0.14886999130249023
mini_batch_src_global generation: 0.09168839454650879

&&&&&&&&&&&&&&& before remove duplicate length: 3266745
&&&&&&&&&&&&&&& after remove duplicate length: 699393

r_  generation: 0.7464807033538818


connection checking time:  13.575302124023438
block generation total time  12.05634880065918
block dataloader generation time/epoch 56.24352478981018
pseudo mini batch 0 input nodes size: 924191
----------------------------------------before batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.2885246276855469  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.6328129768371582  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.6331691741943359  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

first layer input nodes number: 924191
first layer output nodes number: 375645
edges number: 3670077
----------------------------------------before model layer 0
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.4006690979003906  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([924191, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.4006690979003906  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.4006690979003906  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5693669319152832  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5693669319152832  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.927609920501709  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([375645, 256])
h_self size  torch.Size([375645, 100])
----------------------------------------before rst
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.927609920501709  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([375645, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2858529090881348  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.927609920501709  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([375645, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2858529090881348  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3754138946533203  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------input nodes number: 375645
----------------output nodes number: 47783
----------------edges number: 1127793
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3788552284240723  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3788552284240723  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4331841468811035  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4331841468811035  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4415507316589355  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([47783, 47])
h_self size  torch.Size([47783, 256])
----------------------------------------before rst
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4415507316589355  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([47783, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4499173164367676  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4415507316589355  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([47783, 47])
pseudo mini batch 1 input nodes size: 751944
----------------------------------------before batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.35413360595703125  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.6342549324035645  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.6346321105957031  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

first layer input nodes number: 751944
first layer output nodes number: 386656
edges number: 3816686
----------------------------------------before model layer 0
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.3374366760253906  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([751944, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.3374366760253906  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.3374366760253906  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5113544464111328  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5113544464111328  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.8800983428955078  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([386656, 256])
h_self size  torch.Size([386656, 100])
----------------------------------------before rst
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.8800983428955078  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([386656, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2488422393798828  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.8800983428955078  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([386656, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2488422393798828  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3410282135009766  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------input nodes number: 386656
----------------output nodes number: 50591
----------------edges number: 1255859
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3442864418029785  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3442864418029785  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.402268886566162  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.402268886566162  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4111270904541016  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([50591, 47])
h_self size  torch.Size([50591, 256])
----------------------------------------before rst
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4111270904541016  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([50591, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.419985294342041  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4111270904541016  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([50591, 47])
pseudo mini batch 2 input nodes size: 775757
----------------------------------------before batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.2904791831970215  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5794715881347656  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5798296928405762  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

first layer input nodes number: 775757
first layer output nodes number: 349792
edges number: 3413126
----------------------------------------before model layer 0
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.34516048431396484  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([775757, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.34516048431396484  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.34516048431396484  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5031585693359375  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5031585693359375  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.8371429443359375  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([349792, 256])
h_self size  torch.Size([349792, 100])
----------------------------------------before rst
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.8371429443359375  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([349792, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.1707305908203125  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.8367462158203125  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([349792, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.1707305908203125  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2537307739257812  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------input nodes number: 349792
----------------output nodes number: 48012
----------------edges number: 1161226
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2571454048156738  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2571454048156738  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3119444847106934  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3119444847106934  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3203511238098145  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([48012, 47])
h_self size  torch.Size([48012, 256])
----------------------------------------before rst
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3203511238098145  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([48012, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3287577629089355  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3203511238098145  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([48012, 47])
pseudo mini batch 3 input nodes size: 729822
----------------------------------------before batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.29887962341308594  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5707597732543945  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.571134090423584  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

first layer input nodes number: 729822
first layer output nodes number: 340625
edges number: 3266745
----------------------------------------before model layer 0
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.3231821060180664  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([729822, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.3231821060180664  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.3231821060180664  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.4757418632507324  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.4757418632507324  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.8005871772766113  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([340625, 256])
h_self size  torch.Size([340625, 100])
----------------------------------------before rst
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.8005871772766113  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([340625, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.1254324913024902  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.8005871772766113  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([340625, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.1254324913024902  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.206644058227539  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------input nodes number: 340625
----------------output nodes number: 50185
----------------edges number: 1219001
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2102980613708496  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2102980613708496  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.267615795135498  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.267615795135498  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2764029502868652  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([50185, 47])
h_self size  torch.Size([50185, 256])
----------------------------------------before rst
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2764029502868652  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([50185, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2851901054382324  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2764029502868652  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([50185, 47])
Average training time/epoch 0.7569350004196167
Average Training time/epoch w/o nid counting 0.7294690608978271
Number of nodes for computation during this epoch:  4634432
Number of first layer input nodes during this epoch:  3181714
Number of first layer output nodes during this epoch:  1452718

-----------------------------------------------------------------------------epoch done
read pickle file
0.6668281555175781

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2519533634185791
global_2_local spend time (sec) 0.4352381229400635

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.130 seconds
Metis partitioning: 12.036 seconds
Split the graph: 3.414 seconds
Construct subgraphs: 0.057 seconds
47744
50570
48971
49286
REG metis partition end ----................................
the time spent:  27.662405014038086
REG construction  time spent:  9.004318475723267
pure dgl.metis_partition the time spent:  18.65808653831482
total k batches seeds list generation spend  28.319031238555908
after graph partition
graph partition algorithm spend time 29.088221788406372

partition_len_list
[376434, 393152, 321609, 333163]
REG selection method  spend 29.73404026031494
check_connections_block*********************************
time for parepare 1: 0.21396207809448242
local_output_nid generation: 0.00907588005065918
local_in_edges_tensor generation: 0.011645317077636719
mini_batch_src_global generation: 0.03715252876281738

&&&&&&&&&&&&&&& before remove duplicate length: 1125578
&&&&&&&&&&&&&&& after remove duplicate length: 368718

r_  generation: 0.2237081527709961

local_output_nid generation: 0.010929346084594727
local_in_edges_tensor generation: 0.011898040771484375
mini_batch_src_global generation: 0.04201006889343262

&&&&&&&&&&&&&&& before remove duplicate length: 1256879
&&&&&&&&&&&&&&& after remove duplicate length: 391090

r_  generation: 0.268157958984375

local_output_nid generation: 0.011773347854614258
local_in_edges_tensor generation: 0.013710737228393555
mini_batch_src_global generation: 0.034180641174316406

&&&&&&&&&&&&&&& before remove duplicate length: 1184303
&&&&&&&&&&&&&&& after remove duplicate length: 319531

r_  generation: 0.2176837921142578

local_output_nid generation: 0.011113882064819336
local_in_edges_tensor generation: 0.027266502380371094
mini_batch_src_global generation: 0.03493618965148926

&&&&&&&&&&&&&&& before remove duplicate length: 1197119
&&&&&&&&&&&&&&& after remove duplicate length: 330626

r_  generation: 0.22882294654846191


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7792487144470215
gen group dst list time:  0.04664301872253418
check_connections_block*********************************
time for parepare 1: 0.36311769485473633
local_output_nid generation: 0.08487296104431152
local_in_edges_tensor generation: 0.16367554664611816
mini_batch_src_global generation: 0.1192164421081543

&&&&&&&&&&&&&&& before remove duplicate length: 3677879
&&&&&&&&&&&&&&& after remove duplicate length: 883549

r_  generation: 0.7722795009613037

local_output_nid generation: 0.09922623634338379
local_in_edges_tensor generation: 0.1486530303955078
mini_batch_src_global generation: 0.15025711059570312

&&&&&&&&&&&&&&& before remove duplicate length: 3884726
&&&&&&&&&&&&&&& after remove duplicate length: 725761

r_  generation: 0.7778584957122803

local_output_nid generation: 0.0866689682006836
local_in_edges_tensor generation: 0.09229850769042969
mini_batch_src_global generation: 0.08145761489868164

&&&&&&&&&&&&&&& before remove duplicate length: 3069028
&&&&&&&&&&&&&&& after remove duplicate length: 642355

r_  generation: 0.6371104717254639

local_output_nid generation: 0.08678960800170898
local_in_edges_tensor generation: 0.16812396049499512
mini_batch_src_global generation: 0.09119749069213867

&&&&&&&&&&&&&&& before remove duplicate length: 3251058
&&&&&&&&&&&&&&& after remove duplicate length: 653784

r_  generation: 0.6568007469177246


connection checking time:  12.772977352142334
block generation total time  11.9839768409729
block dataloader generation time/epoch 56.04477349917094
pseudo mini batch 0 input nodes size: 929527
----------------------------------------before batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.282163143157959  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.6284389495849609  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.6287946701049805  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

first layer input nodes number: 929527
first layer output nodes number: 376434
edges number: 3677879
----------------------------------------before model layer 0
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.4021573066711426  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([929527, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.4021573066711426  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.4021573066711426  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5714297294616699  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.5714297294616699  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.9304251670837402  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([376434, 256])
h_self size  torch.Size([376434, 100])
----------------------------------------before rst
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.9304251670837402  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([376434, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2894206047058105  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.9304251670837402  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([376434, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.2894206047058105  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3791694641113281  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------input nodes number: 376434
----------------output nodes number: 47744
----------------edges number: 1125578
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3823299407958984  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.3823299407958984  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4371027946472168  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4371027946472168  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4454622268676758  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([47744, 47])
h_self size  torch.Size([47744, 256])
----------------------------------------before rst
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4454622268676758  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([47744, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4538216590881348  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 1.4454622268676758  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([47744, 47])
pseudo mini batch 1 input nodes size: 753884
----------------------------------------before batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.3561134338378906  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.6369571685791016  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.6373343467712402  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

first layer input nodes number: 753884
first layer output nodes number: 393152
edges number: 3884726
----------------------------------------before model layer 0
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.33939027786254883  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([753884, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.33939027786254883  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2440185546875 GB
    Memory Allocated: 0.33939027786254883  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2459716796875 GB
    Memory Allocated: 0.5162596702575684  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2459716796875 GB
    Memory Allocated: 0.5162596702575684  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 0.8912596702575684  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([393152, 256])
h_self size  torch.Size([393152, 100])
----------------------------------------before rst
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 0.8912596702575684  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([393152, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.2662596702575684  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 0.8912596702575684  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([393152, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.2662596702575684  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.3599944114685059  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------input nodes number: 393152
----------------output nodes number: 50570
----------------edges number: 1256879
----------------------------------------before mean aggregator
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.3633008003234863  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.3633008003234863  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.4212708473205566  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.4212708473205566  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.4301252365112305  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([50570, 47])
h_self size  torch.Size([50570, 256])
----------------------------------------before rst
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.4301252365112305  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([50570, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.4389796257019043  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.3709716796875 GB
    Memory Allocated: 1.4301252365112305  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([50570, 47])
pseudo mini batch 2 input nodes size: 670735
----------------------------------------before batch input features to device
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.2911977767944336  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.5410661697387695  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.5414314270019531  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

first layer input nodes number: 670735
first layer output nodes number: 321609
edges number: 3069028
----------------------------------------before model layer 0
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.2997007369995117  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([670735, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.2997007369995117  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.2997007369995117  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.4442415237426758  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.4442415237426758  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.7509517669677734  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([321609, 256])
h_self size  torch.Size([321609, 100])
----------------------------------------before rst
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.7509517669677734  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([321609, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.057662010192871  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.7509517669677734  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([321609, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.057662010192871  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.1343398094177246  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------input nodes number: 321609
----------------output nodes number: 48971
----------------edges number: 1184303
----------------------------------------before mean aggregator
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.137101650238037  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.137101650238037  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.1929936408996582  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.1929936408996582  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.2015681266784668  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([48971, 47])
h_self size  torch.Size([48971, 256])
----------------------------------------before rst
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.2015681266784668  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([48971, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.2101426124572754  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.2015681266784668  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([48971, 47])
pseudo mini batch 3 input nodes size: 679907
----------------------------------------before batch input features to device
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.2599306106567383  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.5132160186767578  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.5135836601257324  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

first layer input nodes number: 679907
first layer output nodes number: 333163
edges number: 3251058
----------------------------------------before model layer 0
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.30476951599121094  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([679907, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.30476951599121094  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.30476951599121094  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.4546656608581543  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.4546656608581543  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.7723946571350098  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([333163, 256])
h_self size  torch.Size([333163, 100])
----------------------------------------before rst
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.7723946571350098  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([333163, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.0901236534118652  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 0.7723946571350098  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([333163, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.0901236534118652  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.1695561408996582  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------input nodes number: 333163
----------------output nodes number: 49286
----------------edges number: 1197119
----------------------------------------before mean aggregator
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.1724061965942383  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.1724061965942383  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.2286968231201172  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.2286968231201172  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.2373266220092773  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

h_neigh size torch.Size([49286, 47])
h_self size  torch.Size([49286, 256])
----------------------------------------before rst
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.2373266220092773  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([49286, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.2459564208984375  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.7498779296875 GB
    Memory Allocated: 1.2373266220092773  GigaBytes
Max Memory Allocated: 2.1630444526672363  GigaBytes

torch.Size([49286, 47])
Average training time/epoch 0.7564662297566732
Average Training time/epoch w/o nid counting 0.7551062107086182
Number of nodes for computation during this epoch:  4458411
Number of first layer input nodes during this epoch:  3034053
Number of first layer output nodes during this epoch:  1424358

-----------------------------------------------------------------------------epoch done
