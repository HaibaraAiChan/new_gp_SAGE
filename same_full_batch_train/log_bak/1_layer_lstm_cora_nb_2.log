main start at this time 1649924394.53046
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012886524200439453
src global
[432, 403, 346, 2029, 1049, 637, 2208, 623, 1819, 821, 1428, 1162, 186, 2064, 328, 818, 419, 2032, 1002, 2226, 1587, 2001, 2004, 74, 431, 1793, 266, 592, 130, 2569, 1415, 2367, 2287, 1985, 1898, 910, 79, 7, 2296, 1716, 2445, 1454, 1938, 168, 352, 1410, 1286, 2068, 624, 67, 602, 2401, 1794, 1879, 417, 2469, 845, 580, 2160, 925, 542, 1372, 1230, 70, 72, 310, 776, 741, 1958, 2669, 2079, 2528, 2543, 1101, 2223, 899, 1082, 2020, 1682, 184, 1924, 736, 1047, 240, 866, 2658, 2673, 2681, 65, 554, 812, 1209, 1981, 484, 140, 1337, 138, 2209, 1921, 859, 1939, 479, 52, 1516, 760, 1544, 2518, 1852, 2232, 34, 452, 1826, 2156, 1941, 850, 2141, 1487, 575, 1488, 2468, 1754, 501, 1795, 468, 666, 1281, 1343, 645, 1308, 2169, 1327, 2337, 2224, 69, 3, 429, 2013, 24, 242, 1683, 783, 749, 404, 291, 311, 622, 491, 715, 589, 1301, 1300, 2435, 1857, 1183, 1125, 1288, 635, 636, 1652, 2544, 2030, 627, 1270, 1888, 2164, 2037, 1886, 2275, 2190, 1078, 1890, 1887, 1502, 1401, 747, 2103, 796, 1486, 1465, 1161, 878, 858, 1603, 187, 1318, 1319, 253, 354, 536, 327, 1497, 757, 1433, 761, 420, 2332, 2436, 1378, 2081, 2036, 1840, 1781, 2206, 2557, 1694, 1323, 2066, 855, 1624, 1751, 2411, 1239, 1240, 1253, 1248, 1777, 1249, 1618, 1987, 1801, 1250, 1645, 2254, 73, 781, 571, 570, 340, 568, 567, 1007, 1055, 2265, 1006, 1867, 360, 295, 347, 1238, 137, 131, 2629, 2264, 2568, 2266, 2270, 2267, 2268, 2269, 1405, 1417, 725, 724, 1418, 1168, 1644, 726, 2230, 2599, 1828, 2137, 2574, 2288, 2329, 2519, 2331, 2147, 2527, 2145, 1611, 1197, 1192, 1955, 1196, 1328, 1189, 1190, 1194, 1980, 1093, 1083, 1084, 1085, 994, 997, 500, 990, 80, 5, 4, 6, 8, 1850, 2298, 1849, 1861, 1847, 1846, 1851, 2578, 1848, 948, 1316, 947, 2604, 2063, 2065, 2082, 1422, 809, 1429, 1946, 2396, 1397, 1600, 1802, 2041, 1341, 169, 263, 563, 596, 1426, 1482, 1442, 1448, 711, 777, 808, 1430, 778, 2018, 2447, 1364, 359, 68, 66, 1241, 2193, 2600, 1975, 1998, 1974, 1972, 1973, 2017, 1054, 1008, 2326, 2111, 1060, 1059, 1317, 1058, 1099, 2165, 395, 758, 2104, 2105, 1583, 1172, 643, 911, 364, 1213, 2311, 2154, 2536, 2255, 922, 924, 1659, 541, 1104, 662, 2075, 1229, 979, 1228, 71, 380, 308, 309, 765, 1444, 766, 779, 1423, 1173, 2397, 1957, 1174, 1956, 2648, 2657, 2659, 2663, 1829, 2452, 1377, 2621, 2330, 2628, 2558, 2204, 2205, 535, 1918, 538, 537, 1673, 1685, 1689, 1684, 1677, 2006, 1686, 2239, 2007, 1680, 901, 1631, 898, 902, 1427, 1895, 2426, 1046, 1669, 185, 182, 183, 2353, 2360, 2117, 772, 1420, 917, 518, 288, 223, 1324, 1601, 926, 867, 655, 462, 654, 2635, 2634, 2631, 2632, 2630, 2633, 2670, 2651, 2682, 2654, 2672, 2676, 2691, 2671, 1152, 1371, 1485, 1989, 1792, 2403, 1984, 1982, 927, 136, 143, 135, 1321, 1322, 142, 2349, 2357, 1108, 1617, 2158, 1109, 1107, 1590, 478, 1163, 1602, 1329, 915, 860, 51, 1403, 1435, 1100, 438, 418, 1298, 2521, 2530, 2595, 1667, 2566, 2545, 2211, 36, 35, 33, 32, 834, 2023, 2284, 2346, 2093, 1648, 1165, 1358, 1937, 460, 852, 1586, 2142, 1597, 1943, 1820, 1594, 1593, 2009, 2440, 2339, 2042, 2072, 1081, 1191, 813, 2456, 1052, 2244, 966, 1051, 991, 578, 510, 1783, 874, 667, 1373, 2014, 1936, 1295, 365, 1091, 1268, 1271, 1309, 1267, 2051, 1350, 2008, 1636, 1331, 1335, 1302, 1910, 2343, 2442, 1909, 1691, 1692, 2012, 2556, 0, 1, 2, 780, 430, 771, 2419, 1279, 1280, 1278, 22, 23, 254, 293, 226, 227, 971, 1676]
dst local
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
global_2_local spend time (sec) 0.00017642974853515625
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0005638599395751953
nx_g = dgl.to_networkx(g)   spent  0.002458810806274414
A = nx.to_scipy_sparse_matrix(nx_g)   spent  0.003781557083129883
shared_neighbor_matrix = (AT*A)   spent  0.0004436969757080078
shared_neighbor_matrix = (AT*A).todok()   spent  0.0005433559417724609
shared_neighbor_matrix.setdiag(0), achieve weights  spent  0.006692171096801758
get remove nodes spent  0.000392913818359375
remove nodes length
450
  (117, 2)	1
  (100, 11)	1
  (40, 13)	1
  (81, 30)	1
  (131, 34)	1
  (134, 37)	1
  (107, 38)	1
  (13, 40)	1
  (63, 49)	1
  (88, 49)	1
  (133, 49)	1
  (49, 63)	1
  (133, 63)	1
  (87, 69)	1
  (30, 81)	1
  (107, 82)	1
  (69, 87)	1
  (49, 88)	1
  (133, 88)	1
  (101, 99)	1
  (11, 100)	1
  (130, 100)	1
  (99, 101)	1
  (38, 107)	1
  (82, 107)	1
  (2, 117)	1
  (100, 130)	1
  (34, 131)	1
  (49, 133)	1
  (63, 133)	1
  (88, 133)	1
  (37, 134)	1
prepare for output_shared_matrix spent  0.0001850128173828125
32
    source  target  weight  capacity
0      117       2       1         1
1      100      11       1         1
2       40      13       1         1
3       81      30       1         1
4      131      34       1         1
5      134      37       1         1
6      107      38       1         1
7       13      40       1         1
8       63      49       1         1
9       88      49       1         1
10     133      49       1         1
11      49      63       1         1
12     133      63       1         1
13      87      69       1         1
14      30      81       1         1
15     107      82       1         1
16      69      87       1         1
17      49      88       1         1
18     133      88       1         1
19     101      99       1         1
20      11     100       1         1
21     130     100       1         1
22      99     101       1         1
23      38     107       1         1
24      82     107       1         1
25       2     117       1         1
26     100     130       1         1
27      34     131       1         1
28      49     133       1         1
29      63     133       1         1
30      88     133       1         1
31      37     134       1         1
get auxiliary matrix spent  0.014191627502441406
cut_value
0
({2, 131, 130, 133, 69, 11, 13, 81, 82, 87, 88, 30, 34, 99, 100, 38, 101, 40, 107, 49, 117, 63}, {37, 134})
get mini cut partition spent  0.0005395412445068359
partition adjustment spent  0.022621870040893555
self.weighted_graph_bipart() spend  0.08370685577392578
after graph partition
graph partition algorithm spend time 0.08409929275512695
[65, 67, 69, 70, 346, 479, 575, 736, 859, 1047, 1162, 1327, 1415, 1852, 1898, 1939, 2064, 2296, 2337, 2445, 2669, 2681]
[3, 7, 24, 34, 52, 72, 74, 79, 130, 138, 140, 168, 184, 186, 240, 242, 266, 310, 328, 352, 403, 417, 419, 429, 431, 432, 452, 468, 484, 501, 542, 554, 580, 592, 602, 623, 624, 637, 645, 666, 741, 760, 776, 812, 818, 821, 845, 850, 866, 899, 910, 925, 1002, 1049, 1082, 1101, 1209, 1230, 1281, 1286, 1308, 1337, 1343, 1372, 1410, 1428, 1454, 1487, 1488, 1516, 1544, 1587, 1682, 1683, 1716, 1754, 1793, 1794, 1795, 1819, 1826, 1879, 1921, 1924, 1938, 1941, 1958, 1981, 1985, 2001, 2004, 2013, 2020, 2029, 2032, 2068, 2079, 2141, 2156, 2160, 2169, 2208, 2209, 2223, 2224, 2226, 2232, 2287, 2367, 2401, 2468, 2469, 2518, 2528, 2543, 2569, 2658, 2673]
partition_len_list
[95, 510]
shared_neighbor_graph_partition selection method range initialization spend 0.08459806442260742
time for parepare:  5.698204040527344e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0006835460662841797
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00014090538024902344
----------------------check_connections_block total spend ----------------------------- 0.0014317035675048828
generate_one_block  0.0033817291259765625
generate_one_block  0.0012640953063964844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 95
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06312799453735352  GigaBytes
Max Memory Allocated: 0.06312799453735352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06312847137451172  GigaBytes
Max Memory Allocated: 0.06312847137451172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06312847137451172  GigaBytes
Max Memory Allocated: 0.06312847137451172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06312942504882812  GigaBytes
Max Memory Allocated: 0.06312942504882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06312942504882812  GigaBytes
Max Memory Allocated: 0.06312942504882812  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06312942504882812  GigaBytes
Max Memory Allocated: 0.06312942504882812  GigaBytes

torch.Size([95, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06312942504882812  GigaBytes
Max Memory Allocated: 0.06312942504882812  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06312942504882812  GigaBytes
Max Memory Allocated: 0.06312942504882812  GigaBytes

m.shape torch.Size([1, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06375265121459961  GigaBytes
Max Memory Allocated: 0.06375360488891602  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06375265121459961  GigaBytes
Max Memory Allocated: 0.06375360488891602  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06376409530639648  GigaBytes
Max Memory Allocated: 0.06376409530639648  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06392717361450195  GigaBytes
Max Memory Allocated: 0.06393814086914062  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([5, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06400156021118164  GigaBytes
Max Memory Allocated: 0.06400251388549805  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06400156021118164  GigaBytes
Max Memory Allocated: 0.06400251388549805  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06405496597290039  GigaBytes
Max Memory Allocated: 0.06405496597290039  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06522989273071289  GigaBytes
Max Memory Allocated: 0.06531000137329102  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([4, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06528902053833008  GigaBytes
Max Memory Allocated: 0.06531000137329102  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06528902053833008  GigaBytes
Max Memory Allocated: 0.06531000137329102  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06533193588256836  GigaBytes
Max Memory Allocated: 0.06533193588256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06657648086547852  GigaBytes
Max Memory Allocated: 0.06666231155395508  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([5, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06668853759765625  GigaBytes
Max Memory Allocated: 0.06668949127197266  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06668853759765625  GigaBytes
Max Memory Allocated: 0.06668949127197266  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.066741943359375  GigaBytes
Max Memory Allocated: 0.066741943359375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06866455078125  GigaBytes
Max Memory Allocated: 0.06879806518554688  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([2, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06870222091674805  GigaBytes
Max Memory Allocated: 0.06879806518554688  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06870222091674805  GigaBytes
Max Memory Allocated: 0.06879806518554688  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06872415542602539  GigaBytes
Max Memory Allocated: 0.06879806518554688  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06965017318725586  GigaBytes
Max Memory Allocated: 0.06971454620361328  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06971406936645508  GigaBytes
Max Memory Allocated: 0.06971502304077148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06971406936645508  GigaBytes
Max Memory Allocated: 0.06971502304077148  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06973600387573242  GigaBytes
Max Memory Allocated: 0.06973600387573242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07081270217895508  GigaBytes
Max Memory Allocated: 0.07088756561279297  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07084465026855469  GigaBytes
Max Memory Allocated: 0.07088756561279297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07084465026855469  GigaBytes
Max Memory Allocated: 0.07088756561279297  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07085609436035156  GigaBytes
Max Memory Allocated: 0.07088756561279297  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07147407531738281  GigaBytes
Max Memory Allocated: 0.0715169906616211  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07157516479492188  GigaBytes
Max Memory Allocated: 0.07157611846923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07157516479492188  GigaBytes
Max Memory Allocated: 0.07157611846923828  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07159709930419922  GigaBytes
Max Memory Allocated: 0.07159709930419922  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07312583923339844  GigaBytes
Max Memory Allocated: 0.07323265075683594  GigaBytes

torch.Size([1, 2, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07262134552001953  GigaBytes
Max Memory Allocated: 0.07346582412719727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07262229919433594  GigaBytes
Max Memory Allocated: 0.07346582412719727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07262325286865234  GigaBytes
Max Memory Allocated: 0.07346582412719727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07262182235717773  GigaBytes
Max Memory Allocated: 0.07346582412719727  GigaBytes

torch.Size([22, 7])
input nodes number: 95
output nodes number: 22
edges number: 112
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07262516021728516  GigaBytes
Max Memory Allocated: 0.07346582412719727  GigaBytes

torch.Size([22, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07262611389160156  GigaBytes
Max Memory Allocated: 0.07346582412719727  GigaBytes

torch.Size([22, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07262659072875977  GigaBytes
Max Memory Allocated: 0.07346582412719727  GigaBytes

torch.Size([22, 7])
torch.Size([22, 7])
input nodes number: 95
output nodes number: 22
edges number: 112
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07262754440307617  GigaBytes
Max Memory Allocated: 0.07346582412719727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07262849807739258  GigaBytes
Max Memory Allocated: 0.07346582412719727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12575340270996094  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

pseudo mini batch 1 input nodes size: 510
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.1257495880126953  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.1257495880126953  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12847232818603516  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12847328186035156  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12796545028686523  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12796926498413086  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12796926498413086  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12796926498413086  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([510, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12796926498413086  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.12796926498413086  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.13051509857177734  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.13051509857177734  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.13072872161865234  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.13243770599365234  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([1, 20, 1433])
m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.13258743286132812  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.13258743286132812  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.1328439712524414  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.1366891860961914  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([1, 24, 1433])
m.shape torch.Size([21, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.13689756393432617  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.13689756393432617  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3807373046875 GB
    Memory Allocated: 0.13712263107299805  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.1420612335205078  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([1, 21, 1433])
m.shape torch.Size([18, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.1423335075378418  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.1423335075378418  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.14252614974975586  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.14810705184936523  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([1, 18, 1433])
m.shape torch.Size([10, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.14827775955200195  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.14827775955200195  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3885498046875 GB
    Memory Allocated: 0.14838457107543945  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.15222978591918945  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([1, 10, 1433])
m.shape torch.Size([9, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1524648666381836  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1524648666381836  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.15256118774414062  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.15670299530029297  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([1, 9, 1433])
m.shape torch.Size([2, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.15672969818115234  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.15672969818115234  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.1567516326904297  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.15782833099365234  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.15790319442749023  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.15790319442749023  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.15792512893676758  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.15915250778198242  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.1593341827392578  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.1593341827392578  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.1593770980834961  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.1621236801147461  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([8, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.16252946853637695  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.16252946853637695  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.16261529922485352  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.16869497299194336  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([1, 8, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.16684818267822266  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.16685152053833008  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.1668548583984375  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.16685056686401367  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([118, 7])
input nodes number: 510
output nodes number: 118
edges number: 453
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.16685962677001953  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([118, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.16686296463012695  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([118, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.16686391830444336  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

torch.Size([118, 7])
torch.Size([118, 7])
input nodes number: 510
output nodes number: 118
edges number: 453
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.16686630249023438  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.16686677932739258  GigaBytes
Max Memory Allocated: 0.19737768173217773  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.12798070907592773  GigaBytes
Max Memory Allocated: 0.2902817726135254  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5975341796875 GB
    Memory Allocated: 0.2532191276550293  GigaBytes
Max Memory Allocated: 0.3469691276550293  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5975341796875 GB
    Memory Allocated: 0.2532191276550293  GigaBytes
Max Memory Allocated: 0.3469691276550293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006755352020263672 |0.1712867021560669 |0.2646716833114624 |0.00012695789337158203 |0.01806628704071045 |0.005339622497558594 |
----------------------------------------------------------pseudo_mini_loss sum 2.4940526485443115
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  605
Number of first layer input nodes during this epoch:  605
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=7, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(7, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  16459452
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([7, 1433])
layers.0.fc_neigh.weight, torch.Size([7, 1433])
bns.0.weight, torch.Size([7])
bns.0.bias, torch.Size([7])
----------------------------------------
un-trainable parameters
