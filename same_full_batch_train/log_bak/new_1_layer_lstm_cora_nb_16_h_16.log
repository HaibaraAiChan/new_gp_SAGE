main start at this time 1649984786.18962
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010609626770019531
global_2_local spend time (sec) 0.00010085105895996094
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00035762786865234375
A = g.adjacency_matrix() spent  0.00021886825561523438
get remove nodes spent  0.0004868507385253906
remove nodes length
450
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.003 seconds
total k batches seeds list generation spend  0.008714914321899414
after graph partition
graph partition algorithm spend time 0.06032228469848633
9
9
9
9
9
9
9
9
8
9
9
8
9
8
9
8
partition_len_list
[37, 38, 42, 49, 44, 34, 48, 38, 33, 40, 48, 42, 24, 25, 43, 38]
shared_neighbor_graph_partition selection method range initialization spend 0.06061053276062012
time for parepare:  7.271766662597656e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0011343955993652344
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5020370483398438e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0265579223632812e-05
----------------------check_connections_block total spend ----------------------------- 0.0039865970611572266
generate_one_block  0.002271413803100586
generate_one_block  0.0010619163513183594
generate_one_block  0.0010592937469482422
generate_one_block  0.001032114028930664
generate_one_block  0.0010151863098144531
generate_one_block  0.0009572505950927734
generate_one_block  0.0009541511535644531
generate_one_block  0.0009963512420654297
generate_one_block  0.0009882450103759766
generate_one_block  0.0009551048278808594
generate_one_block  0.0010306835174560547
generate_one_block  0.0018727779388427734
generate_one_block  0.0009665489196777344
generate_one_block  0.0009593963623046875
generate_one_block  0.0009610652923583984
generate_one_block  0.0009577274322509766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 37
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06281852722167969  GigaBytes
Max Memory Allocated: 0.06281852722167969  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06281900405883789  GigaBytes
Max Memory Allocated: 0.06281900405883789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06281900405883789  GigaBytes
Max Memory Allocated: 0.06281900405883789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.0628199577331543  GigaBytes
Max Memory Allocated: 0.0628199577331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.0628199577331543  GigaBytes
Max Memory Allocated: 0.0628199577331543  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.0628199577331543  GigaBytes
Max Memory Allocated: 0.0628199577331543  GigaBytes

torch.Size([37, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.0628199577331543  GigaBytes
Max Memory Allocated: 0.0628199577331543  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.0628199577331543  GigaBytes
Max Memory Allocated: 0.0628199577331543  GigaBytes

m.shape torch.Size([3, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.0630335807800293  GigaBytes
Max Memory Allocated: 0.0630345344543457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.0630335807800293  GigaBytes
Max Memory Allocated: 0.0630345344543457  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06306600570678711  GigaBytes
Max Memory Allocated: 0.06306600570678711  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06354951858520508  GigaBytes
Max Memory Allocated: 0.06358194351196289  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06354951858520508  GigaBytes
Max Memory Allocated: 0.06358194351196289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06354951858520508  GigaBytes
Max Memory Allocated: 0.06358194351196289  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06356096267700195  GigaBytes
Max Memory Allocated: 0.06358194351196289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06379985809326172  GigaBytes
Max Memory Allocated: 0.06381607055664062  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.0638585090637207  GigaBytes
Max Memory Allocated: 0.06385946273803711  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.0638585090637207  GigaBytes
Max Memory Allocated: 0.06385946273803711  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06389093399047852  GigaBytes
Max Memory Allocated: 0.06389093399047852  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06482553482055664  GigaBytes
Max Memory Allocated: 0.06488990783691406  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06483602523803711  GigaBytes
Max Memory Allocated: 0.06488990783691406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06483602523803711  GigaBytes
Max Memory Allocated: 0.06488990783691406  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06484746932983398  GigaBytes
Max Memory Allocated: 0.06488990783691406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06523799896240234  GigaBytes
Max Memory Allocated: 0.06526470184326172  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06526470184326172  GigaBytes
Max Memory Allocated: 0.06526565551757812  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06526470184326172  GigaBytes
Max Memory Allocated: 0.06526565551757812  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.0652761459350586  GigaBytes
Max Memory Allocated: 0.0652761459350586  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06574249267578125  GigaBytes
Max Memory Allocated: 0.06577491760253906  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06560468673706055  GigaBytes
Max Memory Allocated: 0.06588029861450195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06560516357421875  GigaBytes
Max Memory Allocated: 0.06588029861450195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06560564041137695  GigaBytes
Max Memory Allocated: 0.06588029861450195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06560468673706055  GigaBytes
Max Memory Allocated: 0.06588029861450195  GigaBytes

torch.Size([9, 7])
input nodes number: 37
output nodes number: 9
edges number: 32
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06560707092285156  GigaBytes
Max Memory Allocated: 0.06588029861450195  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06560754776000977  GigaBytes
Max Memory Allocated: 0.06588029861450195  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06560802459716797  GigaBytes
Max Memory Allocated: 0.06588029861450195  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 37
output nodes number: 9
edges number: 32
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06560850143432617  GigaBytes
Max Memory Allocated: 0.06588029861450195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06560945510864258  GigaBytes
Max Memory Allocated: 0.06588029861450195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.1254429817199707  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

pseudo mini batch 1 input nodes size: 38
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12543964385986328  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12543964385986328  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.1256427764892578  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12564325332641602  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12544488906860352  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([38, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

m.shape torch.Size([2, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12562322616577148  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12562322616577148  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12564516067504883  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12581777572631836  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12582826614379883  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12582826614379883  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12585020065307617  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.1261734962463379  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12619495391845703  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12619495391845703  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12621688842773438  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12669086456298828  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12670135498046875  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12670135498046875  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12671279907226562  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.1270275115966797  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12705421447753906  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12705421447753906  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12706565856933594  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.1275320053100586  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.1275639533996582  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.1275639533996582  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12757539749145508  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12811756134033203  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12799406051635742  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12799453735351562  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12799501419067383  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12799406051635742  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([9, 7])
input nodes number: 38
output nodes number: 9
edges number: 29
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12799644470214844  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12799692153930664  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12799739837646484  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 38
output nodes number: 9
edges number: 29
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12799739837646484  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.12799787521362305  GigaBytes
Max Memory Allocated: 0.1905527114868164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12544822692871094  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

pseudo mini batch 2 input nodes size: 42
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12544488906860352  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12544488906860352  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.1256694793701172  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.1256699562072754  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12546634674072266  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12546730041503906  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12546730041503906  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12546730041503906  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([42, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12546730041503906  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12546730041503906  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

m.shape torch.Size([1, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12570905685424805  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12570905685424805  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12572050094604492  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.1258077621459961  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12581300735473633  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12581300735473633  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.1258244514465332  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12598752975463867  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12602996826171875  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12602996826171875  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12606239318847656  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.1267714500427246  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12677669525146484  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12677669525146484  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12678813934326172  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12710285186767578  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12712955474853516  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12712955474853516  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12714099884033203  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.1276073455810547  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12770843505859375  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.12770843505859375  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.1277303695678711  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1292591094970703  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([1, 2, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1290607452392578  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12906122207641602  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12906169891357422  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1290607452392578  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([9, 7])
input nodes number: 42
output nodes number: 9
edges number: 42
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12906312942504883  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12906360626220703  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12906408309936523  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 42
output nodes number: 9
edges number: 42
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12906408309936523  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12906455993652344  GigaBytes
Max Memory Allocated: 0.2528648376464844  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546968460083008  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

pseudo mini batch 3 input nodes size: 49
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546634674072266  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546634674072266  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12572813034057617  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12572860717773438  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255035400390625  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255044937133789  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255044937133789  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255044937133789  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([49, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255044937133789  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255044937133789  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

m.shape torch.Size([1, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1257953643798828  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1257953643798828  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1258068084716797  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12596988677978516  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12598037719726562  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12598037719726562  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1259918212890625  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12623071670532227  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12624645233154297  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12624645233154297  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12625789642333984  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1265726089477539  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12662029266357422  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12662029266357422  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12664222717285156  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12741756439208984  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1274709701538086  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1274709701538086  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12749290466308594  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284189224243164  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12845611572265625  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12845611572265625  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12846755981445312  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12916135787963867  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12920904159545898  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12920904159545898  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12922048568725586  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1299901008605957  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12975263595581055  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12975311279296875  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12975358963012695  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12975263595581055  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([9, 7])
input nodes number: 49
output nodes number: 9
edges number: 50
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12975502014160156  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12975549697875977  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12975597381591797  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 49
output nodes number: 9
edges number: 50
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12975597381591797  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12975645065307617  GigaBytes
Max Memory Allocated: 0.25380849838256836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12550687789916992  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

pseudo mini batch 4 input nodes size: 44
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255035400390625  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255035400390625  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12573862075805664  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12573909759521484  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12547683715820312  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12547779083251953  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12547779083251953  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12547779083251953  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([44, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12547779083251953  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12547779083251953  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

m.shape torch.Size([1, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1257939338684082  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1257939338684082  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12580537796020508  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12604427337646484  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12606000900268555  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12606000900268555  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12607145309448242  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12638616561889648  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1264338493347168  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1264338493347168  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12645578384399414  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12723112106323242  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12728452682495117  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12728452682495117  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12730646133422852  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12823247909545898  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12830734252929688  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12830734252929688  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12832927703857422  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12955665588378906  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1295938491821289  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1295938491821289  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12960529327392578  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13029909133911133  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13004207611083984  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13004255294799805  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13004302978515625  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13004207611083984  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([9, 7])
input nodes number: 44
output nodes number: 9
edges number: 54
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13004446029663086  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13004493713378906  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13004541397094727  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 44
output nodes number: 9
edges number: 54
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13004541397094727  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.13004589080810547  GigaBytes
Max Memory Allocated: 0.2546234130859375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12548017501831055  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 5 input nodes size: 34
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12547683715820312  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12547683715820312  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12565851211547852  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12565898895263672  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12542343139648438  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12542438507080078  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12542438507080078  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12542438507080078  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([34, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12542438507080078  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12542438507080078  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([2, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12558460235595703  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12558460235595703  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12560653686523438  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1257791519165039  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12578964233398438  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12578964233398438  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12581157684326172  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12613487243652344  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12614011764526367  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12614011764526367  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12615156173706055  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1263904571533203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1264491081237793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1264491081237793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1264815330505371  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12741613388061523  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1274266242980957  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1274266242980957  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12743806838989258  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12782859802246094  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12772274017333984  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12772321701049805  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12772369384765625  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12772274017333984  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
input nodes number: 34
output nodes number: 9
edges number: 26
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12772512435913086  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12772560119628906  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12772607803344727  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 34
output nodes number: 9
edges number: 26
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12772607803344727  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12772655487060547  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254267692565918  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 6 input nodes size: 48
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12542343139648438  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12542343139648438  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12567996978759766  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12568044662475586  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549829483032227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549924850463867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549924850463867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549924850463867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([48, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549924850463867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549924850463867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([2, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12575006484985352  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12575006484985352  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12577199935913086  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12609529495239258  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([4, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12614870071411133  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12614870071411133  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1261916160583496  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1271357536315918  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1271519660949707  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1271519660949707  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12716341018676758  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12770557403564453  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12774276733398438  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12774276733398438  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12775421142578125  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1283721923828125  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284198760986328  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284198760986328  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284313201904297  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12920093536376953  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1290149688720703  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12901544570922852  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12901592254638672  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1290149688720703  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
input nodes number: 48
output nodes number: 9
edges number: 41
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12901735305786133  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12901782989501953  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12901830673217773  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 48
output nodes number: 9
edges number: 41
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12901830673217773  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12901878356933594  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255016326904297  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 7 input nodes size: 38
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549829483032227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549829483032227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1257014274597168  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.125701904296875  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544488906860352  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([38, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([4, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12563228607177734  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12563228607177734  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12567520141601562  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12601852416992188  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([1, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1260080337524414  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1260080337524414  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12601947784423828  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12618255615234375  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12620925903320312  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12620925903320312  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12623119354248047  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12670516967773438  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12673187255859375  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12673187255859375  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12674331665039062  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12728548049926758  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1273331642150879  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1273331642150879  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12734460830688477  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1281142234802246  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1279926300048828  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12799310684204102  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12799358367919922  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1279926300048828  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
input nodes number: 38
output nodes number: 9
edges number: 29
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12799501419067383  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12799549102783203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12799596786499023  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 38
output nodes number: 9
edges number: 29
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12799596786499023  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12799644470214844  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544822692871094  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 8 input nodes size: 33
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544488906860352  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544488906860352  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12562131881713867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12541818618774414  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12541913986206055  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12541913986206055  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12541913986206055  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([33, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12541913986206055  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12541913986206055  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([1, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255793571472168  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255793571472168  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12559080123901367  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12567806243896484  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12570476531982422  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12570476531982422  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12573719024658203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.126220703125  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([2, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12624740600585938  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12624740600585938  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12626934051513672  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1268939971923828  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12690973281860352  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12690973281860352  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1269211769104004  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12731170654296875  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12734365463256836  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12734365463256836  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12735509872436523  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1278972625732422  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12778091430664062  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12778139114379883  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12778186798095703  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12778091430664062  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
input nodes number: 33
output nodes number: 8
edges number: 27
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12778329849243164  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12778377532958984  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12778425216674805  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
torch.Size([8, 7])
input nodes number: 33
output nodes number: 8
edges number: 27
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12778425216674805  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12778472900390625  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12542152404785156  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 9 input nodes size: 40
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12541818618774414  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12541818618774414  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12563180923461914  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12563228607177734  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12545537948608398  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254563331604004  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254563331604004  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254563331604004  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([40, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254563331604004  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254563331604004  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([1, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12565374374389648  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12565374374389648  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12566518783569336  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12575244903564453  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12576818466186523  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12576818466186523  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12579011917114258  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1261134147644043  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12611865997314453  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12611865997314453  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1261301040649414  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12636899948120117  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([4, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1264491081237793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1264491081237793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12649202346801758  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12773656845092773  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([1, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12776851654052734  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12776851654052734  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12777996063232422  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12854957580566406  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284012794494629  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284017562866211  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284022331237793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284012794494629  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
input nodes number: 40
output nodes number: 9
edges number: 34
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284036636352539  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284041404724121  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284046173095703  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 40
output nodes number: 9
edges number: 34
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1284046173095703  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12840509414672852  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254587173461914  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 10 input nodes size: 48
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12545537948608398  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12545537948608398  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12571191787719727  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12571239471435547  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549829483032227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549924850463867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549924850463867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549924850463867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([48, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549924850463867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549924850463867  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([2, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1257643699645996  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1257643699645996  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12578630447387695  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12595891952514648  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([3, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12599611282348633  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12599611282348633  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12602853775024414  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1267375946044922  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12674808502197266  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12674808502197266  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12675952911376953  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1271500587463379  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1273045539855957  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1273045539855957  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12733697891235352  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1296248435974121  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 3, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12940406799316406  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12940454483032227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12940502166748047  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12940406799316406  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
input nodes number: 48
output nodes number: 9
edges number: 46
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12940645217895508  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12940692901611328  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12940740585327148  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 48
output nodes number: 9
edges number: 46
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12940740585327148  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1294078826904297  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255016326904297  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 11 input nodes size: 42
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549829483032227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549829483032227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12572288513183594  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12572336196899414  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546634674072266  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546730041503906  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546730041503906  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546730041503906  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([42, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546730041503906  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546730041503906  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([1, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12567138671875  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12567138671875  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12568283081054688  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12577009201049805  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12578582763671875  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12578582763671875  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1258077621459961  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1261310577392578  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12615251541137695  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12615251541137695  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1261744499206543  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1266484260559082  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1266641616821289  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1266641616821289  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12667560577392578  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12706613540649414  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12710857391357422  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12710857391357422  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1271200180053711  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12781381607055664  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12786149978637695  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12786149978637695  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12787294387817383  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12864255905151367  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12848186492919922  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12848234176635742  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12848281860351562  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12848186492919922  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
input nodes number: 42
output nodes number: 8
edges number: 35
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12848424911499023  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12848472595214844  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12848520278930664  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
torch.Size([8, 7])
input nodes number: 42
output nodes number: 8
edges number: 35
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12848520278930664  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12848567962646484  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546968460083008  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 12 input nodes size: 24
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546634674072266  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12546634674072266  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255946159362793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255950927734375  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537002563476562  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537097930908203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537097930908203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537097930908203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([24, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537097930908203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537097930908203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([1, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12558460235595703  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12558460235595703  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255960464477539  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12568330764770508  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12571001052856445  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12571001052856445  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1257319450378418  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1262059211730957  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1262378692626953  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1262378692626953  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12625980377197266  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12688446044921875  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12692689895629883  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12692689895629883  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12694883346557617  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12772417068481445  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1277775764465332  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1277775764465332  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12779951095581055  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12872552871704102  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1285557746887207  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1285562515258789  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1285567283630371  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1285557746887207  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
input nodes number: 24
output nodes number: 9
edges number: 37
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12855815887451172  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12855863571166992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12855911254882812  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 24
output nodes number: 9
edges number: 37
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12855911254882812  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12855958938598633  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537336349487305  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 13 input nodes size: 25
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537002563476562  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537002563476562  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255035400390625  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1255040168762207  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537527084350586  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537622451782227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537622451782227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537622451782227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([25, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537622451782227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537622451782227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([3, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549066543579102  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12549066543579102  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12552309036254883  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12578105926513672  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([3, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12579727172851562  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12579727172851562  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12582969665527344  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1263132095336914  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([2, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12633991241455078  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12633991241455078  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12636184692382812  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12698650360107422  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1269221305847168  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.126922607421875  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1269230842590332  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1269221305847168  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
input nodes number: 25
output nodes number: 8
edges number: 17
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1269245147705078  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12692499160766602  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12692546844482422  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
torch.Size([8, 7])
input nodes number: 25
output nodes number: 8
edges number: 17
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12692546844482422  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12692594528198242  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537860870361328  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 14 input nodes size: 43
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537527084350586  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12537527084350586  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12560510635375977  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12560558319091797  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254715919494629  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254725456237793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254725456237793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254725456237793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([43, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254725456237793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254725456237793  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([2, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12569665908813477  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12569665908813477  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1257185935974121  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12604188919067383  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12604713439941406  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12604713439941406  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12605857849121094  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1262974739074707  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12633466720581055  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12633466720581055  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1263566017150879  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12698125839233398  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([3, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12705039978027344  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12705039978027344  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12708282470703125  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12824296951293945  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12825918197631836  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12825918197631836  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12827062606811523  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1287369728088379  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12857770919799805  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12857818603515625  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12857866287231445  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12857770919799805  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
input nodes number: 43
output nodes number: 9
edges number: 36
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12858009338378906  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12858057022094727  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12858104705810547  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([9, 7])
torch.Size([9, 7])
input nodes number: 43
output nodes number: 9
edges number: 36
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12858104705810547  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12858152389526367  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254749298095703  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

pseudo mini batch 15 input nodes size: 38
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254715919494629  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1254715919494629  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12567472457885742  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12567520141601562  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544488906860352  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([38, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544584274291992  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

m.shape torch.Size([2, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12562847137451172  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12562847137451172  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12565040588378906  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1258230209350586  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1258230209350586  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1258230209350586  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12583446502685547  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12599754333496094  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1260242462158203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1260242462158203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12604618072509766  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12652015686035156  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12653589248657227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12653589248657227  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12654733657836914  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1269378662109375  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12696456909179688  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12696456909179688  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12697601318359375  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1274423599243164  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12748479843139648  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12748479843139648  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12749624252319336  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.1281900405883789  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12805604934692383  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12805652618408203  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12805700302124023  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12805604934692383  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
input nodes number: 38
output nodes number: 8
edges number: 30
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12805843353271484  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12805891036987305  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12805938720703125  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

torch.Size([8, 7])
torch.Size([8, 7])
input nodes number: 38
output nodes number: 8
edges number: 30
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12805938720703125  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12805986404418945  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4373779296875 GB
    Memory Allocated: 0.12544822692871094  GigaBytes
Max Memory Allocated: 0.2549128532409668  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5311279296875 GB
    Memory Allocated: 0.2506866455078125  GigaBytes
Max Memory Allocated: 0.3444366455078125  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5311279296875 GB
    Memory Allocated: 0.2506866455078125  GigaBytes
Max Memory Allocated: 0.3444366455078125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00781482458114624 |0.022208571434020996 |0.05040431022644043 |7.802248001098633e-05 |0.007067084312438965 |0.0024557113647460938 |
----------------------------------------------------------pseudo_mini_loss sum 2.3608498573303223
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  623
Number of first layer input nodes during this epoch:  623
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=7, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(7, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  16459452
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([7, 1433])
layers.0.fc_neigh.weight, torch.Size([7, 1433])
bns.0.weight, torch.Size([7])
bns.0.bias, torch.Size([7])
----------------------------------------
un-trainable parameters
