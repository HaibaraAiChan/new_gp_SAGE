main start at this time 1649982574.4183402
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014023780822753906
global_2_local spend time (sec) 9.679794311523438e-05
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0004887580871582031
A = g.adjacency_matrix() spent  0.00028324127197265625
tensor(indices=tensor([[140, 141, 142,  ...,  74, 588, 589],
                       [  0,   0,   1,  ..., 139, 139, 139]]),
       values=tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1.]),
       size=(590, 590), nnz=565, layout=torch.sparse_coo)
tensor(indices=tensor([[  0,   0,   1,  ..., 139, 139, 139],
                       [140, 141, 142,  ...,  74, 588, 589]]),
       values=tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1.]),
       size=(590, 590), nnz=565, layout=torch.sparse_coo)
[[0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 12, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 16, 16, 17, 17, 17, 17, 17, 17, 18, 19, 19, 19, 20, 20, 20, 20, 20, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 29, 29, 29, 29, 29, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 31, 31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 36, 37, 37, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 39, 39, 40, 40, 40, 40, 40, 41, 41, 41, 41, 42, 42, 42, 42, 42, 42, 42, 42, 42, 43, 44, 44, 44, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 46, 47, 47, 48, 48, 49, 49, 49, 49, 49, 50, 51, 51, 51, 51, 51, 51, 51, 52, 52, 52, 52, 52, 53, 53, 53, 53, 53, 53, 53, 53, 53, 54, 54, 55, 55, 55, 56, 56, 56, 57, 57, 57, 57, 58, 58, 58, 58, 59, 59, 59, 60, 60, 61, 61, 62, 62, 62, 62, 63, 63, 63, 63, 64, 65, 65, 65, 65, 65, 66, 66, 66, 66, 67, 68, 68, 68, 68, 68, 69, 69, 69, 69, 69, 70, 70, 70, 71, 71, 72, 72, 72, 72, 72, 72, 73, 73, 73, 73, 73, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 75, 75, 75, 75, 75, 76, 77, 78, 78, 78, 79, 79, 79, 80, 80, 80, 81, 81, 81, 81, 82, 82, 82, 83, 83, 84, 84, 84, 84, 84, 84, 84, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 86, 86, 87, 87, 87, 87, 87, 87, 87, 88, 88, 88, 88, 89, 90, 90, 91, 91, 92, 92, 92, 92, 93, 94, 94, 94, 95, 95, 95, 95, 96, 97, 97, 98, 98, 98, 98, 98, 98, 98, 98, 99, 99, 99, 100, 100, 100, 100, 100, 100, 100, 100, 101, 101, 101, 101, 102, 103, 103, 104, 104, 104, 104, 104, 105, 106, 106, 106, 106, 106, 106, 107, 107, 107, 108, 108, 108, 108, 109, 109, 109, 109, 110, 111, 111, 112, 112, 112, 112, 112, 113, 113, 113, 113, 113, 113, 114, 114, 114, 115, 115, 115, 115, 115, 115, 115, 115, 115, 115, 116, 116, 116, 117, 117, 117, 118, 118, 118, 119, 119, 119, 120, 120, 120, 120, 121, 121, 121, 122, 122, 122, 122, 123, 124, 124, 125, 126, 126, 126, 127, 127, 127, 128, 128, 128, 128, 128, 128, 128, 128, 129, 129, 130, 130, 130, 130, 130, 130, 131, 131, 131, 131, 131, 131, 131, 132, 132, 132, 132, 133, 133, 133, 133, 133, 133, 134, 134, 134, 134, 134, 134, 135, 135, 135, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 137, 137, 138, 138, 138, 138, 139, 139, 139], [140, 141, 142, 143, 144, 145, 146, 147, 117, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 151, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 100, 181, 182, 183, 184, 185, 40, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 115, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 175, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 232, 244, 245, 246, 247, 248, 249, 250, 81, 251, 252, 253, 175, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 131, 280, 281, 282, 283, 221, 284, 285, 286, 287, 288, 289, 134, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 107, 301, 257, 302, 303, 304, 305, 13, 306, 307, 175, 308, 309, 310, 311, 312, 179, 115, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 175, 329, 330, 331, 332, 333, 334, 162, 133, 335, 63, 336, 88, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 231, 232, 348, 349, 350, 351, 352, 353, 305, 354, 355, 356, 357, 358, 304, 359, 360, 321, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 341, 379, 380, 335, 133, 49, 380, 144, 381, 146, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 87, 397, 398, 399, 400, 401, 402, 304, 403, 404, 405, 406, 202, 407, 408, 188, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 74, 428, 429, 430, 431, 432, 433, 434, 435, 436, 30, 251, 437, 438, 439, 107, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 403, 450, 451, 452, 453, 241, 454, 455, 456, 457, 458, 69, 455, 457, 459, 460, 461, 462, 133, 335, 336, 49, 463, 464, 465, 466, 467, 468, 278, 469, 470, 471, 472, 473, 474, 206, 313, 475, 476, 477, 159, 478, 479, 480, 313, 481, 482, 483, 484, 115, 101, 485, 486, 487, 313, 312, 11, 488, 130, 206, 489, 486, 490, 99, 491, 492, 175, 493, 494, 495, 496, 497, 498, 175, 401, 499, 500, 501, 260, 263, 38, 82, 502, 503, 504, 366, 505, 506, 507, 508, 509, 510, 511, 512, 406, 513, 514, 368, 515, 206, 516, 313, 517, 518, 312, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 493, 175, 532, 533, 534, 2, 535, 175, 398, 175, 536, 304, 537, 538, 539, 540, 541, 542, 543, 544, 467, 242, 232, 545, 546, 547, 548, 518, 549, 206, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 528, 368, 305, 100, 560, 561, 206, 562, 563, 564, 349, 565, 258, 566, 34, 567, 568, 569, 570, 571, 49, 336, 335, 380, 63, 88, 288, 289, 572, 573, 574, 37, 575, 576, 577, 292, 246, 295, 215, 548, 578, 579, 580, 300, 581, 582, 583, 584, 585, 586, 587, 74, 588, 589]]
[[140, 141, 142, 143, 144, 145, 146, 147, 117, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 151, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 100, 181, 182, 183, 184, 185, 40, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 115, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 175, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 232, 244, 245, 246, 247, 248, 249, 250, 81, 251, 252, 253, 175, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 131, 280, 281, 282, 283, 221, 284, 285, 286, 287, 288, 289, 134, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 107, 301, 257, 302, 303, 304, 305, 13, 306, 307, 175, 308, 309, 310, 311, 312, 179, 115, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 175, 329, 330, 331, 332, 333, 334, 162, 133, 335, 63, 336, 88, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 231, 232, 348, 349, 350, 351, 352, 353, 305, 354, 355, 356, 357, 358, 304, 359, 360, 321, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 341, 379, 380, 335, 133, 49, 380, 144, 381, 146, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 87, 397, 398, 399, 400, 401, 402, 304, 403, 404, 405, 406, 202, 407, 408, 188, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 74, 428, 429, 430, 431, 432, 433, 434, 435, 436, 30, 251, 437, 438, 439, 107, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 403, 450, 451, 452, 453, 241, 454, 455, 456, 457, 458, 69, 455, 457, 459, 460, 461, 462, 133, 335, 336, 49, 463, 464, 465, 466, 467, 468, 278, 469, 470, 471, 472, 473, 474, 206, 313, 475, 476, 477, 159, 478, 479, 480, 313, 481, 482, 483, 484, 115, 101, 485, 486, 487, 313, 312, 11, 488, 130, 206, 489, 486, 490, 99, 491, 492, 175, 493, 494, 495, 496, 497, 498, 175, 401, 499, 500, 501, 260, 263, 38, 82, 502, 503, 504, 366, 505, 506, 507, 508, 509, 510, 511, 512, 406, 513, 514, 368, 515, 206, 516, 313, 517, 518, 312, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 493, 175, 532, 533, 534, 2, 535, 175, 398, 175, 536, 304, 537, 538, 539, 540, 541, 542, 543, 544, 467, 242, 232, 545, 546, 547, 548, 518, 549, 206, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 528, 368, 305, 100, 560, 561, 206, 562, 563, 564, 349, 565, 258, 566, 34, 567, 568, 569, 570, 571, 49, 336, 335, 380, 63, 88, 288, 289, 572, 573, 574, 37, 575, 576, 577, 292, 246, 295, 215, 548, 578, 579, 580, 300, 581, 582, 583, 584, 585, 586, 587, 74, 588, 589], [0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 12, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 16, 16, 17, 17, 17, 17, 17, 17, 18, 19, 19, 19, 20, 20, 20, 20, 20, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 29, 29, 29, 29, 29, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 31, 31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 36, 37, 37, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 39, 39, 40, 40, 40, 40, 40, 41, 41, 41, 41, 42, 42, 42, 42, 42, 42, 42, 42, 42, 43, 44, 44, 44, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 46, 47, 47, 48, 48, 49, 49, 49, 49, 49, 50, 51, 51, 51, 51, 51, 51, 51, 52, 52, 52, 52, 52, 53, 53, 53, 53, 53, 53, 53, 53, 53, 54, 54, 55, 55, 55, 56, 56, 56, 57, 57, 57, 57, 58, 58, 58, 58, 59, 59, 59, 60, 60, 61, 61, 62, 62, 62, 62, 63, 63, 63, 63, 64, 65, 65, 65, 65, 65, 66, 66, 66, 66, 67, 68, 68, 68, 68, 68, 69, 69, 69, 69, 69, 70, 70, 70, 71, 71, 72, 72, 72, 72, 72, 72, 73, 73, 73, 73, 73, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 75, 75, 75, 75, 75, 76, 77, 78, 78, 78, 79, 79, 79, 80, 80, 80, 81, 81, 81, 81, 82, 82, 82, 83, 83, 84, 84, 84, 84, 84, 84, 84, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 86, 86, 87, 87, 87, 87, 87, 87, 87, 88, 88, 88, 88, 89, 90, 90, 91, 91, 92, 92, 92, 92, 93, 94, 94, 94, 95, 95, 95, 95, 96, 97, 97, 98, 98, 98, 98, 98, 98, 98, 98, 99, 99, 99, 100, 100, 100, 100, 100, 100, 100, 100, 101, 101, 101, 101, 102, 103, 103, 104, 104, 104, 104, 104, 105, 106, 106, 106, 106, 106, 106, 107, 107, 107, 108, 108, 108, 108, 109, 109, 109, 109, 110, 111, 111, 112, 112, 112, 112, 112, 113, 113, 113, 113, 113, 113, 114, 114, 114, 115, 115, 115, 115, 115, 115, 115, 115, 115, 115, 116, 116, 116, 117, 117, 117, 118, 118, 118, 119, 119, 119, 120, 120, 120, 120, 121, 121, 121, 122, 122, 122, 122, 123, 124, 124, 125, 126, 126, 126, 127, 127, 127, 128, 128, 128, 128, 128, 128, 128, 128, 129, 129, 130, 130, 130, 130, 130, 130, 131, 131, 131, 131, 131, 131, 131, 132, 132, 132, 132, 133, 133, 133, 133, 133, 133, 134, 134, 134, 134, 134, 134, 135, 135, 135, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 137, 137, 138, 138, 138, 138, 139, 139, 139]]
get remove nodes spent  0.0006330013275146484
remove nodes length
450
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.000 seconds
[[2, 3, 4, 5, 6, 7, 8, 10, 18, 19, 21, 22, 23, 25, 26, 29, 30, 31, 33, 34, 35, 38, 39, 40, 41, 45, 48, 52, 53, 54, 55, 58, 61, 69, 70, 71, 72, 76, 81, 82, 83, 84, 85, 86, 87, 90, 91, 92, 93, 94, 96, 97, 103, 105, 108, 112, 115, 116, 118, 119, 121, 122, 123, 125, 128, 129, 131, 132, 136, 138], [0, 1, 9, 11, 12, 13, 14, 15, 16, 17, 20, 24, 27, 28, 32, 36, 37, 42, 43, 44, 46, 47, 49, 50, 51, 56, 57, 59, 60, 62, 63, 64, 65, 66, 67, 68, 73, 74, 75, 77, 78, 79, 80, 88, 89, 95, 98, 99, 100, 101, 102, 104, 106, 107, 109, 110, 111, 113, 114, 117, 120, 124, 126, 127, 130, 133, 134, 135, 137, 139]]
self.weighted_graph_bipart() spend  0.025434017181396484
after graph partition
graph partition algorithm spend time 0.05000877380371094
[74, 138, 140, 240, 242, 266, 346, 417, 468, 484, 501, 623, 624, 637, 736, 812, 866, 910, 1002, 1047, 1049, 1082, 1209, 1281, 1308, 1372, 1410, 1415, 1428, 1454, 1487, 1488, 1516, 1544, 1716, 1793, 1794, 1795, 1819, 1879, 1898, 1981, 1985, 2001, 2004, 2013, 2029, 2079, 2141, 2156, 2160, 2169, 2208, 2209, 2224, 2226, 2232, 2296, 2337, 2367, 2445, 2468, 2469, 2528, 2543, 2569, 2658, 2669, 2673, 2681]
[3, 7, 24, 34, 52, 65, 67, 69, 70, 72, 79, 130, 168, 184, 186, 310, 328, 352, 403, 419, 429, 431, 432, 452, 479, 542, 554, 575, 580, 592, 602, 645, 666, 741, 760, 776, 818, 821, 845, 850, 859, 899, 925, 1101, 1162, 1230, 1286, 1327, 1337, 1343, 1587, 1682, 1683, 1754, 1826, 1852, 1921, 1924, 1938, 1939, 1941, 1958, 2020, 2032, 2064, 2068, 2223, 2287, 2401, 2518]
partition_len_list
[318, 281]
shared_neighbor_graph_partition selection method range initialization spend 0.05032944679260254
time for parepare:  7.104873657226562e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0021889209747314453
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00012159347534179688
----------------------check_connections_block total spend ----------------------------- 0.003043651580810547
generate_one_block  0.003268003463745117
generate_one_block  0.0015158653259277344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 318
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.06431865692138672  GigaBytes
Max Memory Allocated: 0.06431865692138672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.06431961059570312  GigaBytes
Max Memory Allocated: 0.06431961059570312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.06431961059570312  GigaBytes
Max Memory Allocated: 0.06431961059570312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06432247161865234  GigaBytes
Max Memory Allocated: 0.06432247161865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06432247161865234  GigaBytes
Max Memory Allocated: 0.06432247161865234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06432247161865234  GigaBytes
Max Memory Allocated: 0.06432247161865234  GigaBytes

torch.Size([318, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06432247161865234  GigaBytes
Max Memory Allocated: 0.06432247161865234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06432247161865234  GigaBytes
Max Memory Allocated: 0.06432247161865234  GigaBytes

m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.06599712371826172  GigaBytes
Max Memory Allocated: 0.06599807739257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.06599712371826172  GigaBytes
Max Memory Allocated: 0.06599807739257812  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.06608295440673828  GigaBytes
Max Memory Allocated: 0.06608295440673828  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.06676816940307617  GigaBytes
Max Memory Allocated: 0.06681108474731445  GigaBytes

torch.Size([1, 8, 1433])
m.shape torch.Size([16, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.06689643859863281  GigaBytes
Max Memory Allocated: 0.06689739227294922  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.06689643859863281  GigaBytes
Max Memory Allocated: 0.06689739227294922  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.06706809997558594  GigaBytes
Max Memory Allocated: 0.06706809997558594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06963443756103516  GigaBytes
Max Memory Allocated: 0.06980562210083008  GigaBytes

torch.Size([1, 16, 1433])
m.shape torch.Size([10, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06970882415771484  GigaBytes
Max Memory Allocated: 0.06980562210083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06970882415771484  GigaBytes
Max Memory Allocated: 0.06980562210083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.06981563568115234  GigaBytes
Max Memory Allocated: 0.06981563568115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.07216548919677734  GigaBytes
Max Memory Allocated: 0.0723257064819336  GigaBytes

torch.Size([1, 10, 1433])
m.shape torch.Size([12, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.07236862182617188  GigaBytes
Max Memory Allocated: 0.07236957550048828  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.07236862182617188  GigaBytes
Max Memory Allocated: 0.07236957550048828  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.07249736785888672  GigaBytes
Max Memory Allocated: 0.07249736785888672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07621955871582031  GigaBytes
Max Memory Allocated: 0.0764760971069336  GigaBytes

torch.Size([1, 12, 1433])
m.shape torch.Size([6, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07631540298461914  GigaBytes
Max Memory Allocated: 0.0764760971069336  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07631540298461914  GigaBytes
Max Memory Allocated: 0.0764760971069336  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.07638025283813477  GigaBytes
Max Memory Allocated: 0.0764760971069336  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.07869338989257812  GigaBytes
Max Memory Allocated: 0.07885360717773438  GigaBytes

torch.Size([1, 6, 1433])
m.shape torch.Size([3, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.07875728607177734  GigaBytes
Max Memory Allocated: 0.07885360717773438  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.07875728607177734  GigaBytes
Max Memory Allocated: 0.07885360717773438  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.07878971099853516  GigaBytes
Max Memory Allocated: 0.07885360717773438  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.08017539978027344  GigaBytes
Max Memory Allocated: 0.08027172088623047  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([3, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.08027172088623047  GigaBytes
Max Memory Allocated: 0.08027267456054688  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.08027172088623047  GigaBytes
Max Memory Allocated: 0.08027267456054688  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.08030414581298828  GigaBytes
Max Memory Allocated: 0.08030414581298828  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08191537857055664  GigaBytes
Max Memory Allocated: 0.08202791213989258  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08194208145141602  GigaBytes
Max Memory Allocated: 0.08202791213989258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08194208145141602  GigaBytes
Max Memory Allocated: 0.08202791213989258  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08195352554321289  GigaBytes
Max Memory Allocated: 0.08202791213989258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08257150650024414  GigaBytes
Max Memory Allocated: 0.08261442184448242  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08271026611328125  GigaBytes
Max Memory Allocated: 0.08271121978759766  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08271026611328125  GigaBytes
Max Memory Allocated: 0.08271121978759766  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.08274269104003906  GigaBytes
Max Memory Allocated: 0.08274269104003906  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.08480501174926758  GigaBytes
Max Memory Allocated: 0.08494949340820312  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([8, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.08521604537963867  GigaBytes
Max Memory Allocated: 0.08521747589111328  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.08521604537963867  GigaBytes
Max Memory Allocated: 0.08521747589111328  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.08530187606811523  GigaBytes
Max Memory Allocated: 0.08530187606811523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09138154983520508  GigaBytes
Max Memory Allocated: 0.09180879592895508  GigaBytes

torch.Size([1, 8, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09008359909057617  GigaBytes
Max Memory Allocated: 0.09245729446411133  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09008550643920898  GigaBytes
Max Memory Allocated: 0.09245729446411133  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0900874137878418  GigaBytes
Max Memory Allocated: 0.09245729446411133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09008455276489258  GigaBytes
Max Memory Allocated: 0.09245729446411133  GigaBytes

torch.Size([70, 7])
input nodes number: 318
output nodes number: 70
edges number: 302
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09009075164794922  GigaBytes
Max Memory Allocated: 0.09245729446411133  GigaBytes

torch.Size([70, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09009265899658203  GigaBytes
Max Memory Allocated: 0.09245729446411133  GigaBytes

torch.Size([70, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09009313583374023  GigaBytes
Max Memory Allocated: 0.09245729446411133  GigaBytes

torch.Size([70, 7])
torch.Size([70, 7])
input nodes number: 318
output nodes number: 70
edges number: 302
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09009504318237305  GigaBytes
Max Memory Allocated: 0.09245729446411133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09009599685668945  GigaBytes
Max Memory Allocated: 0.09245729446411133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1269512176513672  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

pseudo mini batch 1 input nodes size: 281
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12694168090820312  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12694168090820312  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12844181060791016  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12844276428222656  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12674379348754883  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12674665451049805  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12674665451049805  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12674665451049805  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([281, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12674665451049805  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12674665451049805  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12852859497070312  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12852859497070312  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12865734100341797  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1296844482421875  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([1, 12, 1433])
m.shape torch.Size([9, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1297163963317871  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1297163963317871  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.12981271743774414  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1312575340270996  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([1, 9, 1433])
m.shape torch.Size([16, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13146591186523438  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13146591186523438  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1316375732421875  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13540124893188477  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([1, 16, 1433])
m.shape torch.Size([10, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1355290412902832  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1355290412902832  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1356358528137207  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1387333869934082  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([1, 10, 1433])
m.shape torch.Size([9, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13892030715942383  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13892030715942383  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.13901662826538086  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14248418807983398  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([1, 9, 1433])
m.shape torch.Size([8, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14269256591796875  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14269256591796875  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1427783966064453  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14646053314208984  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([1, 8, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1464552879333496  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1464552879333496  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14646673202514648  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14700889587402344  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14708900451660156  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14708900451660156  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1471109390258789  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14833831787109375  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1483755111694336  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1483755111694336  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14838695526123047  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14908075332641602  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14918184280395508  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14918184280395508  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14920377731323242  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.15073251724243164  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([1, 2, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14938068389892578  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1493825912475586  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1493844985961914  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.1493816375732422  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([70, 7])
input nodes number: 281
output nodes number: 70
edges number: 263
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14938783645629883  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([70, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14938974380493164  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([70, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14939022064208984  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

torch.Size([70, 7])
torch.Size([70, 7])
input nodes number: 281
output nodes number: 70
edges number: 263
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14939022064208984  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.14939069747924805  GigaBytes
Max Memory Allocated: 0.21384859085083008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.1267533302307129  GigaBytes
Max Memory Allocated: 0.2738041877746582  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.25199174880981445  GigaBytes
Max Memory Allocated: 0.34574174880981445  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.25199174880981445  GigaBytes
Max Memory Allocated: 0.34574174880981445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009812116622924805 |0.17997527122497559 |0.2718294858932495 |0.00012493133544921875 |0.015935778617858887 |0.003260374069213867 |
----------------------------------------------------------pseudo_mini_loss sum 2.4722280502319336
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  599
Number of first layer input nodes during this epoch:  599
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=7, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(7, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  16459452
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([7, 1433])
layers.0.fc_neigh.weight, torch.Size([7, 1433])
bns.0.weight, torch.Size([7])
bns.0.bias, torch.Size([7])
----------------------------------------
un-trainable parameters
