main start at this time 1649984637.043388
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.004073143005371094
global_2_local spend time (sec) 0.00011157989501953125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00048804283142089844
A = g.adjacency_matrix() spent  0.0003914833068847656
get remove nodes spent  0.0007982254028320312
remove nodes length
450
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
total k batches seeds list generation spend  0.007922172546386719
after graph partition
graph partition algorithm spend time 0.060483694076538086
17
18
18
18
17
17
17
18
partition_len_list
[86, 85, 79, 104, 51, 77, 71, 71]
shared_neighbor_graph_partition selection method range initialization spend 0.06083202362060547
time for parepare:  8.20159912109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.002385854721069336
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  9.679794311523438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.9087066650390625e-05
----------------------check_connections_block total spend ----------------------------- 0.004791259765625
generate_one_block  0.002651214599609375
generate_one_block  0.0013060569763183594
generate_one_block  0.0011174678802490234
generate_one_block  0.0010707378387451172
generate_one_block  0.0010454654693603516
generate_one_block  0.0010249614715576172
generate_one_block  0.0010433197021484375
generate_one_block  0.0010542869567871094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 86
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.063079833984375  GigaBytes
Max Memory Allocated: 0.063079833984375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630803108215332  GigaBytes
Max Memory Allocated: 0.0630803108215332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630803108215332  GigaBytes
Max Memory Allocated: 0.0630803108215332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06308126449584961  GigaBytes
Max Memory Allocated: 0.06308126449584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06308126449584961  GigaBytes
Max Memory Allocated: 0.06308126449584961  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06308126449584961  GigaBytes
Max Memory Allocated: 0.06308126449584961  GigaBytes

torch.Size([86, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06308126449584961  GigaBytes
Max Memory Allocated: 0.06308126449584961  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06308126449584961  GigaBytes
Max Memory Allocated: 0.06308126449584961  GigaBytes

m.shape torch.Size([1, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06356048583984375  GigaBytes
Max Memory Allocated: 0.06356143951416016  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06356048583984375  GigaBytes
Max Memory Allocated: 0.06356143951416016  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06357192993164062  GigaBytes
Max Memory Allocated: 0.06357192993164062  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.0636591911315918  GigaBytes
Max Memory Allocated: 0.06366491317749023  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06368589401245117  GigaBytes
Max Memory Allocated: 0.06368684768676758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06368589401245117  GigaBytes
Max Memory Allocated: 0.06368684768676758  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06371831893920898  GigaBytes
Max Memory Allocated: 0.06371831893920898  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06420183181762695  GigaBytes
Max Memory Allocated: 0.06423425674438477  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([3, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06423377990722656  GigaBytes
Max Memory Allocated: 0.06423473358154297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06423377990722656  GigaBytes
Max Memory Allocated: 0.06423473358154297  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2459716796875 GB
    Memory Allocated: 0.06426620483398438  GigaBytes
Max Memory Allocated: 0.06426620483398438  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06497526168823242  GigaBytes
Max Memory Allocated: 0.06502342224121094  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([2, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.0650019645690918  GigaBytes
Max Memory Allocated: 0.06502342224121094  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.0650019645690918  GigaBytes
Max Memory Allocated: 0.06502342224121094  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06502389907836914  GigaBytes
Max Memory Allocated: 0.06502389907836914  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06564855575561523  GigaBytes
Max Memory Allocated: 0.06569147109985352  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06566429138183594  GigaBytes
Max Memory Allocated: 0.06569147109985352  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06566429138183594  GigaBytes
Max Memory Allocated: 0.06569147109985352  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06567573547363281  GigaBytes
Max Memory Allocated: 0.06569147109985352  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06606626510620117  GigaBytes
Max Memory Allocated: 0.06609296798706055  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06615686416625977  GigaBytes
Max Memory Allocated: 0.06615781784057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06615686416625977  GigaBytes
Max Memory Allocated: 0.06615781784057617  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06618928909301758  GigaBytes
Max Memory Allocated: 0.06618928909301758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06757497787475586  GigaBytes
Max Memory Allocated: 0.06767129898071289  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06760692596435547  GigaBytes
Max Memory Allocated: 0.06767129898071289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06760692596435547  GigaBytes
Max Memory Allocated: 0.06767129898071289  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06761837005615234  GigaBytes
Max Memory Allocated: 0.06767129898071289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06831216812133789  GigaBytes
Max Memory Allocated: 0.0683603286743164  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.0684666633605957  GigaBytes
Max Memory Allocated: 0.06846761703491211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.0684666633605957  GigaBytes
Max Memory Allocated: 0.06846761703491211  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06849908828735352  GigaBytes
Max Memory Allocated: 0.06849908828735352  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07078695297241211  GigaBytes
Max Memory Allocated: 0.07094717025756836  GigaBytes

torch.Size([1, 3, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.0703887939453125  GigaBytes
Max Memory Allocated: 0.07104158401489258  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.0703892707824707  GigaBytes
Max Memory Allocated: 0.07104158401489258  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.0703897476196289  GigaBytes
Max Memory Allocated: 0.07104158401489258  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.0703887939453125  GigaBytes
Max Memory Allocated: 0.07104158401489258  GigaBytes

torch.Size([17, 7])
input nodes number: 86
output nodes number: 17
edges number: 86
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07039165496826172  GigaBytes
Max Memory Allocated: 0.07104158401489258  GigaBytes

torch.Size([17, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07039213180541992  GigaBytes
Max Memory Allocated: 0.07104158401489258  GigaBytes

torch.Size([17, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07039260864257812  GigaBytes
Max Memory Allocated: 0.07104158401489258  GigaBytes

torch.Size([17, 7])
torch.Size([17, 7])
input nodes number: 86
output nodes number: 17
edges number: 86
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07039308547973633  GigaBytes
Max Memory Allocated: 0.07104158401489258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07039403915405273  GigaBytes
Max Memory Allocated: 0.07104158401489258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12570476531982422  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

pseudo mini batch 1 input nodes size: 85
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.1257009506225586  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.1257009506225586  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12615489959716797  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12615537643432617  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12569570541381836  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12569665908813477  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12569665908813477  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12569665908813477  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([85, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12569665908813477  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12569665908813477  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

m.shape torch.Size([3, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12615442276000977  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12615442276000977  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12618684768676758  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12644481658935547  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([4, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12647151947021484  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12647151947021484  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12651443481445312  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12715816497802734  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([2, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12716913223266602  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12716913223266602  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12719106674194336  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12766504287719727  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12769699096679688  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12769699096679688  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12771892547607422  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.1283435821533203  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.1283860206604004  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.1283860206604004  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12840795516967773  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12918329238891602  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12920475006103516  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12920475006103516  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12921619415283203  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.1296825408935547  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12972497940063477  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12972497940063477  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.12973642349243164  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.1304302215576172  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.130584716796875  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.130584716796875  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.1306171417236328  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.1329050064086914  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([1, 3, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.13254404067993164  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.13254451751708984  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.13254499435424805  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.13254404067993164  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([18, 7])
input nodes number: 85
output nodes number: 18
edges number: 80
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.13254690170288086  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([18, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.13254737854003906  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([18, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.13254785537719727  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
input nodes number: 85
output nodes number: 18
edges number: 80
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.13254785537719727  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3787841796875 GB
    Memory Allocated: 0.13254833221435547  GigaBytes
Max Memory Allocated: 0.19504833221435547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12569952011108398  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

pseudo mini batch 2 input nodes size: 79
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12569570541381836  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12569570541381836  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12611770629882812  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12611818313598633  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12566375732421875  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12566471099853516  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12566471099853516  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12566471099853516  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([79, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12566471099853516  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12566471099853516  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

m.shape torch.Size([1, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1261453628540039  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1261453628540039  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12615680694580078  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12624406814575195  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12627077102661133  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12627077102661133  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12630319595336914  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1267867088317871  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([2, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12680292129516602  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12680292129516602  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12682485580444336  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12729883193969727  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12733078002929688  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12733078002929688  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12735271453857422  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1279773712158203  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([3, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12804651260375977  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12804651260375977  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12807893753051758  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12923908233642578  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([3, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1293191909790039  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1293191909790039  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12935161590576172  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1307373046875  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13075876235961914  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13075876235961914  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13077020645141602  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13131237030029297  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1313924789428711  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1313924789428711  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13141441345214844  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13264179229736328  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13267898559570312  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13267898559570312  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1326904296875  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13338422775268555  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13299989700317383  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13300037384033203  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13300085067749023  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13299989700317383  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([18, 7])
input nodes number: 79
output nodes number: 18
edges number: 86
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13300275802612305  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([18, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13300323486328125  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([18, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13300371170043945  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
input nodes number: 79
output nodes number: 18
edges number: 86
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13300371170043945  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13300418853759766  GigaBytes
Max Memory Allocated: 0.25712108612060547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12566757202148438  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

pseudo mini batch 3 input nodes size: 104
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12566375732421875  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12566375732421875  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1262192726135254  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1262197494506836  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12579727172851562  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12579822540283203  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12579822540283203  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12579822540283203  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([104, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12579822540283203  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12579822540283203  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

m.shape torch.Size([2, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12628936767578125  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12628936767578125  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1263113021850586  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12648391723632812  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12648391723632812  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12648391723632812  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.126495361328125  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12665843963623047  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12668514251708984  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12668514251708984  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1267070770263672  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1271810531616211  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([5, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12727689743041992  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12727689743041992  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12733030319213867  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12887907028198242  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([3, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12893247604370117  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12893247604370117  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12896490097045898  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1301250457763672  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1301412582397461  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1301412582397461  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13015270233154297  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13061904907226562  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13065099716186523  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13065099716186523  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1306624412536621  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13120460510253906  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13124704360961914  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13124704360961914  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13125848770141602  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13195228576660156  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13205337524414062  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13205337524414062  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13207530975341797  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1336040496826172  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([1, 2, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.133209228515625  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1332097053527832  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1332101821899414  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.133209228515625  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([18, 7])
input nodes number: 104
output nodes number: 18
edges number: 87
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13321208953857422  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([18, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13321256637573242  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([18, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13321304321289062  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
input nodes number: 104
output nodes number: 18
edges number: 87
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13321304321289062  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13321352005004883  GigaBytes
Max Memory Allocated: 0.25782299041748047  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12580108642578125  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

pseudo mini batch 4 input nodes size: 51
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12579727172851562  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12579727172851562  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1260695457458496  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1260700225830078  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12551403045654297  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12551498413085938  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12551498413085938  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12551498413085938  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([51, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12551498413085938  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12551498413085938  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

m.shape torch.Size([3, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12583637237548828  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12583637237548828  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1258687973022461  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12612676620483398  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([4, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12615346908569336  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12615346908569336  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12619638442993164  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12684011459350586  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([2, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12685108184814453  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12685108184814453  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12687301635742188  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12734699249267578  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([4, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12742185592651367  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12742185592651367  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12746477127075195  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1287093162536621  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([2, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12874126434326172  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12874126434326172  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12876319885253906  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12953853607177734  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([2, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1295919418334961  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1295919418334961  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12961387634277344  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1305398941040039  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 2, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13031625747680664  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13031673431396484  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13031721115112305  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13031625747680664  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
input nodes number: 51
output nodes number: 17
edges number: 55
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13031864166259766  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13031911849975586  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13031959533691406  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
torch.Size([17, 7])
input nodes number: 51
output nodes number: 17
edges number: 55
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13031959533691406  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13032007217407227  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1255173683166504  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

pseudo mini batch 5 input nodes size: 77
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12551403045654297  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12551403045654297  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12592554092407227  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12592601776123047  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12565326690673828  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1256542205810547  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1256542205810547  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1256542205810547  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([77, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1256542205810547  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1256542205810547  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

m.shape torch.Size([2, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12601089477539062  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12601089477539062  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12603282928466797  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1262054443359375  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([5, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12624788284301758  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12624788284301758  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12630128860473633  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12710237503051758  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([5, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12715578079223633  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12715578079223633  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12720918655395508  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12838411331176758  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([1, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12837886810302734  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12837886810302734  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12839031219482422  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12870502471923828  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12873172760009766  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12873172760009766  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12874317169189453  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1292095184326172  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1292414665222168  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1292414665222168  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12925291061401367  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12979507446289062  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12983226776123047  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12983226776123047  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12984371185302734  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1304616928100586  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1305093765258789  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1305093765258789  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13052082061767578  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13129043579101562  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13103055953979492  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13103103637695312  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13103151321411133  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13103055953979492  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
input nodes number: 77
output nodes number: 17
edges number: 62
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13103342056274414  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13103389739990234  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13103437423706055  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
torch.Size([17, 7])
input nodes number: 77
output nodes number: 17
edges number: 62
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13103437423706055  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13103485107421875  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1256570816040039  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

pseudo mini batch 6 input nodes size: 71
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12565326690673828  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12565326690673828  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12603235244750977  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12603282928466797  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562084197998047  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([71, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

m.shape torch.Size([3, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12594318389892578  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12594318389892578  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1259756088256836  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12623357772827148  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([3, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1262497901916504  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1262497901916504  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1262822151184082  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12676572799682617  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([3, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12679767608642578  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12679767608642578  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1268301010131836  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12753915786743164  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([5, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12762975692749023  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12762975692749023  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12768316268920898  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12923192977905273  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([2, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1292586326599121  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1292586326599121  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12928056716918945  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13005590438842773  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1300826072692871  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1300826072692871  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13009405136108398  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13063621520996094  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1304178237915039  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1304183006286621  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1304187774658203  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1304178237915039  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
input nodes number: 71
output nodes number: 17
edges number: 55
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13042068481445312  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13042116165161133  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13042163848876953  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([17, 7])
torch.Size([17, 7])
input nodes number: 71
output nodes number: 17
edges number: 55
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13042163848876953  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13042211532592773  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1256246566772461  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

pseudo mini batch 7 input nodes size: 71
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562084197998047  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562084197998047  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12599992752075195  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12600040435791016  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562084197998047  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([71, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12562179565429688  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

m.shape torch.Size([5, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12594842910766602  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12594842910766602  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12600183486938477  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12642908096313477  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([2, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12642383575439453  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12642383575439453  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12644577026367188  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1267690658569336  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([7, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12687063217163086  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12687063217163086  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12694597244262695  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12859487533569336  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 7, 1433])
m.shape torch.Size([1, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12857866287231445  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12857866287231445  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12859010696411133  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1289048194885254  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1289525032043457  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1289525032043457  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12897443771362305  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12974977493286133  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1297922134399414  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1297922134399414  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12980365753173828  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13057327270507812  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13036489486694336  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13036537170410156  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13036584854125977  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13036489486694336  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([18, 7])
input nodes number: 71
output nodes number: 18
edges number: 54
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13036775588989258  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([18, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13036823272705078  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([18, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13036870956420898  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
input nodes number: 71
output nodes number: 18
edges number: 54
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.13036870956420898  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1303691864013672  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.1256246566772461  GigaBytes
Max Memory Allocated: 0.25790929794311523  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.25086307525634766  GigaBytes
Max Memory Allocated: 0.34461307525634766  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.25086307525634766  GigaBytes
Max Memory Allocated: 0.34461307525634766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009263664484024048 |0.04320451617240906 |0.08670860528945923 |8.705258369445801e-05 |0.011575788259506226 |0.005189180374145508 |
----------------------------------------------------------pseudo_mini_loss sum 2.264024496078491
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  624
Number of first layer input nodes during this epoch:  624
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=7, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(7, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  16459452
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([7, 1433])
layers.0.fc_neigh.weight, torch.Size([7, 1433])
bns.0.weight, torch.Size([7])
bns.0.bias, torch.Size([7])
----------------------------------------
un-trainable parameters
