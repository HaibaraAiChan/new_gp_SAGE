main start at this time 1649924026.1466029
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008974075317382812
src global
[1415, 1209, 925, 899, 34, 818, 2543, 776, 1230, 1958, 1047, 2401, 1343, 328, 1826, 910, 2367, 79, 602, 452, 417, 1938, 1819, 575, 468, 2658, 760, 1716, 72, 2528, 1487, 2160, 736, 666, 2569, 812, 1682, 242, 1941, 70, 554, 1516, 1985, 2004, 2209, 1428, 266, 592, 850, 2001, 1162, 429, 2518, 2287, 580, 2032, 1898, 821, 2068, 2337, 1281, 2064, 484, 3, 645, 168, 186, 501, 130, 74, 2232, 1308, 2079, 1924, 1082, 741, 1852, 2020, 240, 184, 2224, 1002, 1544, 1793, 1794, 2296, 623, 2669, 1337, 310, 140, 2226, 2223, 7, 1101, 352, 24, 2468, 1754, 346, 2141, 1587, 419, 432, 1049, 1327, 1488, 1683, 1939, 866, 52, 2469, 431, 69, 2169, 2445, 542, 845, 2208, 2013, 1410, 1795, 1879, 67, 2681, 1981, 637, 403, 859, 1454, 1372, 65, 1921, 1286, 479, 2029, 2156, 624, 138, 2673, 1405, 1417, 725, 724, 1418, 2103, 1168, 1644, 726, 1989, 1792, 922, 924, 1659, 901, 1631, 898, 902, 1427, 36, 35, 33, 32, 1497, 757, 1433, 2604, 2628, 2558, 2204, 2205, 2206, 765, 1444, 766, 779, 1229, 979, 1998, 1228, 1173, 2397, 1957, 1174, 1956, 917, 518, 2193, 2600, 1975, 1974, 1972, 1973, 1937, 1936, 2066, 253, 354, 536, 327, 2023, 2284, 994, 1645, 997, 500, 990, 2230, 2599, 80, 1241, 834, 395, 758, 1946, 2396, 1161, 1397, 1600, 1802, 2041, 1341, 1888, 2164, 2037, 1886, 2275, 2190, 1078, 1890, 1887, 1081, 1191, 874, 2635, 2634, 2670, 2633, 2632, 2631, 2629, 2679, 2651, 2630, 1435, 1100, 438, 418, 1298, 948, 1316, 947, 71, 2621, 2330, 1403, 2072, 2311, 2154, 2536, 2255, 772, 1420, 667, 1373, 2264, 2568, 2265, 2266, 2270, 2267, 2268, 2269, 1371, 1485, 1046, 1669, 254, 293, 226, 227, 1165, 1358, 68, 1152, 1611, 1955, 1967, 1677, 1198, 1197, 1196, 2404, 1194, 2003, 1189, 1195, 1190, 1192, 1328, 1193, 1355, 1980, 1253, 1988, 2005, 1249, 1250, 1801, 1778, 2254, 1618, 1875, 1251, 1252, 1800, 1987, 1777, 1248, 2413, 1246, 1247, 2544, 2349, 1401, 747, 796, 1486, 1465, 360, 295, 347, 1238, 460, 852, 1586, 1751, 2411, 1239, 1240, 878, 858, 1603, 780, 430, 771, 2521, 2530, 2595, 2137, 2329, 1828, 2574, 2288, 2519, 2331, 2147, 2527, 2145, 643, 911, 364, 1213, 2332, 2436, 1378, 2081, 2036, 1840, 1093, 1083, 1084, 1085, 1502, 2447, 1364, 1910, 2111, 2343, 2442, 1909, 2014, 1318, 1319, 927, 5, 4, 0, 1, 2, 1295, 365, 1091, 169, 187, 991, 578, 510, 137, 131, 73, 2566, 2545, 2211, 1268, 1271, 1309, 1267, 2051, 1350, 2008, 2009, 1829, 2452, 1377, 2353, 2360, 2117, 1895, 1423, 1667, 2426, 288, 223, 185, 182, 183, 1691, 1692, 2012, 2556, 1781, 1007, 1055, 1006, 1867, 2017, 1054, 1008, 1850, 2578, 1851, 1853, 1847, 2298, 1849, 1846, 2163, 1848, 1861, 627, 1270, 2648, 2657, 2659, 2663, 1321, 1322, 311, 380, 491, 308, 309, 136, 143, 135, 2557, 1694, 1673, 1862, 1674, 1686, 2422, 2443, 2239, 2022, 2007, 1671, 1670, 1668, 1672, 2006, 1690, 1684, 1687, 1685, 1676, 1681, 2149, 1680, 1678, 2173, 1675, 1679, 1688, 1689, 6, 8, 535, 1918, 538, 537, 263, 563, 596, 22, 23, 2456, 1052, 2244, 966, 1051, 589, 2142, 2339, 2277, 1820, 1803, 2042, 1943, 1593, 1594, 1896, 1942, 1591, 2437, 1597, 1590, 2412, 2522, 1940, 2348, 2350, 2440, 1588, 1589, 1592, 1323, 855, 1624, 761, 420, 783, 749, 1857, 1183, 1636, 1331, 1335, 1302, 813, 971, 1163, 1602, 1329, 1324, 1601, 926, 867, 655, 462, 654, 51, 2104, 2105, 781, 571, 570, 340, 568, 567, 66, 2063, 2065, 2082, 541, 1104, 1583, 1172, 1652, 2435, 2030, 2419, 1279, 1280, 1278, 1426, 1442, 1448, 778, 1430, 710, 1445, 777, 711, 1482, 808, 1783, 2326, 1060, 1059, 1317, 1058, 1099, 2165, 2682, 2672, 2676, 2691, 2671, 2403, 1984, 1982, 1125, 1288, 635, 636, 404, 291, 622, 715, 478, 1422, 809, 1429, 662, 2075, 2357, 1108, 1617, 2158, 1109, 1107, 2018, 915, 860, 1301, 1300, 2346, 2093, 1648, 359, 142, 2654]
dst local
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
global_2_local spend time (sec) 0.0001735687255859375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003712177276611328
nx_g = dgl.to_networkx(g)   spent  0.002735614776611328
A = nx.to_scipy_sparse_matrix(nx_g)   spent  0.0023415088653564453
shared_neighbor_matrix = (AT*A)   spent  0.00038123130798339844
shared_neighbor_matrix = (AT*A).todok()   spent  0.00026035308837890625
shared_neighbor_matrix.setdiag(0), achieve weights  spent  0.0072591304779052734
get remove nodes spent  0.00042366981506347656
remove nodes length
504
  (32, 0)	1
  (76, 10)	1
  (100, 21)	1
  (99, 23)	1
  (0, 32)	1
  (92, 36)	1
  (113, 39)	1
  (123, 39)	1
  (108, 50)	1
  (59, 56)	1
  (56, 59)	1
  (115, 61)	1
  (93, 63)	1
  (10, 76)	1
  (85, 76)	1
  (76, 85)	1
  (124, 87)	1
  (36, 92)	1
  (107, 92)	1
  (63, 93)	1
  (23, 99)	1
  (21, 100)	1
  (101, 100)	1
  (132, 100)	1
  (100, 101)	1
  (108, 105)	1
  (92, 107)	1
  (50, 108)	1
  (105, 108)	1
  (39, 113)	1
  (123, 113)	1
  (131, 113)	1
  (61, 115)	1
  (39, 123)	1
  (113, 123)	1
  (131, 123)	1
  (87, 124)	1
  (134, 128)	1
  (113, 131)	1
  (123, 131)	1
  (100, 132)	1
  (128, 134)	1
prepare for output_shared_matrix spent  0.0001800060272216797
42
    source  target  weight  capacity
0       32       0       1         1
1       76      10       1         1
2      100      21       1         1
3       99      23       1         1
4        0      32       1         1
5       92      36       1         1
6      113      39       1         1
7      123      39       1         1
8      108      50       1         1
9       59      56       1         1
10      56      59       1         1
11     115      61       1         1
12      93      63       1         1
13      10      76       1         1
14      85      76       1         1
15      76      85       1         1
16     124      87       1         1
17      36      92       1         1
18     107      92       1         1
19      63      93       1         1
20      23      99       1         1
21      21     100       1         1
22     101     100       1         1
23     132     100       1         1
24     100     101       1         1
25     108     105       1         1
26      92     107       1         1
27      50     108       1         1
28     105     108       1         1
29      39     113       1         1
30     123     113       1         1
31     131     113       1         1
32      61     115       1         1
33      39     123       1         1
34     113     123       1         1
35     131     123       1         1
36      87     124       1         1
37     134     128       1         1
38     113     131       1         1
39     123     131       1         1
40     100     132       1         1
41     128     134       1         1
get auxiliary matrix spent  0.010936260223388672
cut_value
0
({0, 131, 132, 10, 76, 21, 85, 23, 87, 92, 93, 32, 99, 36, 100, 101, 39, 105, 107, 108, 123, 113, 50, 115, 56, 59, 124, 61, 63}, {128, 134})
get mini cut partition spent  0.0003790855407714844
partition adjustment spent  0.022413969039916992
self.weighted_graph_bipart() spend  0.09229183197021484
after graph partition
graph partition algorithm spend time 0.09263396263122559
[3, 7, 65, 67, 69, 70, 346, 575, 736, 1047, 1162, 1327, 1415, 1587, 1682, 1683, 1852, 1898, 1921, 1938, 1939, 2064, 2141, 2223, 2296, 2337, 2445, 2669, 2681]
[24, 34, 52, 72, 74, 79, 130, 138, 140, 168, 184, 186, 240, 242, 266, 310, 328, 352, 403, 417, 419, 429, 431, 432, 452, 468, 479, 484, 501, 542, 554, 580, 592, 602, 623, 624, 637, 645, 666, 741, 760, 776, 812, 818, 821, 845, 850, 859, 866, 899, 910, 925, 1002, 1049, 1082, 1101, 1209, 1230, 1281, 1286, 1308, 1337, 1343, 1372, 1410, 1428, 1454, 1487, 1488, 1516, 1544, 1716, 1754, 1793, 1794, 1795, 1819, 1826, 1879, 1924, 1941, 1958, 1981, 1985, 2001, 2004, 2013, 2020, 2029, 2032, 2068, 2079, 2156, 2160, 2169, 2208, 2209, 2224, 2226, 2232, 2287, 2367, 2401, 2468, 2469, 2518, 2528, 2543, 2569, 2658, 2673]
partition_len_list
[182, 484]
shared_neighbor_graph_partition selection method range initialization spend 0.09297537803649902
time for parepare:  5.7220458984375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0006976127624511719
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00014090538024902344
----------------------check_connections_block total spend ----------------------------- 0.0014150142669677734
generate_one_block  0.003129243850708008
generate_one_block  0.0013108253479003906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006079673767089844
gen group dst list time:  2.9802322387695312e-05
time for parepare:  0.00016927719116210938
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00040268898010253906
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0008866786956787109
----------------------check_connections_block total spend ----------------------------- 0.00243377685546875
generate_one_block  0.0015156269073486328
generate_one_block  0.0021016597747802734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006175041198730469
gen group dst list time:  5.245208740234375e-05
time for parepare:  0.00017309188842773438
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0010404586791992188
local_output_nid generation:  9.202957153320312e-05
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.00018906593322753906
r_  generation:  0.0020999908447265625
----------------------check_connections_block total spend ----------------------------- 0.0051572322845458984
generate_one_block  0.002309560775756836
generate_one_block  0.0034036636352539062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.0075910091400146484
block generation total time  0.009330511093139648
average batch blocks generation time:  0.004665255546569824
pseudo mini batch 0 input nodes size: 1330
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.07680797576904297  GigaBytes
Max Memory Allocated: 0.07680797576904297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.07680845260620117  GigaBytes
Max Memory Allocated: 0.07680845260620117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.07680845260620117  GigaBytes
Max Memory Allocated: 0.07680845260620117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07684469223022461  GigaBytes
Max Memory Allocated: 0.07684469223022461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07684469223022461  GigaBytes
Max Memory Allocated: 0.07684469223022461  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07684469223022461  GigaBytes
Max Memory Allocated: 0.07684469223022461  GigaBytes

torch.Size([1330, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07684469223022461  GigaBytes
Max Memory Allocated: 0.07684469223022461  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07684469223022461  GigaBytes
Max Memory Allocated: 0.07684469223022461  GigaBytes

m.shape torch.Size([30, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.09465503692626953  GigaBytes
Max Memory Allocated: 0.09465599060058594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.09465503692626953  GigaBytes
Max Memory Allocated: 0.09465599060058594  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.09497547149658203  GigaBytes
Max Memory Allocated: 0.09497547149658203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09753894805908203  GigaBytes
Max Memory Allocated: 0.09769916534423828  GigaBytes

torch.Size([1, 30, 1433])
m.shape torch.Size([94, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09838247299194336  GigaBytes
Max Memory Allocated: 0.09838485717773438  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09838247299194336  GigaBytes
Max Memory Allocated: 0.09838485717773438  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.09938669204711914  GigaBytes
Max Memory Allocated: 0.09938669204711914  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.11510848999023438  GigaBytes
Max Memory Allocated: 0.11611223220825195  GigaBytes

torch.Size([1, 94, 1433])
m.shape torch.Size([125, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.1166086196899414  GigaBytes
Max Memory Allocated: 0.11661291122436523  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.1166086196899414  GigaBytes
Max Memory Allocated: 0.11661291122436523  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.11794376373291016  GigaBytes
Max Memory Allocated: 0.11794376373291016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.1474757194519043  GigaBytes
Max Memory Allocated: 0.14947795867919922  GigaBytes

torch.Size([1, 125, 1433])
m.shape torch.Size([107, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.1490931510925293  GigaBytes
Max Memory Allocated: 0.14947795867919922  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.1490931510925293  GigaBytes
Max Memory Allocated: 0.14947795867919922  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.15023565292358398  GigaBytes
Max Memory Allocated: 0.15023565292358398  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18336820602416992  GigaBytes
Max Memory Allocated: 0.1856532096862793  GigaBytes

torch.Size([1, 107, 1433])
m.shape torch.Size([93, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18527936935424805  GigaBytes
Max Memory Allocated: 0.1856532096862793  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18527936935424805  GigaBytes
Max Memory Allocated: 0.1856532096862793  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18627309799194336  GigaBytes
Max Memory Allocated: 0.18627309799194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.22260141372680664  GigaBytes
Max Memory Allocated: 0.2250838279724121  GigaBytes

torch.Size([1, 93, 1433])
m.shape torch.Size([40, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.22338581085205078  GigaBytes
Max Memory Allocated: 0.2250838279724121  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.22338581085205078  GigaBytes
Max Memory Allocated: 0.2250838279724121  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4139404296875 GB
    Memory Allocated: 0.22381305694580078  GigaBytes
Max Memory Allocated: 0.2250838279724121  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.24218463897705078  GigaBytes
Max Memory Allocated: 0.24346590042114258  GigaBytes

torch.Size([1, 40, 1433])
m.shape torch.Size([28, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.24322223663330078  GigaBytes
Max Memory Allocated: 0.24346590042114258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.24322223663330078  GigaBytes
Max Memory Allocated: 0.24346590042114258  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.24352169036865234  GigaBytes
Max Memory Allocated: 0.24352169036865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.25847434997558594  GigaBytes
Max Memory Allocated: 0.2595210075378418  GigaBytes

torch.Size([1, 28, 1433])
m.shape torch.Size([22, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.2592644691467285  GigaBytes
Max Memory Allocated: 0.2595210075378418  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.2592644691467285  GigaBytes
Max Memory Allocated: 0.2595210075378418  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.25950002670288086  GigaBytes
Max Memory Allocated: 0.2595210075378418  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.2729039192199707  GigaBytes
Max Memory Allocated: 0.27384376525878906  GigaBytes

torch.Size([1, 22, 1433])
m.shape torch.Size([6, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.2730746269226074  GigaBytes
Max Memory Allocated: 0.27384376525878906  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.2730746269226074  GigaBytes
Max Memory Allocated: 0.27384376525878906  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4608154296875 GB
    Memory Allocated: 0.27313947677612305  GigaBytes
Max Memory Allocated: 0.27384376525878906  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.2772512435913086  GigaBytes
Max Memory Allocated: 0.2775397300720215  GigaBytes

torch.Size([1, 6, 1433])
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.2777528762817383  GigaBytes
Max Memory Allocated: 0.2777543067932129  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.2777528762817383  GigaBytes
Max Memory Allocated: 0.2777543067932129  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.2778596878051758  GigaBytes
Max Memory Allocated: 0.2778596878051758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.2854433059692383  GigaBytes
Max Memory Allocated: 0.2859773635864258  GigaBytes

torch.Size([1, 10, 1433])
m.shape torch.Size([7, 11, 1433])
----------------------------------------1
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.28580141067504883  GigaBytes
Max Memory Allocated: 0.2859773635864258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.28580141067504883  GigaBytes
Max Memory Allocated: 0.2859773635864258  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.2858767509460449  GigaBytes
Max Memory Allocated: 0.2859773635864258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.29172182083129883  GigaBytes
Max Memory Allocated: 0.2921333312988281  GigaBytes

torch.Size([1, 7, 1433])
m.shape torch.Size([7, 12, 1433])
----------------------------------------1
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.2921328544616699  GigaBytes
Max Memory Allocated: 0.29213428497314453  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.2921328544616699  GigaBytes
Max Memory Allocated: 0.29213428497314453  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4783935546875 GB
    Memory Allocated: 0.292208194732666  GigaBytes
Max Memory Allocated: 0.292208194732666  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.29857778549194336  GigaBytes
Max Memory Allocated: 0.2990264892578125  GigaBytes

torch.Size([1, 7, 1433])
m.shape torch.Size([3, 13, 1433])
----------------------------------------1
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.2987484931945801  GigaBytes
Max Memory Allocated: 0.2990264892578125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.2987484931945801  GigaBytes
Max Memory Allocated: 0.2990264892578125  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.2987809181213379  GigaBytes
Max Memory Allocated: 0.2990264892578125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.3017454147338867  GigaBytes
Max Memory Allocated: 0.3019537925720215  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([2, 14, 1433])
----------------------------------------1
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.3018789291381836  GigaBytes
Max Memory Allocated: 0.3019537925720215  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.3018789291381836  GigaBytes
Max Memory Allocated: 0.3019537925720215  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.30190086364746094  GigaBytes
Max Memory Allocated: 0.3019537925720215  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.3040323257446289  GigaBytes
Max Memory Allocated: 0.3041820526123047  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([4, 15, 1433])
----------------------------------------1
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.30434179306030273  GigaBytes
Max Memory Allocated: 0.30434274673461914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.30434179306030273  GigaBytes
Max Memory Allocated: 0.30434274673461914  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4901123046875 GB
    Memory Allocated: 0.304384708404541  GigaBytes
Max Memory Allocated: 0.304384708404541  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.30893373489379883  GigaBytes
Max Memory Allocated: 0.30925416946411133  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([4, 16, 1433])
----------------------------------------1
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.30925416946411133  GigaBytes
Max Memory Allocated: 0.30925512313842773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.30925416946411133  GigaBytes
Max Memory Allocated: 0.30925512313842773  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.3092970848083496  GigaBytes
Max Memory Allocated: 0.3092970848083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.3141465187072754  GigaBytes
Max Memory Allocated: 0.31448841094970703  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([5, 17, 1433])
----------------------------------------1
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.3145790100097656  GigaBytes
Max Memory Allocated: 0.31458044052124023  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.3145790100097656  GigaBytes
Max Memory Allocated: 0.31458044052124023  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.3146324157714844  GigaBytes
Max Memory Allocated: 0.3146324157714844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.3210411071777344  GigaBytes
Max Memory Allocated: 0.32149505615234375  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([1, 18, 1433])
----------------------------------------1
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.32111072540283203  GigaBytes
Max Memory Allocated: 0.32149505615234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.32111072540283203  GigaBytes
Max Memory Allocated: 0.32149505615234375  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.3211221694946289  GigaBytes
Max Memory Allocated: 0.32149505615234375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.3224983215332031  GigaBytes
Max Memory Allocated: 0.32259464263916016  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 19, 1433])
----------------------------------------1
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.3227972984313965  GigaBytes
Max Memory Allocated: 0.3227982521057129  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.3227972984313965  GigaBytes
Max Memory Allocated: 0.3227982521057129  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.3228297233581543  GigaBytes
Max Memory Allocated: 0.3228297233581543  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.3271474838256836  GigaBytes
Max Memory Allocated: 0.3274521827697754  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 21, 1433])
----------------------------------------1
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.3272438049316406  GigaBytes
Max Memory Allocated: 0.3274521827697754  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.3272438049316406  GigaBytes
Max Memory Allocated: 0.3274521827697754  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.3272552490234375  GigaBytes
Max Memory Allocated: 0.3274521827697754  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.3288588523864746  GigaBytes
Max Memory Allocated: 0.32897138595581055  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 23, 1433])
----------------------------------------1
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.3289761543273926  GigaBytes
Max Memory Allocated: 0.328977108001709  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.3289761543273926  GigaBytes
Max Memory Allocated: 0.328977108001709  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.32898759841918945  GigaBytes
Max Memory Allocated: 0.32898759841918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.33074283599853516  GigaBytes
Max Memory Allocated: 0.33086585998535156  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([16, 25, 1433])
----------------------------------------1
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.3330988883972168  GigaBytes
Max Memory Allocated: 0.33310413360595703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.3330988883972168  GigaBytes
Max Memory Allocated: 0.33310413360595703  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.3332705497741699  GigaBytes
Max Memory Allocated: 0.3332705497741699  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.3633756637573242  GigaBytes
Max Memory Allocated: 0.365511417388916  GigaBytes

torch.Size([1, 16, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.3489222526550293  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.3495030403137207  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3500838279724121  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.34949827194213867  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([609, 256])
input nodes number: 1330
output nodes number: 609
edges number: 3208
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3500957489013672  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([609, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3506765365600586  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([609, 256])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.35082197189331055  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([609, 256])
----------------------------------------before model layer 1
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.35082197189331055  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([609, 256])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.35082197189331055  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.35082197189331055  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.35200929641723633  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.35200929641723633  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3520169258117676  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3520779609680176  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 4, 256])
m.shape torch.Size([19, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3521108627319336  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3521108627319336  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.35214710235595703  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3526906967163086  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 19, 256])
m.shape torch.Size([29, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3527565002441406  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3527565002441406  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3528118133544922  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.35402870178222656  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 29, 256])
m.shape torch.Size([35, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.35413599014282227  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.35413599014282227  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3542027473449707  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.3561387062072754  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 35, 256])
m.shape torch.Size([34, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.35626888275146484  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.35626888275146484  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.35633373260498047  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.35866832733154297  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 34, 256])
m.shape torch.Size([14, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.3587169647216797  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.3587169647216797  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.35874366760253906  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.3598918914794922  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 14, 256])
m.shape torch.Size([13, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.3599662780761719  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.3599662780761719  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.35999107360839844  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.36123085021972656  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 13, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.3612957000732422  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.3612957000732422  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.3613147735595703  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.36240196228027344  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 10, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.36240148544311523  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.36240148544311523  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.36240339279174805  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.36252546310424805  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.3625631332397461  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.3625631332397461  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.36257076263427734  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3631124496459961  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 4, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3631300926208496  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3631300926208496  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36313390731811523  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.363431453704834  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 2, 256])
m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3634529113769531  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3634529113769531  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36345672607421875  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3637809753417969  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 2, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36382532119750977  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36382532119750977  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3638310432434082  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36447763442993164  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 3, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36450767517089844  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36450767517089844  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36451148986816406  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.36496925354003906  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 2, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.364987850189209  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.364987850189209  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3649897575378418  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.36527204513549805  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([2, 32, 256])
----------------------------------------1
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.36533260345458984  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.36533260345458984  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.36533641815185547  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.3661947250366211  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 2, 256])
m.shape torch.Size([1, 33, 256])
----------------------------------------1
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.3662247657775879  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.3662247657775879  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.3662266731262207  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.3666691780090332  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([6, 35, 256])
----------------------------------------1
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.3668704032897949  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.3668704032897949  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.3668818473815918  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.36969709396362305  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 6, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3686952590942383  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3688688278198242  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.36904239654541016  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3688673973083496  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([182, 256])
input nodes number: 609
output nodes number: 182
edges number: 1199
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.369049072265625  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([182, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.36922264099121094  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([182, 256])
----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3692660331726074  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([182, 256])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3692660331726074  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3692660331726074  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3694934844970703  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3694934844970703  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3694953918457031  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3695240020751953  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3695406913757324  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3695406913757324  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3695521354675293  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.36980390548706055  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 6, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3698101043701172  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3698101043701172  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3698158264160156  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3699817657470703  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 3, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3700127601623535  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3700127601623535  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3700261116027832  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37050676345825195  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 7, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3705177307128906  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3705177307128906  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37052345275878906  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3707695007324219  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 3, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37078046798706055  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37078046798706055  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37078428268432617  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3709750175476074  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 2, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3709888458251953  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3709888458251953  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37099266052246094  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37121009826660156  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 2, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3712172508239746  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3712172508239746  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3712191581726074  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3713412284851074  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3713502883911133  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3713502883911133  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3713521957397461  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3714876174926758  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37149858474731445  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37149858474731445  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37150049209594727  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37166261672973633  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 32, 256])
----------------------------------------1
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3716926574707031  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.3716926574707031  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.37169456481933594  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.37212371826171875  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 36, 256])
----------------------------------------1
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.37215757369995117  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.37215757369995117  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.372159481048584  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.37264204025268555  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.37244701385498047  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.3724479675292969  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.3724489212036133  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.37244749069213867  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

torch.Size([29, 7])
input nodes number: 182
output nodes number: 29
edges number: 214
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.3724503517150879  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.3724513053894043  GigaBytes
Max Memory Allocated: 0.37303829193115234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.14714527130126953  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

pseudo mini batch 1 input nodes size: 2068
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.14703130722045898  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.14703130722045898  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.15807104110717773  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.15807199478149414  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.1509714126586914  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.15104389190673828  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.15104389190673828  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.15104389190673828  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

torch.Size([2068, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.15104389190673828  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.7166748046875 GB
    Memory Allocated: 0.15104389190673828  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

m.shape torch.Size([106, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.1854548454284668  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.1854548454284668  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.18658685684204102  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.19564151763916016  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

torch.Size([1, 106, 1433])
m.shape torch.Size([253, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.19777679443359375  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.19777679443359375  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.20120000839233398  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.24185466766357422  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

torch.Size([1, 253, 1433])
m.shape torch.Size([282, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.24502038955688477  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.24502038955688477  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.24834346771240234  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.3145880699157715  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

torch.Size([1, 282, 1433])
m.shape torch.Size([231, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.31801509857177734  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.31801509857177734  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.32094478607177734  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3948636054992676  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

torch.Size([1, 231, 1433])
m.shape torch.Size([189, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.39867496490478516  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.39867496490478516  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.4008369445800781  GigaBytes
Max Memory Allocated: 0.4764680862426758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.474700927734375  GigaBytes
Max Memory Allocated: 0.47974586486816406  GigaBytes

torch.Size([1, 189, 1433])
m.shape torch.Size([94, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.4767031669616699  GigaBytes
Max Memory Allocated: 0.47974586486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.4767031669616699  GigaBytes
Max Memory Allocated: 0.47974586486816406  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.4777073860168457  GigaBytes
Max Memory Allocated: 0.47974586486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.5212898254394531  GigaBytes
Max Memory Allocated: 0.5243010520935059  GigaBytes

torch.Size([1, 94, 1433])
m.shape torch.Size([50, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.5226564407348633  GigaBytes
Max Memory Allocated: 0.5243010520935059  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.5226564407348633  GigaBytes
Max Memory Allocated: 0.5243010520935059  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.8885498046875 GB
    Memory Allocated: 0.5231904983520508  GigaBytes
Max Memory Allocated: 0.5243010520935059  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.5504374504089355  GigaBytes
Max Memory Allocated: 0.5523061752319336  GigaBytes

torch.Size([1, 50, 1433])
m.shape torch.Size([37, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.551750659942627  GigaBytes
Max Memory Allocated: 0.5523061752319336  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.551750659942627  GigaBytes
Max Memory Allocated: 0.5523061752319336  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.5521464347839355  GigaBytes
Max Memory Allocated: 0.5523061752319336  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.5746712684631348  GigaBytes
Max Memory Allocated: 0.5762515068054199  GigaBytes

torch.Size([1, 37, 1433])
m.shape torch.Size([20, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.575434684753418  GigaBytes
Max Memory Allocated: 0.5762515068054199  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.575434684753418  GigaBytes
Max Memory Allocated: 0.5762515068054199  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.575648307800293  GigaBytes
Max Memory Allocated: 0.5762515068054199  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.589320182800293  GigaBytes
Max Memory Allocated: 0.5902814865112305  GigaBytes

torch.Size([1, 20, 1433])
m.shape torch.Size([21, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.5903348922729492  GigaBytes
Max Memory Allocated: 0.5903377532958984  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.5903348922729492  GigaBytes
Max Memory Allocated: 0.5903377532958984  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.5905599594116211  GigaBytes
Max Memory Allocated: 0.5905599594116211  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6064968109130859  GigaBytes
Max Memory Allocated: 0.6076183319091797  GigaBytes

torch.Size([1, 21, 1433])
m.shape torch.Size([12, 11, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6070890426635742  GigaBytes
Max Memory Allocated: 0.6076183319091797  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6070890426635742  GigaBytes
Max Memory Allocated: 0.6076183319091797  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6072177886962891  GigaBytes
Max Memory Allocated: 0.6076183319091797  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6172285079956055  GigaBytes
Max Memory Allocated: 0.6179332733154297  GigaBytes

torch.Size([1, 12, 1433])
m.shape torch.Size([14, 12, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6180610656738281  GigaBytes
Max Memory Allocated: 0.6180634498596191  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6180610656738281  GigaBytes
Max Memory Allocated: 0.6180634498596191  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6182107925415039  GigaBytes
Max Memory Allocated: 0.6182107925415039  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.63092041015625  GigaBytes
Max Memory Allocated: 0.6318173408508301  GigaBytes

torch.Size([1, 14, 1433])
m.shape torch.Size([4, 13, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6311235427856445  GigaBytes
Max Memory Allocated: 0.6318173408508301  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6311235427856445  GigaBytes
Max Memory Allocated: 0.6318173408508301  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6311664581298828  GigaBytes
Max Memory Allocated: 0.6318173408508301  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6351146697998047  GigaBytes
Max Memory Allocated: 0.6353926658630371  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([5, 14, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6354670524597168  GigaBytes
Max Memory Allocated: 0.6354684829711914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6354670524597168  GigaBytes
Max Memory Allocated: 0.6354684829711914  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6355204582214355  GigaBytes
Max Memory Allocated: 0.6355204582214355  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6408076286315918  GigaBytes
Max Memory Allocated: 0.641181468963623  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([4, 15, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6411013603210449  GigaBytes
Max Memory Allocated: 0.641181468963623  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6411013603210449  GigaBytes
Max Memory Allocated: 0.641181468963623  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6411442756652832  GigaBytes
Max Memory Allocated: 0.641181468963623  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.645693302154541  GigaBytes
Max Memory Allocated: 0.6460137367248535  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([5, 16, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6460990905761719  GigaBytes
Max Memory Allocated: 0.6461005210876465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6460990905761719  GigaBytes
Max Memory Allocated: 0.6461005210876465  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6461524963378906  GigaBytes
Max Memory Allocated: 0.6461524963378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6521873474121094  GigaBytes
Max Memory Allocated: 0.6526145935058594  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([7, 17, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6527962684631348  GigaBytes
Max Memory Allocated: 0.6527976989746094  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6527962684631348  GigaBytes
Max Memory Allocated: 0.6527976989746094  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6528716087341309  GigaBytes
Max Memory Allocated: 0.6528716087341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6618638038635254  GigaBytes
Max Memory Allocated: 0.6624994277954102  GigaBytes

torch.Size([1, 7, 1433])
m.shape torch.Size([3, 18, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6621146202087402  GigaBytes
Max Memory Allocated: 0.6624994277954102  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6621146202087402  GigaBytes
Max Memory Allocated: 0.6624994277954102  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.662147045135498  GigaBytes
Max Memory Allocated: 0.6624994277954102  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6662392616271973  GigaBytes
Max Memory Allocated: 0.6665277481079102  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([4, 19, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6666288375854492  GigaBytes
Max Memory Allocated: 0.6666302680969238  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6666288375854492  GigaBytes
Max Memory Allocated: 0.6666302680969238  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6666717529296875  GigaBytes
Max Memory Allocated: 0.6666717529296875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6724224090576172  GigaBytes
Max Memory Allocated: 0.672828197479248  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([3, 21, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6727375984191895  GigaBytes
Max Memory Allocated: 0.672828197479248  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6727375984191895  GigaBytes
Max Memory Allocated: 0.672828197479248  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6727700233459473  GigaBytes
Max Memory Allocated: 0.672828197479248  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6775388717651367  GigaBytes
Max Memory Allocated: 0.6778755187988281  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 22, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.677640438079834  GigaBytes
Max Memory Allocated: 0.6778755187988281  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.677640438079834  GigaBytes
Max Memory Allocated: 0.6778755187988281  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6776518821716309  GigaBytes
Max Memory Allocated: 0.6778755187988281  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6793313026428223  GigaBytes
Max Memory Allocated: 0.6794490814208984  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 23, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6796941757202148  GigaBytes
Max Memory Allocated: 0.6796956062316895  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6796941757202148  GigaBytes
Max Memory Allocated: 0.6796956062316895  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6797266006469727  GigaBytes
Max Memory Allocated: 0.6797266006469727  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6849465370178223  GigaBytes
Max Memory Allocated: 0.6853151321411133  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([17, 25, 1433])
----------------------------------------1
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6878743171691895  GigaBytes
Max Memory Allocated: 0.6878795623779297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.6878743171691895  GigaBytes
Max Memory Allocated: 0.6878795623779297  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.688056468963623  GigaBytes
Max Memory Allocated: 0.688056468963623  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.7200436592102051  GigaBytes
Max Memory Allocated: 0.7223129272460938  GigaBytes

torch.Size([1, 17, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6931033134460449  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6944541931152344  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6957559585571289  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.694394588470459  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1365, 256])
input nodes number: 2068
output nodes number: 1365
edges number: 6317
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6957736015319824  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1365, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6972794532775879  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1365, 256])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6974010467529297  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1365, 256])
----------------------------------------before model layer 1
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6974010467529297  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1365, 256])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6974010467529297  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6974010467529297  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

m.shape torch.Size([42, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7000870704650879  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7000870704650879  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.700167179107666  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.700808048248291  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 42, 256])
m.shape torch.Size([79, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7009201049804688  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7009201049804688  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7010707855224609  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7033309936523438  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 79, 256])
m.shape torch.Size([79, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7034835815429688  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7034835815429688  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7036342620849609  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.7069492340087891  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 79, 256])
m.shape torch.Size([80, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.707181453704834  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.707181453704834  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9510498046875 GB
    Memory Allocated: 0.707334041595459  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.711759090423584  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 80, 256])
m.shape torch.Size([56, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.7119522094726562  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.7119522094726562  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.7120590209960938  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.7159042358398438  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 56, 256])
m.shape torch.Size([50, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.7161393165588379  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.7161393165588379  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.7162346839904785  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7203354835510254  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 50, 256])
m.shape torch.Size([23, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7204427719116211  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7204427719116211  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7204866409301758  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.7226800918579102  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 23, 256])
m.shape torch.Size([13, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.7227582931518555  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.7227582931518555  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.722783088684082  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7241964340209961  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 13, 256])
m.shape torch.Size([7, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7242445945739746  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7242445945739746  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7242579460144043  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7251124382019043  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 7, 256])
m.shape torch.Size([10, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7252020835876465  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7252020835876465  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7252211570739746  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7265753746032715  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 10, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7266082763671875  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7266082763671875  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7266159057617188  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7272109985351562  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 4, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7272882461547852  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7272882461547852  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7273015975952148  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7284364700317383  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 7, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7284550666809082  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7284550666809082  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7284588813781738  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7288098335266113  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 2, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7288217544555664  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7288217544555664  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7288236618041992  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7290124893188477  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7290263175964355  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7290263175964355  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7290282249450684  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7292304039001465  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([4, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7292909622192383  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7292909622192383  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7292985916137695  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7301607131958008  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 4, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7302227020263672  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7302227020263672  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7302303314208984  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7311458587646484  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 4, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7311768531799316  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7311768531799316  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7311806678771973  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7316651344299316  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 2, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7317180633544922  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7317180633544922  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.7317237854003906  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.7324905395507812  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 3, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.7325081825256348  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.7325081825256348  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.7325100898742676  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.7327923774719238  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.7328581809997559  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.7328581809997559  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.7328639030456543  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7337908744812012  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 3, 256])
m.shape torch.Size([1, 29, 256])
----------------------------------------1
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7338161468505859  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7338161468505859  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7338180541992188  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7342071533203125  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 30, 256])
----------------------------------------1
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7342352867126465  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7342352867126465  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7342371940612793  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7346396446228027  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 31, 256])
----------------------------------------1
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7346687316894531  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7346687316894531  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7346706390380859  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7350864410400391  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 32, 256])
----------------------------------------1
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7351164817810059  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7351164817810059  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7351183891296387  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7355475425720215  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 33, 256])
----------------------------------------1
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7355785369873047  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7355785369873047  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.7355804443359375  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.73602294921875  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 34, 256])
----------------------------------------1
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7360548973083496  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7360548973083496  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7360568046569824  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7365126609802246  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([7, 35, 256])
----------------------------------------1
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7367472648620605  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7367472648620605  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7367606163024902  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.7400450706481934  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 7, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7378849983215332  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7383465766906738  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7388081550598145  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7383427619934082  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([484, 256])
input nodes number: 1365
output nodes number: 484
edges number: 2697
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7388205528259277  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([484, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7392821311950684  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([484, 256])
----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7393975257873535  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([484, 256])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7393975257873535  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7393975257873535  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7398476600646973  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7398476600646973  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7398858070373535  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7401909828186035  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 20, 256])
m.shape torch.Size([24, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7402181625366211  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7402181625366211  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7402639389038086  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7409505844116211  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

torch.Size([1, 24, 256])
m.shape torch.Size([20, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7409853935241699  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7409853935241699  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7410235404968262  GigaBytes
Max Memory Allocated: 0.7418122291564941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7418627738952637  GigaBytes
Max Memory Allocated: 0.741919994354248  GigaBytes

torch.Size([1, 20, 256])
m.shape torch.Size([19, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7419171333312988  GigaBytes
Max Memory Allocated: 0.741919994354248  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7419171333312988  GigaBytes
Max Memory Allocated: 0.741919994354248  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7419533729553223  GigaBytes
Max Memory Allocated: 0.7419533729553223  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.743004322052002  GigaBytes
Max Memory Allocated: 0.7430768013000488  GigaBytes

torch.Size([1, 19, 256])
m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7430248260498047  GigaBytes
Max Memory Allocated: 0.7430768013000488  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7430248260498047  GigaBytes
Max Memory Allocated: 0.7430768013000488  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7430400848388672  GigaBytes
Max Memory Allocated: 0.7430768013000488  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7435894012451172  GigaBytes
Max Memory Allocated: 0.7436275482177734  GigaBytes

torch.Size([1, 8, 256])
m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7436280250549316  GigaBytes
Max Memory Allocated: 0.7436285018920898  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7436280250549316  GigaBytes
Max Memory Allocated: 0.7436285018920898  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7436432838439941  GigaBytes
Max Memory Allocated: 0.7436432838439941  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7442994117736816  GigaBytes
Max Memory Allocated: 0.7443451881408691  GigaBytes

torch.Size([1, 8, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7443056106567383  GigaBytes
Max Memory Allocated: 0.7443451881408691  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7443056106567383  GigaBytes
Max Memory Allocated: 0.7443451881408691  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7443094253540039  GigaBytes
Max Memory Allocated: 0.7443451881408691  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7445001602172852  GigaBytes
Max Memory Allocated: 0.7445135116577148  GigaBytes

torch.Size([1, 2, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7445063591003418  GigaBytes
Max Memory Allocated: 0.7445135116577148  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7445063591003418  GigaBytes
Max Memory Allocated: 0.7445135116577148  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7445082664489746  GigaBytes
Max Memory Allocated: 0.7445135116577148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7446169853210449  GigaBytes
Max Memory Allocated: 0.7446246147155762  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7446422576904297  GigaBytes
Max Memory Allocated: 0.7446427345275879  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7446422576904297  GigaBytes
Max Memory Allocated: 0.7446427345275879  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.7446479797363281  GigaBytes
Max Memory Allocated: 0.7446479797363281  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7450141906738281  GigaBytes
Max Memory Allocated: 0.7450399398803711  GigaBytes

torch.Size([1, 3, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7450308799743652  GigaBytes
Max Memory Allocated: 0.7450399398803711  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7450308799743652  GigaBytes
Max Memory Allocated: 0.7450399398803711  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7450346946716309  GigaBytes
Max Memory Allocated: 0.7450399398803711  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7453055381774902  GigaBytes
Max Memory Allocated: 0.7453246116638184  GigaBytes

torch.Size([1, 2, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7453145980834961  GigaBytes
Max Memory Allocated: 0.7453246116638184  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7453145980834961  GigaBytes
Max Memory Allocated: 0.7453246116638184  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7453165054321289  GigaBytes
Max Memory Allocated: 0.7453246116638184  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7454652786254883  GigaBytes
Max Memory Allocated: 0.7454757690429688  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.745476245880127  GigaBytes
Max Memory Allocated: 0.7454767227172852  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.745476245880127  GigaBytes
Max Memory Allocated: 0.7454767227172852  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7454781532287598  GigaBytes
Max Memory Allocated: 0.7454781532287598  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7456402778625488  GigaBytes
Max Memory Allocated: 0.7456517219543457  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7456579208374023  GigaBytes
Max Memory Allocated: 0.7456583976745605  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7456579208374023  GigaBytes
Max Memory Allocated: 0.7456583976745605  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7456598281860352  GigaBytes
Max Memory Allocated: 0.7456598281860352  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.745915412902832  GigaBytes
Max Memory Allocated: 0.7459335327148438  GigaBytes

torch.Size([1, 1, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7459349632263184  GigaBytes
Max Memory Allocated: 0.7459354400634766  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7459349632263184  GigaBytes
Max Memory Allocated: 0.7459354400634766  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7459368705749512  GigaBytes
Max Memory Allocated: 0.7459368705749512  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7462191581726074  GigaBytes
Max Memory Allocated: 0.746239185333252  GigaBytes

torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7458996772766113  GigaBytes
Max Memory Allocated: 0.7465310096740723  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7459030151367188  GigaBytes
Max Memory Allocated: 0.7465310096740723  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7459063529968262  GigaBytes
Max Memory Allocated: 0.7465310096740723  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7459020614624023  GigaBytes
Max Memory Allocated: 0.7465310096740723  GigaBytes

torch.Size([111, 7])
input nodes number: 484
output nodes number: 111
edges number: 424
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7459092140197754  GigaBytes
Max Memory Allocated: 0.7465310096740723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.7459096908569336  GigaBytes
Max Memory Allocated: 0.7465310096740723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0877685546875 GB
    Memory Allocated: 0.15120363235473633  GigaBytes
Max Memory Allocated: 0.8082051277160645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.291750431060791  GigaBytes
Max Memory Allocated: 0.8082051277160645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.291750431060791  GigaBytes
Max Memory Allocated: 0.8082051277160645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03460538387298584 |0.17045915126800537 |0.4503525495529175 |0.00012743473052978516 |0.18439269065856934 |0.009781599044799805 |
----------------------------------------------------------pseudo_mini_loss sum 3.1891403198242188
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6038
Number of first layer input nodes during this epoch:  3398
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  18361424
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.2.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.2.lstm.bias_ih_l0, torch.Size([1024])
layers.2.lstm.bias_hh_l0, torch.Size([1024])
layers.2.fc_self.weight, torch.Size([7, 256])
layers.2.fc_neigh.weight, torch.Size([7, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
bns.1.weight, torch.Size([256])
bns.1.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
