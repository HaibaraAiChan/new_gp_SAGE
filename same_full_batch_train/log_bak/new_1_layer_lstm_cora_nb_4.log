main start at this time 1649982774.4902434
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.003979682922363281
global_2_local spend time (sec) 0.00011658668518066406
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00040602684020996094
A = g.adjacency_matrix() spent  0.00027680397033691406
tensor(indices=tensor([[140, 141, 142,  ...,  74, 588, 589],
                       [  0,   0,   1,  ..., 139, 139, 139]]),
       values=tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1.]),
       size=(590, 590), nnz=565, layout=torch.sparse_coo)
tensor(indices=tensor([[  0,   0,   1,  ..., 139, 139, 139],
                       [140, 141, 142,  ...,  74, 588, 589]]),
       values=tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
                      1., 1., 1., 1., 1.]),
       size=(590, 590), nnz=565, layout=torch.sparse_coo)
[[0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 12, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 16, 16, 17, 17, 17, 17, 17, 17, 18, 19, 19, 19, 20, 20, 20, 20, 20, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 29, 29, 29, 29, 29, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 31, 31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 36, 37, 37, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 39, 39, 40, 40, 40, 40, 40, 41, 41, 41, 41, 42, 42, 42, 42, 42, 42, 42, 42, 42, 43, 44, 44, 44, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 46, 47, 47, 48, 48, 49, 49, 49, 49, 49, 50, 51, 51, 51, 51, 51, 51, 51, 52, 52, 52, 52, 52, 53, 53, 53, 53, 53, 53, 53, 53, 53, 54, 54, 55, 55, 55, 56, 56, 56, 57, 57, 57, 57, 58, 58, 58, 58, 59, 59, 59, 60, 60, 61, 61, 62, 62, 62, 62, 63, 63, 63, 63, 64, 65, 65, 65, 65, 65, 66, 66, 66, 66, 67, 68, 68, 68, 68, 68, 69, 69, 69, 69, 69, 70, 70, 70, 71, 71, 72, 72, 72, 72, 72, 72, 73, 73, 73, 73, 73, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 75, 75, 75, 75, 75, 76, 77, 78, 78, 78, 79, 79, 79, 80, 80, 80, 81, 81, 81, 81, 82, 82, 82, 83, 83, 84, 84, 84, 84, 84, 84, 84, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 86, 86, 87, 87, 87, 87, 87, 87, 87, 88, 88, 88, 88, 89, 90, 90, 91, 91, 92, 92, 92, 92, 93, 94, 94, 94, 95, 95, 95, 95, 96, 97, 97, 98, 98, 98, 98, 98, 98, 98, 98, 99, 99, 99, 100, 100, 100, 100, 100, 100, 100, 100, 101, 101, 101, 101, 102, 103, 103, 104, 104, 104, 104, 104, 105, 106, 106, 106, 106, 106, 106, 107, 107, 107, 108, 108, 108, 108, 109, 109, 109, 109, 110, 111, 111, 112, 112, 112, 112, 112, 113, 113, 113, 113, 113, 113, 114, 114, 114, 115, 115, 115, 115, 115, 115, 115, 115, 115, 115, 116, 116, 116, 117, 117, 117, 118, 118, 118, 119, 119, 119, 120, 120, 120, 120, 121, 121, 121, 122, 122, 122, 122, 123, 124, 124, 125, 126, 126, 126, 127, 127, 127, 128, 128, 128, 128, 128, 128, 128, 128, 129, 129, 130, 130, 130, 130, 130, 130, 131, 131, 131, 131, 131, 131, 131, 132, 132, 132, 132, 133, 133, 133, 133, 133, 133, 134, 134, 134, 134, 134, 134, 135, 135, 135, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 137, 137, 138, 138, 138, 138, 139, 139, 139], [140, 141, 142, 143, 144, 145, 146, 147, 117, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 151, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 100, 181, 182, 183, 184, 185, 40, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 115, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 175, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 232, 244, 245, 246, 247, 248, 249, 250, 81, 251, 252, 253, 175, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 131, 280, 281, 282, 283, 221, 284, 285, 286, 287, 288, 289, 134, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 107, 301, 257, 302, 303, 304, 305, 13, 306, 307, 175, 308, 309, 310, 311, 312, 179, 115, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 175, 329, 330, 331, 332, 333, 334, 162, 133, 335, 63, 336, 88, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 231, 232, 348, 349, 350, 351, 352, 353, 305, 354, 355, 356, 357, 358, 304, 359, 360, 321, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 341, 379, 380, 335, 133, 49, 380, 144, 381, 146, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 87, 397, 398, 399, 400, 401, 402, 304, 403, 404, 405, 406, 202, 407, 408, 188, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 74, 428, 429, 430, 431, 432, 433, 434, 435, 436, 30, 251, 437, 438, 439, 107, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 403, 450, 451, 452, 453, 241, 454, 455, 456, 457, 458, 69, 455, 457, 459, 460, 461, 462, 133, 335, 336, 49, 463, 464, 465, 466, 467, 468, 278, 469, 470, 471, 472, 473, 474, 206, 313, 475, 476, 477, 159, 478, 479, 480, 313, 481, 482, 483, 484, 115, 101, 485, 486, 487, 313, 312, 11, 488, 130, 206, 489, 486, 490, 99, 491, 492, 175, 493, 494, 495, 496, 497, 498, 175, 401, 499, 500, 501, 260, 263, 38, 82, 502, 503, 504, 366, 505, 506, 507, 508, 509, 510, 511, 512, 406, 513, 514, 368, 515, 206, 516, 313, 517, 518, 312, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 493, 175, 532, 533, 534, 2, 535, 175, 398, 175, 536, 304, 537, 538, 539, 540, 541, 542, 543, 544, 467, 242, 232, 545, 546, 547, 548, 518, 549, 206, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 528, 368, 305, 100, 560, 561, 206, 562, 563, 564, 349, 565, 258, 566, 34, 567, 568, 569, 570, 571, 49, 336, 335, 380, 63, 88, 288, 289, 572, 573, 574, 37, 575, 576, 577, 292, 246, 295, 215, 548, 578, 579, 580, 300, 581, 582, 583, 584, 585, 586, 587, 74, 588, 589]]
[[140, 141, 142, 143, 144, 145, 146, 147, 117, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 151, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 100, 181, 182, 183, 184, 185, 40, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 115, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 175, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 232, 244, 245, 246, 247, 248, 249, 250, 81, 251, 252, 253, 175, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 131, 280, 281, 282, 283, 221, 284, 285, 286, 287, 288, 289, 134, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 107, 301, 257, 302, 303, 304, 305, 13, 306, 307, 175, 308, 309, 310, 311, 312, 179, 115, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 175, 329, 330, 331, 332, 333, 334, 162, 133, 335, 63, 336, 88, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 231, 232, 348, 349, 350, 351, 352, 353, 305, 354, 355, 356, 357, 358, 304, 359, 360, 321, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 341, 379, 380, 335, 133, 49, 380, 144, 381, 146, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 87, 397, 398, 399, 400, 401, 402, 304, 403, 404, 405, 406, 202, 407, 408, 188, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 74, 428, 429, 430, 431, 432, 433, 434, 435, 436, 30, 251, 437, 438, 439, 107, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 403, 450, 451, 452, 453, 241, 454, 455, 456, 457, 458, 69, 455, 457, 459, 460, 461, 462, 133, 335, 336, 49, 463, 464, 465, 466, 467, 468, 278, 469, 470, 471, 472, 473, 474, 206, 313, 475, 476, 477, 159, 478, 479, 480, 313, 481, 482, 483, 484, 115, 101, 485, 486, 487, 313, 312, 11, 488, 130, 206, 489, 486, 490, 99, 491, 492, 175, 493, 494, 495, 496, 497, 498, 175, 401, 499, 500, 501, 260, 263, 38, 82, 502, 503, 504, 366, 505, 506, 507, 508, 509, 510, 511, 512, 406, 513, 514, 368, 515, 206, 516, 313, 517, 518, 312, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 493, 175, 532, 533, 534, 2, 535, 175, 398, 175, 536, 304, 537, 538, 539, 540, 541, 542, 543, 544, 467, 242, 232, 545, 546, 547, 548, 518, 549, 206, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 528, 368, 305, 100, 560, 561, 206, 562, 563, 564, 349, 565, 258, 566, 34, 567, 568, 569, 570, 571, 49, 336, 335, 380, 63, 88, 288, 289, 572, 573, 574, 37, 575, 576, 577, 292, 246, 295, 215, 548, 578, 579, 580, 300, 581, 582, 583, 584, 585, 586, 587, 74, 588, 589], [0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 12, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 16, 16, 17, 17, 17, 17, 17, 17, 18, 19, 19, 19, 20, 20, 20, 20, 20, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 29, 29, 29, 29, 29, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 31, 31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 36, 37, 37, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 39, 39, 40, 40, 40, 40, 40, 41, 41, 41, 41, 42, 42, 42, 42, 42, 42, 42, 42, 42, 43, 44, 44, 44, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 46, 47, 47, 48, 48, 49, 49, 49, 49, 49, 50, 51, 51, 51, 51, 51, 51, 51, 52, 52, 52, 52, 52, 53, 53, 53, 53, 53, 53, 53, 53, 53, 54, 54, 55, 55, 55, 56, 56, 56, 57, 57, 57, 57, 58, 58, 58, 58, 59, 59, 59, 60, 60, 61, 61, 62, 62, 62, 62, 63, 63, 63, 63, 64, 65, 65, 65, 65, 65, 66, 66, 66, 66, 67, 68, 68, 68, 68, 68, 69, 69, 69, 69, 69, 70, 70, 70, 71, 71, 72, 72, 72, 72, 72, 72, 73, 73, 73, 73, 73, 74, 74, 74, 74, 74, 74, 74, 74, 74, 74, 75, 75, 75, 75, 75, 76, 77, 78, 78, 78, 79, 79, 79, 80, 80, 80, 81, 81, 81, 81, 82, 82, 82, 83, 83, 84, 84, 84, 84, 84, 84, 84, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 86, 86, 87, 87, 87, 87, 87, 87, 87, 88, 88, 88, 88, 89, 90, 90, 91, 91, 92, 92, 92, 92, 93, 94, 94, 94, 95, 95, 95, 95, 96, 97, 97, 98, 98, 98, 98, 98, 98, 98, 98, 99, 99, 99, 100, 100, 100, 100, 100, 100, 100, 100, 101, 101, 101, 101, 102, 103, 103, 104, 104, 104, 104, 104, 105, 106, 106, 106, 106, 106, 106, 107, 107, 107, 108, 108, 108, 108, 109, 109, 109, 109, 110, 111, 111, 112, 112, 112, 112, 112, 113, 113, 113, 113, 113, 113, 114, 114, 114, 115, 115, 115, 115, 115, 115, 115, 115, 115, 115, 116, 116, 116, 117, 117, 117, 118, 118, 118, 119, 119, 119, 120, 120, 120, 120, 121, 121, 121, 122, 122, 122, 122, 123, 124, 124, 125, 126, 126, 126, 127, 127, 127, 128, 128, 128, 128, 128, 128, 128, 128, 129, 129, 130, 130, 130, 130, 130, 130, 131, 131, 131, 131, 131, 131, 131, 132, 132, 132, 132, 133, 133, 133, 133, 133, 133, 134, 134, 134, 134, 134, 134, 135, 135, 135, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 137, 137, 138, 138, 138, 138, 139, 139, 139]]
get remove nodes spent  0.0004267692565917969
remove nodes length
450
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
[[10, 18, 19, 22, 25, 29, 30, 35, 38, 40, 41, 45, 51, 52, 58, 72, 82, 84, 85, 90, 91, 99, 101, 103, 105, 108, 110, 112, 116, 118, 119, 122, 125, 127, 129, 136], [0, 1, 3, 4, 6, 15, 16, 17, 21, 23, 26, 27, 28, 32, 33, 34, 53, 61, 65, 75, 89, 92, 97, 102, 104, 107, 109, 114, 115, 117, 120, 121, 124, 128, 139], [11, 20, 31, 36, 37, 39, 42, 49, 57, 59, 62, 63, 64, 67, 70, 71, 76, 77, 78, 88, 93, 94, 95, 96, 98, 100, 106, 113, 126, 130, 131, 133, 134, 135, 137, 138], [2, 5, 7, 8, 9, 12, 13, 14, 24, 43, 44, 46, 47, 48, 50, 54, 55, 56, 60, 66, 68, 69, 73, 74, 79, 80, 81, 83, 86, 87, 111, 123, 132]]
total k batches seeds list generation spend  0.03130912780761719
after graph partition
graph partition algorithm spend time 0.0800485610961914
[452, 479, 645, 812, 859, 866, 910, 1002, 1047, 1209, 1281, 1410, 1415, 1428, 1454, 1487, 1488, 1516, 1544, 1793, 1794, 1795, 2004, 2013, 2156, 2160, 2169, 2226, 2232, 2296, 2401, 2445, 2468, 2543, 2569, 2658]
[34, 52, 74, 130, 266, 310, 403, 419, 432, 501, 554, 575, 592, 666, 760, 818, 850, 899, 1049, 1308, 1372, 1683, 1754, 1852, 1879, 1898, 1981, 1985, 2001, 2029, 2032, 2141, 2208, 2209, 2287]
[3, 7, 24, 65, 67, 69, 70, 72, 79, 138, 140, 242, 429, 484, 580, 741, 925, 1082, 1162, 1230, 1327, 1337, 1343, 1587, 1682, 1716, 1921, 1938, 1939, 1941, 2020, 2079, 2337, 2367, 2518, 2528]
[168, 184, 186, 240, 328, 346, 352, 417, 431, 468, 542, 602, 623, 624, 637, 736, 776, 821, 845, 1101, 1286, 1819, 1826, 1924, 1958, 2064, 2068, 2223, 2224, 2469, 2669, 2673, 2681]
partition_len_list
[173, 170, 134, 136]
shared_neighbor_graph_partition selection method range initialization spend 0.08037400245666504
time for parepare:  6.961822509765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0018191337585449219
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.5789947509765625e-05
----------------------check_connections_block total spend ----------------------------- 0.0030317306518554688
generate_one_block  0.0017817020416259766
generate_one_block  0.0014150142669677734
generate_one_block  0.0013885498046875
generate_one_block  0.0014078617095947266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0.0
pseudo mini batch 0 input nodes size: 173
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06262063980102539  GigaBytes
Max Memory Allocated: 0.06262063980102539  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06354427337646484  GigaBytes
Max Memory Allocated: 0.06354427337646484  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06354475021362305  GigaBytes
Max Memory Allocated: 0.06354475021362305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06354475021362305  GigaBytes
Max Memory Allocated: 0.06354475021362305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06354665756225586  GigaBytes
Max Memory Allocated: 0.06354665756225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06354665756225586  GigaBytes
Max Memory Allocated: 0.06354665756225586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06354665756225586  GigaBytes
Max Memory Allocated: 0.06354665756225586  GigaBytes

torch.Size([173, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06354665756225586  GigaBytes
Max Memory Allocated: 0.06354665756225586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1444091796875 GB
    Memory Allocated: 0.06354665756225586  GigaBytes
Max Memory Allocated: 0.06354665756225586  GigaBytes

m.shape torch.Size([4, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.0645136833190918  GigaBytes
Max Memory Allocated: 0.0645146369934082  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.0645136833190918  GigaBytes
Max Memory Allocated: 0.0645146369934082  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06455659866333008  GigaBytes
Max Memory Allocated: 0.06455659866333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06489992141723633  GigaBytes
Max Memory Allocated: 0.06492137908935547  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([4, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06492137908935547  GigaBytes
Max Memory Allocated: 0.06492233276367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06492137908935547  GigaBytes
Max Memory Allocated: 0.06492233276367188  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06496429443359375  GigaBytes
Max Memory Allocated: 0.06496429443359375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06560802459716797  GigaBytes
Max Memory Allocated: 0.06565093994140625  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([7, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06569910049438477  GigaBytes
Max Memory Allocated: 0.06570005416870117  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06569910049438477  GigaBytes
Max Memory Allocated: 0.06570005416870117  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.06577444076538086  GigaBytes
Max Memory Allocated: 0.06577444076538086  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06742334365844727  GigaBytes
Max Memory Allocated: 0.0675358772277832  GigaBytes

torch.Size([1, 7, 1433])
m.shape torch.Size([5, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06749248504638672  GigaBytes
Max Memory Allocated: 0.0675358772277832  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06749248504638672  GigaBytes
Max Memory Allocated: 0.0675358772277832  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.06754589080810547  GigaBytes
Max Memory Allocated: 0.06754589080810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06909465789794922  GigaBytes
Max Memory Allocated: 0.06920146942138672  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([4, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06917476654052734  GigaBytes
Max Memory Allocated: 0.06920146942138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06917476654052734  GigaBytes
Max Memory Allocated: 0.06920146942138672  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2518310546875 GB
    Memory Allocated: 0.06921768188476562  GigaBytes
Max Memory Allocated: 0.06921768188476562  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07076263427734375  GigaBytes
Max Memory Allocated: 0.07086944580078125  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([3, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07083749771118164  GigaBytes
Max Memory Allocated: 0.07086944580078125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07083749771118164  GigaBytes
Max Memory Allocated: 0.07086944580078125  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.07086992263793945  GigaBytes
Max Memory Allocated: 0.07086992263793945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07225561141967773  GigaBytes
Max Memory Allocated: 0.07235193252563477  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([2, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07231426239013672  GigaBytes
Max Memory Allocated: 0.07235193252563477  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07231426239013672  GigaBytes
Max Memory Allocated: 0.07235193252563477  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07233619689941406  GigaBytes
Max Memory Allocated: 0.07235193252563477  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07341289520263672  GigaBytes
Max Memory Allocated: 0.07348775863647461  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07345008850097656  GigaBytes
Max Memory Allocated: 0.07348775863647461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07345008850097656  GigaBytes
Max Memory Allocated: 0.07348775863647461  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.07346153259277344  GigaBytes
Max Memory Allocated: 0.07348775863647461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.07415533065795898  GigaBytes
Max Memory Allocated: 0.0742034912109375  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([6, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.07447004318237305  GigaBytes
Max Memory Allocated: 0.07447099685668945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.07447004318237305  GigaBytes
Max Memory Allocated: 0.07447099685668945  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.07453489303588867  GigaBytes
Max Memory Allocated: 0.07453489303588867  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07909631729125977  GigaBytes
Max Memory Allocated: 0.07941675186157227  GigaBytes

torch.Size([1, 6, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07831287384033203  GigaBytes
Max Memory Allocated: 0.07963895797729492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07831382751464844  GigaBytes
Max Memory Allocated: 0.07963895797729492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07831478118896484  GigaBytes
Max Memory Allocated: 0.07963895797729492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07831335067749023  GigaBytes
Max Memory Allocated: 0.07963895797729492  GigaBytes

torch.Size([36, 7])
input nodes number: 173
output nodes number: 36
edges number: 174
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07831716537475586  GigaBytes
Max Memory Allocated: 0.07963895797729492  GigaBytes

torch.Size([36, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07831811904907227  GigaBytes
Max Memory Allocated: 0.07963895797729492  GigaBytes

torch.Size([36, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07831859588623047  GigaBytes
Max Memory Allocated: 0.07963895797729492  GigaBytes

torch.Size([36, 7])
torch.Size([36, 7])
input nodes number: 173
output nodes number: 36
edges number: 174
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07831954956054688  GigaBytes
Max Memory Allocated: 0.07963895797729492  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.07832050323486328  GigaBytes
Max Memory Allocated: 0.07963895797729492  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12617206573486328  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

pseudo mini batch 1 input nodes size: 170
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12616586685180664  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12616586685180664  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1270737648010254  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1270742416381836  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12615013122558594  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12615203857421875  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12615203857421875  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12615203857421875  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([170, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12615203857421875  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12615203857421875  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

m.shape torch.Size([3, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1269378662109375  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1269378662109375  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1269702911376953  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1272282600402832  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([9, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12730836868286133  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12730836868286133  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12740468978881836  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12884950637817383  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([1, 9, 1433])
m.shape torch.Size([7, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12891387939453125  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12891387939453125  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.12898921966552734  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13063812255859375  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([1, 7, 1433])
m.shape torch.Size([5, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1307072639465332  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1307072639465332  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13076066970825195  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1323094367980957  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([4, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13238954544067383  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13238954544067383  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1324324607849121  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13397741317749023  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([2, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13402032852172852  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13402032852172852  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13404226303100586  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13496828079223633  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13500022888183594  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13500022888183594  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1350116729736328  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13562965393066406  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13567209243774414  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13567209243774414  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13568353652954102  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13637733459472656  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([3, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13653182983398438  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13653182983398438  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1365642547607422  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13885211944580078  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([1, 3, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13825464248657227  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13825559616088867  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13825654983520508  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.13825511932373047  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([35, 7])
input nodes number: 170
output nodes number: 35
edges number: 141
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1382589340209961  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([35, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1382598876953125  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([35, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1382603645324707  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
input nodes number: 170
output nodes number: 35
edges number: 141
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1382603645324707  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1382608413696289  GigaBytes
Max Memory Allocated: 0.20250368118286133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12615633010864258  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

pseudo mini batch 2 input nodes size: 134
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12615013122558594  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12615013122558594  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12686586380004883  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12686634063720703  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12595796585083008  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1259598731994629  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1259598731994629  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1259598731994629  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([134, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1259598731994629  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1259598731994629  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

m.shape torch.Size([7, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12676715850830078  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12676715850830078  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12684249877929688  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1274423599243164  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([1, 7, 1433])
m.shape torch.Size([3, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12743711471557617  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12743711471557617  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12746953964233398  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12795305252075195  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([6, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12803316116333008  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12803316116333008  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1280980110168457  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12951183319091797  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([1, 6, 1433])
m.shape torch.Size([7, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12962913513183594  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12962913513183594  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12970447540283203  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13187789916992188  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([1, 7, 1433])
m.shape torch.Size([4, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13194704055786133  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13194704055786133  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1319899559020996  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13353490829467773  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([1, 4, 1433])
m.shape torch.Size([5, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13367366790771484  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13367366790771484  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1337270736694336  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13602352142333984  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13603448867797852  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13603448867797852  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1360459327697754  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13658809661865234  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13666820526123047  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13666820526123047  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1366901397705078  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13791751861572266  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([1, 2, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1379547119140625  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1379547119140625  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13796615600585938  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13865995407104492  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1380786895751953  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13807964324951172  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13808059692382812  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13807916641235352  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([36, 7])
input nodes number: 134
output nodes number: 36
edges number: 141
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13808298110961914  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([36, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13808393478393555  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([36, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13808441162109375  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

torch.Size([36, 7])
torch.Size([36, 7])
input nodes number: 134
output nodes number: 36
edges number: 141
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13808441162109375  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13808488845825195  GigaBytes
Max Memory Allocated: 0.2627415657043457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12596416473388672  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

pseudo mini batch 3 input nodes size: 136
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12595796585083008  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12595796585083008  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12668418884277344  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12668466567993164  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12596845626831055  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12596940994262695  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12596940994262695  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12596940994262695  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([136, 1433])
----------------------------------------after msg_fn = fn.copy_src('h', 'm')
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12596940994262695  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12596940994262695  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

m.shape torch.Size([6, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12659978866577148  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12659978866577148  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1266646385192871  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12717914581298828  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([1, 6, 1433])
m.shape torch.Size([9, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1272430419921875  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1272430419921875  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12733936309814453  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1287841796875  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([1, 9, 1433])
m.shape torch.Size([6, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12883234024047852  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12883234024047852  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12889719009399414  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1303110122680664  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([1, 6, 1433])
m.shape torch.Size([5, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1303853988647461  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1303853988647461  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13043880462646484  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1319875717163086  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([1, 5, 1433])
m.shape torch.Size([3, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13204097747802734  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13204097747802734  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13207340240478516  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13323354721069336  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([1, 3, 1433])
m.shape torch.Size([1, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13324975967407227  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13324975967407227  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13326120376586914  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1337275505065918  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1337594985961914  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1337594985961914  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13377094268798828  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13431310653686523  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1343555450439453  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1343555450439453  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1343669891357422  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13506078720092773  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([1, 1, 1433])
m.shape torch.Size([1, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13510847091674805  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13510847091674805  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13511991500854492  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13588953018188477  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([1, 1, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13546228408813477  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13546323776245117  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13546419143676758  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.13546276092529297  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([33, 7])
input nodes number: 136
output nodes number: 33
edges number: 109
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1354665756225586  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([33, 7])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.135467529296875  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([33, 7])
----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1354680061340332  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

torch.Size([33, 7])
torch.Size([33, 7])
input nodes number: 136
output nodes number: 33
edges number: 109
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1354680061340332  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1354684829711914  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.12597274780273438  GigaBytes
Max Memory Allocated: 0.2628059387207031  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.25121116638183594  GigaBytes
Max Memory Allocated: 0.34496116638183594  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.25121116638183594  GigaBytes
Max Memory Allocated: 0.34496116638183594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009811103343963623 |0.08827978372573853 |0.1489030122756958 |9.655952453613281e-05 |0.015753626823425293 |0.004931926727294922 |
----------------------------------------------------------pseudo_mini_loss sum 2.4430480003356934
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  613
Number of first layer input nodes during this epoch:  613
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=7, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(7, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  16459452
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([7, 1433])
layers.0.fc_neigh.weight, torch.Size([7, 1433])
bns.0.weight, torch.Size([7])
bns.0.bias, torch.Size([7])
----------------------------------------
un-trainable parameters
